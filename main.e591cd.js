var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(f){var n=0;return function(){return n<f.length?{done:!1,value:f[n++]}:{done:!0}}};$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,n,m){f!=Array.prototype&&f!=Object.prototype&&(f[n]=m.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(f,n){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:n})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function f(m){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(m||"")+"_"+n++,m)}var n=0;return f}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.asyncIterator;f||(f=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};
$jscomp.checkStringArgs=function(f,n,m){if(null==f)throw new TypeError("The 'this' value for String.prototype."+m+" must not be null or undefined");if(n instanceof RegExp)throw new TypeError("First argument to String.prototype."+m+" must not be a regular expression");return f+""};
$jscomp.polyfill=function(f,n,m,h){if(n){m=$jscomp.global;f=f.split(".");for(h=0;h<f.length-1;h++){var e=f[h];e in m||(m[e]={});m=m[e]}f=f[f.length-1];h=m[f];n=n(h);n!=h&&null!=n&&$jscomp.defineProperty(m,f,{configurable:!0,writable:!0,value:n})}};
$jscomp.polyfill("String.prototype.repeat",function(f){return f?f:function(f){var m=$jscomp.checkStringArgs(this,null,"repeat");if(0>f||1342177279<f)throw new RangeError("Invalid count value");f|=0;for(var h="";f;)if(f&1&&(h+=m),f>>>=1)m+=m;return h}},"es6","es3");
$jscomp.iteratorFromArray=function(f,n){$jscomp.initSymbolIterator();f instanceof String&&(f+="");var m=0,h={next:function(){if(m<f.length){var e=m++;return{value:n(e,f[e]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};$jscomp.polyfill("Array.prototype.keys",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");
$jscomp.polyfill("Number.parseFloat",function(f){return f||parseFloat},"es6","es3");$jscomp.polyfill("Number.parseInt",function(f){return f||parseInt},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f,m){return m})}},"es8","es3");$jscomp.findInternal=function(f,n,m){f instanceof String&&(f=String(f));for(var h=f.length,e=0;e<h;e++){var d=f[e];if(n.call(m,d,e,f))return{i:e,v:d}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(f,m){return $jscomp.findInternal(this,f,m).v}},"es6","es3");$jscomp.polyfill("Object.is",function(f){return f?f:function(f,m){return f===m?0!==f||1/f===1/m:f!==f&&m!==m}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(f){return f?f:function(f,m){var h=this;h instanceof String&&(h=String(h));var e=h.length;m=m||0;for(0>m&&(m=Math.max(m+e,0));m<e;m++){var d=h[m];if(d===f||Object.is(d,f))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(f){return f?f:function(f,m){return-1!==$jscomp.checkStringArgs(this,f,"includes").indexOf(f,m||0)}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(f){return f?f:function(f,m){var h=$jscomp.checkStringArgs(this,f,"endsWith");f+="";void 0===m&&(m=h.length);m=Math.max(0,Math.min(m|0,h.length));for(var e=f.length;0<e&&0<m;)if(h[--m]!=f[--e])return!1;return 0>=e}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(f){return f?f:function(f,m){var h=$jscomp.checkStringArgs(this,f,"startsWith");f+="";var e=h.length,d=f.length;m=Math.max(0,Math.min(m|0,h.length));for(var b=0;b<d&&m<e;)if(h[m++]!=f[b++])return!1;return b>=d}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(f){return f?f:function(f,m,h){var e=this.length||0;0>m&&(m=Math.max(0,e+m));if(null==h||h>e)h=e;h=Number(h);0>h&&(h=Math.max(0,e+h));for(m=Number(m||0);m<h;m++)this[m]=f;return this}},"es6","es3");$jscomp.owns=function(f,n){return Object.prototype.hasOwnProperty.call(f,n)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(f,n){for(var m=1;m<arguments.length;m++){var h=arguments[m];if(h)for(var e in h)$jscomp.owns(h,e)&&(f[e]=h[e])}return f};
$jscomp.polyfill("Object.assign",function(f){return f||$jscomp.assign},"es6","es3");$jscomp.polyfill("Math.sign",function(f){return f?f:function(f){f=Number(f);return 0===f||isNaN(f)?f:0<f?1:-1}},"es6","es3");$jscomp.makeIterator=function(f){var n="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return n?n.call(f):$jscomp.arrayIterator(f)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(f){function n(){this.batch_=null}function m(b){return b instanceof e?b:new e(function(a,c){a(b)})}if(f&&!$jscomp.FORCE_POLYFILL_PROMISE)return f;n.prototype.asyncExecute=function(b){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(b)};var h=$jscomp.global.setTimeout;n.prototype.asyncExecuteFunction=function(b){h(b,0)};n.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];b[a]=null;try{c()}catch(g){this.asyncThrow_(g)}}}this.batch_=null};n.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var e=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(c){a.reject(c)}};e.prototype.createResolveAndReject_=function(){function b(b){return function(d){c||(c=!0,b.call(a,d))}}var a=this,c=!1;
return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};e.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof e)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};e.prototype.resolveToNonPromiseObj_=function(b){var a=void 0;try{a=b.then}catch(c){this.reject_(c);return}"function"==typeof a?
this.settleSameAsThenable_(a,b):this.fulfill_(b)};e.prototype.reject_=function(b){this.settle_(2,b)};e.prototype.fulfill_=function(b){this.settle_(1,b)};e.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)d.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var d=new n;e.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};e.prototype.settleSameAsThenable_=function(b,a){var c=this.createResolveAndReject_();try{b.call(a,c.resolve,c.reject)}catch(g){c.reject(g)}};e.prototype.then=function(b,a){function c(a,c){return"function"==typeof a?function(c){try{d(a(c))}catch(p){k(p)}}:c}var d,k,l=new e(function(a,c){d=a;k=c});this.callWhenSettled_(c(b,d),c(a,k));return l};
e.prototype.catch=function(b){return this.then(void 0,b)};e.prototype.callWhenSettled_=function(b,a){function c(){switch(g.state_){case 1:b(g.result_);break;case 2:a(g.result_);break;default:throw Error("Unexpected state: "+g.state_);}}var g=this;null==this.onSettledCallbacks_?d.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=m;e.reject=function(b){return new e(function(a,c){c(b)})};e.race=function(b){return new e(function(a,c){for(var d=$jscomp.makeIterator(b),k=d.next();!k.done;k=d.next())m(k.value).callWhenSettled_(a,
c)})};e.all=function(b){var a=$jscomp.makeIterator(b),c=a.next();return c.done?m([]):new e(function(b,d){function g(a){return function(c){k[a]=c;r--;0==r&&b(k)}}var k=[],r=0;do k.push(void 0),r++,m(c.value).callWhenSettled_(g(k.length-1),d),c=a.next();while(!c.done)})};return e},"es6","es3");$jscomp.polyfill("Number.isFinite",function(f){return f?f:function(f){return"number"!==typeof f?!1:!isNaN(f)&&Infinity!==f&&-Infinity!==f}},"es6","es3");
$jscomp.polyfill("Number.isInteger",function(f){return f?f:function(f){return Number.isFinite(f)?f===Math.floor(f):!1}},"es6","es3");$jscomp.polyfill("String.prototype.trimLeft",function(f){function n(){return this.replace(/^[\s\xa0]+/,"")}return f||n},"es_2019","es3");$jscomp.polyfill("Math.log2",function(f){return f?f:function(f){return Math.log(f)/Math.LN2}},"es6","es3");$jscomp.underscoreProtoCanBeSet=function(){var f={a:!0},n={};try{return n.__proto__=f,n.a}catch(m){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(f,n){f.__proto__=n;if(f.__proto__!==n)throw new TypeError(f+" is not extensible");return f}:null;$jscomp.polyfill("Object.setPrototypeOf",function(f){return f||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Math.fround",function(f){if(f)return f;if($jscomp.SIMPLE_FROUND_POLYFILL||"function"!==typeof Float32Array)return function(f){return f};var n=new Float32Array(1);return function(f){n[0]=f;return n[0]}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(f){return f?f:function(){return[]}},"es6","es5");
$jscomp.polyfill("Reflect.ownKeys",function(f){return f?f:function(f){var m=[],h=Object.getOwnPropertyNames(f);f=Object.getOwnPropertySymbols(f);for(var e=0;e<h.length;e++)("jscomp_symbol_"==h[e].substring(0,14)?f:m).push(h[e]);return m.concat(f)}},"es6","es5");$jscomp.polyfill("Object.getOwnPropertyDescriptors",function(f){return f?f:function(f){for(var m={},h=Reflect.ownKeys(f),e=0;e<h.length;e++)m[h[e]]=Object.getOwnPropertyDescriptor(f,h[e]);return m}},"es8","es5");
(function(f,n,m){function h(d,b){b=n[d];if(!b){var a=f[d];if(!a)return;var c={};b=n[d]={exports:c};a[0](function(c){return h(a[1][c]||c)},b,c)}return b.exports}for(var e=0;e<m.length;e++)h(m[e])})({1:[function(f,n,m){f("../core/platform/CCClass");var h=f("../core/utils/misc");cc.Action=cc.Class({name:"cc.Action",ctor:function(){this.target=this.originalTarget=null;this.tag=cc.Action.TAG_INVALID},clone:function(){var e=new cc.Action;return e.originalTarget=null,e.target=null,e.tag=this.tag,e},isDone:function(){return!0},
startWithTarget:function(e){this.target=this.originalTarget=e},stop:function(){this.target=null},step:function(e){cc.logID(1006)},update:function(e){cc.logID(1007)},getTarget:function(){return this.target},setTarget:function(e){this.target=e},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(e){this.originalTarget=e},getTag:function(){return this.tag},setTag:function(e){this.tag=e},retain:function(){},release:function(){}});cc.Action.TAG_INVALID=-1;cc.FiniteTimeAction=
cc.Class({name:"cc.FiniteTimeAction",extends:cc.Action,ctor:function(){this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(e){this._duration=e},reverse:function(){return cc.logID(1008),null},clone:function(){return new cc.FiniteTimeAction}});cc.Speed=cc.Class({name:"cc.Speed",extends:cc.Action,ctor:function(e,d){this._speed=0;this._innerAction=null;e&&this.initWithAction(e,d)},getSpeed:function(){return this._speed},setSpeed:function(e){this._speed=
e},initWithAction:function(e,d){return e?(this._innerAction=e,this._speed=d,!0):(cc.errorID(1021),!1)},clone:function(){var e=new cc.Speed;return e.initWithAction(this._innerAction.clone(),this._speed),e},startWithTarget:function(e){cc.Action.prototype.startWithTarget.call(this,e);this._innerAction.startWithTarget(e)},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this)},step:function(e){this._innerAction.step(e*this._speed)},isDone:function(){return this._innerAction.isDone()},
reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(e){this._innerAction!==e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}});cc.speed=function(e,d){return new cc.Speed(e,d)};cc.Follow=cc.Class({name:"cc.Follow",extends:cc.Action,ctor:function(e,d){this._followedNode=null;this._boundaryFullyCovered=this._boundarySet=!1;this._fullScreenSize=this._halfScreenSize=null;this.bottomBoundary=this.topBoundary=this.rightBoundary=
this.leftBoundary=0;this._worldRect=cc.rect(0,0,0,0);e&&(d?this.initWithTarget(e,d):this.initWithTarget(e))},clone:function(){var e=new cc.Follow,d=this._worldRect;d=new cc.Rect(d.x,d.y,d.width,d.height);return e.initWithTarget(this._followedNode,d),e},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(e){this._boundarySet=e},initWithTarget:function(e,d){if(!e)return cc.errorID(1022),!1;d=d||cc.rect(0,0,0,0);this._followedNode=e;this._worldRect=d;this._boundarySet=!(0===d.width&&
0===d.height);this._boundaryFullyCovered=!1;e=cc.winSize;return this._fullScreenSize=cc.v2(e.width,e.height),this._halfScreenSize=this._fullScreenSize.mul(.5),this._boundarySet&&(this.leftBoundary=-(d.x+d.width-this._fullScreenSize.x),this.rightBoundary=-d.x,this.topBoundary=-d.y,this.bottomBoundary=-(d.y+d.height-this._fullScreenSize.y),this.rightBoundary<this.leftBoundary&&(this.rightBoundary=this.leftBoundary=(this.leftBoundary+this.rightBoundary)/2),this.topBoundary<this.bottomBoundary&&(this.topBoundary=
this.bottomBoundary=(this.topBoundary+this.bottomBoundary)/2),this.topBoundary===this.bottomBoundary&&this.leftBoundary===this.rightBoundary&&(this._boundaryFullyCovered=!0)),!0},step:function(e){e=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO);var d=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO);e=e.sub(d);e=this.target.parent.convertToNodeSpaceAR(e.add(this._halfScreenSize));this._boundarySet?this._boundaryFullyCovered||this.target.setPosition(h.clampf(e.x,this.leftBoundary,this.rightBoundary),
h.clampf(e.y,this.bottomBoundary,this.topBoundary)):this.target.setPosition(e.x,e.y)},isDone:function(){return!this._followedNode.activeInHierarchy},stop:function(){this.target=null;cc.Action.prototype.stop.call(this)}});cc.follow=function(e,d){return new cc.Follow(e,d)}},{"../core/platform/CCClass":130,"../core/utils/misc":220}],2:[function(f,n,m){function h(b,a){return b[Math.min(b.length-1,Math.max(a,0))]}function e(b){for(var a=[],c=b.length-1;0<=c;c--)a.push(cc.v2(b[c].x,b[c].y));return a}function d(b){for(var a=
[],c=0;c<b.length;c++)a.push(cc.v2(b[c].x,b[c].y));return a}cc.CardinalSplineTo=cc.Class({name:"cc.CardinalSplineTo",extends:cc.ActionInterval,ctor:function(b,a,c){this._points=[];this._tension=this._deltaT=0;this._accumulatedDiff=this._previousPosition=null;void 0!==c&&cc.CardinalSplineTo.prototype.initWithDuration.call(this,b,a,c)},initWithDuration:function(b,a,c){return a&&0!==a.length?!!cc.ActionInterval.prototype.initWithDuration.call(this,b)&&(this.setPoints(a),this._tension=c,!0):(cc.errorID(1024),
!1)},clone:function(){var b=new cc.CardinalSplineTo;return b.initWithDuration(this._duration,d(this._points),this._tension),b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._deltaT=1/(this._points.length-1);this._previousPosition=cc.v2(this.target.x,this.target.y);this._accumulatedDiff=cc.v2(0,0)},update:function(b){b=this._computeEaseTime(b);var a=this._points;if(1===b){var c=a.length-1;var d=1}else{var k=this._deltaT;d=(b-k*(c=0|b/k))/k}var l,q;k=h(a,
c-1);b=h(a,c-0);var r=h(a,c+1);a=h(a,c+2);var e=d*d,p=e*d,v=(1-this._tension)/2;c=v*(2*e-p-d);var w=v*(-p+e)+(2*p-3*e+1);d=v*(p-2*e+d)+(-2*p+3*e);e=v*(p-e);k=cc.v2(k.x*c+b.x*w+r.x*d+a.x*e,k.y*c+b.y*w+r.y*d+a.y*e);cc.macro.ENABLE_STACKABLE_ACTIONS&&(l=this.target.x-this._previousPosition.x,q=this.target.y-this._previousPosition.y,0!==l||0!==q)&&(b=this._accumulatedDiff,l=b.x+l,q=b.y+q,b.x=l,b.y=q,k.x+=l,k.y+=q);this.updatePosition(k)},reverse:function(){var b=e(this._points);return cc.cardinalSplineTo(this._duration,
b,this._tension)},updatePosition:function(b){this.target.setPosition(b);this._previousPosition=b},getPoints:function(){return this._points},setPoints:function(b){this._points=b}});cc.cardinalSplineTo=function(b,a,c){return new cc.CardinalSplineTo(b,a,c)};cc.CardinalSplineBy=cc.Class({name:"cc.CardinalSplineBy",extends:cc.CardinalSplineTo,ctor:function(b,a,c){this._startPosition=cc.v2(0,0);void 0!==c&&this.initWithDuration(b,a,c)},startWithTarget:function(b){cc.CardinalSplineTo.prototype.startWithTarget.call(this,
b);this._startPosition.x=b.x;this._startPosition.y=b.y},reverse:function(){for(var b,a=this._points.slice(),c=a[0],d=1;d<a.length;++d)b=a[d],a[d]=b.sub(c),c=b;a=e(a);c=a[a.length-1];a.pop();c.x=-c.x;c.y=-c.y;a.unshift(c);for(d=1;d<a.length;++d)(b=a[d]).x=-b.x,b.y=-b.y,b.x+=c.x,b.y+=c.y,c=a[d]=b;return cc.cardinalSplineBy(this._duration,a,this._tension)},updatePosition:function(b){var a=this._startPosition,c=b.x+a.x;b=b.y+a.y;this._previousPosition.x=c;this._previousPosition.y=b;this.target.setPosition(c,
b)},clone:function(){var b=new cc.CardinalSplineBy;return b.initWithDuration(this._duration,d(this._points),this._tension),b}});cc.cardinalSplineBy=function(b,a,c){return new cc.CardinalSplineBy(b,a,c)};cc.CatmullRomTo=cc.Class({name:"cc.CatmullRomTo",extends:cc.CardinalSplineTo,ctor:function(b,a){a&&this.initWithDuration(b,a)},initWithDuration:function(b,a){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,b,a,.5)},clone:function(){var b=new cc.CatmullRomTo;return b.initWithDuration(this._duration,
d(this._points)),b}});cc.catmullRomTo=function(b,a){return new cc.CatmullRomTo(b,a)};cc.CatmullRomBy=cc.Class({name:"cc.CatmullRomBy",extends:cc.CardinalSplineBy,ctor:function(b,a){a&&this.initWithDuration(b,a)},initWithDuration:function(b,a){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,b,a,.5)},clone:function(){var b=new cc.CatmullRomBy;return b.initWithDuration(this._duration,d(this._points)),b}});cc.catmullRomBy=function(b,a){return new cc.CatmullRomBy(b,a)}},{}],3:[function(f,
n,m){function h(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}cc.easeIn=function(a){return{_rate:a,easing:function(a){return Math.pow(a,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}};cc.easeOut=function(a){return{_rate:a,easing:function(a){return Math.pow(a,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}};cc.easeInOut=function(a){return{_rate:a,easing:function(a){return 1>
(a*=2)?.5*Math.pow(a,this._rate):1-.5*Math.pow(2-a,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}};var e={easing:function(a){return 0===a?0:Math.pow(2,10*(a-1))},reverse:function(){return d}};cc.easeExponentialIn=function(){return e};var d={easing:function(a){return 1===a?1:1-Math.pow(2,-10*a)},reverse:function(){return e}};cc.easeExponentialOut=function(){return d};var b={easing:function(a){return 1!==a&&0!==a?1>(a*=2)?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*(a-1))):a},reverse:function(){return b}};
cc.easeExponentialInOut=function(){return b};var a={easing:function(a){return 0===a||1===a?a:-1*Math.cos(a*Math.PI/2)+1},reverse:function(){return c}};cc.easeSineIn=function(){return a};var c={easing:function(a){return 0===a||1===a?a:Math.sin(a*Math.PI/2)},reverse:function(){return a}};cc.easeSineOut=function(){return c};var g={easing:function(a){return 0===a||1===a?a:-.5*(Math.cos(Math.PI*a)-1)},reverse:function(){return g}};cc.easeSineInOut=function(){return g};var k={easing:function(a){return 0===
a||1===a?a:(--a,-Math.pow(2,10*a)*Math.sin((a-.075)*Math.PI*2/.3))},reverse:function(){return l}};cc.easeElasticIn=function(a){return a&&.3!==a?{_period:a,easing:function(a){return 0===a||1===a?a:(--a,-Math.pow(2,10*a)*Math.sin((a-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:k};var l={easing:function(a){return 0===a||1===a?a:Math.pow(2,-10*a)*Math.sin((a-.075)*Math.PI*2/.3)+1},reverse:function(){return k}};cc.easeElasticOut=function(a){return a&&
.3!==a?{_period:a,easing:function(a){return 0===a||1===a?a:Math.pow(2,-10*a)*Math.sin((a-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:l};cc.easeElasticInOut=function(a){return{_period:a=a||.3,easing:function(a){var c=this._period;if(0===a||1===a)c=a;else{a*=2;c||(c=this._period=.3*1.5);var b=c/4;c=0>--a?-.5*Math.pow(2,10*a)*Math.sin((a-b)*Math.PI*2/c):Math.pow(2,-10*a)*Math.sin((a-b)*Math.PI*2/c)*.5+1}return c},reverse:function(){return cc.easeElasticInOut(this._period)}}};
var q={easing:function(a){return 1-h(1-a)},reverse:function(){return r}};cc.easeBounceIn=function(){return q};var r={easing:function(a){return h(a)},reverse:function(){return q}};cc.easeBounceOut=function(){return r};var t={easing:function(a){return.5>a?.5*(1-h(1-2*a)):.5*h(2*a-1)+.5},reverse:function(){return t}};cc.easeBounceInOut=function(){return t};var p={easing:function(a){return 0===a||1===a?a:a*a*(2.70158*a-1.70158)},reverse:function(){return v}};cc.easeBackIn=function(){return p};var v={easing:function(a){return--a*
a*(2.70158*a+1.70158)+1},reverse:function(){return p}};cc.easeBackOut=function(){return v};var w={easing:function(a){return 1>(a*=2)?a*a*(3.5949095*a-2.5949095)/2:(a-=2)*a*(3.5949095*a+2.5949095)/2+1},reverse:function(){return w}};cc.easeBackInOut=function(){return w};cc.easeBezierAction=function(a,c,b,d){return{easing:function(g){return Math.pow(1-g,3)*a+3*g*Math.pow(1-g,2)*c+3*Math.pow(g,2)*(1-g)*b+Math.pow(g,3)*d},reverse:function(){return cc.easeBezierAction(d,b,c,a)}}};var E={easing:function(a){return Math.pow(a,
2)},reverse:function(){return E}};cc.easeQuadraticActionIn=function(){return E};var x={easing:function(a){return-a*(a-2)},reverse:function(){return x}};cc.easeQuadraticActionOut=function(){return x};var y={easing:function(a){return 1>(a*=2)?a*a*.5:-.5*(--a*(a-2)-1)},reverse:function(){return y}};cc.easeQuadraticActionInOut=function(){return y};var u={easing:function(a){return a*a*a*a},reverse:function(){return u}};cc.easeQuarticActionIn=function(){return u};var B={easing:function(a){return-(--a*a*
a*a-1)},reverse:function(){return B}};cc.easeQuarticActionOut=function(){return B};var C={easing:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},reverse:function(){return C}};cc.easeQuarticActionInOut=function(){return C};var z={easing:function(a){return a*a*a*a*a},reverse:function(){return z}};cc.easeQuinticActionIn=function(){return z};var A={easing:function(a){return--a*a*a*a*a+1},reverse:function(){return A}};cc.easeQuinticActionOut=function(){return A};var D={easing:function(a){return 1>
(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},reverse:function(){return D}};cc.easeQuinticActionInOut=function(){return D};var I={easing:function(a){return-1*(Math.sqrt(1-a*a)-1)},reverse:function(){return I}};cc.easeCircleActionIn=function(){return I};var F={easing:function(a){return--a,Math.sqrt(1-a*a)},reverse:function(){return F}};cc.easeCircleActionOut=function(){return F};var G={easing:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):(a-=2,.5*(Math.sqrt(1-a*a)+1))},reverse:function(){return G}};
cc.easeCircleActionInOut=function(){return G};var J={easing:function(a){return a*a*a},reverse:function(){return J}};cc.easeCubicActionIn=function(){return J};var N={easing:function(a){return--a*a*a+1},reverse:function(){return N}};cc.easeCubicActionOut=function(){return N};var K={easing:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)},reverse:function(){return K}};cc.easeCubicActionInOut=function(){return K}},{}],4:[function(f,n,m){cc.ActionInstant=cc.Class({name:"cc.ActionInstant",extends:cc.FiniteTimeAction,
isDone:function(){return!0},step:function(f){this.update(1)},update:function(f){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}});cc.Show=cc.Class({name:"cc.Show",extends:cc.ActionInstant,update:function(f){f=this.target.getComponentsInChildren(cc.RenderComponent);for(var e=0;e<f.length;++e)f[e].enabled=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}});cc.show=function(){return new cc.Show};cc.Hide=cc.Class({name:"cc.Hide",extends:cc.ActionInstant,
update:function(f){f=this.target.getComponentsInChildren(cc.RenderComponent);for(var e=0;e<f.length;++e)f[e].enabled=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}});cc.hide=function(){return new cc.Hide};cc.ToggleVisibility=cc.Class({name:"cc.ToggleVisibility",extends:cc.ActionInstant,update:function(f){f=this.target.getComponentsInChildren(cc.RenderComponent);for(var e=0;e<f.length;++e){var d=f[e];d.enabled=!d.enabled}},reverse:function(){return new cc.ToggleVisibility},
clone:function(){return new cc.ToggleVisibility}});cc.toggleVisibility=function(){return new cc.ToggleVisibility};cc.RemoveSelf=cc.Class({name:"cc.RemoveSelf",extends:cc.ActionInstant,ctor:function(f){this._isNeedCleanUp=!0;void 0!==f&&this.init(f)},update:function(f){this.target.removeFromParent(this._isNeedCleanUp)},init:function(f){return this._isNeedCleanUp=f,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}});
cc.removeSelf=function(f){return new cc.RemoveSelf(f)};cc.FlipX=cc.Class({name:"cc.FlipX",extends:cc.ActionInstant,ctor:function(f){this._flippedX=!1;void 0!==f&&this.initWithFlipX(f)},initWithFlipX:function(f){return this._flippedX=f,!0},update:function(f){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var f=new cc.FlipX;return f.initWithFlipX(this._flippedX),f}});cc.flipX=function(f){return new cc.FlipX(f)};
cc.FlipY=cc.Class({name:"cc.FlipY",extends:cc.ActionInstant,ctor:function(f){this._flippedY=!1;void 0!==f&&this.initWithFlipY(f)},initWithFlipY:function(f){return this._flippedY=f,!0},update:function(f){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var f=new cc.FlipY;return f.initWithFlipY(this._flippedY),f}});cc.flipY=function(f){return new cc.FlipY(f)};cc.Place=cc.Class({name:"cc.Place",extends:cc.ActionInstant,
ctor:function(f,e){this._y=this._x=0;void 0!==f&&(void 0!==f.x&&(e=f.y,f=f.x),this.initWithPosition(f,e))},initWithPosition:function(f,e){return this._x=f,this._y=e,!0},update:function(f){this.target.setPosition(this._x,this._y)},clone:function(){var f=new cc.Place;return f.initWithPosition(this._x,this._y),f}});cc.place=function(f,e){return new cc.Place(f,e)};cc.CallFunc=cc.Class({name:"cc.CallFunc",extends:cc.ActionInstant,ctor:function(f,e,d){this._data=this._function=this._selectorTarget=null;
this.initWithFunction(f,e,d)},initWithFunction:function(f,e,d){return f&&(this._function=f),e&&(this._selectorTarget=e),void 0!==d&&(this._data=d),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(f){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(f){f!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=f)},clone:function(){var f=new cc.CallFunc;
return f.initWithFunction(this._function,this._selectorTarget,this._data),f}});cc.callFunc=function(f,e,d){return new cc.CallFunc(f,e,d)}},{}],5:[function(f,n,m){function h(e,d,b,a,c){return Math.pow(1-c,3)*e+3*c*Math.pow(1-c,2)*d+3*Math.pow(c,2)*(1-c)*b+Math.pow(c,3)*a}cc.ActionInterval=cc.Class({name:"cc.ActionInterval",extends:cc.FiniteTimeAction,ctor:function(e){this.MAX_VALUE=2;this._elapsed=0;this._firstTick=!1;this._easeList=null;this._timesForRepeat=this._speed=1;this._speedMethod=this._repeatMethod=
this._repeatForever=!1;void 0!==e&&cc.ActionInterval.prototype.initWithDuration.call(this,e)},getElapsed:function(){return this._elapsed},initWithDuration:function(e){return this._duration=0===e?cc.macro.FLT_EPSILON:e,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(e){e._repeatForever=this._repeatForever;e._speed=this._speed;e._timesForRepeat=this._timesForRepeat;e._easeList=this._easeList;e._speedMethod=this._speedMethod;e._repeatMethod=
this._repeatMethod},_reverseEaseList:function(e){if(this._easeList){e._easeList=[];for(var d=0;d<this._easeList.length;d++)e._easeList.push(this._easeList[d].reverse())}},clone:function(){var e=new cc.ActionInterval(this._duration);return this._cloneDecoration(e),e},easing:function(e){this._easeList?this._easeList.length=0:this._easeList=[];for(var d=0;d<arguments.length;d++)this._easeList.push(arguments[d]);return this},_computeEaseTime:function(e){var d=this._easeList;if(!d||0===d.length)return e;
for(var b=0,a=d.length;b<a;b++)e=d[b].easing(e);return e},step:function(e){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=e;e=this._elapsed/(1.192092896E-7<this._duration?this._duration:1.192092896E-7);e=1>e?e:1;this.update(0<e?e:0);this._repeatMethod&&1<this._timesForRepeat&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(e){cc.Action.prototype.startWithTarget.call(this,
e);this._elapsed=0;this._firstTick=!0},reverse:function(){return cc.logID(1010),null},setAmplitudeRate:function(e){cc.logID(1011)},getAmplitudeRate:function(){return cc.logID(1012),0},speed:function(e){return 0>=e?(cc.logID(1013),this):(this._speedMethod=!0,this._speed*=e,this)},getSpeed:function(){return this._speed},setSpeed:function(e){return this._speed=e,this},repeat:function(e){return e=Math.round(e),isNaN(e)||1>e?(cc.logID(1014),this):(this._repeatMethod=!0,this._timesForRepeat*=e,this)},repeatForever:function(){return this._repeatMethod=
!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}});cc.actionInterval=function(e){return new cc.ActionInterval(e)};cc.Sequence=cc.Class({name:"cc.Sequence",extends:cc.ActionInterval,ctor:function(e){this._actions=[];this._split=null;this._last=0;this._reversed=!1;var d=e instanceof Array?e:arguments;if(1!==d.length){var b=d.length-1;if(0<=b&&null==d[b]&&cc.logID(1015),0<=b){for(var a,c=d[0],g=1;g<b;g++)d[g]&&(a=c,c=cc.Sequence._actionOneTwo(a,d[g]));this.initWithTwoActions(c,d[b])}}else cc.errorID(1019)},
initWithTwoActions:function(e,d){return e&&d?(this.initWithDuration(e._duration*(e._repeatMethod?e._timesForRepeat:1)+d._duration*(d._repeatMethod?d._timesForRepeat:1)),this._actions[0]=e,this._actions[1]=d,!0):(cc.errorID(1025),!1)},clone:function(){var e=new cc.Sequence;return this._cloneDecoration(e),e.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._split=this._actions[0]._duration/
this._duration;this._split*=this._actions[0]._repeatMethod?this._actions[0]._timesForRepeat:1;this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop();cc.Action.prototype.stop.call(this)},update:function(e){var d,b=0,a=this._split,c=this._actions,g=this._last;(e=this._computeEaseTime(e))<a?(d=0!==a?e/a:1,0===b&&1===g&&this._reversed&&(c[1].update(0),c[1].stop())):(b=1,d=1===a?1:(e-a)/(1-a),-1===g&&(c[0].startWithTarget(this.target),c[0].update(1),c[0].stop()),0===g&&(c[0].update(1),
c[0].stop()));e=c[b];g===b&&e.isDone()||(g!==b&&e.startWithTarget(this.target),d*=e._timesForRepeat,e.update(1<d?d%1:d),this._last=b)},reverse:function(){var e=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e._reversed=!0,e}});cc.sequence=function(e){var d=e instanceof Array?e:arguments;if(1===d.length)return cc.errorID(1019),null;var b=d.length-1;0<=b&&null==d[b]&&cc.logID(1015);var a=null;if(0<=b){a=d[0];
for(var c=1;c<=b;c++)d[c]&&(a=cc.Sequence._actionOneTwo(a,d[c]))}return a};cc.Sequence._actionOneTwo=function(e,d){var b=new cc.Sequence;return b.initWithTwoActions(e,d),b};cc.Repeat=cc.Class({name:"cc.Repeat",extends:cc.ActionInterval,ctor:function(e,d){this._nextDt=this._total=this._times=0;this._actionInstant=!1;this._innerAction=null;void 0!==d&&this.initWithAction(e,d)},initWithAction:function(e,d){return!!this.initWithDuration(e._duration*d)&&(this._times=d,this._innerAction=e,e instanceof cc.ActionInstant&&
(this._actionInstant=!0,--this._times),this._total=0,!0)},clone:function(){var e=new cc.Repeat;return this._cloneDecoration(e),e.initWithAction(this._innerAction.clone(),this._times),e},startWithTarget:function(e){this._total=0;this._nextDt=this._innerAction._duration/this._duration;cc.ActionInterval.prototype.startWithTarget.call(this,e);this._innerAction.startWithTarget(e)},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this)},update:function(e){e=this._computeEaseTime(e);
var d=this._innerAction,b=this._duration,a=this._times,c=this._nextDt;if(e>=c){for(;e>c&&this._total<a;)d.update(1),this._total++,d.stop(),d.startWithTarget(this.target),c+=d._duration/b,this._nextDt=1<c?1:c;1<=e&&this._total<a&&(d.update(1),this._total++);this._actionInstant||(this._total===a?d.stop():d.update(e-(c-d._duration/b)))}else d.update(e*a%1)},isDone:function(){return this._total===this._times},reverse:function(){var e=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(e),
this._reverseEaseList(e),e},setInnerAction:function(e){this._innerAction!==e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}});cc.repeat=function(e,d){return new cc.Repeat(e,d)};cc.RepeatForever=cc.Class({name:"cc.RepeatForever",extends:cc.ActionInterval,ctor:function(e){this._innerAction=null;e&&this.initWithAction(e)},initWithAction:function(e){return e?(this._innerAction=e,!0):(cc.errorID(1026),!1)},clone:function(){var e=new cc.RepeatForever;return this._cloneDecoration(e),
e.initWithAction(this._innerAction.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._innerAction.startWithTarget(e)},step:function(e){var d=this._innerAction;d.step(e);d.isDone()&&(d.startWithTarget(this.target),d.step(d.getElapsed()-d._duration))},isDone:function(){return!1},reverse:function(){var e=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e},setInnerAction:function(e){this._innerAction!==
e&&(this._innerAction=e)},getInnerAction:function(){return this._innerAction}});cc.repeatForever=function(e){return new cc.RepeatForever(e)};cc.Spawn=cc.Class({name:"cc.Spawn",extends:cc.ActionInterval,ctor:function(e){this._two=this._one=null;var d=e instanceof Array?e:arguments;if(1!==d.length){var b=d.length-1;if(0<=b&&null==d[b]&&cc.logID(1015),0<=b){for(var a,c=d[0],g=1;g<b;g++)d[g]&&(a=c,c=cc.Spawn._actionOneTwo(a,d[g]));this.initWithTwoActions(c,d[b])}}else cc.errorID(1020)},initWithTwoActions:function(e,
d){if(!e||!d)return cc.errorID(1027),!1;var b=!1,a=e._duration,c=d._duration;return this.initWithDuration(Math.max(a,c))&&(this._one=e,this._two=d,a>c?this._two=cc.Sequence._actionOneTwo(d,cc.delayTime(a-c)):a<c&&(this._one=cc.Sequence._actionOneTwo(e,cc.delayTime(c-a))),b=!0),b},clone:function(){var e=new cc.Spawn;return this._cloneDecoration(e),e.initWithTwoActions(this._one.clone(),this._two.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._one.startWithTarget(e);
this._two.startWithTarget(e)},stop:function(){this._one.stop();this._two.stop();cc.Action.prototype.stop.call(this)},update:function(e){e=this._computeEaseTime(e);this._one&&this._one.update(e);this._two&&this._two.update(e)},reverse:function(){var e=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.spawn=function(e){var d=e instanceof Array?e:arguments;if(1===d.length)return cc.errorID(1020),null;0<d.length&&null==d[d.length-
1]&&cc.logID(1015);for(var b=d[0],a=1;a<d.length;a++)null!=d[a]&&(b=cc.Spawn._actionOneTwo(b,d[a]));return b};cc.Spawn._actionOneTwo=function(e,d){var b=new cc.Spawn;return b.initWithTwoActions(e,d),b};cc.RotateTo=cc.Class({name:"cc.RotateTo",extends:cc.ActionInterval,ctor:function(e,d){this._angle=this._dstAngle=this._startAngle=0;void 0!==d&&this.initWithDuration(e,d)},initWithDuration:function(e,d){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._dstAngle=d,!0)},clone:function(){var e=
new cc.RotateTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._dstAngle),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);e=e.angle%360;var d=cc.macro.ROTATE_ACTION_CCW?this._dstAngle-e:e-this._dstAngle;180<d&&(d-=360);-180>d&&(d+=360);this._startAngle=e;this._angle=cc.macro.ROTATE_ACTION_CCW?d:-d},reverse:function(){cc.logID(1016)},update:function(e){e=this._computeEaseTime(e);this.target&&(this.target.angle=this._startAngle+this._angle*
e)}});cc.rotateTo=function(e,d){return new cc.RotateTo(e,d)};cc.RotateBy=cc.Class({name:"cc.RotateBy",extends:cc.ActionInterval,ctor:function(e,d){d*=cc.macro.ROTATE_ACTION_CCW?1:-1;this._startAngle=this._deltaAngle=0;void 0!==d&&this.initWithDuration(e,d)},initWithDuration:function(e,d){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._deltaAngle=d,!0)},clone:function(){var e=new cc.RotateBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._deltaAngle),
e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._startAngle=e.angle},update:function(e){e=this._computeEaseTime(e);this.target&&(this.target.angle=this._startAngle+this._deltaAngle*e)},reverse:function(){var e=new cc.RotateBy;return e.initWithDuration(this._duration,-this._deltaAngle),this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.rotateBy=function(e,d){return new cc.RotateBy(e,d)};cc.MoveBy=cc.Class({name:"cc.MoveBy",extends:cc.ActionInterval,
ctor:function(e,d,b){this._positionDelta=cc.v2(0,0);this._startPosition=cc.v2(0,0);this._previousPosition=cc.v2(0,0);void 0!==d&&cc.MoveBy.prototype.initWithDuration.call(this,e,d,b)},initWithDuration:function(e,d,b){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(void 0!==d.x&&(b=d.y,d=d.x),this._positionDelta.x=d,this._positionDelta.y=b,!0)},clone:function(){var e=new cc.MoveBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._positionDelta),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,
e);var d=e.x;e=e.y;this._previousPosition.x=d;this._previousPosition.y=e;this._startPosition.x=d;this._startPosition.y=e},update:function(e){if(e=this._computeEaseTime(e),this.target){var d=this._positionDelta.x*e;e*=this._positionDelta.y;var b=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var a=this.target.y,c=this._previousPosition;b.x=b.x+this.target.x-c.x;b.y=b.y+a-c.y;d+=b.x;e+=b.y;c.x=d;c.y=e;this.target.setPosition(d,e)}else this.target.setPosition(b.x+d,b.y+e)}},reverse:function(){var e=
new cc.MoveBy(this._duration,cc.v2(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.moveBy=function(e,d,b){return new cc.MoveBy(e,d,b)};cc.MoveTo=cc.Class({name:"cc.MoveTo",extends:cc.MoveBy,ctor:function(e,d,b){this._endPosition=cc.v2(0,0);void 0!==d&&this.initWithDuration(e,d,b)},initWithDuration:function(e,d,b){return!!cc.MoveBy.prototype.initWithDuration.call(this,e,d,b)&&(void 0!==d.x&&(b=d.y,d=d.x),this._endPosition.x=d,this._endPosition.y=
b,!0)},clone:function(){var e=new cc.MoveTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endPosition),e},startWithTarget:function(e){cc.MoveBy.prototype.startWithTarget.call(this,e);this._positionDelta.x=this._endPosition.x-e.x;this._positionDelta.y=this._endPosition.y-e.y}});cc.moveTo=function(e,d,b){return new cc.MoveTo(e,d,b)};cc.SkewTo=cc.Class({name:"cc.SkewTo",extends:cc.ActionInterval,ctor:function(e,d,b){this._deltaY=this._deltaX=this._endSkewY=this._endSkewX=this._startSkewY=
this._startSkewX=this._skewY=this._skewX=0;void 0!==b&&cc.SkewTo.prototype.initWithDuration.call(this,e,d,b)},initWithDuration:function(e,d,b){var a=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._endSkewX=d,this._endSkewY=b,a=!0),a},clone:function(){var e=new cc.SkewTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endSkewX,this._endSkewY),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._startSkewX=
e.skewX%180;this._deltaX=this._endSkewX-this._startSkewX;180<this._deltaX&&(this._deltaX-=360);-180>this._deltaX&&(this._deltaX+=360);this._startSkewY=e.skewY%360;this._deltaY=this._endSkewY-this._startSkewY;180<this._deltaY&&(this._deltaY-=360);-180>this._deltaY&&(this._deltaY+=360)},update:function(e){e=this._computeEaseTime(e);this.target.skewX=this._startSkewX+this._deltaX*e;this.target.skewY=this._startSkewY+this._deltaY*e}});cc.skewTo=function(e,d,b){return new cc.SkewTo(e,d,b)};cc.SkewBy=cc.Class({name:"cc.SkewBy",
extends:cc.SkewTo,ctor:function(e,d,b){void 0!==b&&this.initWithDuration(e,d,b)},initWithDuration:function(e,d,b){var a=!1;return cc.SkewTo.prototype.initWithDuration.call(this,e,d,b)&&(this._skewX=d,this._skewY=b,a=!0),a},clone:function(){var e=new cc.SkewBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._skewX,this._skewY),e},startWithTarget:function(e){cc.SkewTo.prototype.startWithTarget.call(this,e);this._deltaX=this._skewX;this._deltaY=this._skewY;this._endSkewX=this._startSkewX+
this._deltaX;this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var e=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.skewBy=function(e,d,b){return new cc.SkewBy(e,d,b)};cc.JumpBy=cc.Class({name:"cc.JumpBy",extends:cc.ActionInterval,ctor:function(e,d,b,a,c){this._startPosition=cc.v2(0,0);this._previousPosition=cc.v2(0,0);this._delta=cc.v2(0,0);this._jumps=this._height=0;void 0!==a&&cc.JumpBy.prototype.initWithDuration.call(this,
e,d,b,a,c)},initWithDuration:function(e,d,b,a,c){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(void 0===c&&(c=a,a=b,b=d.y,d=d.x),this._delta.x=d,this._delta.y=b,this._height=a,this._jumps=c,!0)},clone:function(){var e=new cc.JumpBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._delta,this._height,this._jumps),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var d=e.x;e=e.y;this._previousPosition.x=d;this._previousPosition.y=
e;this._startPosition.x=d;this._startPosition.y=e},update:function(e){if(e=this._computeEaseTime(e),this.target){var d=e*this._jumps%1;d=4*this._height*d*(1-d);d+=this._delta.y*e;e*=this._delta.x;var b=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var a=this.target.y,c=this._previousPosition;b.x=b.x+this.target.x-c.x;b.y=b.y+a-c.y;e+=b.x;d+=b.y;c.x=e;c.y=d;this.target.setPosition(e,d)}else this.target.setPosition(b.x+e,b.y+d)}},reverse:function(){var e=new cc.JumpBy(this._duration,cc.v2(-this._delta.x,
-this._delta.y),this._height,this._jumps);return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.jumpBy=function(e,d,b,a,c){return new cc.JumpBy(e,d,b,a,c)};cc.JumpTo=cc.Class({name:"cc.JumpTo",extends:cc.JumpBy,ctor:function(e,d,b,a,c){this._endPosition=cc.v2(0,0);void 0!==a&&this.initWithDuration(e,d,b,a,c)},initWithDuration:function(e,d,b,a,c){return!!cc.JumpBy.prototype.initWithDuration.call(this,e,d,b,a,c)&&(void 0===c&&(b=d.y,d=d.x),this._endPosition.x=d,this._endPosition.y=b,!0)},
startWithTarget:function(e){cc.JumpBy.prototype.startWithTarget.call(this,e);this._delta.x=this._endPosition.x-this._startPosition.x;this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var e=new cc.JumpTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),e}});cc.jumpTo=function(e,d,b,a,c){return new cc.JumpTo(e,d,b,a,c)};cc.BezierBy=cc.Class({name:"cc.BezierBy",extends:cc.ActionInterval,ctor:function(e,d){this._config=
[];this._startPosition=cc.v2(0,0);this._previousPosition=cc.v2(0,0);d&&cc.BezierBy.prototype.initWithDuration.call(this,e,d)},initWithDuration:function(e,d){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._config=d,!0)},clone:function(){var e=new cc.BezierBy;this._cloneDecoration(e);for(var d=[],b=0;b<this._config.length;b++){var a=this._config[b];d.push(cc.v2(a.x,a.y))}return e.initWithDuration(this._duration,d),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,
e);var d=e.x;e=e.y;this._previousPosition.x=d;this._previousPosition.y=e;this._startPosition.x=d;this._startPosition.y=e},update:function(e){if(e=this._computeEaseTime(e),this.target){var d=this._config,b=d[0].y,a=d[1].y,c=d[2].y;d=h(0,d[0].x,d[1].x,d[2].x,e);e=h(0,b,a,c,e);b=this._startPosition;cc.macro.ENABLE_STACKABLE_ACTIONS?(a=this.target.y,c=this._previousPosition,b.x=b.x+this.target.x-c.x,b.y=b.y+a-c.y,d+=b.x,e+=b.y,c.x=d,c.y=e,this.target.setPosition(d,e)):this.target.setPosition(b.x+d,b.y+
e)}},reverse:function(){var e=this._config,d=e[0].x,b=e[0].y,a=e[2].x,c=e[2].y;e=[cc.v2(e[1].x-a,e[1].y-c),cc.v2(d-a,b-c),cc.v2(-a,-c)];e=new cc.BezierBy(this._duration,e);return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.bezierBy=function(e,d){return new cc.BezierBy(e,d)};cc.BezierTo=cc.Class({name:"cc.BezierTo",extends:cc.BezierBy,ctor:function(e,d){this._toConfig=[];d&&this.initWithDuration(e,d)},initWithDuration:function(e,d){return!!cc.ActionInterval.prototype.initWithDuration.call(this,
e)&&(this._toConfig=d,!0)},clone:function(){var e=new cc.BezierTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toConfig),e},startWithTarget:function(e){cc.BezierBy.prototype.startWithTarget.call(this,e);e=this._startPosition;var d=this._toConfig,b=this._config;b[0]=d[0].sub(e);b[1]=d[1].sub(e);b[2]=d[2].sub(e)}});cc.bezierTo=function(e,d){return new cc.BezierTo(e,d)};cc.ScaleTo=cc.Class({name:"cc.ScaleTo",extends:cc.ActionInterval,ctor:function(e,d,b){this._startScaleY=
this._startScaleX=this._scaleY=this._scaleX=1;this._deltaY=this._deltaX=this._endScaleY=this._endScaleX=0;void 0!==d&&cc.ScaleTo.prototype.initWithDuration.call(this,e,d,b)},initWithDuration:function(e,d,b){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._endScaleX=d,this._endScaleY=null!=b?b:d,!0)},clone:function(){var e=new cc.ScaleTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endScaleX,this._endScaleY),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,
e);this._startScaleX=e.scaleX;this._startScaleY=e.scaleY;this._deltaX=this._endScaleX-this._startScaleX;this._deltaY=this._endScaleY-this._startScaleY},update:function(e){e=this._computeEaseTime(e);this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*e,this.target.scaleY=this._startScaleY+this._deltaY*e)}});cc.scaleTo=function(e,d,b){return new cc.ScaleTo(e,d,b)};cc.ScaleBy=cc.Class({name:"cc.ScaleBy",extends:cc.ScaleTo,startWithTarget:function(e){cc.ScaleTo.prototype.startWithTarget.call(this,
e);this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX;this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var e=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.ScaleBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._endScaleX,this._endScaleY),e}});cc.scaleBy=function(e,d,b){return new cc.ScaleBy(e,d,b)};cc.Blink=cc.Class({name:"cc.Blink",
extends:cc.ActionInterval,ctor:function(e,d){this._times=0;this._originalState=!1;void 0!==d&&this.initWithDuration(e,d)},initWithDuration:function(e,d){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._times=d,!0)},clone:function(){var e=new cc.Blink;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._times),e},update:function(e){if(e=this._computeEaseTime(e),this.target&&!this.isDone()){var d=1/this._times;this.target.opacity=e%d>d/2?255:0}},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,
e);this._originalState=e.opacity},stop:function(){this.target.opacity=this._originalState;cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var e=new cc.Blink(this._duration,this._times);return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.blink=function(e,d){return new cc.Blink(e,d)};cc.FadeTo=cc.Class({name:"cc.FadeTo",extends:cc.ActionInterval,ctor:function(e,d){this._fromOpacity=this._toOpacity=0;void 0!==d&&cc.FadeTo.prototype.initWithDuration.call(this,e,d)},initWithDuration:function(e,
d){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._toOpacity=d,!0)},clone:function(){var e=new cc.FadeTo;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e},update:function(e){e=this._computeEaseTime(e);var d=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=d+(this._toOpacity-d)*e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._fromOpacity=e.opacity}});cc.fadeTo=function(e,d){return new cc.FadeTo(e,
d)};cc.FadeIn=cc.Class({name:"cc.FadeIn",extends:cc.FadeTo,ctor:function(e){null==e&&(e=0);this._reverseAction=null;this.initWithDuration(e,255)},reverse:function(){var e=new cc.FadeOut;return e.initWithDuration(this._duration,0),this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.FadeIn;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._toOpacity),e},startWithTarget:function(e){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity);
cc.FadeTo.prototype.startWithTarget.call(this,e)}});cc.fadeIn=function(e){return new cc.FadeIn(e)};cc.FadeOut=cc.Class({name:"cc.FadeOut",extends:cc.FadeTo,ctor:function(e){null==e&&(e=0);this._reverseAction=null;this.initWithDuration(e,0)},reverse:function(){var e=new cc.FadeIn;return e._reverseAction=this,e.initWithDuration(this._duration,255),this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.FadeOut;return this._cloneDecoration(e),e.initWithDuration(this._duration,
this._toOpacity),e}});cc.fadeOut=function(e){return new cc.FadeOut(e)};cc.TintTo=cc.Class({name:"cc.TintTo",extends:cc.ActionInterval,ctor:function(e,d,b,a){this._to=cc.color(0,0,0);this._from=cc.color(0,0,0);d instanceof cc.Color&&(a=d.b,b=d.g,d=d.r);void 0!==a&&this.initWithDuration(e,d,b,a)},initWithDuration:function(e,d,b,a){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=cc.color(d,b,a),!0)},clone:function(){var e=new cc.TintTo;this._cloneDecoration(e);var d=this._to;
return e.initWithDuration(this._duration,d.r,d.g,d.b),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._from=this.target.color},update:function(e){e=this._computeEaseTime(e);var d=this._from,b=this._to;d&&(this.target.color=cc.color(d.r+(b.r-d.r)*e,d.g+(b.g-d.g)*e,d.b+(b.b-d.b)*e))}});cc.tintTo=function(e,d,b,a){return new cc.TintTo(e,d,b,a)};cc.TintBy=cc.Class({name:"cc.TintBy",extends:cc.ActionInterval,ctor:function(e,d,b,a){this._fromB=this._fromG=this._fromR=
this._deltaB=this._deltaG=this._deltaR=0;void 0!==a&&this.initWithDuration(e,d,b,a)},initWithDuration:function(e,d,b,a){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._deltaR=d,this._deltaG=b,this._deltaB=a,!0)},clone:function(){var e=new cc.TintBy;return this._cloneDecoration(e),e.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);e=e.color;this._fromR=e.r;this._fromG=
e.g;this._fromB=e.b},update:function(e){e=this._computeEaseTime(e);this.target.color=cc.color(this._fromR+this._deltaR*e,this._fromG+this._deltaG*e,this._fromB+this._deltaB*e)},reverse:function(){var e=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(e),this._reverseEaseList(e),e}});cc.tintBy=function(e,d,b,a){return new cc.TintBy(e,d,b,a)};cc.DelayTime=cc.Class({name:"cc.DelayTime",extends:cc.ActionInterval,update:function(e){},reverse:function(){var e=
new cc.DelayTime(this._duration);return this._cloneDecoration(e),this._reverseEaseList(e),e},clone:function(){var e=new cc.DelayTime;return this._cloneDecoration(e),e.initWithDuration(this._duration),e}});cc.delayTime=function(e){return new cc.DelayTime(e)};cc.ReverseTime=cc.Class({name:"cc.ReverseTime",extends:cc.ActionInterval,ctor:function(e){this._other=null;e&&this.initWithAction(e)},initWithAction:function(e){return e?e===this._other?(cc.errorID(1029),!1):!!cc.ActionInterval.prototype.initWithDuration.call(this,
e._duration)&&(this._other=e,!0):(cc.errorID(1028),!1)},clone:function(){var e=new cc.ReverseTime;return this._cloneDecoration(e),e.initWithAction(this._other.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);this._other.startWithTarget(e)},update:function(e){e=this._computeEaseTime(e);this._other&&this._other.update(1-e)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop();cc.Action.prototype.stop.call(this)}});cc.reverseTime=
function(e){return new cc.ReverseTime(e)};cc.TargetedAction=cc.Class({name:"cc.TargetedAction",extends:cc.ActionInterval,ctor:function(e,d){this._forcedTarget=this._action=null;d&&this.initWithTarget(e,d)},initWithTarget:function(e,d){return!!this.initWithDuration(d._duration)&&(this._forcedTarget=e,this._action=d,!0)},clone:function(){var e=new cc.TargetedAction;return this._cloneDecoration(e),e.initWithTarget(this._forcedTarget,this._action.clone()),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,
e);this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(e){e=this._computeEaseTime(e);this._action.update(e)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(e){this._forcedTarget!==e&&(this._forcedTarget=e)}});cc.targetedAction=function(e,d){return new cc.TargetedAction(e,d)}},{}],6:[function(f,n,m){f("../core/platform/CCClass");var h=f("../core/platform/js"),e=function(){this.actions=[];this.target=null;this.actionIndex=
0;this.currentAction=null;this.lock=this.paused=!1};cc.ActionManager=function(){this._hashTargets=h.createMap(!0);this._arrayTargets=[];this._currentTarget=null;cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)};cc.ActionManager.prototype={constructor:cc.ActionManager,_elementPool:[],_searchElementByTarget:function(d,b){for(var a=0;a<d.length;a++)if(b===d[a].target)return d[a];return null},_getElement:function(d,b){var a=this._elementPool.pop();return a||(a=new e),a.target=d,a.paused=
!!b,a},_putElement:function(d){d.actions.length=0;d.actionIndex=0;d.currentAction=null;d.paused=!1;d.target=null;d.lock=!1;this._elementPool.push(d)},addAction:function(d,b,a){if(d&&b){var c=this._hashTargets[b._id];c?c.actions||(c.actions=[]):(c=this._getElement(b,a),this._hashTargets[b._id]=c,this._arrayTargets.push(c));c.actions.push(d);d.startWithTarget(b)}else cc.errorID(1E3)},removeAllActions:function(){for(var d=this._arrayTargets,b=0;b<d.length;b++){var a=d[b];a&&this._putElement(a)}this._arrayTargets.length=
0;this._hashTargets=h.createMap(!0)},removeAllActionsFromTarget:function(d,b){null!=d&&(d=this._hashTargets[d._id])&&(d.actions.length=0,this._deleteHashElement(d))},removeAction:function(d){if(null!=d){var b=d.getOriginalTarget();if(b=this._hashTargets[b._id])for(var a=0;a<b.actions.length;a++){if(b.actions[a]===d){b.actions.splice(a,1);b.actionIndex>=a&&b.actionIndex--;break}}else cc.logID(1001)}},removeActionByTag:function(d,b){d===cc.Action.TAG_INVALID&&cc.logID(1002);cc.assertID(b,1003);var a=
this._hashTargets[b._id];if(a)for(var c=a.actions.length,g=0;g<c;++g){var k=a.actions[g];if(k&&k.getTag()===d&&k.getOriginalTarget()===b){this._removeActionAtIndex(g,a);break}}},getActionByTag:function(d,b){d===cc.Action.TAG_INVALID&&cc.logID(1004);if(b=this._hashTargets[b._id]){if(null!=b.actions)for(var a=0;a<b.actions.length;++a){var c=b.actions[a];if(c&&c.getTag()===d)return c}cc.logID(1005,d)}return null},getNumberOfRunningActionsInTarget:function(d){return(d=this._hashTargets[d._id])&&d.actions?
d.actions.length:0},pauseTarget:function(d){(d=this._hashTargets[d._id])&&(d.paused=!0)},resumeTarget:function(d){(d=this._hashTargets[d._id])&&(d.paused=!1)},pauseAllRunningActions:function(){for(var d=[],b=this._arrayTargets,a=0;a<b.length;a++){var c=b[a];c&&!c.paused&&(c.paused=!0,d.push(c.target))}return d},resumeTargets:function(d){if(d)for(var b=0;b<d.length;b++)d[b]&&this.resumeTarget(d[b])},pauseTargets:function(d){if(d)for(var b=0;b<d.length;b++)d[b]&&this.pauseTarget(d[b])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},
_removeActionAtIndex:function(d,b){b.actions[d];b.actions.splice(d,1);b.actionIndex>=d&&b.actionIndex--;0===b.actions.length&&this._deleteHashElement(b)},_deleteHashElement:function(d){var b=!1;if(d&&!d.lock&&this._hashTargets[d.target._id]){delete this._hashTargets[d.target._id];b=this._arrayTargets;for(var a=0,c=b.length;a<c;a++)if(b[a]===d){b.splice(a,1);break}this._putElement(d);b=!0}return b},update:function(d){for(var b,a=this._arrayTargets,c=0;c<a.length;c++){if(this._currentTarget=a[c],!(b=
this._currentTarget).paused&&b.actions){b.lock=!0;for(b.actionIndex=0;b.actionIndex<b.actions.length;b.actionIndex++)if(b.currentAction=b.actions[b.actionIndex],b.currentAction){if(b.currentAction.step(d*(b.currentAction._speedMethod?b.currentAction._speed:1)),b.currentAction&&b.currentAction.isDone()){b.currentAction.stop();var g=b.currentAction;b.currentAction=null;this.removeAction(g)}b.currentAction=null}b.lock=!1}0===b.actions.length&&this._deleteHashElement(b)&&c--}}}},{"../core/platform/CCClass":130,
"../core/platform/js":150}],7:[function(f,n,m){f("./CCActionManager");f("./CCAction");f("./CCActionInterval");f("./CCActionInstant");f("./CCActionEase");f("./CCActionCatmullRom");f("./tween")},{"./CCAction":1,"./CCActionCatmullRom":2,"./CCActionEase":3,"./CCActionInstant":4,"./CCActionInterval":5,"./CCActionManager":6,"./tween":8}],8:[function(f,n,m){function h(a){this._actions=[];this._finalAction=null;this._target=a}function e(c){return function(){a.length=0;for(var b=arguments.length,d=0;d<b;d++){var g=
a[d]=arguments[d];g instanceof h&&(a[d]=g._union())}return c.apply(this,a)}}var d=cc.Class({name:"cc.TweenAction",extends:cc.ActionInterval,ctor:function(a,c,b){if(this._opts=b=b||Object.create(null),this._props=Object.create(null),b.progress=b.progress||this.progress,b.easing&&"string"==typeof b.easing){var d=b.easing;b.easing=cc.easing[d];!b.easing&&cc.warnID(1031,d)}b=this._opts.relative;for(var g in c){d=c[g];var k=void 0,l=void 0;if(void 0!==d.value&&(d.easing||d.progress)&&("string"==typeof d.easing?
!(k=cc.easing[d.easing])&&cc.warnID(1031,d.easing):k=d.easing,l=d.progress,d=d.value),"number"==typeof d||d.lerp&&(!b||d.add||d.mul)&&d.clone){var q=Object.create(null);q.value=d;q.easing=k;q.progress=l;this._props[g]=q}else cc.warn("Can not animate "+g+" property, because it do not have [lerp, (add|mul), clone] function.")}this._originProps=c;this.initWithDuration(a)},clone:function(){var a=new d(this._duration,this._originProps,this._opts);return this._cloneDecoration(a),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);var c=!!this._opts.relative,b=this._props,d;for(d in b){var g=a[d],k=b[d];"number"==typeof g?(k.start=g,k.current=g,k.end=c?g+k.value:k.value):(k.start=g.clone(),k.current=g.clone(),k.end=c?(g.add||g.mul).call(g,k.value):k.value)}},update:function(a){var c=this._opts,b=a;c.easing&&(b=c.easing(a));if(c=this.target){var d=this._props,g=this._opts.progress,k;for(k in d){var l=d[k],e=l.easing?l.easing(a):b;l=l.current=(l.progress||g)(l.start,l.end,l.current,e);c[k]=l}}},progress:function(a,c,b,d){return"number"==
typeof a?b=a+(c-a)*d:a.lerp(c,d,b),b}}),b=cc.Class({name:"cc.SetAction",extends:cc.ActionInstant,ctor:function(a){this._props={};void 0!==a&&this.init(a)},init:function(a){for(var c in a)this._props[c]=a[c];return!0},update:function(){var a=this._props,c=this.target,b;for(b in a)c[b]=a[b]},clone:function(){var a=new b;return a.init(this._props),a}});h.prototype.then=function(a){return a instanceof cc.Action?this._actions.push(a.clone()):this._actions.push(a._union()),this};h.prototype.target=function(a){return this._target=
a,this};h.prototype.start=function(){return this._target?(this._finalAction&&cc.director.getActionManager().removeAction(this._finalAction),this._finalAction=this._union(),cc.director.getActionManager().addAction(this._finalAction,this._target,!1),this):(cc.warn("Please set target to tween first"),this)};h.prototype.stop=function(){return this._finalAction&&cc.director.getActionManager().removeAction(this._finalAction),this};h.prototype.clone=function(a){var c=this._union();return cc.tween(a).then(c.clone())};
h.prototype.union=function(){var a=this._union();return this._actions.length=0,this._actions.push(a),this};h.prototype._union=function(){var a=this._actions;return 1===a.length?a[0]:cc.sequence(a)};var a=[],c={to:function(a,c,b){return(b=b||Object.create(null)).relative=!1,new d(a,c,b)},by:function(a,c,b){return(b=b||Object.create(null)).relative=!0,new d(a,c,b)},set:function(a){return new b(a)},delay:cc.delayTime,call:cc.callFunc,hide:cc.hide,show:cc.show,removeSelf:cc.removeSelf,sequence:e(cc.sequence),
parallel:e(cc.spawn)},g={repeat:cc.repeat,repeatForever:function(a){return cc.repeat(a,1E9)},reverseTime:cc.reverseTime},k=Object.keys(c);n=function(a){var b=k[a];h.prototype[b]=function(){var a=c[b].apply(c,arguments);return this._actions.push(a),this}};for(f=0;f<k.length;f++)n(f);k=Object.keys(g);n=function(a){var c=k[a];h.prototype[c]=function(){var a=this._actions,b=arguments[arguments.length-1],d=arguments.length-1;b instanceof cc.Tween?b=b._union():b instanceof cc.Action||(b=a[a.length-1],--a.length,
d+=1);for(var k=[b],l=0;l<d;l++)k.push(arguments[l]);return b=g[c].apply(this,k),a.push(b),this}};for(f=0;f<k.length;f++)n(f);cc.tween=function(a){return new h(a)};cc.Tween=h},{}],9:[function(f,n,m){function h(a,c){b.call(this);this.target=a;this.animation=c;this._anims=new d.array.MutableForwardIterator([])}function e(b,d){var l=d.clip;d.duration=l.duration;d.speed=l.speed;d.wrapMode=l.wrapMode;d.frameRate=l.sample;(d.wrapMode&g.Loop)===g.Loop?d.repeatCount=1/0:d.repeatCount=1;var q=d.curves=l.createCurves(d,
b);if(l=l.events)for(var e=void 0,v=0,w=l.length;v<w;v++){e||((e=new a).target=b,q.push(e));var f=l[v],h=f.frame/d.duration,y=void 0,u=k(e.ratios,h);0<=u?y=e.events[u]:(y=new c,e.ratios.push(h),e.events.push(y));y.add(f.func,f.params)}}var d=cc.js,b=f("./playable");m=f("./animation-curves");var a=m.EventAnimCurve,c=m.EventInfo,g=f("./types").WrapModeMask,k=f("../core/utils/binary-search").binarySearchEpsilon;d.extend(h,b);f=h.prototype;f.playState=function(a,c){a.clip&&(a.curveLoaded||e(this.target,
a),a.animator=this,a.play(),"number"==typeof c&&a.setTime(c),this.play())};f.stopStatesExcept=function(a){var c=this._anims,b=c.array;for(c.i=0;c.i<b.length;++c.i){var d=b[c.i];d!==a&&this.stopState(d)}};f.addAnimation=function(a){-1===this._anims.array.indexOf(a)&&this._anims.push(a);a._setEventTarget(this.animation)};f.removeAnimation=function(a){var c=this._anims.array.indexOf(a);0<=c?(this._anims.fastRemoveAt(c),0===this._anims.array.length&&this.stop()):cc.errorID(3908);a.animator=null};f.sample=
function(){var a=this._anims,c=a.array;for(a.i=0;a.i<c.length;++a.i)c[a.i].sample()};f.stopState=function(a){a&&a.stop()};f.pauseState=function(a){a&&a.pause()};f.resumeState=function(a){a&&a.resume();this.isPaused&&this.resume()};f.setStateTime=function(a,c){if(void 0!==c)a&&(a.setTime(c),a.sample());else{c=a;a=this._anims.array;for(var b=0;b<a.length;++b){var d=a[b];d.setTime(c);d.sample()}}};f.onStop=function(){var a=this._anims,c=a.array;for(a.i=0;a.i<c.length;++a.i)c[a.i].stop()};f.onPause=function(){for(var a=
this._anims.array,c=0;c<a.length;++c){var b=a[c];b.pause();b.animator=null}};f.onResume=function(){for(var a=this._anims.array,c=0;c<a.length;++c){var b=a[c];b.animator=this;b.resume()}};f._reloadClip=function(a){e(this.target,a)};n.exports=h},{"../core/utils/binary-search":213,"./animation-curves":11,"./playable":18,"./types":19}],10:[function(f,n,m){m=f("./types").WrapMode;var h=f("./animation-curves"),e=h.DynamicAnimCurve,d=h.quickFindIndex,b=f("./motion-path-helper").sampleMotionPaths,a=f("../core/utils/binary-search").binarySearchEpsilon,
c=cc.Class({name:"cc.AnimationClip",extends:cc.Asset,properties:{_duration:{default:0,type:cc.Float},duration:{get:function(){return this._duration}},sample:{default:60},speed:{default:1},wrapMode:{default:m.Normal},curveData:{default:{},visible:!1},events:{default:[],visible:!1}},statics:{createWithSpriteFrames:function(a,b){if(!Array.isArray(a))return cc.errorID(3905),null;var d=new c;d.sample=b||d.sample;d._duration=a.length/d.sample;b=[];for(var g=1/d.sample,k=0,e=a.length;k<e;k++)b[k]={frame:k*
g,value:a[k]};return d.curveData={comps:{"cc.Sprite":{spriteFrame:b}}},d}},onLoad:function(){this._duration=Number.parseFloat(this.duration);this.speed=Number.parseFloat(this.speed);this.wrapMode=Number.parseInt(this.wrapMode);this.frameRate=Number.parseFloat(this.sample)},createPropCurve:function(c,k,l){var g=[],r=c instanceof cc.Node&&"position"===k,t=new e;t.target=c;t.prop=k;k=0;for(var p=l.length;k<p;k++){var v=l[k];t.ratios.push(v.frame/this.duration);r&&g.push(v.motionPath);t.values.push(v.value);
if(v=v.curve){if("string"==typeof v){t.types.push(v);continue}if(Array.isArray(v)){v[0]===v[1]&&v[2]===v[3]?t.types.push(e.Linear):t.types.push(e.Bezier(v));continue}}t.types.push(e.Linear)}r&&b(g,t,this.duration,this.sample,c);c=t.ratios;g=void 0;r=!0;k=1;for(p=c.length;k<p;k++)if(l=c[k]-c[k-1],1===k)g=l;else if(1E-6<Math.abs(l-g)){r=!1;break}t._findFrameIndex=r?d:a;c=t.values[0];return void 0===c||null===c||t._lerp||("number"==typeof c?t._lerp=e.prototype._lerpNumber:c instanceof cc.Quat?t._lerp=
e.prototype._lerpQuat:c instanceof cc.Vec2||c instanceof cc.Vec3?t._lerp=e.prototype._lerpVector:c.lerp&&(t._lerp=e.prototype._lerpObject)),t},createTargetCurves:function(a,c,b){var d=c.props;c=c.comps;if(d)for(var g in d){var k=this.createPropCurve(a,g,d[g]);b.push(k)}if(c)for(var l in c)if(d=a.getComponent(l)){g=c[l];for(var e in g)k=this.createPropCurve(d,e,g[e]),b.push(k)}},createCurves:function(a,c){var b=this.curveData;a=b.paths;var d=[],g;for(g in this.createTargetCurves(c,b,d),a)(b=cc.find(g,
c))&&this.createTargetCurves(b,a[g],d);return d}});cc.AnimationClip=n.exports=c},{"../core/utils/binary-search":213,"./animation-curves":11,"./motion-path-helper":17,"./types":19}],11:[function(f,n,m){function h(a,c){if("string"==typeof c){var b=cc.easing[c];b?a=b(a):cc.errorID(3906,c)}else Array.isArray(c)&&(a=e(c,a));return a}var e=f("./bezier").bezierByTime,d=f("../core/utils/binary-search").binarySearchEpsilon,b=f("./types").WrapModeMask,a=f("./types").WrappedInfo;f=cc.Class({name:"cc.AnimCurve",
sample:function(a,c,b){},onTimeChangedManually:void 0});m=cc.Class({name:"cc.DynamicAnimCurve",extends:f,ctor:function(){this._cachedIndex=0},properties:{target:null,prop:"",values:[],ratios:[],types:[]},_findFrameIndex:d,_lerp:void 0,_lerpNumber:function(a,c,b){return a+(c-a)*b},_lerpObject:function(a,c,b){return a.lerp(c,b)},_lerpQuat:function(){var a=cc.quat();return function(c,b,d){return c.lerp(b,d,a)}}(),_lerpVector:function(){var a=cc.v3();return function(c,b,d){return c.lerp(b,d,a)}}(),sample:function(a,
c,b){a=this.values;b=this.ratios;var d=b.length;if(0!==d){var g=!0,k=this._cachedIndex;if(0>k&&0<(k=~k)&&k<b.length){var l=b[k];c>b[k-1]&&c<l&&(g=!1)}g&&(this._cachedIndex=this._findFrameIndex(b,c));g=this._cachedIndex;0>g?0>=(g=~g)?c=a[0]:g>=d?c=a[d-1]:(d=a[g-1],this._lerp?(l=b[g-1],k=this.types[g-1],c=(c-l)/(b[g]-l),k&&(c=h(c,k)),c=this._lerp(d,a[g],c)):c=d):c=a[g];this.target[this.prop]=c}}});m.Linear=null;m.Bezier=function(a){return a};var c=function(){this.events=[]};c.prototype.add=function(a,
c){this.events.push({func:a||"",params:c||[]})};var g=cc.Class({name:"cc.EventAnimCurve",extends:f,properties:{target:null,ratios:[],events:[],_wrappedInfo:{default:function(){return new a}},_lastWrappedInfo:null,_ignoreIndex:NaN},_wrapIterations:function(a){return 0==a-(0|a)&&--a,0|a},sample:function(c,g,e){c=this.ratios.length;g=e.getWrappedInfo(e.time,this._wrappedInfo);var k=g.direction,l=d(this.ratios,g.ratio);if(0>l&&(l=~l-1,0>k&&(l+=1)),this._ignoreIndex!==l&&(this._ignoreIndex=NaN),g.frameIndex=
l,!this._lastWrappedInfo)return this._fireEvent(l),void(this._lastWrappedInfo=new a(g));e=e.wrapMode;var q=this._wrapIterations(g.iterations);k=this._lastWrappedInfo;var v=this._wrapIterations(k.iterations),w=k.frameIndex;k=k.direction;var f=-1!==v&&q!==v;if(w===l&&f&&1===c)this._fireEvent(0);else if(w!==l||f){do{if(w!==l){if(-1===k&&0===w&&0<l?((e&b.PingPong)===b.PingPong?k*=-1:w=c,v++):1===k&&w===c-1&&l<c-1&&((e&b.PingPong)===b.PingPong?k*=-1:w=-1,v++),w===l)break;if(v>q)break}w+=k;cc.director.getAnimationManager().pushDelayEvent(this,
"_fireEvent",[w])}while(w!==l&&-1<w&&w<c)}this._lastWrappedInfo.set(g)},_fireEvent:function(a){if(!(0>a||a>=this.events.length||this._ignoreIndex===a)&&(a=this.events[a].events,this.target.isValid))for(var c=this.target._components,b=0;b<a.length;b++)for(var d=a[b],g=d.func,k=0;k<c.length;k++){var e=c[k],w=e[g];w&&w.apply(e,d.params)}},onTimeChangedManually:function(a,c){this._lastWrappedInfo=null;this._ignoreIndex=NaN;c=c.getWrappedInfo(a,this._wrappedInfo);a=c.direction;c=d(this.ratios,c.ratio);
0>c&&(c=~c-1,0>a&&(c+=1),this._ignoreIndex=c)}});n.exports={AnimCurve:f,DynamicAnimCurve:m,EventAnimCurve:g,EventInfo:c,computeRatioByType:h,quickFindIndex:function(a,c){var b=a.length-1;if(0===b)return 0;var d=a[0];if(c<d)return 0;var g=a[b];if(c>g)return~a.length;a=(c-d)/(g-d)/(1/b);c=0|a;return 1E-6>a-c?c:1E-6>c+1-a?c+1:~(c+1)}}},{"../core/utils/binary-search":213,"./bezier":14,"./types":19}],12:[function(f,n,m){var h=cc.js;f=cc.Class({ctor:function(){this._anims=new h.array.MutableForwardIterator([]);
this._delayEvents=[];cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)},update:function(e){var d=this._anims,b=d.array;for(d.i=0;d.i<b.length;++d.i){var a=b[d.i];a._isPlaying&&!a._isPaused&&a.update(e)}e=this._delayEvents;for(d=0;d<e.length;d++)b=e[d],b.target[b.func].apply(b.target,b.args);e.length=0},destruct:function(){},addAnimation:function(e){-1===this._anims.array.indexOf(e)&&this._anims.push(e)},removeAnimation:function(e){e=this._anims.array.indexOf(e);0<=e?this._anims.fastRemoveAt(e):
cc.errorID(3907)},pushDelayEvent:function(e,d,b){this._delayEvents.push({target:e,func:d,args:b})}});cc.AnimationManager=n.exports=f},{}],13:[function(f,n,m){function h(d,g){b.call(this);this._currentFramePlayed=!1;this._delayTime=this._delay=0;this._wrappedInfo=new a;this._lastWrappedInfo=null;this._process=e;this._clip=d;this._name=g||d&&d.name;this.animator=null;this.curves=[];this.delay=0;this.speed=this.duration=this.repeatCount=1;this.wrapMode=c.Normal;this.time=0;this._target=null;this._lastframeEventOn=
!1;this.emit=function(){for(var a=Array(arguments.length),c=0,b=a.length;c<b;c++)a[c]=arguments[c];cc.director.getAnimationManager().pushDelayEvent(this,"_emit",a)}}function e(){var c,b=this.sample();this._lastframeEventOn&&(c=this._lastWrappedInfo?this._lastWrappedInfo:this._lastWrappedInfo=new a(b),1<this.repeatCount&&(0|b.iterations)>(0|c.iterations)&&this.emit("lastframe",this),c.set(b));b.stopped&&(this.stop(),this.emit("finished",this))}function d(){var a=this.time,c=this.duration;a>c?0===(a%=
c)&&(a=c):0>a&&0!==(a%=c)&&(a+=c);c=a/c;for(var b=this.curves,d=0,g=b.length;d<g;d++)b[d].sample(a,c,this);this._lastframeEventOn&&(void 0===this._lastIterations&&(this._lastIterations=c),(0<this.time&&this._lastIterations>c||0>this.time&&this._lastIterations<c)&&this.emit("lastframe",this),this._lastIterations=c)}m=cc.js;var b=f("./playable");f=f("./types");var a=f.WrappedInfo,c=f.WrapMode,g=f.WrapModeMask;m.extend(h,b);f=h.prototype;f._emit=function(a,c){this._target&&this._target.isValid&&this._target.emit(a,
a,c)};f.on=function(a,c,b){return this._target&&this._target.isValid?("lastframe"===a&&(this._lastframeEventOn=!0),this._target.on(a,c,b)):null};f.once=function(a,c,b){if(this._target&&this._target.isValid){"lastframe"===a&&(this._lastframeEventOn=!0);var d=this;return this._target.once(a,function(a){c.call(b,a);d._lastframeEventOn=!1})}return null};f.off=function(a,c,b){this._target&&this._target.isValid&&("lastframe"===a&&(this._target.hasEventListener(a)||(this._lastframeEventOn=!1)),this._target.off(a,
c,b))};f._setEventTarget=function(a){this._target=a};f.onPlay=function(){this.setTime(0);this._delayTime=this._delay;cc.director.getAnimationManager().addAnimation(this);this.animator&&this.animator.addAnimation(this);this.emit("play",this)};f.onStop=function(){this.isPaused||cc.director.getAnimationManager().removeAnimation(this);this.animator&&this.animator.removeAnimation(this);this.emit("stop",this)};f.onResume=function(){cc.director.getAnimationManager().addAnimation(this);this.emit("resume",
this)};f.onPause=function(){cc.director.getAnimationManager().removeAnimation(this);this.emit("pause",this)};f.setTime=function(a){this._currentFramePlayed=!1;this.time=a||0;for(var c=this.curves,b=0,d=c.length;b<d;b++){var g=c[b];g.onTimeChangedManually&&g.onTimeChangedManually(a,this)}};f.update=function(a){0<this._delayTime&&(this._delayTime-=a,0<this._delayTime)||(this._currentFramePlayed?this.time+=a*this.speed:this._currentFramePlayed=!0,this._process())};f._needRevers=function(a){var c=this.wrapMode,
b=!1;(c&g.PingPong)===g.PingPong&&(0==a-(0|a)&&0<a&&--a,1&a&&(b=!b));return(c&g.Reverse)===g.Reverse&&(b=!b),b};f.getWrappedInfo=function(c,b){b=b||new a;var d=!1,k=this.duration,l=this.repeatCount,e=0<c?c/k:-c/k;e>=l&&(e=l,d=!0,l-=0|l,0===l&&(l=1),c=l*k*(0<c?1:-1));c>k?(c%=k,c=0===c?k:c):0>c&&0!==(c%=k)&&(c+=k);l=!1;var v=this._wrapMode&g.ShouldWrap;v&&(l=this._needRevers(e));var w=l?-1:1;return 0>this.speed&&(w*=-1),v&&l&&(c=k-c),b.ratio=c/k,b.time=c,b.direction=w,b.stopped=d,b.iterations=e,b};
f.sample=function(){for(var a=this.getWrappedInfo(this.time,this._wrappedInfo),c=this.curves,b=0,d=c.length;b<d;b++)c[b].sample(a.time,a.ratio,this);return a};m.get(f,"clip",function(){return this._clip});m.get(f,"name",function(){return this._name});m.obsolete(f,"AnimationState.length","duration");m.getset(f,"curveLoaded",function(){return 0<this.curves.length},function(){this.curves.length=0});m.getset(f,"wrapMode",function(){return this._wrapMode},function(a){this._wrapMode=a;this.time=0;a&g.Loop?
this.repeatCount=1/0:this.repeatCount=1});m.getset(f,"repeatCount",function(){return this._repeatCount},function(a){this._repeatCount=a;var c=this._wrapMode&g.ShouldWrap,b=(this.wrapMode&g.Reverse)===g.Reverse;this._process=a!==1/0||c||b?e:d});m.getset(f,"delay",function(){return this._delay},function(a){this._delayTime=this._delay=a});cc.AnimationState=n.exports=h},{"./playable":18,"./types":19}],14:[function(f,n,m){function h(a){return 0>a?-Math.pow(-a,1/3):Math.pow(a,1/3)}var e=Math.cos,d=Math.acos,
b=Math.max,a=2*Math.PI,c=Math.sqrt;n.exports={bezier:function(a,c,b,d,e){var g=1-e;return g*(g*(a+(3*c-a)*e)+3*b*e*e)+d*e*e*e},bezierByTime:function(g,k){var l,q,r,t=k-0;var p=k-g[0];var v=3*t,w=3*p,f=3*(k-g[2]);k=1/(-t+w-f+(k-1));f=(v-6*p+f)*k;p=1/3*f;var x=(-v+w)*k;v=1/3*(3*x-f*f);w=1/3*v;t=(2*f*f*f-9*f*x+27*t*k)/27;k=t/2;w=k*k+w*w*w;if(0>w){var y=1/3*-v;y=c(y*y*y);t=-t/(2*y);t=d(-1>t?-1:1<t?1:t);y=2*h(y);p=(l=y*e(1/3*t)-p,q=y*e(1/3*(t+a))-p,r=y*e(1/3*(t+2*a))-p,0<=l&&1>=l?0<=q&&1>=q?0<=r&&1>=r?
b(l,q,r):b(l,q):0<=r&&1>=r?b(l,r):l:0<=q&&1>=q?0<=r&&1>=r?b(q,r):q:r)}else 0===w?p=(q=-(y=0>k?h(-k):-h(k))-p,0<=(l=2*y-p)&&1>=l?0<=q&&1>=q?b(l,q):l:q):(l=c(w),p=h(-k+l)-h(k+l)-p);l=g[1];return((1-p)*(l+(g[3]-l)*p)*3+p*p)*p}}},{}],15:[function(f,n,m){function h(d,b){return function(a){return.5>a?b(2*a)/2:d(2*a-1)/2+.5}}var e={constant:function(){return 0},linear:function(d){return d},quadIn:function(d){return d*d},quadOut:function(d){return d*(2-d)},quadInOut:function(d){return 1>(d*=2)?.5*d*d:-.5*
(--d*(d-2)-1)},cubicIn:function(d){return d*d*d},cubicOut:function(d){return--d*d*d+1},cubicInOut:function(d){return 1>(d*=2)?.5*d*d*d:.5*((d-=2)*d*d+2)},quartIn:function(d){return d*d*d*d},quartOut:function(d){return 1- --d*d*d*d},quartInOut:function(d){return 1>(d*=2)?.5*d*d*d*d:-.5*((d-=2)*d*d*d-2)},quintIn:function(d){return d*d*d*d*d},quintOut:function(d){return--d*d*d*d*d+1},quintInOut:function(d){return 1>(d*=2)?.5*d*d*d*d*d:.5*((d-=2)*d*d*d*d+2)},sineIn:function(d){return 1-Math.cos(d*Math.PI/
2)},sineOut:function(d){return Math.sin(d*Math.PI/2)},sineInOut:function(d){return.5*(1-Math.cos(Math.PI*d))},expoIn:function(d){return 0===d?0:Math.pow(1024,d-1)},expoOut:function(d){return 1===d?1:1-Math.pow(2,-10*d)},expoInOut:function(d){return 0===d?0:1===d?1:1>(d*=2)?.5*Math.pow(1024,d-1):.5*(2-Math.pow(2,-10*(d-1)))},circIn:function(d){return 1-Math.sqrt(1-d*d)},circOut:function(d){return Math.sqrt(1- --d*d)},circInOut:function(d){return 1>(d*=2)?-.5*(Math.sqrt(1-d*d)-1):.5*(Math.sqrt(1-(d-=
2)*d)+1)},elasticIn:function(d){var b,a=.1;return 0===d?0:1===d?1:(!a||1>a?(a=1,b=.1):b=.4*Math.asin(1/a)/(2*Math.PI),-a*Math.pow(2,10*--d)*Math.sin(2*(d-b)*Math.PI/.4))},elasticOut:function(d){var b,a=.1;return 0===d?0:1===d?1:(!a||1>a?(a=1,b=.1):b=.4*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*d)*Math.sin(2*(d-b)*Math.PI/.4)+1)},elasticInOut:function(d){var b,a=.1;return 0===d?0:1===d?1:(!a||1>a?(a=1,b=.1):b=.4*Math.asin(1/a)/(2*Math.PI),1>(d*=2)?a*Math.pow(2,10*--d)*Math.sin(2*(d-b)*Math.PI/.4)*
-.5:a*Math.pow(2,-10*--d)*Math.sin(2*(d-b)*Math.PI/.4)*.5+1)},backIn:function(d){return d*d*(2.70158*d-1.70158)},backOut:function(d){return--d*d*(2.70158*d+1.70158)+1},backInOut:function(d){return 1>(d*=2)?d*d*(3.5949095*d-2.5949095)*.5:.5*((d-=2)*d*(3.5949095*d+2.5949095)+2)},bounceIn:function(d){return 1-e.bounceOut(1-d)},bounceOut:function(d){return d<1/2.75?7.5625*d*d:d<2/2.75?7.5625*(d-=1.5/2.75)*d+.75:d<2.5/2.75?7.5625*(d-=2.25/2.75)*d+.9375:7.5625*(d-=2.625/2.75)*d+.984375},bounceInOut:function(d){return.5>
d?.5*e.bounceIn(2*d):.5*e.bounceOut(2*d-1)+.5},smooth:function(d){return 0>=d?0:1<=d?1:d*d*(3-2*d)},fade:function(d){return 0>=d?0:1<=d?1:d*d*d*(d*(6*d-15)+10)}};e.quadOutIn=h(e.quadIn,e.quadOut);e.cubicOutIn=h(e.cubicIn,e.cubicOut);e.quartOutIn=h(e.quartIn,e.quartOut);e.quintOutIn=h(e.quintIn,e.quintOut);e.sineOutIn=h(e.sineIn,e.sineOut);e.expoOutIn=h(e.expoIn,e.expoOut);e.circOutIn=h(e.circIn,e.circOut);e.backOutIn=h(e.backIn,e.backOut);e.bounceIn=function(d){return 1-e.bounceOut(1-d)};e.bounceInOut=
function(d){return.5>d?.5*e.bounceIn(2*d):.5*e.bounceOut(2*d-1)+.5};e.bounceOutIn=h(e.bounceIn,e.bounceOut);cc.easing=n.exports=e},{}],16:[function(f,n,m){f("./bezier");f("./easing");f("./types");f("./motion-path-helper");f("./animation-curves");f("./animation-clip");f("./animation-manager");f("./animation-state");f("./animation-animator")},{"./animation-animator":9,"./animation-clip":10,"./animation-curves":11,"./animation-manager":12,"./animation-state":13,"./bezier":14,"./easing":15,"./motion-path-helper":17,
"./types":19}],17:[function(f,n,m){function h(a){this.points=a||[];this.beziers=[];this.ratios=[];this.progresses=[];this.length=0;this.computeBeziers()}function e(){this.start=k();this.end=k();this.startCtrlPoint=k();this.endCtrlPoint=k()}function d(a){if(!Array.isArray(a))return!1;for(var c=0,b=a.length;c<b;c++){var d=a[c];if(!Array.isArray(d)||6!==d.length)return!1}return!0}var b=f("./animation-curves").DynamicAnimCurve,a=f("./animation-curves").computeRatioByType,c=f("./bezier").bezier,g=f("../core/utils/binary-search").binarySearchEpsilon,
k=cc.v2;h.prototype.computeBeziers=function(){var a;this.beziers.length=0;this.ratios.length=0;this.length=this.progresses.length=0;for(var c=1;c<this.points.length;c++){var b=this.points[c-1],d=this.points[c];(a=new e).start=b.pos;a.startCtrlPoint=b.out;a.end=d.pos;a.endCtrlPoint=d.in;this.beziers.push(a);this.length+=a.getLength()}for(c=b=0;c<this.beziers.length;c++)a=this.beziers[c],this.ratios[c]=a.getLength()/this.length,this.progresses[c]=b+=this.ratios[c];return this.beziers};e.prototype.getPointAt=
function(a){a=this.getUtoTmapping(a);return this.getPoint(a)};e.prototype.getPoint=function(a){var b=c(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,a);a=c(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,a);return new k(b,a)};e.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};e.prototype.getLengths=function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===a+1)return this.cacheArcLengths;
var c,b=[],d=this.getPoint(0),g=k(),l=0;b.push(0);for(c=1;c<=a;c++){var e=this.getPoint(c/a);g.x=d.x-e.x;g.y=d.y-e.y;l+=g.mag();b.push(l);d=e}return this.cacheArcLengths=b,b};e.prototype.getUtoTmapping=function(a,c){var b=this.getLengths(),d=b.length;a=c||a*b[d-1];for(var g,k=0,l=d-1;k<=l;)if(0>(g=b[c=Math.floor(k+(l-k)/2)]-a))k=c+1;else{if(!(0<g)){l=c;break}l=c-1}if(b[c=l]===a)return c/(d-1);g=b[c];return(c+(a-g)/(b[c+1]-g))/(d-1)};n.exports={sampleMotionPaths:function(c,e,r,t,p){function l(a){return a instanceof
cc.Vec2?{in:a,pos:a,out:a}:Array.isArray(a)&&6===a.length?{in:k(a[2],a[3]),pos:k(a[0],a[1]),out:k(a[4],a[5])}:{in:cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}function q(a,c,b){B.push(a);m.push(c);z.push(b)}var f=e.values=e.values.map(function(a){return Array.isArray(a)&&(a=2===a.length?cc.v2(a[0],a[1]):cc.v3(a[0],a[1],a[2])),a});if(0!==c.length&&0!==f.length){for(var x=!1,y=0;y<c.length;y++){var u=c[y];if(u&&!d(u)&&(cc.errorID(3904,p?p.name:"","position",y),u=null),u&&0<u.length){x=!0;break}}if(x&&
1!==f.length){p=e.types;x=e.ratios;var B=e.values=[],m=e.types=[],z=e.ratios=[];e=0;var A=b.Linear;y=0;for(u=c.length;y<u-1;y++){var D=c[y],n=x[y],F=x[y+1]-n,G=f[y],J=f[y+1];A=p[y];var N=[],K=e/F,P=1/(F*r*t);if(D&&0<D.length){var L=[];L.push(l(G));G=0;for(var M=D.length;G<M;G++){var U=l(D[G]);L.push(U)}L.push(l(J));J=new h(L);J.computeBeziers();for(D=J.progresses;1E-6<1-K;)0>(L=a(L=K,A))?(M=(0-L)*(L=J.beziers[0]).getLength(),G=L.start.sub(L.endCtrlPoint).normalize(),L=L.start.add(G.mul(M))):1<L?(M=
(L-1)*(L=J.beziers[J.beziers.length-1]).getLength(),G=L.end.sub(L.startCtrlPoint).normalize(),L=L.end.add(G.mul(M))):(G=g(D,L),0>G&&(G=~G),L-=0<G?D[G-1]:0,L/=J.ratios[G],L=J.beziers[G].getPointAt(L)),N.push(L),K+=P}else for(;1E-6<1-K;)L=a(L=K,A),N.push(G.lerp(J,L)),K+=P;A="constant"===A?A:b.Linear;G=0;for(M=N.length;G<M;G++)q(N[G],A,n+e+P*G*F);e=1E-6<Math.abs(K-1)?(K-1)*F:0}x[x.length-1]!==z[z.length-1]&&q(f[f.length-1],A,x[x.length-1])}}},Curve:h,Bezier:e}},{"../core/utils/binary-search":213,"./animation-curves":11,
"./bezier":14}],18:[function(f,n,m){function h(){this._stepOnce=this._isPaused=this._isPlaying=!1}m=cc.js;var e=f("../core/CCDebug");f=h.prototype;m.get(f,"isPlaying",function(){return this._isPlaying},!0);m.get(f,"isPaused",function(){return this._isPaused},!0);m=function(){};f.onPlay=m;f.onPause=m;f.onResume=m;f.onStop=m;f.onError=m;f.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError(e.getError(3912)):(this._isPlaying=!0,this.onPlay())};f.stop=function(){this._isPlaying&&
(this._isPlaying=!1,this.onStop(),this._isPaused=!1)};f.pause=function(){this._isPlaying&&!this._isPaused&&(this._isPaused=!0,this.onPause())};f.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())};f.step=function(){this.pause();this._stepOnce=!0;this._isPlaying||this.play()};n.exports=h},{"../core/CCDebug":27}],19:[function(f,n,m){function h(e){e?this.set(e):(this.ratio=0,this.time=0,this.direction=1,this.stopped=!0,this.iterations=0,this.frameIndex=void 0)}f={Loop:2,
ShouldWrap:4,PingPong:22,Reverse:36};m=cc.Enum({Default:0,Normal:1,Reverse:f.Reverse,Loop:f.Loop,LoopReverse:f.Loop|f.Reverse,PingPong:f.PingPong,PingPongReverse:f.PingPong|f.Reverse});cc.WrapMode=m;h.prototype.set=function(e){this.ratio=e.ratio;this.time=e.time;this.direction=e.direction;this.stopped=e.stopped;this.iterations=e.iterations;this.frameIndex=e.frameIndex};n.exports={WrapModeMask:f,WrapMode:m,WrappedInfo:h}},{}],20:[function(f,n,m){var h=f("../core/event/event-target"),e=f("../core/platform/CCSys"),
d=f("../core/assets/CCAudioClip").LoadMode,b=!1,a=[],c=function r(a){h.call(this);this._src=a;this._element=null;this.id=0;this._volume=1;this._loop=!1;this._nextTime=0;this._state=r.State.INITIALZING;this._onended=function(){this._state=r.State.STOPPED;this.emit("ended")}.bind(this)};cc.js.extend(c,h);c.State={ERROR:-1,INITIALZING:0,PLAYING:1,PAUSED:2,STOPPED:3};(function(g){g._bindEnded=function(a){a=a||this._onended;var c=this._element;this._src&&c instanceof HTMLAudioElement?c.addEventListener("ended",
a):c.onended=a};g._unbindEnded=function(){var a=this._element;a instanceof HTMLAudioElement?a.removeEventListener("ended",this._onended):a&&(a.onended=null)};g._onLoaded=function(){this._createElement();this.setVolume(this._volume);this.setLoop(this._loop);0!==this._nextTime&&this.setCurrentTime(this._nextTime);this.getState()===c.State.PLAYING?this.play():this._state=c.State.INITIALZING};g._createElement=function(){var a=this._src._nativeAsset;a instanceof HTMLAudioElement?(this._element||(this._element=
document.createElement("audio")),this._element.src=a.src):this._element=new k(a,this)};g.play=function(){this._state=c.State.PLAYING;this._element&&(this._bindEnded(),this._element.play(),this._touchToPlay())};g._touchToPlay=function(){(this._src&&this._src.loadMode===d.DOM_AUDIO&&this._element.paused&&a.push({instance:this,offset:0,audio:this._element}),b)||(b=!0,cc.game.canvas.addEventListener("ontouchend"in window?"touchend":"mousedown",function(){for(var c;c=a.pop();)c.audio.play(c.offset)}))};
g.destroy=function(){this._element=null};g.pause=function(){this._element&&this.getState()===c.State.PLAYING&&(this._unbindEnded(),this._element.pause(),this._state=c.State.PAUSED)};g.resume=function(){this._element&&this.getState()===c.State.PAUSED&&(this._bindEnded(),this._element.play(),this._state=c.State.PLAYING)};g.stop=function(){if(this._element){this._element.pause();try{this._element.currentTime=0}catch(t){}for(var b=0;b<a.length;b++)if(a[b].instance===this){a.splice(b,1);break}this._unbindEnded();
this.emit("stop");this._state=c.State.STOPPED}};g.setLoop=function(a){this._loop=a;this._element&&(this._element.loop=a)};g.getLoop=function(){return this._loop};g.setVolume=function(a){this._volume=a;this._element&&(this._element.volume=a)};g.getVolume=function(){return this._volume};g.setCurrentTime=function(a){if(this._element){this._nextTime=0;this._unbindEnded();this._bindEnded(function(){this._bindEnded()}.bind(this));try{this._element.currentTime=a}catch(p){var c=this._element;c.addEventListener&&
c.addEventListener("loadedmetadata",function w(){c.removeEventListener("loadedmetadata",w);c.currentTime=a})}}else this._nextTime=a};g.getCurrentTime=function(){return this._element?this._element.currentTime:0};g.getDuration=function(){return this._element?this._element.duration:0};g.getState=function(){return this._forceUpdatingState(),this._state};g._forceUpdatingState=function(){var a=this._element;a&&(c.State.PLAYING===this._state&&a.paused?this._state=c.State.STOPPED:c.State.STOPPED!==this._state||
a.paused||(this._state=c.State.PLAYING))};Object.defineProperty(g,"src",{get:function(){return this._src},set:function(a){if(this._unbindEnded(),a)if(this._src=a,a.loaded)this._onLoaded();else{var b=this;a.once("load",function(){a===b._src&&b._onLoaded()});cc.loader.load({url:a.nativeUrl,skips:["Loader"]},function(c,b){c?cc.error(c):a.loaded||(a._nativeAsset=b)})}else this._src=null,this._element instanceof HTMLAudioElement?this._element.src="":this._element=null,this._state=c.State.INITIALZING;return a},
enumerable:!0,configurable:!0});Object.defineProperty(g,"paused",{get:function(){return!this._element||this._element.paused},enumerable:!0,configurable:!0})})(c.prototype);var g=void 0;g=cc.sys.browserType===cc.sys.BROWSER_TYPE_EDGE||cc.sys.browserType===cc.sys.BROWSER_TYPE_BAIDU||cc.sys.browserType===cc.sys.BROWSER_TYPE_UC?.01:0;var k=function(a,c){this._audio=c;this._context=e.__audioSupport.context;this._buffer=a;this._gainObj=this._context.createGain();this.volume=1;this._gainObj.connect(this._context.destination);
this._loop=!1;this._startTime=-1;this._currentSource=null;this.playedLength=0;this._currentTimer=null;this._endCallback=function(){this.onended&&this.onended(this)}.bind(this)};(function(c){c.play=function(c){this._currentSource&&!this.paused&&(this._currentSource.onended=null,this._currentSource.stop(0),this.playedLength=0);var b=this._context.createBufferSource();b.buffer=this._buffer;b.connect(this._gainObj);b.loop=this._loop;this._startTime=this._context.currentTime;(c=c||this.playedLength)&&
(this._startTime-=c);var d=this._buffer.duration,g=c,k=void 0;if(this._loop?b.start?b.start(0,g):b.notoGrainOn?b.noteGrainOn(0,g):b.noteOn(0,g):(k=d-c,b.start?b.start(0,g,k):b.noteGrainOn?b.noteGrainOn(0,g,k):b.noteOn(0,g,k)),this._currentSource=b,b.onended=this._endCallback,(!b.context.state||"suspended"===b.context.state)&&0===this._context.currentTime){var e=this;clearTimeout(this._currentTimer);this._currentTimer=setTimeout(function(){0===e._context.currentTime&&a.push({instance:e._audio,offset:c,
audio:e})},10)}};c.pause=function(){if(clearTimeout(this._currentTimer),!this.paused){this.playedLength=this._context.currentTime-this._startTime;this.playedLength%=this._buffer.duration;var a=this._currentSource;this._currentSource=null;this._startTime=-1;a&&a.stop(0)}};Object.defineProperty(c,"paused",{get:function(){return(!this._currentSource||!this._currentSource.loop)&&(-1===this._startTime||this._context.currentTime-this._startTime>this._buffer.duration)},enumerable:!0,configurable:!0});Object.defineProperty(c,
"loop",{get:function(){return this._loop},set:function(a){return this._currentSource&&(this._currentSource.loop=a),this._loop=a},enumerable:!0,configurable:!0});Object.defineProperty(c,"volume",{get:function(){return this._volume},set:function(a){if(this._volume=a,this._gainObj.gain.setTargetAtTime)try{this._gainObj.gain.setTargetAtTime(a,this._context.currentTime,g)}catch(t){this._gainObj.gain.setTargetAtTime(a,this._context.currentTime,.01)}else this._gainObj.gain.value=a;e.os===e.OS_IOS&&!this.paused&&
this._currentSource&&(this._currentSource.onended=null,this.pause(),this.play())},enumerable:!0,configurable:!0});Object.defineProperty(c,"currentTime",{get:function(){return this.paused?this.playedLength:(this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration,this.playedLength)},set:function(a){return this.paused?this.playedLength=a:(this.pause(),this.playedLength=a,this.play()),a},enumerable:!0,configurable:!0});Object.defineProperty(c,"duration",{get:function(){return this._buffer.duration},
enumerable:!0,configurable:!0})})(k.prototype);n.exports=cc.Audio=c},{"../core/assets/CCAudioClip":35,"../core/event/event-target":99,"../core/platform/CCSys":139}],21:[function(f,n,m){var h=f("./CCAudio"),e=f("../core/assets/CCAudioClip"),d=cc.js,b=0,a=d.createMap(!0),c={},g=[],k=function(d){var k=b++,l=c[d];if(l||(l=c[d]=[]),q._maxAudioInstance<=l.length)d=l.shift(),a[d].stop();d=g.pop()||new h;var e=function(){if(a[this.id]){delete a[this.id];var c=l.indexOf(this.id);cc.js.array.fastRemoveAt(l,
c)}this._finishCallback=null;this.off("ended");this.off("stop");this.src=null;g.includes(this)||(32>g.length?g.push(this):this.destroy())};return d.on("ended",function(){this._finishCallback&&this._finishCallback();e.call(this)},d),d.on("stop",e,d),d.id=k,a[k]=d,l.push(k),d},l=function(a){return void 0===a?a=1:"string"==typeof a&&(a=Number.parseFloat(a)),a},q={AudioState:h.State,_maxWebAudioSize:2097152,_maxAudioInstance:24,_id2audio:a,play:function(a,c,b){var d=a;if("string"==typeof a){cc.warnID(8401,
"cc.audioEngine","cc.AudioClip","AudioClip","cc.AudioClip","audio");var g=k(d=a);e._loadByUrl(d,function(a,c){c&&(g.src=c)})}else{if(!a)return;d=a.nativeUrl;(g=k(d)).src=a}return g.setLoop(c||!1),b=l(b),g.setVolume(b),setTimeout(function(){g.play()},10),g.id},setLoop:function(c,b){(c=a[c])&&c.setLoop&&c.setLoop(b)},isLoop:function(c){c=a[c];return!(!c||!c.getLoop)&&c.getLoop()},setVolume:function(c,b){(c=a[c])&&c.setVolume(b)},getVolume:function(c){return(c=a[c])?c.getVolume():1},setCurrentTime:function(c,
b){c=a[c];return!!c&&(c.setCurrentTime(b),!0)},getCurrentTime:function(c){return(c=a[c])?c.getCurrentTime():0},getDuration:function(c){return(c=a[c])?c.getDuration():0},getState:function(c){return(c=a[c])?c.getState():this.AudioState.ERROR},setFinishCallback:function(c,b){(c=a[c])&&(c._finishCallback=b)},pause:function(c){c=a[c];return!!c&&(c.pause(),!0)},_pauseIDCache:[],pauseAll:function(){for(var c in a){var b=a[c];b.getState()===h.State.PLAYING&&(this._pauseIDCache.push(c),b.pause())}},resume:function(c){(c=
a[c])&&c.resume()},resumeAll:function(){for(var c=0;c<this._pauseIDCache.length;++c){var b=a[this._pauseIDCache[c]];b&&b.resume()}this._pauseIDCache.length=0},stop:function(c){c=a[c];return!!c&&(c.stop(),!0)},stopAll:function(){for(var c in a){var b=a[c];b&&b.stop()}},setMaxAudioInstance:function(a){this._maxAudioInstance=a},getMaxAudioInstance:function(){return this._maxAudioInstance},uncache:function(b){if("string"==typeof b)cc.warnID(8401,"cc.audioEngine","cc.AudioClip","AudioClip","cc.AudioClip",
"audio");else{if(!b)return;b=b.nativeUrl}if(b=c[b])for(;0<b.length;){var d=b.pop(),g=a[d];g&&(g.stop(),delete a[d])}},uncacheAll:function(){this.stopAll();var b=void 0,k;for(k in a)(b=a[k])&&b.destroy();for(;b=g.pop();)b.destroy();a=d.createMap(!0);c={}},getProfile:function(a){},preload:function(a,c){cc.loader.load(a,c&&function(a){a||c()})},setMaxWebAudioSize:function(a){this._maxWebAudioSize=1024*a},_breakCache:null,_break:function(){for(var c in this._breakCache=[],a){var b=a[c];b.getState()===
h.State.PLAYING&&(this._breakCache.push(c),b.pause())}},_restore:function(){if(this._breakCache){for(;0<this._breakCache.length;){var c=this._breakCache.pop();(c=a[c])&&c.resume&&c.resume()}this._breakCache=null}},_music:{id:-1,loop:!1,volume:1},_effect:{volume:1,pauseCache:[]},playMusic:function(a,c){var b=this._music;return this.stop(b.id),b.id=this.play(a,c,b.volume),b.loop=c,b.id},stopMusic:function(){this.stop(this._music.id)},pauseMusic:function(){return this.pause(this._music.id),this._music.id},
resumeMusic:function(){return this.resume(this._music.id),this._music.id},getMusicVolume:function(){return this._music.volume},setMusicVolume:function(a){a=l(a);var c=this._music;return c.volume=a,this.setVolume(c.id,c.volume),c.volume},isMusicPlaying:function(){return this.getState(this._music.id)===this.AudioState.PLAYING},playEffect:function(a,c){return this.play(a,c||!1,this._effect.volume)},setEffectsVolume:function(c){c=l(c);var b=this._music.id,d;for(d in this._effect.volume=c,a){var g=a[d];
g&&g.id!==b&&q.setVolume(d,c)}},getEffectsVolume:function(){return this._effect.volume},pauseEffect:function(a){return this.pause(a)},pauseAllEffects:function(){var c=this._music.id,b=this._effect,d;for(d in b.pauseCache.length=0,a){var g=a[d];g&&g.id!==c&&g.getState()===this.AudioState.PLAYING&&(b.pauseCache.push(d),g.pause())}},resumeEffect:function(a){this.resume(a)},resumeAllEffects:function(){for(var c=this._effect.pauseCache,b=0;b<c.length;++b){var d=a[c[b]];d&&d.resume()}},stopEffect:function(a){return this.stop(a)},
stopAllEffects:function(){var c=this._music.id,b;for(b in a){var d=a[b];d&&d.id!==c&&d.getState()===q.AudioState.PLAYING&&d.stop()}}};n.exports=cc.audioEngine=q},{"../core/assets/CCAudioClip":35,"./CCAudio":20}],22:[function(f,n,m){var h={name:"Jacob__Codec"};h.Base64=f("./base64");h.GZip=f("./gzip");h.unzip=function(){return h.GZip.gunzip.apply(h.GZip,arguments)};h.unzipBase64=function(){var e=h.Base64.decode.apply(h.Base64,arguments);try{return h.GZip.gunzip.call(h.GZip,e)}catch(d){return e.slice(7)}};
h.unzipBase64AsArray=function(e,d){d=d||1;var b,a,c=this.unzipBase64(e),g=[];e=0;for(a=c.length/d;e<a;e++)for(g[e]=0,b=d-1;0<=b;--b)g[e]+=c.charCodeAt(e*d+b)<<8*b;return g};h.unzipAsArray=function(e,d){d=d||1;var b,a,c=this.unzip(e),g=[];e=0;for(a=c.length/d;e<a;e++)for(g[e]=0,b=d-1;0<=b;--b)g[e]+=c.charCodeAt(e*d+b)<<8*b;return g};cc.codec=n.exports=h},{"./base64":23,"./gzip":24}],23:[function(f,n,m){var h=f("../core/utils/misc").BASE64_VALUES;n.exports={name:"Jacob__Codec__Base64",decode:function(e){var d,
b,a,c=[],g=0;for(e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");g<e.length;){var k=h[e.charCodeAt(g++)]<<2|(d=h[e.charCodeAt(g++)])>>4;d=(15&d)<<4|(b=h[e.charCodeAt(g++)])>>2;var l=(3&b)<<6|(a=h[e.charCodeAt(g++)]);c.push(String.fromCharCode(k));64!==b&&c.push(String.fromCharCode(d));64!==a&&c.push(String.fromCharCode(l))}return c.join("")},decodeAsArray:function(e,d){var b,a,c=this.decode(e),g=[];e=0;for(a=c.length/d;e<a;e++)for(g[e]=0,b=d-1;0<=b;--b)g[e]+=c.charCodeAt(e*d+b)<<8*b;return g}}},{"../core/utils/misc":220}],
24:[function(f,n,m){var h=function(e){this.data=e;this.debug=!1;this.gpflags=void 0;this.files=0;this.unzipped=[];this.buf32k=Array(32768);this.bIdx=0;this.modeZIP=!1;this.bytepos=0;this.bb=1;this.bits=0;this.nameBuf=[];this.fileout=void 0;this.literalTree=Array(h.LITERALS);this.distanceTree=Array(32);this.treepos=0;this.Places=null;this.len=0;this.fpos=Array(17);this.fpos[0]=0;this.fmax=this.flens=void 0};h.gunzip=function(e){return e.constructor===Array||(e.constructor,String),(new h(e)).gunzip()[0][0]};
h.HufNode=function(){this.b1=this.b0=0;this.jump=null;this.jumppos=-1};h.LITERALS=288;h.NAMEMAX=256;h.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,
182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,
159,95,223,63,191,127,255];h.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];h.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99];h.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];h.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];h.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];h.prototype.gunzip=function(){return this.outputArr=
[],this.nextFile(),this.unzipped};h.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1};h.prototype.byteAlign=function(){this.bb=1};h.prototype.readBit=function(){var e;return this.bits++,e=1&this.bb,this.bb>>=1,0===this.bb&&(this.bb=this.readByte(),e=1&this.bb,this.bb=this.bb>>1|128),e};h.prototype.readBits=function(e){for(var d=0,b=e;b--;)d=d<<1|this.readBit();return e&&(d=h.bitReverse[d]>>8-e),d};h.prototype.flushBuffer=function(){this.bIdx=
0};h.prototype.addBuffer=function(e){this.buf32k[this.bIdx++]=e;this.outputArr.push(String.fromCharCode(e));32768===this.bIdx&&(this.bIdx=0)};h.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}};h.prototype.Rec=function(){var e,d=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,0<=(e=this.IsPat()))d.b0=e;else if(d.b0=32768,this.Rec())return-1;
if(0<=(e=this.IsPat()))d.b1=e,d.jump=null;else if(d.b1=32768,d.jump=this.Places[this.treepos],d.jumppos=this.treepos,this.Rec())return-1;return this.len--,0};h.prototype.CreateTree=function(e,d,b,a){this.Places=e;this.treepos=0;this.flens=b;this.fmax=d;for(e=0;17>e;e++)this.fpos[e]=0;return this.len=0,this.Rec()?-1:0};h.prototype.DecodeValue=function(e){for(var d,b,a=0,c=e[a];;)if(this.readBit()){if(!(32768&c.b1))return c.b1;c=c.jump;d=e.length;for(b=0;b<d;b++)if(e[b]===c){a=b;break}}else{if(!(32768&
c.b0))return c.b0;c=e[++a]}};h.prototype.DeflateLoop=function(){var e,d;do if(e=this.readBit(),0===(d=this.readBits(2))){this.byteAlign();d=this.readByte();d|=this.readByte()<<8;var b=this.readByte();for(65535&(d^~(b|this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");d--;)b=this.readByte(),this.addBuffer(b)}else if(1===d)for(;;)if(23<(c=h.bitReverse[this.readBits(7)]>>1)?199<(c=c<<1|this.readBit())?c=(c-=128)<<1|this.readBit():143<(c-=48)&&(c+=136):c+=256,256>c)this.addBuffer(c);
else{if(256===c)break;c-=257;var a=this.readBits(h.cplext[c])+h.cplens[c];c=h.bitReverse[this.readBits(5)]>>3;8<h.cpdext[c]?(q=this.readBits(8),q|=this.readBits(h.cpdext[c]-8)<<8):q=this.readBits(h.cpdext[c]);q+=h.cpdist[c];for(c=0;c<a;c++)b=this.buf32k[this.bIdx-q&32767],this.addBuffer(b)}else if(2===d){var c,g=Array(320);d=257+this.readBits(5);b=1+this.readBits(5);var k=4+this.readBits(4);for(c=0;19>c;c++)g[c]=0;for(c=0;c<k;c++)g[h.border[c]]=this.readBits(3);a=this.distanceTree.length;for(k=0;k<
a;k++)this.distanceTree[k]=new h.HufNode;if(this.CreateTree(this.distanceTree,19,g,0))return this.flushBuffer(),1;a=d+b;for(k=0;k<a;)if(0,16>(c=this.DecodeValue(this.distanceTree)))g[k++]=c;else if(16===c){var l;if(k+(c=3+this.readBits(2))>a)return this.flushBuffer(),1;for(l=k?g[k-1]:0;c--;)g[k++]=l}else{if(k+(c=17===c?3+this.readBits(3):11+this.readBits(7))>a)return this.flushBuffer(),1;for(;c--;)g[k++]=0}a=this.literalTree.length;for(k=0;k<a;k++)this.literalTree[k]=new h.HufNode;if(this.CreateTree(this.literalTree,
d,g,0))return this.flushBuffer(),1;a=this.literalTree.length;for(k=0;k<a;k++)this.distanceTree[k]=new h.HufNode;c=[];for(k=d;k<g.length;k++)c[k-d]=g[k];if(this.CreateTree(this.distanceTree,b,c,0))return this.flushBuffer(),1;for(;;)if(256<=(c=this.DecodeValue(this.literalTree))){var q;if(0===(c-=256))break;c--;a=this.readBits(h.cplext[c])+h.cplens[c];c=this.DecodeValue(this.distanceTree);8<h.cpdext[c]?(q=this.readBits(8),q|=this.readBits(h.cpdext[c]-8)<<8):q=this.readBits(h.cpdext[c]);for(q+=h.cpdist[c];a--;)b=
this.buf32k[this.bIdx-q&32767],this.addBuffer(b)}else this.addBuffer(c)}while(!e);return this.flushBuffer(),this.byteAlign(),0};h.prototype.unzipFile=function(e){var d;this.gunzip();for(d=0;d<this.unzipped.length;d++)if(this.unzipped[d][1]===e)return this.unzipped[d][0]};h.prototype.nextFile=function(){this.outputArr=[];this.modeZIP=!1;var e=[];if(e[0]=this.readByte(),e[1]=this.readByte(),120===e[0]&&218===e[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],
this.files++),31===e[0]&&139===e[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===e[0]&&75===e[1]&&(this.modeZIP=!0,e[2]=this.readByte(),e[3]=this.readByte(),3===e[2]&&4===e[3])){e[0]=this.readByte();e[1]=this.readByte();this.gpflags=this.readByte();this.gpflags|=this.readByte()<<8;e=this.readByte();e|=this.readByte()<<8;this.readByte();this.readByte();this.readByte();this.readByte();this.readByte();this.readByte()<<8;this.readByte()<<16;this.readByte()<<
24;this.readByte();this.readByte()<<8;this.readByte()<<16;this.readByte()<<24;var d=this.readByte();d|=this.readByte()<<8;var b=this.readByte();b|=this.readByte()<<8;c=0;for(this.nameBuf=[];d--;){var a=this.readByte();"/"===a|":"===a?c=0:c<h.NAMEMAX-1&&(this.nameBuf[c++]=String.fromCharCode(a))}this.fileout||(this.fileout=this.nameBuf);for(var c=0;c<b;)this.readByte(),c++;8===e&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++);this.skipdir()}};
h.prototype.skipdir=function(){var e;var d=[];if(8&this.gpflags&&(d[0]=this.readByte(),d[1]=this.readByte(),d[2]=this.readByte(),d[3]=this.readByte(),this.readByte(),this.readByte()<<8,this.readByte()<<16,this.readByte()<<24,this.readByte(),this.readByte()<<8,this.readByte()<<16,this.readByte()<<24),this.modeZIP&&this.nextFile(),d[0]=this.readByte(),8!==d[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(d[0]=
this.readByte(),d[2]=this.readByte(),this.len=d[0]+256*d[1],d=0;d<this.len;d++)this.readByte();if(8&this.gpflags)for(d=0,this.nameBuf=[];e=this.readByte();)"7"!==e&&":"!==e||(d=0),d<h.NAMEMAX-1&&(this.nameBuf[d++]=e);if(16&this.gpflags)for(;this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte());this.DeflateLoop();this.readByte();this.readByte();this.readByte();this.readByte();this.modeZIP&&this.nextFile()};n.exports=h},{}],25:[function(f,n,m){(function(){function f(a){throw a;}function e(a,
c){var b;a=a.split(".");var d=u;a[0]in d||!d.execScript||d.execScript("var "+a[0]);for(;a.length&&(b=a.shift());)a.length||void 0===c?d=d[b]?d[b]:d[b]={}:d[b]=c}function d(a){if("string"==typeof a){var c,b=a.split("");a=0;for(c=b.length;a<c;a++)b[a]=(255&b[a].charCodeAt(0))>>>0;a=b}b=1;for(var d=0,g=a.length,k=0;0<g;){g-=c=1024<g?1024:g;do d+=b+=a[k++];while(--c);b%=65521;d%=65521}return(d<<16|b)>>>0}function b(a,c){this.index="number"==typeof c?c:0;this.i=0;this.buffer=a instanceof(B?Uint8Array:
Array)?a:new (B?Uint8Array:Array)(32768);2*this.buffer.length<=this.index&&f(Error("invalid index"));this.buffer.length<=this.index&&this.f()}function a(a){this.buffer=new (B?Uint16Array:Array)(2*a);this.length=0}function c(a){var c,b,d,g=a.length,k=0,l=Number.POSITIVE_INFINITY;for(b=0;b<g;++b)a[b]>k&&(k=a[b]),a[b]<l&&(l=a[b]);var e=1<<k;var q=new (B?Uint32Array:Array)(e);var p=1;var r=0;for(c=2;p<=k;){for(b=0;b<g;++b)if(a[b]===p){var t=0;var v=r;for(d=0;d<p;++d)t=t<<1|1&v,v>>=1;for(d=t;d<e;d+=c)q[d]=
p<<16|b;++r}++p;r<<=1;c<<=1}return[q,k,l]}function g(a,c){this.h=G;this.w=0;this.input=a;this.b=0;c&&(c.lazy&&(this.w=c.lazy),"number"==typeof c.compressionType&&(this.h=c.compressionType),c.outputBuffer&&(this.a=B&&c.outputBuffer instanceof Array?new Uint8Array(c.outputBuffer):c.outputBuffer),"number"==typeof c.outputIndex&&(this.b=c.outputIndex));this.a||(this.a=new (B?Uint8Array:Array)(32768))}function k(a,c){this.length=a;this.G=c}function l(){var a=N;switch(!0){case 3===a:return[257,a-3,0];case 4===
a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=
a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:f("invalid length: "+a)}}function q(a,c){function b(a,c){var b,d=a.G,g=[],k=0;switch(b=K[a.length],g[k++]=65535&b,g[k++]=b>>16&255,g[k++]=b>>24,!0){case 1===d:var l=
[0,d-1,0];break;case 2===d:l=[1,d-2,0];break;case 3===d:l=[2,d-3,0];break;case 4===d:l=[3,d-4,0];break;case 6>=d:l=[4,d-5,1];break;case 8>=d:l=[5,d-7,1];break;case 12>=d:l=[6,d-9,2];break;case 16>=d:l=[7,d-13,2];break;case 24>=d:l=[8,d-17,3];break;case 32>=d:l=[9,d-25,3];break;case 48>=d:l=[10,d-33,4];break;case 64>=d:l=[11,d-49,4];break;case 96>=d:l=[12,d-65,5];break;case 128>=d:l=[13,d-97,5];break;case 192>=d:l=[14,d-129,6];break;case 256>=d:l=[15,d-193,6];break;case 384>=d:l=[16,d-257,7];break;
case 512>=d:l=[17,d-385,7];break;case 768>=d:l=[18,d-513,8];break;case 1024>=d:l=[19,d-769,8];break;case 1536>=d:l=[20,d-1025,9];break;case 2048>=d:l=[21,d-1537,9];break;case 3072>=d:l=[22,d-2049,10];break;case 4096>=d:l=[23,d-3073,10];break;case 6144>=d:l=[24,d-4097,11];break;case 8192>=d:l=[25,d-6145,11];break;case 12288>=d:l=[26,d-8193,12];break;case 16384>=d:l=[27,d-12289,12];break;case 24576>=d:l=[28,d-16385,13];break;case 32768>=d:l=[29,d-24577,13];break;default:f("invalid distance")}b=l;g[k++]=
b[0];g[k++]=b[1];g[k++]=b[2];b=0;for(l=g.length;b<l;++b)r[t++]=g[b];w[g[0]]++;h[g[3]]++;v=a.length+c-1;q=null}var d,g,l,e,q,p={},r=B?new Uint16Array(2*c.length):[],t=0,v=0,w=new (B?Uint32Array:Array)(286),h=new (B?Uint32Array:Array)(30),x=a.w;if(!B){for(g=0;285>=g;)w[g++]=0;for(g=0;29>=g;)h[g++]=0}w[256]=1;var E=0;for(d=c.length;E<d;++E){g=e=0;for(l=3;g<l&&E+g!==d;++g)e=e<<8|c[E+g];if(void 0===p[e]&&(p[e]=[]),g=p[e],!(0<v--)){for(;0<g.length&&32768<E-g[0];)g.shift();if(E+3>=d){q&&b(q,-1);g=0;for(l=
d-E;g<l;++g){var u=c[E+g];r[t++]=u;++w[u]}break}if(0<g.length){e=l=void 0;var A=0,y=void 0,m=void 0;y=void 0;var C=c.length,Z=(m=0,g.length);a:for(;m<Z;m++){if(l=g[Z-m-1],y=3,3<A){for(y=A;3<y;y--)if(c[l+y-1]!==c[E+y-1])continue a;y=A}for(;258>y&&E+y<C&&c[l+y]===c[E+y];)++y;if(y>A&&(e=l,A=y),258===y)break}l=new k(A,E-e);q?q.length<l.length?(u=c[E-1],r[t++]=u,++w[u],b(l,0)):b(q,-1):l.length<x?q=l:b(l,0)}else q?b(q,-1):(u=c[E],r[t++]=u,++w[u])}g.push(E)}return r[t++]=256,w[256]++,a.L=w,a.K=h,B?r.subarray(0,
t):r}function r(c,b){function d(a){var c=v[a][f[a]];c===p?(d(a+1),d(a+1)):--r[c];++f[a]}var g,k;var l=c.length;var e=new a(572),q=new (B?Uint8Array:Array)(l);if(!B)for(k=0;k<l;k++)q[k]=0;for(k=0;k<l;++k)0<c[k]&&e.push(k,c[k]);if(g=Array(e.length/2),c=new (B?Uint32Array:Array)(e.length/2),1===g.length)return q[e.pop().index]=1,q;k=0;for(l=e.length/2;k<l;++k)g[k]=e.pop(),c[k]=g[k].value;var p=c.length;e=new (B?Uint16Array:Array)(b);l=new (B?Uint8Array:Array)(b);var r=new (B?Uint8Array:Array)(p),t=Array(b),
v=Array(b),f=Array(b);var w=(1<<b)-p;var h=1<<b-1;e[b-1]=p;for(k=0;k<b;++k)w<h?l[k]=0:(l[k]=1,w-=h),w<<=1,e[b-2-k]=(e[b-1-k]/2|0)+p;e[0]=l[0];t[0]=Array(e[0]);v[0]=Array(e[0]);for(k=1;k<b;++k)e[k]>2*e[k-1]+l[k]&&(e[k]=2*e[k-1]+l[k]),t[k]=Array(e[k]),v[k]=Array(e[k]);for(w=0;w<p;++w)r[w]=b;for(h=0;h<e[b-1];++h)t[b-1][h]=c[h],v[b-1][h]=h;for(w=0;w<b;++w)f[w]=0;1===l[b-1]&&(--r[0],++f[b-1]);for(k=b-2;0<=k;--k){b=w=0;var x=f[k+1];for(h=0;h<e[k];h++)(b=t[k+1][x]+t[k+1][x+1])>c[w]?(t[k][h]=b,v[k][h]=p,
x+=2):(t[k][h]=c[w],v[k][h]=w,++w);f[k]=0;1===l[k]&&d(k)}b=r;k=0;for(l=g.length;k<l;++k)q[g[k].index]=b[k];return q}function t(a){var c,b,d=new (B?Uint16Array:Array)(a.length);var g=[];var k=[],l=0;var e=0;for(c=a.length;e<c;e++)g[a[e]]=1+(0|g[a[e]]);e=1;for(c=16;e<=c;e++)k[e]=l,(l+=0|g[e])>1<<e&&f("overcommitted"),l<<=1;65536>l&&f("undercommitted");e=0;for(c=a.length;e<c;e++)for(l=k[a[e]],k[a[e]]+=1,g=d[e]=0,b=a[e];g<b;g++)d[e]=d[e]<<1|1&l,l>>>=1;return d}function p(a,c){this.input=a;this.a=new (B?
Uint8Array:Array)(32768);this.h=P.j;var b;a={};for(b in!c&&(c={})||"number"!=typeof c.compressionType||(this.h=c.compressionType),c)a[b]=c[b];a.outputBuffer=this.a;this.z=new g(this.input,a)}function v(a,c){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=B?new Uint8Array(a):a,this.s=!1,this.m=M,this.B=!1,!c&&(c={})||(c.index&&(this.c=c.index),c.bufferSize&&(this.l=c.bufferSize),c.bufferType&&(this.m=c.bufferType),c.resize&&(this.B=c.resize)),this.m){case L:this.b=32768;this.a=
new (B?Uint8Array:Array)(32768+this.l+258);break;case M:this.b=0;this.a=new (B?Uint8Array:Array)(this.l);this.f=this.J;this.t=this.H;this.o=this.I;break;default:f(Error("invalid inflate mode"))}}function w(a,c){for(var b,d=a.g,g=a.e,k=a.input,l=a.c;g<c;)void 0===(b=k[l++])&&f(Error("input buffer is broken")),d|=b<<g,g+=8;return b=d&(1<<c)-1,a.g=d>>>c,a.e=g-c,a.c=l,b}function E(a,c){for(var b,d,g=a.g,k=a.e,l=a.input,e=a.c,q=c[0],p=c[1];k<p;)void 0===(c=l[e++])&&f(Error("input buffer is broken")),g|=
c<<k,k+=8;return d=(b=q[g&(1<<p)-1])>>>16,a.g=g>>d,a.e=k-d,a.c=e,65535&b}function x(a){function b(a,c,b){var d,g;for(g=0;g<a;)switch(d=E(this,c)){case 16:for(d=3+w(this,2);d--;)b[g++]=k;break;case 17:for(d=3+w(this,3);d--;)b[g++]=0;var k=0;break;case 18:for(d=11+w(this,7);d--;)b[g++]=0;k=0;break;default:k=b[g++]=d}return b}var d,g=w(a,5)+257,k=w(a,5)+1;var l=w(a,4)+4;var e=new (B?Uint8Array:Array)(U.length);for(d=0;d<l;++d)e[U[d]]=w(a,3);d=c(e);l=new (B?Uint8Array:Array)(g);e=new (B?Uint8Array:Array)(k);
a.o(c(b.call(a,g,d,l)),c(b.call(a,k,d,e)))}function y(a,c){var b,d;switch(this.input=a,this.c=0,!c&&(c={})||(c.index&&(this.c=c.index),c.verify&&(this.M=c.verify)),b=a[this.c++],d=a[this.c++],15&b){case Q:this.method=Q;break;default:f(Error("unsupported compression method"))}0!=((b<<8)+d)%31&&f(Error("invalid fcheck flag:"+((b<<8)+d)%31));32&d&&f(Error("fdict flag is not supported"));this.A=new v(a,{index:this.c,bufferSize:c.bufferSize,bufferType:c.bufferType,resize:c.resize})}var u=this,B="undefined"!=
typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;b.prototype.f=function(){var a,c=this.buffer,b=c.length,d=new (B?Uint8Array:Array)(b<<1);if(B)d.set(c);else for(a=0;a<b;++a)d[a]=c[a];return this.buffer=d};b.prototype.d=function(a,c,b){var d=this.buffer,g=this.index,k=this.i,l=d[g];if(b&&1<c&&(a=8<c?(F[255&a]<<24|F[a>>>8&255]<<16|F[a>>>16&255]<<8|F[a>>>24&255])>>32-c:F[a]>>8-c),8>c+k)l=l<<c|a,k+=c;else for(b=0;b<c;++b)l=l<<1|a>>c-b-1&1,8==++k&&(k=0,d[g++]=F[l],l=
0,g===d.length&&(d=this.f()));d[g]=l;this.buffer=d;this.i=k;this.index=g};b.prototype.finish=function(){var a,c=this.buffer,b=this.index;return 0<this.i&&(c[b]<<=8-this.i,c[b]=F[c[b]],b++),B?a=c.subarray(0,b):(c.length=b,a=c),a};var m,z=new (B?Uint8Array:Array)(256);for(m=0;256>m;++m){for(var A=n=m,D=7,n=n>>>1;n;n>>>=1)A<<=1,A|=1&n,--D;z[m]=(A<<D&255)>>>0}var F=z;B&&new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,
162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,
2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,
2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,
2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,
2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,
601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);a.prototype.getParent=function(a){return 2*((a-2)/4|0)};a.prototype.push=function(a,c){var b,d=this.buffer;var g=this.length;d[this.length++]=c;for(d[this.length++]=a;0<g&&(b=this.getParent(g),d[g]>d[b]);)a=d[g],d[g]=d[b],d[b]=a,a=d[g+1],d[g+1]=d[b+1],d[b+1]=a,g=b;return this.length};a.prototype.pop=function(){var a,c,b=this.buffer;var d=b[0];var g=b[1];this.length-=2;b[0]=b[this.length];b[1]=b[this.length+
1];for(c=0;!((a=2*c+2)>=this.length)&&(a+2<this.length&&b[a+2]>b[a]&&(a+=2),b[a]>b[c]);){var k=b[c];b[c]=b[a];b[a]=k;k=b[c+1];b[c+1]=b[a+1];b[a+1]=k;c=a}return{index:g,value:d,length:this.length}};var G=2;m={NONE:0,r:1,j:G,N:3};var J=[];for(z=0;288>z;z++)switch(!0){case 143>=z:J.push([z+48,8]);break;case 255>=z:J.push([z-144+400,9]);break;case 279>=z:J.push([z-256,7]);break;case 287>=z:J.push([z-280+192,8]);break;default:f("invalid literal: "+z)}g.prototype.n=function(){var a,c,d,g=this.input;switch(this.h){case 0:var k=
0;for(d=g.length;k<d;){var l,e,p,v=c=B?g.subarray(k,k+65535):g.slice(k,k+65535),w=(k+=c.length)===d;c=this.a;var h=this.b;if(B){for(c=new Uint8Array(this.a.buffer);c.length<=h+v.length+5;)c=new Uint8Array(c.length<<1);c.set(this.a)}if(l=w?1:0,c[h++]=0|l,p=65536+~(e=v.length)&65535,c[h++]=255&e,c[h++]=e>>>8&255,c[h++]=255&p,c[h++]=p>>>8&255,B)c.set(v,h),h+=v.length,c=c.subarray(0,h);else{w=0;for(a=v.length;w<a;++w)c[h++]=v[w];c.length=h}this.b=h;this.a=c}break;case 1:k=new b(new Uint8Array(this.a.buffer),
this.b);k.d(1,1,!0);k.d(1,2,!0);d=q(this,g);l=0;for(g=d.length;l<g;l++)if(c=d[l],b.prototype.d.apply(k,J[c]),256<c)k.d(d[++l],d[++l],!0),k.d(d[++l],5),k.d(d[++l],d[++l],!0);else if(256===c)break;this.a=k.finish();this.b=this.a.length;break;case G:var x,E,u,A;l=new b(new Uint8Array(this.a),this.b);var y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];c=Array(19);e=G;l.d(1,1,!0);l.d(e,2,!0);g=q(this,g);w=t(h=r(this.L,15));p=t(e=r(this.K,7));for(x=286;257<x&&0===h[x-1];x--);for(E=30;1<E&&0===e[E-1];E--);
var m;var C=x;var z=E;var D=new (B?Uint32Array:Array)(C+z),F=new (B?Uint32Array:Array)(316);var n=new (B?Uint8Array:Array)(19);for(A=u=0;A<C;A++)D[u++]=h[A];for(A=0;A<z;A++)D[u++]=e[A];if(!B)for(A=0,z=n.length;A<z;++A)n[A]=0;A=m=0;for(z=D.length;A<z;A+=u){for(u=1;A+u<z&&D[A+u]===D[A];++u);if(C=u,0===D[A])if(3>C)for(;0<C--;)F[m++]=0,n[0]++;else for(;0<C;)(a=138>C?C:138)>C-3&&a<C&&(a=C-3),10>=a?(F[m++]=17,F[m++]=a-3,n[17]++):(F[m++]=18,F[m++]=a-11,n[18]++),C-=a;else if(F[m++]=D[A],n[D[A]]++,3>--C)for(;0<
C--;)F[m++]=D[A],n[D[A]]++;else for(;0<C;)(a=6>C?C:6)>C-3&&a<C&&(a=C-3),F[m++]=16,F[m++]=a-3,n[16]++,C-=a}a=B?F.subarray(0,m):F.slice(0,m);n=r(n,7);for(A=0;19>A;A++)c[A]=n[y[A]];for(u=19;4<u&&0===c[u-1];u--);y=t(n);l.d(x-257,5,!0);l.d(E-1,5,!0);l.d(u-4,4,!0);for(A=0;A<u;A++)l.d(c[A],3,!0);A=0;for(c=a.length;A<c;A++)if(d=a[A],l.d(y[d],n[d],!0),16<=d){switch(A++,d){case 16:v=2;break;case 17:v=3;break;case 18:v=7;break;default:f("invalid code: "+d)}l.d(a[A],v,!0)}v=[w,h];p=[p,e];d=v[0];v=v[1];e=p[0];
w=p[1];p=0;for(c=g.length;p<c;++p)if(k=g[p],l.d(d[k],v[k],!0),256<k)l.d(g[++p],g[++p],!0),h=g[++p],l.d(e[h],w[h],!0),l.d(g[++p],g[++p],!0);else if(256===k)break;this.a=l.finish();this.b=this.a.length;break;default:f("invalid compression type")}return this.a};var N;A=[];for(N=3;258>=N;N++)z=l(),A[N]=z[2]<<24|z[1]<<16|z[0];var K=B?new Uint32Array(A):A,P=m;p.prototype.n=function(){var a,c,b,g,k,l=0;switch(k=this.a,a=Q){case Q:var e=Math.LOG2E*Math.log(32768)-8;break;default:f(Error("invalid compression method"))}switch(c=
e<<4|a,k[l++]=c,a){case Q:switch(this.h){case P.NONE:var p=0;break;case P.r:p=1;break;case P.j:p=2;break;default:f(Error("unsupported compression type"))}break;default:f(Error("invalid compression method"))}return b=p<<6|0,k[l++]=b|31-(256*c+b)%31,g=d(this.input),this.z.b=l,l=(k=this.z.n()).length,B&&((k=new Uint8Array(k.buffer)).length<=l+4&&(this.a=new Uint8Array(k.length+4),this.a.set(k),k=this.a),k=k.subarray(0,l+4)),k[l++]=g>>24&255,k[l++]=g>>16&255,k[l++]=g>>8&255,k[l++]=255&g,k};e("Zlib.Deflate",
p);e("Zlib.Deflate.compress",function(a,c){return(new p(a,c)).n()});e("Zlib.Deflate.CompressionType",P);e("Zlib.Deflate.CompressionType.NONE",P.NONE);e("Zlib.Deflate.CompressionType.FIXED",P.r);e("Zlib.Deflate.CompressionType.DYNAMIC",P.j);var L=0,M=1;m={D:L,C:M};v.prototype.p=function(){for(;!this.s;){var a=w(this,3);switch(1&a&&(this.s=!0),a>>>=1){case 0:a=this.input;var c=this.c,b=this.a,d=this.b,g=void 0,k=void 0,l=void 0,e=b.length;switch(this.e=this.g=0,void 0===(g=a[c++])&&f(Error("invalid uncompressed block header: LEN (first byte)")),
k=g,void 0===(g=a[c++])&&f(Error("invalid uncompressed block header: LEN (second byte)")),k|=g<<8,void 0===(g=a[c++])&&f(Error("invalid uncompressed block header: NLEN (first byte)")),l=g,void 0===(g=a[c++])&&f(Error("invalid uncompressed block header: NLEN (second byte)")),k===~(l|g<<8)&&f(Error("invalid uncompressed block header: length verify")),c+k>a.length&&f(Error("input buffer is broken")),this.m){case L:for(;d+k>b.length;){if(k-=g=e-d,B)b.set(a.subarray(c,c+g),d),d+=g,c+=g;else for(;g--;)b[d++]=
a[c++];this.b=d;b=this.f();d=this.b}break;case M:for(;d+k>b.length;)b=this.f({v:2});break;default:f(Error("invalid inflate mode"))}if(B)b.set(a.subarray(c,c+k),d),d+=k,c+=k;else for(;k--;)b[d++]=a[c++];this.c=c;this.b=d;this.a=b;break;case 1:this.o(W,T);break;case 2:x(this);break;default:f(Error("unknown BTYPE: "+a))}}return this.t()};z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var U=B?new Uint16Array(z):z;z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,
258,258,258];var R=B?new Uint16Array(z):z;z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var O=B?new Uint8Array(z):z;z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var H=B?new Uint16Array(z):z;z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var S=B?new Uint8Array(z):z;D=new (B?Uint8Array:Array)(288);z=0;for(A=D.length;z<A;++z)D[z]=143>=z?8:255>=z?9:279>=z?7:8;var W=c(D);D=new (B?Uint8Array:
Array)(30);z=0;for(A=D.length;z<A;++z)D[z]=5;var T=c(D);v.prototype.o=function(a,c){var b=this.a,d=this.b;this.u=a;for(var g,k,l,e=b.length-258;256!==(g=E(this,a));)if(256>g)d>=e&&(this.b=d,b=this.f(),d=this.b),b[d++]=g;else for(l=R[g-=257],0<O[g]&&(l+=w(this,O[g])),g=E(this,c),k=H[g],0<S[g]&&(k+=w(this,S[g])),d>=e&&(this.b=d,b=this.f(),d=this.b);l--;)b[d]=b[d++-k];for(;8<=this.e;)this.e-=8,this.c--;this.b=d};v.prototype.I=function(a,c){var b=this.a,d=this.b;this.u=a;for(var g,k,l,e=b.length;256!==
(g=E(this,a));)if(256>g)d>=e&&(e=(b=this.f()).length),b[d++]=g;else for(l=R[g-=257],0<O[g]&&(l+=w(this,O[g])),g=E(this,c),k=H[g],0<S[g]&&(k+=w(this,S[g])),d+l>e&&(e=(b=this.f()).length);l--;)b[d]=b[d++-k];for(;8<=this.e;)this.e-=8,this.c--;this.b=d};v.prototype.f=function(){var a,c=new (B?Uint8Array:Array)(this.b-32768),b=this.b-32768,d=this.a;if(B)c.set(d.subarray(32768,c.length));else{var g=0;for(a=c.length;g<a;++g)c[g]=d[g+32768]}if(this.k.push(c),this.q+=c.length,B)d.set(d.subarray(b,b+32768));
else for(g=0;32768>g;++g)d[g]=d[b+g];return this.b=32768,d};v.prototype.J=function(a){var c,b,d,g=this.input.length/this.c+1|0,k=this.input,l=this.a;return a&&("number"==typeof a.v&&(g=a.v),"number"==typeof a.F&&(g+=a.F)),2>g?b=(d=(k.length-this.c)/this.u[2]/2*258|0)<l.length?l.length+d:l.length<<1:b=l.length*g,B?(c=new Uint8Array(b)).set(l):c=l,this.a=c};v.prototype.t=function(){var a,c,b,d=0,g=this.a,k=this.k,l=new (B?Uint8Array:Array)(this.q+(this.b-32768));if(0===k.length)return B?this.a.subarray(32768,
this.b):this.a.slice(32768,this.b);var e=0;for(c=k.length;e<c;++e){var p=0;for(b=(a=k[e]).length;p<b;++p)l[d++]=a[p]}e=32768;for(c=this.b;e<c;++e)l[d++]=g[e];return this.k=[],this.buffer=l};v.prototype.H=function(){var a,c=this.b;return B?this.B?(a=new Uint8Array(c)).set(this.a.subarray(0,c)):a=this.a.subarray(0,c):(this.a.length>c&&(this.a.length=c),a=this.a),this.buffer=a};y.prototype.p=function(){var a,c=this.input;return a=this.A.p(),this.c=this.A.c,this.M&&(c[this.c++]<<24|c[this.c++]<<16|c[this.c++]<<
8|c[this.c++])>>>0!==d(a)&&f(Error("invalid adler-32 checksum")),a};e("Zlib.Inflate",y);e("Zlib.Inflate.BufferType",m);m.ADAPTIVE=m.C;m.BLOCK=m.D;e("Zlib.Inflate.prototype.decompress",y.prototype.p);B&&new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);B&&new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]);B&&new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]);B&&new Uint16Array([1,2,3,4,5,7,9,
13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]);B&&new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]);A=new (B?Uint8Array:Array)(288);m=0;for(z=A.length;m<z;++m)A[m]=143>=m?8:255>=m?9:279>=m?7:8;c(A);A=new (B?Uint8Array:Array)(30);m=0;for(z=A.length;m<z;++m)A[m]=5;c(A);var Q=8}).call(window);f=window.Zlib;f.Deflate=f.Deflate;f.Deflate.compress=f.Deflate.compress;f.Inflate=f.Inflate;f.Inflate.BufferType=f.Inflate.BufferType;
f.Inflate.prototype.decompress=f.Inflate.prototype.decompress;n.exports=f},{}],26:[function(f,n,m){function h(){if(this._localMatDirty){var a=this._matrix,c=a.m;if(b.mat4.fromTRSArray(a,this._trs),this._skewX||this._skewY){a=c[0];var d=c[1],g=c[4],l=c[5],e=Math.tan(this._skewX*k),q=Math.tan(this._skewY*k);e===1/0&&(e=99999999);q===1/0&&(q=99999999);c[0]=a+g*q;c[1]=d+l*q;c[4]=g+a*e;c[5]=l+d*e}this._localMatDirty=0;this._worldMatDirty=!0}}function e(){(this._localMatDirty&&this._updateLocalMatrix(),
this._parent)?b.mat4.mul(this._worldMatrix,this._parent._worldMatrix,this._matrix):b.mat4.copy(this._worldMatrix,this._matrix);this._worldMatDirty=!1}function d(b,d,k){var l=void 0;void 0===d?(l=b.x,d=b.y,k=b.z||0):(l=b,k=k||0);b=this._trs;b[0]===l&&b[1]===d&&b[2]===k||(b[0]=l,b[1]=d,b[2]=k,this.setLocalDirty(c.POSITION),this._renderFlag|=g.FLAG_WORLD_TRANSFORM,this._eventMask&1&&this.emit(a.POSITION_CHANGED))}var b=f("../vmath");n=f("../CCNode");var a=n.EventType,c=n._LocalDirtyFlag,g=f("../renderer/render-flow"),
k=Math.PI/180;f=cc.Node.prototype;var l=f._updateLocalMatrix,q=f._calculWorldMatrix,r=f._upgrade_1x_to_2x,t=f._mulMat;f.setPosition=d;f.setScale=function(b,d,k){b&&"number"!=typeof b?(d=b.y,k=void 0===b.z?1:b.z,b=b.x):void 0!==b&&void 0===d?(d=b,k=b):void 0===k&&(k=1);var l=this._trs;l[7]===b&&l[8]===d&&l[9]===k||(l[7]=b,l[8]=d,l[9]=k,this.setLocalDirty(c.SCALE),this._renderFlag|=g.FLAG_TRANSFORM,this._eventMask&2&&this.emit(a.SCALE_CHANGED))};f._upgrade_1x_to_2x=function(){this._is3DNode&&this._update3DFunction();
r.call(this)};f._update3DFunction=function(){this._is3DNode?(this._updateLocalMatrix=h,this._calculWorldMatrix=e,this._mulMat=b.mat4.mul):(this._updateLocalMatrix=l,this._calculWorldMatrix=q,this._mulMat=t);this._renderComponent&&this._renderComponent._on3DNodeChanged&&this._renderComponent._on3DNodeChanged();this._renderFlag|=g.FLAG_TRANSFORM;this._localMatDirty=c.ALL};cc.js.getset(f,"position",f.getPosition,d,!1,!0);cc.js.getset(f,"is3DNode",function(){return this._is3DNode},function(a){this._is3DNode=
a;this._update3DFunction()});cc.js.getset(f,"scaleZ",function(){return this._trs[9]},function(b){this._trs[9]!==b&&(this._trs[9]=b,this.setLocalDirty(c.SCALE),this._renderFlag|=g.FLAG_TRANSFORM,this._eventMask&2&&this.emit(a.SCALE_CHANGED))});cc.js.getset(f,"z",function(){return this._trs[2]},function(b){var d=this._trs;b!==d[2]&&(d[2]=b,this.setLocalDirty(c.POSITION),this._renderFlag|=g.FLAG_WORLD_TRANSFORM,this._eventMask&1&&this.emit(a.POSITION_CHANGED))});cc.js.getset(f,"eulerAngles",function(){return b.trs.toEuler(this._eulerAngles,
this._trs)},function(a){b.trs.fromEuler(this._trs,a);this.setLocalDirty(c.ROTATION);this._renderFlag|=g.FLAG_TRANSFORM});cc.js.getset(f,"quat",function(){var a=this._trs;return cc.quat(a[3],a[4],a[5],a[6])},f.setRotation)},{"../CCNode":30,"../renderer/render-flow":179,"../vmath":246}],27:[function(f,n,m){function h(a){return function(){var c=arguments[0];c=a+" "+c+", please go to "+d+"#"+c+" to see details.";if(1===arguments.length)return c;if(2===arguments.length)return c+" Arguments: "+arguments[1];
var b=cc.js.shiftArguments.apply(null,arguments);return c+" Arguments: "+b.join(", ")}}var e=f("./platform/utils"),d=(f("../../DebugInfos"),"https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md"),b=void 0;cc.log=cc.warn=cc.error=cc.assert=console.log.bind?console.log.bind(console):console.log;cc._throw=function(a){e.callInNextTick(function(){throw a;})};var a=h("Log");cc.logID=function(){cc.log(a.apply(null,arguments))};var c=h("Warning");cc.warnID=function(){cc.warn(c.apply(null,
arguments))};var g=h("Error");cc.errorID=function(){cc.error(g.apply(null,arguments))};var k=h("Assert");cc.assertID=function(a){a||cc.assert(!1,k.apply(null,cc.js.shiftArguments.apply(null,arguments)))};var l=cc.Enum({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});n.exports=cc.debug={DebugMode:l,_resetDebugSetting:function(a){if(cc.log=cc.warn=cc.error=cc.assert=function(){},a!==l.NONE){if(a>l.ERROR){var c=function(a){if(cc.game.canvas){if(!b){var c=document.createElement("Div");
c.setAttribute("id","logInfoDiv");c.setAttribute("width","200");c.setAttribute("height",cc.game.canvas.height);var d=c.style;d.zIndex="99999";d.position="absolute";d.top=d.left="0";(b=document.createElement("textarea")).setAttribute("rows","20");b.setAttribute("cols","30");b.setAttribute("disabled","true");d=b.style;d.backgroundColor="transparent";d.borderBottom="1px solid #cccccc";d.borderTopWidth=d.borderLeftWidth=d.borderRightWidth="0px";d.borderTopStyle=d.borderLeftStyle=d.borderRightStyle="none";
d.padding="0px";d.margin=0;c.appendChild(b);cc.game.canvas.parentNode.appendChild(c)}b.value=b.value+a+"\r\n";b.scrollTop=b.scrollHeight}};cc.error=function(){c("ERROR :  "+cc.js.formatStr.apply(null,arguments))};cc.assert=function(a,b){!a&&b&&(b=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments)),c("ASSERT: "+b))};a!==l.ERROR_FOR_WEB_PAGE&&(cc.warn=function(){c("WARN :  "+cc.js.formatStr.apply(null,arguments))});a===l.INFO_FOR_WEB_PAGE&&(cc.log=function(){c(cc.js.formatStr.apply(null,
arguments))})}else console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(a,c){if(!a)throw c&&(c=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))),Error(c);});a!==l.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=function(){return console.warn.apply(console,
arguments)});a===l.INFO&&(console.log.bind?cc.log=console.log.bind(console):cc.log=function(){return console.log.apply(console,arguments)})}},getError:h("ERROR"),isDisplayStats:function(){return!!cc.profiler&&cc.profiler.isShowingStats()},setDisplayStats:function(a){cc.profiler&&(a?cc.profiler.showStats():cc.profiler.hideStats(),cc.game.config.showFPS=!!a)}}},{"../../DebugInfos":void 0,"./platform/utils":154}],28:[function(f,n,m){var h=f("./event/event-target"),e=f("./load-pipeline/auto-release-utils"),
d=f("./component-scheduler"),b=f("./node-activator"),a=f("./platform/CCObject"),c=f("./CCGame"),g=f("./renderer"),k=f("./event-manager"),l=f("./CCScheduler");cc.Director=function(){h.call(this);this._purgeDirectorInNextLoop=this._paused=!1;this._winSizeInPoints=null;this._loadingScene="";this._scene=null;this._startTime=this._deltaTime=this._lastUpdate=this._totalFrames=0;this._actionManager=this._nodeActivator=this._compScheduler=this._scheduler=null;var a=this;c.on(c.EVENT_SHOW,function(){a._lastUpdate=
performance.now()});c.once(c.EVENT_ENGINE_INITED,this.init,this)};cc.Director.prototype={constructor:cc.Director,init:function(){return this._totalFrames=0,this._lastUpdate=performance.now(),this._startTime=this._lastUpdate,this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._scheduler=new l,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,l.PRIORITY_SYSTEM,!1)):this._actionManager=null,this.sharedInit(),
!0},sharedInit:function(){this._compScheduler=new d;this._nodeActivator=new b;k&&k.setEnabled(!0);cc.AnimationManager?(this._animationManager=new cc.AnimationManager,this._scheduler.scheduleUpdate(this._animationManager,l.PRIORITY_SYSTEM,!1)):this._animationManager=null;cc.CollisionManager?(this._collisionManager=new cc.CollisionManager,this._scheduler.scheduleUpdate(this._collisionManager,l.PRIORITY_SYSTEM,!1)):this._collisionManager=null;cc.PhysicsManager?(this._physicsManager=new cc.PhysicsManager,
this._scheduler.scheduleUpdate(this._physicsManager,l.PRIORITY_SYSTEM,!1)):this._physicsManager=null;cc._widgetManager&&cc._widgetManager.init(this);cc.loader.init(this)},calculateDeltaTime:function(a){a||(a=performance.now());this._deltaTime=a>this._lastUpdate?(a-this._lastUpdate)/1E3:0;this._lastUpdate=a},convertToGL:function(a){var b=c.container,d=cc.view,g=b.getBoundingClientRect(),k=d._devicePixelRatio*(a.x-(g.left+window.pageXOffset-b.clientLeft));a=d._devicePixelRatio*(g.top+window.pageYOffset-
b.clientTop+g.height-a.y);return d._isRotated?cc.v2(d._viewportRect.width-a,k):cc.v2(k,a)},convertToUI:function(a){var b=c.container,d=cc.view,g=b.getBoundingClientRect(),k=g.left+window.pageXOffset-b.clientLeft;b=g.top+window.pageYOffset-b.clientTop;var l=cc.v2(0,0);return d._isRotated?(l.x=k+a.y/d._devicePixelRatio,l.y=b+g.height-(d._viewportRect.width-a.x)/d._devicePixelRatio):(l.x=k+a.x*d._devicePixelRatio,l.y=b+g.height-a.y*d._devicePixelRatio),l},end:function(){this._purgeDirectorInNextLoop=
!0},getWinSize:function(){return cc.size(cc.winSize)},getWinSizeInPixels:function(){return cc.size(cc.winSize)},pause:function(){this._paused||(this._paused=!0)},purgeCachedData:function(){cc.loader.releaseAll()},purgeDirector:function(){this._scheduler.unscheduleAll();this._compScheduler.unscheduleAll();this._nodeActivator.reset();k&&k.setEnabled(!1);cc.isValid(this._scene)&&this._scene.destroy();this._scene=null;cc.renderer.clear();cc.AssetLibrary.resetBuiltins();cc.game.pause();cc.loader.releaseAll()},
reset:function(){this.purgeDirector();k&&k.setEnabled(!0);this._actionManager&&this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1);this._animationManager&&this._scheduler.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1);this._collisionManager&&this._scheduler.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1);this._physicsManager&&this._scheduler.scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1);cc.game.resume()},
runSceneImmediate:function(b,d,g){cc.assertID(b instanceof cc.Scene,1216);b._load();for(var k=Object.keys(c._persistRootNodes).map(function(a){return c._persistRootNodes[a]}),l=0;l<k.length;l++){var q=k[l],r=b.getChildByUuid(q.uuid);if(r){var t=r.getSiblingIndex();r._destroyImmediate();b.insertChild(q,t)}else q.parent=b}l=this._scene;e.autoRelease(l&&l.autoReleaseAssets&&l.dependAssets,b.dependAssets,k);cc.isValid(l)&&l.destroy();this._scene=null;a._deferredDestroy();d&&d();this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,
b);this._scene=b;b._activate();cc.game.resume();g&&g(null,b);this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,b)},runScene:function(a,c,b){cc.assertID(a,1205);cc.assertID(a instanceof cc.Scene,1216);a._load();this.once(cc.Director.EVENT_AFTER_UPDATE,function(){this.runSceneImmediate(a,c,b)},this)},_getSceneUuid:function(a){var b=c._sceneInfos;if("string"==typeof a){a.endsWith(".fire")||(a+=".fire");"/"===a[0]||a.startsWith("db://")||(a="/"+a);for(var d=0;d<b.length;d++){var g=b[d];if(g.url.endsWith(a))return g}}else if("number"==
typeof a){if(0<=a&&a<b.length)return b[a];cc.errorID(1206,a)}else cc.errorID(1207,a);return null},loadScene:function(a,c,b){if(this._loadingScene)return cc.warnID(1208,a,this._loadingScene),!1;var d=this._getSceneUuid(a);return d?(d=d.uuid,this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,a),this._loadingScene=a,this._loadSceneByUuid(d,c,b),!0):(cc.errorID(1209,a),!1)},preloadScene:function(a,c,b){void 0===b&&(b=c,c=null);var d=this._getSceneUuid(a);d?(this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,
a),cc.loader.load({uuid:d.uuid,type:"uuid"},c,function(c,d){c&&cc.errorID(1210,a,c.message);b&&b(c,d)})):(c='Can not preload the scene "'+a+'" because it is not in the build settings.',b(Error(c)),cc.error("preloadScene: "+c))},_loadSceneByUuid:function(a,c,b,d){console.time("LoadScene "+a);cc.AssetLibrary.loadAsset(a,function(d,g){console.timeEnd("LoadScene "+a);var k=cc.director;if(k._loadingScene="",d)d="Failed to load scene: "+d;else{if(g instanceof cc.SceneAsset)return d=g.scene,d._id=g._uuid,
d._name=g._name,void k.runSceneImmediate(d,b,c);d="The asset "+a+" is not a scene"}cc.error(d);c&&c(d)})},resume:function(){this._paused&&(this._lastUpdate=performance.now(),this._lastUpdate||cc.logID(1200),this._paused=!1,this._deltaTime=0)},setDepthTest:function(a){cc.Camera.main&&(cc.Camera.main.depth=!!a)},setClearColor:function(a){cc.Camera.main&&(cc.Camera.main.backgroundColor=a)},getRunningScene:function(){return this._scene},getScene:function(){return this._scene},getAnimationInterval:function(){return 1E3/
c.getFrameRate()},setAnimationInterval:function(a){c.setFrameRate(Math.round(1E3/a))},getDeltaTime:function(){return this._deltaTime},getTotalTime:function(){return performance.now()-this._startTime},getTotalFrames:function(){return this._totalFrames},isPaused:function(){return this._paused},getScheduler:function(){return this._scheduler},setScheduler:function(a){this._scheduler!==a&&(this._scheduler=a)},getActionManager:function(){return this._actionManager},setActionManager:function(a){this._actionManager!==
a&&(this._actionManager&&this._scheduler.unscheduleUpdate(this._actionManager),this._actionManager=a,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1))},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getPhysicsManager:function(){return this._physicsManager},startAnimation:function(){cc.game.resume()},stopAnimation:function(){cc.game.pause()},_resetDeltaTime:function(){this._lastUpdate=performance.now();
this._deltaTime=0},mainLoop:function(c){if(this._purgeDirectorInNextLoop)this._purgeDirectorInNextLoop=!1,this.purgeDirector();else{this.calculateDeltaTime(c);this._paused||(this.emit(cc.Director.EVENT_BEFORE_UPDATE),this._compScheduler.startPhase(),this._compScheduler.updatePhase(this._deltaTime),this._scheduler.update(this._deltaTime),this._compScheduler.lateUpdatePhase(this._deltaTime),this.emit(cc.Director.EVENT_AFTER_UPDATE),a._deferredDestroy());this.emit(cc.Director.EVENT_BEFORE_DRAW);for(c=
3;0<c&&(cc.Layout.UpdateLayout(),cc._widgetManager.checkRefreshScene(),cc.Layout.HasDirtyLayout());)c--;g.render(this._scene,this._deltaTime);this.emit(cc.Director.EVENT_AFTER_DRAW);k.frameUpdateListeners();this._totalFrames++}},__fastOn:function(a,c,b){this.on(a,c,b)},__fastOff:function(a,c,b){this.off(a,c,b)}};cc.js.addon(cc.Director.prototype,h.prototype);cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed";cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading";cc.Director.EVENT_BEFORE_SCENE_LAUNCH=
"director_before_scene_launch";cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch";cc.Director.EVENT_BEFORE_UPDATE="director_before_update";cc.Director.EVENT_AFTER_UPDATE="director_after_update";cc.Director.EVENT_BEFORE_VISIT="director_before_draw";cc.Director.EVENT_AFTER_VISIT="director_before_draw";cc.Director.EVENT_BEFORE_DRAW="director_before_draw";cc.Director.EVENT_AFTER_DRAW="director_after_draw";cc.Director.PROJECTION_2D=0;cc.Director.PROJECTION_3D=1;cc.Director.PROJECTION_CUSTOM=
3;cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D;cc.director=new cc.Director;n.exports=cc.director},{"./CCGame":29,"./CCScheduler":33,"./component-scheduler":58,"./event-manager":97,"./event/event-target":99,"./load-pipeline/auto-release-utils":112,"./node-activator":128,"./platform/CCObject":136,"./renderer":178}],29:[function(f,n,m){m=f("./event/event-target");f("../audio/CCAudioEngine");var h=f("./CCDebug"),e=f("./renderer/index.js"),d=f("../core/renderer/utils/dynamic-atlas/manager"),
b={EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESTART:"game_on_restart",EVENT_GAME_INITED:"game_inited",EVENT_ENGINE_INITED:"engine_inited",EVENT_RENDERER_INITED:"engine_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_persistRootNodes:{},_paused:!0,_configLoaded:!1,_isCloning:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,_sceneInfos:[],frame:null,container:null,canvas:null,renderType:-1,config:null,
onStart:null,setFrameRate:function(a){this.config.frameRate=a;this._intervalId&&window.cancelAnimFrame(this._intervalId);this._intervalId=0;this._paused=!0;this._setAnimFrame();this._runMainLoop()},getFrameRate:function(){return this.config.frameRate},step:function(){cc.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,cc.audioEngine&&cc.audioEngine._break(),this._intervalId&&window.cancelAnimFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=
!1,cc.audioEngine&&cc.audioEngine._restore(),cc.director._resetDeltaTime(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,function(){for(var a in b._persistRootNodes)b.removePersistRootNode(b._persistRootNodes[a]);cc.director.getScene().destroy();cc.Object._deferredDestroy();cc.audioEngine&&cc.audioEngine.uncacheAll();cc.director.reset();b.pause();cc.AssetLibrary._loadBuiltins(function(){b.onStart();b.emit(b.EVENT_RESTART)})})},
end:function(){close()},_initEngine:function(){this._rendererInitialized||(this._initRenderer(),this._initEvents(),this.emit(this.EVENT_ENGINE_INITED))},_prepareFinished:function(a){var c=this;this._initEngine();this._setAnimFrame();cc.AssetLibrary._loadBuiltins(function(){console.log("Cocos Creator v"+cc.ENGINE_VERSION);c._prepared=!0;c._runMainLoop();c.emit(c.EVENT_GAME_INITED);a&&a()})},eventTargetOn:m.prototype.on,eventTargetOnce:m.prototype.once,on:function(a,c,b){this._prepared&&a===this.EVENT_ENGINE_INITED||
!this._paused&&a===this.EVENT_GAME_INITED?c.call(b):this.eventTargetOn(a,c,b)},once:function(a,c,b){this._prepared&&a===this.EVENT_ENGINE_INITED||!this._paused&&a===this.EVENT_GAME_INITED?c.call(b):this.eventTargetOnce(a,c,b)},prepare:function(a){if(this._prepared)a&&a();else{var c=this.config.jsList;if(c&&0<c.length){var b=this;cc.loader.load(c,function(c){if(c)throw Error(JSON.stringify(c));b._prepareFinished(a)})}else this._prepareFinished(a)}},run:function(a,c){this._initConfig(a);this.onStart=
c;this.prepare(b.onStart&&b.onStart.bind(b))},addPersistRootNode:function(a){if(cc.Node.isNode(a)&&a.uuid){var c=a.uuid;if(!this._persistRootNodes[c]){var b=cc.director._scene;if(cc.isValid(b))if(a.parent){if(!(a.parent instanceof cc.Scene))return void cc.warnID(3801);if(a.parent!==b)return void cc.warnID(3802)}else a.parent=b;this._persistRootNodes[c]=a;a._persistNode=!0}}else cc.warnID(3800)},removePersistRootNode:function(a){var c=a.uuid||"";a===this._persistRootNodes[c]&&(delete this._persistRootNodes[c],
a._persistNode=!1)},isPersistRootNode:function(a){return a._persistNode},_setAnimFrame:function(){this._lastTime=performance.now();var a=b.config.frameRate;this._frameTime=1E3/a;60!==a&&30!==a?(window.requestAnimFrame=this._stTime,window.cancelAnimFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimFrame=window.cancelAnimationFrame||
window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(a){var c=performance.now(),d=Math.max(0,b._frameTime-(c-b._lastTime)),k=window.setTimeout(function(){a()},d);return b._lastTime=c+d,k},_ctTime:function(a){window.clearTimeout(a)},
_runMainLoop:function(){if(this._prepared){var a=this,c=a.config,b=cc.director,d=!0,l=c.frameRate;h.setDisplayStats(c.showFPS);var e=function(c){a._paused||(a._intervalId=window.requestAnimFrame(e),30===l&&(d=!d))||b.mainLoop(c)};a._intervalId=window.requestAnimFrame(e);a._paused=!1}},_initConfig:function(a){"number"!=typeof a.debugMode&&(a.debugMode=0);a.exposeClassName=!!a.exposeClassName;"number"!=typeof a.frameRate&&(a.frameRate=60);var c=a.renderMode;("number"!=typeof c||2<c||0>c)&&(a.renderMode=
0);"boolean"!=typeof a.registerSystemEvent&&(a.registerSystemEvent=!0);a.showFPS=!!a.showFPS;this._sceneInfos=a.scenes||[];this.collisionMatrix=a.collisionMatrix||[];this.groupList=a.groupList||[];h._resetDebugSetting(a.debugMode);this.config=a;this._configLoaded=!0},_determineRenderType:function(){var a=parseInt(this.config.renderMode)||0;this.renderType=this.RENDER_TYPE_CANVAS;var c=!1;if(0===a?cc.sys.capabilities.opengl?(this.renderType=this.RENDER_TYPE_WEBGL,c=!0):cc.sys.capabilities.canvas&&
(this.renderType=this.RENDER_TYPE_CANVAS,c=!0):1===a&&cc.sys.capabilities.canvas?(this.renderType=this.RENDER_TYPE_CANVAS,c=!0):2===a&&cc.sys.capabilities.opengl&&(this.renderType=this.RENDER_TYPE_WEBGL,c=!0),!c)throw Error(h.getError(3820,a));},_initRenderer:function(){if(!this._rendererInitialized){var a=this.config.id,c=void 0,b=void 0,k=void 0,l=void 0;a=a instanceof HTMLElement?a:document.querySelector(a)||document.querySelector("#"+a);if("CANVAS"===a.tagName?(c=a.width,b=a.height,this.canvas=
k=a,this.container=l=document.createElement("DIV"),k.parentNode&&k.parentNode.insertBefore(l,k)):("DIV"!==a.tagName&&cc.warnID(3819),c=a.clientWidth,b=a.clientHeight,this.canvas=k=document.createElement("CANVAS"),this.container=l=document.createElement("DIV"),a.appendChild(l)),l.setAttribute("id","Cocos2dGameContainer"),l.appendChild(k),this.frame=l.parentNode===document.body?document.documentElement:l.parentNode,function(a,c){-1<(" "+a.className+" ").indexOf(" "+c+" ")||(a.className&&(a.className+=
" "),a.className+=c)}(k,"gameCanvas"),k.setAttribute("width",c||480),k.setAttribute("height",b||320),k.setAttribute("tabindex",99),this._determineRenderType(),this.renderType===this.RENDER_TYPE_WEBGL)e.initWebGL(k,{stencil:!0,antialias:cc.macro.ENABLE_WEBGL_ANTIALIAS,alpha:cc.macro.ENABLE_TRANSPARENT_CANVAS}),this._renderContext=e.device._gl,!cc.macro.CLEANUP_IMAGE_CACHE&&d&&(d.enabled=!0);this._renderContext||(this.renderType=this.RENDER_TYPE_CANVAS,e.initCanvas(k),this._renderContext=e.device._ctx);
this.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1};this._rendererInitialized=!0}},_initEvents:function(){function a(){l||(l=!0,b.emit(b.EVENT_HIDE))}function c(a,c,d,g,k){l&&(l=!1,b.emit(b.EVENT_SHOW,a,c,d,g,k))}var d,k=window;this.config.registerSystemEvent&&_cc.inputManager.registerSystemEvent(this.canvas);void 0!==document.hidden?d="hidden":void 0!==document.mozHidden?d="mozHidden":void 0!==document.msHidden?d="msHidden":void 0!==document.webkitHidden&&(d="webkitHidden");
var l=!1;if(d)for(var e=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],r=0;r<e.length;r++)document.addEventListener(e[r],function(b){document[d]||b.hidden?a():c()});else k.addEventListener("blur",a),k.addEventListener("focus",c);-1<navigator.userAgent.indexOf("MicroMessenger")&&(k.onfocus=c);"onpageshow"in window&&"onpagehide"in window&&(k.addEventListener("pagehide",a),k.addEventListener("pageshow",c),document.addEventListener("pagehide",
a),document.addEventListener("pageshow",c));this.on(b.EVENT_HIDE,function(){b.pause()});this.on(b.EVENT_SHOW,function(){b.resume()})}};m.call(b);cc.js.addon(b,m.prototype);cc.game=n.exports=b},{"../audio/CCAudioEngine":21,"../core/renderer/utils/dynamic-atlas/manager":181,"./CCDebug":27,"./event/event-target":99,"./renderer/index.js":178}],30:[function(f,n,m){function h(a){var c=cc.Mask;if(c)for(var b=0;a&&cc.Node.isNode(a);a=a._parent,++b)if(a.getComponent(c))return{index:b,node:a};return null}function e(a,
c){if(!(a._objFlags&v)){var b=0;if(a._bubblingListeners)for(;b<c.length;++b)if(a._bubblingListeners.hasEventListener(c[b]))return!0;if(a._capturingListeners)for(;b<c.length;++b)if(a._capturingListeners.hasEventListener(c[b]))return!0;return!1}return!0}function d(a){var c=a.groupIndex;return 0===c&&a.parent&&(c=d(a.parent)),c}function b(a){var c=d(a);a._cullingMask=1<<c;for(c=0;c<a._children.length;c++)b(a._children[c])}var a=f("./vmath");m=f("./utils/base-node");var c=f("./utils/prefab-helper"),g=
f("./utils/trans-pool").NodeMemPool,k=f("./utils/affine-transform"),l=f("./event-manager"),q=f("./platform/CCMacro"),r=f("./platform/js"),t=(f("./event/event"),f("./event/event-target")),p=f("./renderer/render-flow"),v=cc.Object.Flags.Destroying,w=Math.PI/180,E=!!cc.ActionManager;f=function(){};var x=cc.v3(),y=cc.quat(),u=cc.v3(),B=cc.v3(),C=cc.quat(),z=cc.quat(),A=cc.v3(),D=cc.v3(),I=cc.v3(),F=cc.v3(),G=cc.v3(),J=cc.quat(),N=cc.quat(),K=cc.v3(),P=a.quat.create(),L=cc.v3(),M=cc.v3(),U=cc.quat(),R=
cc.quat(),O=(cc.quat(),a.mat4.create()),H=a.vec3.create(),S=Array(16);S.length=0;var W=cc.Enum({DEBUG:31}),T=cc.Enum({POSITION:1,SCALE:2,ROTATION:4,SKEW:8,TRS:7,RS:6,ALL:65535}),Q=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel",POSITION_CHANGED:"position-changed",ROTATION_CHANGED:"rotation-changed",SCALE_CHANGED:"scale-changed",
SIZE_CHANGED:"size-changed",ANCHOR_CHANGED:"anchor-changed",COLOR_CHANGED:"color-changed",CHILD_ADDED:"child-added",CHILD_REMOVED:"child-removed",CHILD_REORDER:"child-reorder",GROUP_CHANGED:"group-changed",SIBLING_ORDER_CHANGED:"sibling-order-changed"}),Y=[Q.TOUCH_START,Q.TOUCH_MOVE,Q.TOUCH_END,Q.TOUCH_CANCEL],Z=[Q.MOUSE_DOWN,Q.MOUSE_ENTER,Q.MOUSE_MOVE,Q.MOUSE_LEAVE,Q.MOUSE_UP,Q.MOUSE_WHEEL],ba=null,V=function(a,c){var b=a.getLocation(),d=this.owner;return!!d._hitTest(b,this)&&(c.type=Q.TOUCH_START,
c.touch=a,c.bubbles=!0,d.dispatchEvent(c),!0)},X=function(a,c){var b=this.owner;c.type=Q.TOUCH_MOVE;c.touch=a;c.bubbles=!0;b.dispatchEvent(c)},ea=function(a,c){var b=a.getLocation(),d=this.owner;d._hitTest(b,this)?c.type=Q.TOUCH_END:c.type=Q.TOUCH_CANCEL;c.touch=a;c.bubbles=!0;d.dispatchEvent(c)},fa=function(a,c){a.getLocation();var b=this.owner;c.type=Q.TOUCH_CANCEL;c.touch=a;c.bubbles=!0;b.dispatchEvent(c)},ha=function(a){var c=a.getLocation(),b=this.owner;b._hitTest(c,this)&&(a.type=Q.MOUSE_DOWN,
a.bubbles=!0,b.dispatchEvent(a))},aa=function(a){var c=a.getLocation(),b=this.owner;if(b._hitTest(c,this))this._previousIn||(ba&&ba._mouseListener&&(a.type=Q.MOUSE_LEAVE,ba.dispatchEvent(a),ba._mouseListener._previousIn=!1),ba=this.owner,a.type=Q.MOUSE_ENTER,b.dispatchEvent(a),this._previousIn=!0),a.type=Q.MOUSE_MOVE,a.bubbles=!0,b.dispatchEvent(a);else{if(!this._previousIn)return;a.type=Q.MOUSE_LEAVE;b.dispatchEvent(a);this._previousIn=!1;ba=null}a.stopPropagation()},na=function(a){var c=a.getLocation(),
b=this.owner;b._hitTest(c,this)&&(a.type=Q.MOUSE_UP,a.bubbles=!0,b.dispatchEvent(a),a.stopPropagation())},ka=function(a){var c=a.getLocation(),b=this.owner;b._hitTest(c,this)&&(a.type=Q.MOUSE_WHEEL,a.bubbles=!0,b.dispatchEvent(a),a.stopPropagation())};m={name:"cc.Node",extends:m,properties:{_opacity:255,_color:cc.Color.WHITE,_contentSize:cc.Size,_anchorPoint:cc.v2(.5,.5),_position:void 0,_scale:void 0,_trs:null,_eulerAngles:cc.Vec3,_skewX:0,_skewY:0,_zIndex:{default:void 0,type:cc.Integer},_localZOrder:{default:0,
serializable:!1},_is3DNode:!1,_groupIndex:{default:0,formerlySerializedAs:"groupIndex"},groupIndex:{get:function(){return this._groupIndex},set:function(a){this._groupIndex=a;b(this);this.emit(Q.GROUP_CHANGED,this)}},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(a){this.groupIndex=cc.game.groupList.indexOf(a)}},x:{get:function(){return this._trs[0]},set:function(a){var c=this._trs;a!==c[0]&&(c[0]=a,this.setLocalDirty(T.POSITION),1&this._eventMask&&this.emit(Q.POSITION_CHANGED))}},
y:{get:function(){return this._trs[1]},set:function(a){var c=this._trs;a!==c[1]&&(c[1]=a,this.setLocalDirty(T.POSITION),1&this._eventMask&&this.emit(Q.POSITION_CHANGED))}},rotation:{get:function(){return-this.angle},set:function(a){this.angle=-a}},angle:{get:function(){return this._eulerAngles.z},set:function(c){a.vec3.set(this._eulerAngles,0,0,c);a.trs.fromAngleZ(this._trs,c);this.setLocalDirty(T.ROTATION);4&this._eventMask&&this.emit(Q.ROTATION_CHANGED)}},rotationX:{get:function(){return this._eulerAngles.x},
set:function(c){this._eulerAngles.x!==c&&(this._eulerAngles.x=c,this._eulerAngles.x===this._eulerAngles.y?a.trs.fromAngleZ(this._trs,-c):a.trs.fromEulerNumber(this._trs,c,this._eulerAngles.y,0),this.setLocalDirty(T.ROTATION),4&this._eventMask&&this.emit(Q.ROTATION_CHANGED))}},rotationY:{get:function(){return this._eulerAngles.y},set:function(c){this._eulerAngles.y!==c&&(this._eulerAngles.y=c,this._eulerAngles.x===this._eulerAngles.y?a.trs.fromAngleZ(this._trs,-c):a.trs.fromEulerNumber(this._trs,this._eulerAngles.x,
c,0),this.setLocalDirty(T.ROTATION),4&this._eventMask&&this.emit(Q.ROTATION_CHANGED))}},scale:{get:function(){return this._trs[7]},set:function(a){this.setScale(a)}},scaleX:{get:function(){return this._trs[7]},set:function(a){this._trs[7]!==a&&(this._trs[7]=a,this.setLocalDirty(T.SCALE),2&this._eventMask&&this.emit(Q.SCALE_CHANGED))}},scaleY:{get:function(){return this._trs[8]},set:function(a){this._trs[8]!==a&&(this._trs[8]=a,this.setLocalDirty(T.SCALE),2&this._eventMask&&this.emit(Q.SCALE_CHANGED))}},
skewX:{get:function(){return this._skewX},set:function(a){0!==a&&!1;this._skewX=a;this.setLocalDirty(T.SKEW)}},skewY:{get:function(){return this._skewY},set:function(a){0!==a&&!1;this._skewY=a;this.setLocalDirty(T.SKEW)}},opacity:{get:function(){return this._opacity},set:function(a){a=cc.misc.clampf(a,0,255);this._opacity!==a&&(this._opacity=a,this._renderFlag|=p.FLAG_OPACITY_COLOR)},range:[0,255]},color:{get:function(){return this._color.clone()},set:function(a){this._color.equals(a)||(this._color.set(a),
this._renderFlag|=p.FLAG_COLOR,32&this._eventMask&&this.emit(Q.COLOR_CHANGED,a))}},anchorX:{get:function(){return this._anchorPoint.x},set:function(a){var c=this._anchorPoint;c.x!==a&&(c.x=a,16&this._eventMask&&this.emit(Q.ANCHOR_CHANGED))}},anchorY:{get:function(){return this._anchorPoint.y},set:function(a){var c=this._anchorPoint;c.y!==a&&(c.y=a,16&this._eventMask&&this.emit(Q.ANCHOR_CHANGED))}},width:{get:function(){return this._contentSize.width},set:function(a){if(a!==this._contentSize.width){var c=
this._contentSize.width;this._contentSize.width=a;8&this._eventMask&&this.emit(Q.SIZE_CHANGED,c,this._contentSize.height,this._contentSize.width,this._contentSize.height)}}},height:{get:function(){return this._contentSize.height},set:function(a){if(a!==this._contentSize.height){var c=this._contentSize.height;this._contentSize.height=a;8&this._eventMask&&this.emit(Q.SIZE_CHANGED,this._contentSize.width,c,this._contentSize.width,a)}}},zIndex:{get:function(){return this._localZOrder>>16},set:function(a){a>
q.MAX_ZINDEX?(cc.warnID(1636),a=q.MAX_ZINDEX):a<q.MIN_ZINDEX&&(cc.warnID(1637),a=q.MIN_ZINDEX);this.zIndex!==a&&(this._localZOrder=65535&this._localZOrder|a<<16,this.emit(Q.SIBLING_ORDER_CHANGED),this._parent&&this._onSiblingIndexChanged())}}},ctor:function(){this._reorderChildDirty=!1;this._mouseListener=this._touchListener=this._bubblingListeners=this._capturingListeners=this._renderComponent=this._widget=null;this._initDataFromPool();this._eventMask=0;this._childArrivalOrder=this._cullingMask=
1;this._renderFlag=p.FLAG_TRANSFORM|p.FLAG_OPACITY_COLOR},statics:{EventType:Q,_LocalDirtyFlag:T,isNode:function(a){return a instanceof ia&&(a.constructor===ia||!(a instanceof cc.Scene))},BuiltinGroupIndex:W},_onSiblingIndexChanged:function(){for(var a=this._parent,c=a._children,b=0,d=c.length;b<d;b++)c[b]._updateOrderOfArrival();a._delaySort()},_onPreDestroy:function(){this._onPreDestroyBase();E&&cc.director.getActionManager().removeAllActionsFromTarget(this);ba===this&&(ba=null);(this._touchListener||
this._mouseListener)&&(l.removeListeners(this),this._touchListener&&(this._touchListener.owner=null,this._touchListener.mask=null,this._touchListener=null),this._mouseListener&&(this._mouseListener.owner=null,this._mouseListener.mask=null,this._mouseListener=null));this._backDataIntoPool();this._reorderChildDirty&&cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_onPostActivated:function(a){var c=E?cc.director.getActionManager():null;a?(this._renderFlag|=p.FLAG_WORLD_TRANSFORM,
c&&c.resumeTarget(this),l.resumeTarget(this),this._touchListener)?(a=this._touchListener.mask=h(this),this._mouseListener&&(this._mouseListener.mask=a)):this._mouseListener&&(this._mouseListener.mask=h(this)):(c&&c.pauseTarget(this),l.pauseTarget(this))},_onHierarchyChanged:function(a){this._updateOrderOfArrival();b(this);this._parent&&this._parent._delaySort();this._renderFlag|=p.FLAG_WORLD_TRANSFORM;this._onHierarchyChangedBase(a);cc._widgetManager&&(cc._widgetManager._nodesOrderDirty=!0)},_initDataFromPool:function(){this._spaceInfo||
(this._spaceInfo=g.pop());var c=this._spaceInfo;this._matrix=a.mat4.create(c.localMat);a.mat4.identity(this._matrix);this._worldMatrix=a.mat4.create(c.worldMat);a.mat4.identity(this._worldMatrix);this._localMatDirty=T.ALL;this._worldMatDirty=!0;c=this._trs=this._spaceInfo.trs;c[0]=0;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=0;c[6]=1;c[7]=1;c[8]=1;c[9]=1},_backDataIntoPool:function(){g.push(this._spaceInfo);this._spaceInfo=this._trs=this._worldMatrix=this._matrix=null},_toEuler:function(){this.is3DNode?a.trs.toEuler(this._eulerAngles,
this._trs):a.vec3.set(this._eulerAngles,0,0,Math.asin(this._trs[5])/w*2)},_fromEuler:function(){this.is3DNode?a.trs.fromEuler(this._trs,this._eulerAngles):a.trs.fromAngleZ(this._trs,this._eulerAngles.z)},_upgrade_1x_to_2x:function(){var a=this._trs;if(a){var c=a;a=this._trs=this._spaceInfo.trs;11===c.length?a.set(c.subarray(1)):a.set(c)}else this._trs=this._spaceInfo.trs;void 0!==this._zIndex&&(this._localZOrder=this._zIndex<<16,this._zIndex=void 0);this._fromEuler();0!==this._localZOrder&&(this._zIndex=
(4294901760&this._localZOrder)>>16);255>this._color.a&&255===this._opacity&&(this._opacity=this._color.a,this._color.a=255)},_onBatchCreated:function(){var a=this._prefab;a&&a.sync&&a.root===this&&c.syncWithPrefab(this);this._upgrade_1x_to_2x();this._updateOrderOfArrival();this._cullingMask=1<<d(this);this._activeInHierarchy||(E&&cc.director.getActionManager().pauseTarget(this),l.pauseTarget(this));a=this._children;for(var b=0,g=a.length;b<g;b++)a[b]._onBatchCreated();0<a.length&&(this._renderFlag|=
p.FLAG_CHILDREN)},_onBatchRestored:function(){if(this._upgrade_1x_to_2x(),this._cullingMask=1<<d(this),!this._activeInHierarchy){var a=cc.director.getActionManager();a&&a.pauseTarget(this);l.pauseTarget(this)}a=this._children;for(var c=0,b=a.length;c<b;c++)a[c]._onBatchRestored();0<a.length&&(this._renderFlag|=p.FLAG_CHILDREN)},_checknSetupSysEvent:function(a){var c=!1,b=!1;return-1!==Y.indexOf(a)?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:!0,owner:this,mask:h(this),onTouchBegan:V,onTouchMoved:X,onTouchEnded:ea,onTouchCancelled:fa}),l.addListener(this._touchListener,this),c=!0),b=!0):-1!==Z.indexOf(a)&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:h(this),onMouseDown:ha,onMouseMove:aa,onMouseUp:na,onMouseScroll:ka}),l.addListener(this._mouseListener,this),c=!0),b=!0),c&&!this._activeInHierarchy&&cc.director.getScheduler().schedule(function(){this._activeInHierarchy||
l.pauseTarget(this)},this,0,0,0,!1),b},on:function(a,c,b,d){if(this._checknSetupSysEvent(a))return this._onDispatch(a,c,b,d);switch(a){case Q.POSITION_CHANGED:this._eventMask|=1;break;case Q.SCALE_CHANGED:this._eventMask|=2;break;case Q.ROTATION_CHANGED:this._eventMask|=4;break;case Q.SIZE_CHANGED:this._eventMask|=8;break;case Q.ANCHOR_CHANGED:this._eventMask|=16;break;case Q.COLOR_CHANGED:this._eventMask|=32}return this._bubblingListeners||(this._bubblingListeners=new t),this._bubblingListeners.on(a,
c,b)},once:function(a,c,b,d){(this._checknSetupSysEvent(a)&&d?this._capturingListeners=this._capturingListeners||new t:this._bubblingListeners=this._bubblingListeners||new t).once(a,c,b)},_onDispatch:function(a,c,b,d){if("boolean"==typeof b?(d=b,b=void 0):d=!!d,c){var g=null;return(g=d?this._capturingListeners=this._capturingListeners||new t:this._bubblingListeners=this._bubblingListeners||new t).hasEventListener(a,c,b)||(g.on(a,c,b),b&&b.__eventTargets&&b.__eventTargets.push(this)),c}cc.errorID(6800)},
off:function(a,c,b,d){var g=-1!==Y.indexOf(a),k=!g&&-1!==Z.indexOf(a);if(g||k)this._offDispatch(a,c,b,d),g?this._touchListener&&!e(this,Y)&&(l.removeListener(this._touchListener),this._touchListener=null):k&&this._mouseListener&&!e(this,Z)&&(l.removeListener(this._mouseListener),this._mouseListener=null);else if(this._bubblingListeners&&(this._bubblingListeners.off(a,c,b),!this._bubblingListeners.hasEventListener(a)))switch(a){case Q.POSITION_CHANGED:this._eventMask&=-2;break;case Q.SCALE_CHANGED:this._eventMask&=
-3;break;case Q.ROTATION_CHANGED:this._eventMask&=-5;break;case Q.SIZE_CHANGED:this._eventMask&=-9;break;case Q.ANCHOR_CHANGED:this._eventMask&=-17;break;case Q.COLOR_CHANGED:this._eventMask&=-33}},_offDispatch:function(a,c,b,d){("boolean"==typeof b?(d=b,b=void 0):d=!!d,c)?(d=d?this._capturingListeners:this._bubblingListeners)&&(d.off(a,c,b),b&&b.__eventTargets&&r.array.fastRemove(b.__eventTargets,this)):(this._capturingListeners&&this._capturingListeners.removeAll(a),this._bubblingListeners&&this._bubblingListeners.removeAll(a))},
targetOff:function(a){var c=this._bubblingListeners;c&&(c.targetOff(a),1&this._eventMask&&!c.hasEventListener(Q.POSITION_CHANGED)&&(this._eventMask&=-2),2&this._eventMask&&!c.hasEventListener(Q.SCALE_CHANGED)&&(this._eventMask&=-3),4&this._eventMask&&!c.hasEventListener(Q.ROTATION_CHANGED)&&(this._eventMask&=-5),8&this._eventMask&&!c.hasEventListener(Q.SIZE_CHANGED)&&(this._eventMask&=-9),16&this._eventMask&&!c.hasEventListener(Q.ANCHOR_CHANGED)&&(this._eventMask&=-17),32&this._eventMask&&!c.hasEventListener(Q.COLOR_CHANGED)&&
(this._eventMask&=-33));this._capturingListeners&&this._capturingListeners.targetOff(a);a&&a.__eventTargets&&r.array.fastRemove(a.__eventTargets,this);this._touchListener&&!e(this,Y)&&(l.removeListener(this._touchListener),this._touchListener=null);this._mouseListener&&!e(this,Z)&&(l.removeListener(this._mouseListener),this._mouseListener=null)},hasEventListener:function(a){var c=!1;return this._bubblingListeners&&(c=this._bubblingListeners.hasEventListener(a)),!c&&this._capturingListeners&&(c=this._capturingListeners.hasEventListener(a)),
c},emit:function(a,c,b,d,g,k){this._bubblingListeners&&this._bubblingListeners.emit(a,c,b,d,g,k)},dispatchEvent:function(a){a:{var c,b;a.target=this;S.length=0;this._getCapturingTargets(a.type,S);a.eventPhase=1;for(b=S.length-1;0<=b;--b)if((c=S[b])._capturingListeners&&(a.currentTarget=c,c._capturingListeners.emit(a.type,a,S),a._propagationStopped)){S.length=0;break a}if(S.length=0,a.eventPhase=2,a.currentTarget=this,this._capturingListeners&&this._capturingListeners.emit(a.type,a),!a._propagationImmediateStopped&&
this._bubblingListeners&&this._bubblingListeners.emit(a.type,a),!a._propagationStopped&&a.bubbles)for(this._getBubblingTargets(a.type,S),a.eventPhase=3,b=0;b<S.length;++b)if((c=S[b])._bubblingListeners&&(a.currentTarget=c,c._bubblingListeners.emit(a.type,a),a._propagationStopped)){S.length=0;break a}S.length=0}S.length=0},pauseSystemEvents:function(a){l.pauseTarget(this,a)},resumeSystemEvents:function(a){l.resumeTarget(this,a)},_hitTest:function(c,b){var d=this._contentSize.width,g=this._contentSize.height,
k=cc.Camera.findCamera(this);if(k?k.getScreenToWorldPoint(c,L):L.set(c),this._updateWorldMatrix(),!a.mat4.invert(O,this._worldMatrix))return!1;if(a.vec2.transformMat4(M,L,O),M.x+=this._anchorPoint.x*d,M.y+=this._anchorPoint.y*g,0<=M.x&&0<=M.y&&M.x<=d&&M.y<=g){if(b&&b.mask){c=b.mask;d=this;for(g=0;d&&g<c.index;++g,d=d.parent);return d===c.node?(b=d.getComponent(cc.Mask),!b||!b.enabledInHierarchy||b._hitTest(L)):(b.mask=null,!0)}return!0}return!1},_getCapturingTargets:function(a,c){for(var b=this.parent;b;)b._capturingListeners&&
b._capturingListeners.hasEventListener(a)&&c.push(b),b=b.parent},_getBubblingTargets:function(a,c){for(var b=this.parent;b;)b._bubblingListeners&&b._bubblingListeners.hasEventListener(a)&&c.push(b),b=b.parent},runAction:E?function(a){if(this.active)return cc.assertID(a,1618),cc.director.getActionManager().addAction(a,this,!1),a}:f,pauseAllActions:E?function(){cc.director.getActionManager().pauseTarget(this)}:f,resumeAllActions:E?function(){cc.director.getActionManager().resumeTarget(this)}:f,stopAllActions:E?
function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:f,stopAction:E?function(a){cc.director.getActionManager().removeAction(a)}:f,stopActionByTag:E?function(a){a!==cc.Action.TAG_INVALID?cc.director.getActionManager().removeActionByTag(a,this):cc.logID(1612)}:f,getActionByTag:E?function(a){return a===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(a,this)}:function(){return null},getNumberOfRunningActions:E?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:
function(){return 0},getPosition:function(c){return c=c||cc.v3(),a.trs.toPosition(c,this._trs)},setPosition:function(a,c){var b;void 0===c?(b=a.x,c=a.y):b=a;a=this._trs;a[0]===b&&a[1]===c||(a[0]=b,a[1]=c,this.setLocalDirty(T.POSITION),1&this._eventMask&&this.emit(Q.POSITION_CHANGED))},getScale:function(c){return void 0!==c?a.trs.toScale(c,this._trs):(cc.warnID(1400,"cc.Node.getScale","cc.Node.scale or cc.Node.getScale(cc.Vec3)"),this._trs[7])},setScale:function(a,c){a&&"number"!=typeof a?(c=a.y,a=
a.x):void 0===c&&(c=a);var b=this._trs;b[7]===a&&b[8]===c||(b[7]=a,b[8]=c,this.setLocalDirty(T.SCALE),2&this._eventMask&&this.emit(Q.SCALE_CHANGED))},getRotation:function(c){return c instanceof cc.Quat?a.trs.toRotation(c,this._trs):-this.angle},setRotation:function(a,c,b,d){if("number"==typeof a&&void 0===c)this.angle=-a;else{var g=a;void 0===c&&(g=a.x,c=a.y,b=a.z,d=a.w);a=this._trs;a[3]===g&&a[4]===c&&a[5]===b&&a[6]===d||(a[3]=g,a[4]=c,a[5]=b,a[6]=d,this.setLocalDirty(T.ROTATION),4&this._eventMask&&
this.emit(Q.ROTATION_CHANGED))}},getContentSize:function(){return cc.size(this._contentSize.width,this._contentSize.height)},setContentSize:function(a,c){var b=this._contentSize;if(void 0===c){if(a.width===b.width&&a.height===b.height)return;0;b.width=a.width;b.height=a.height}else{if(a===b.width&&c===b.height)return;0;b.width=a;b.height=c}8&this._eventMask&&this.emit(Q.SIZE_CHANGED)},getAnchorPoint:function(){return cc.v2(this._anchorPoint)},setAnchorPoint:function(a,c){var b=this._anchorPoint;if(void 0===
c){if(a.x===b.x&&a.y===b.y)return;b.x=a.x;b.y=a.y}else{if(a===b.x&&c===b.y)return;b.x=a;b.y=c}this.setLocalDirty(T.POSITION);16&this._eventMask&&this.emit(Q.ANCHOR_CHANGED)},_invTransformPoint:function(c,b){this._parent?this._parent._invTransformPoint(c,b):a.vec3.copy(c,b);b=this._trs;return a.trs.toPosition(u,b),a.vec3.sub(c,c,u),a.trs.toRotation(C,b),a.quat.conjugate(z,C),a.vec3.transformQuat(c,c,z),a.trs.toScale(u,b),a.vec3.inverseSafe(B,u),a.vec3.mul(c,c,B),c},getWorldPosition:function(c){a.trs.toPosition(c,
this._trs);for(var b=this._parent,d;b;)d=b._trs,a.trs.toScale(x,d),a.vec3.mul(c,c,x),a.trs.toRotation(y,d),a.vec3.transformQuat(c,c,y),a.trs.toPosition(x,d),a.vec3.add(c,c,x),b=b._parent;return c},setWorldPosition:function(c){var b=this._trs;this._parent?this._parent._invTransformPoint(A,c):a.vec3.copy(A,c);a.trs.fromPosition(b,A);this.setLocalDirty(T.POSITION);1&this._eventMask&&this.emit(Q.POSITION_CHANGED)},getWorldRotation:function(c){a.trs.toRotation(U,this._trs);a.quat.copy(c,U);for(var b=this._parent;b;)a.trs.toRotation(U,
b._trs),a.quat.mul(c,U,c),b=b._parent;return c},setWorldRotation:function(c){this._parent?(this._parent.getWorldRotation(R),a.quat.conjugate(R,R),a.quat.mul(R,R,c)):a.quat.copy(R,c);a.trs.fromRotation(this._trs,R);this.setLocalDirty(T.ROTATION)},getWorldScale:function(c){a.trs.toScale(D,this._trs);a.vec3.copy(c,D);for(var b=this._parent;b;)a.trs.toScale(D,b._trs),a.vec3.mul(c,c,D),b=b._parent;return c},setWorldScale:function(c){this._parent?(this._parent.getWorldScale(I),a.vec3.div(I,c,I)):a.vec3.copy(I,
c);a.trs.fromScale(this._trs,I);this.setLocalDirty(T.SCALE)},getWorldRT:function(c){var b=this._trs;a.trs.toPosition(F,b);a.trs.toRotation(J,b);for(var d=this._parent;d;)b=d._trs,a.trs.toScale(G,b),a.vec3.mul(F,F,G),a.trs.toRotation(N,b),a.vec3.transformQuat(F,F,N),a.trs.toPosition(G,b),a.vec3.add(F,F,G),a.quat.mul(J,N,J),d=d._parent;return a.mat4.fromRT(c,J,F),c},lookAt:function(c,b){this.getWorldPosition(K);a.vec3.sub(K,K,c);a.vec3.normalize(K,K);a.quat.fromViewUp(P,K,b);this.setWorldRotation(P)},
_updateLocalMatrix:function(){var a=this._localMatDirty;if(a){var c=this._matrix.m,b=this._trs;if(a&(T.RS|T.SKEW)){var d=-this._eulerAngles.z;a=this._skewX||this._skewY;var g=b[7],k=b[8];if(d||a){var l=1,e=0,p=0,q=1;d&&(d*=w,p=Math.sin(d),l=q=Math.cos(d),e=-p);if(c[0]=l*g,c[1]=e*g,c[4]=p*k,c[5]=q*k,a)a=c[0],g=c[1],k=c[4],p=c[5],d=Math.tan(this._skewX*w),l=Math.tan(this._skewY*w),d===1/0&&(d=99999999),l===1/0&&(l=99999999),c[0]=a+k*l,c[1]=g+p*l,c[4]=k+a*d,c[5]=p+g*d}else c[0]=g,c[1]=0,c[4]=0,c[5]=
k}c[12]=b[0];c[13]=b[1];this._localMatDirty=0;this._worldMatDirty=!0}},_calculWorldMatrix:function(){this._localMatDirty&&this._updateLocalMatrix();var c=this._parent;c?this._mulMat(this._worldMatrix,c._worldMatrix,this._matrix):a.mat4.copy(this._worldMatrix,this._matrix);this._worldMatDirty=!1},_mulMat:function(a,c,b){var d=c.m;b=b.m;a=a.m;c=d[0];var g=d[1],k=d[4],l=d[5],e=d[12];d=d[13];var p=b[0],q=b[1],r=b[4],t=b[5],v=b[12];b=b[13];0!==g||0!==k?(a[0]=p*c+q*k,a[1]=p*g+q*l,a[4]=r*c+t*k,a[5]=r*g+
t*l,a[12]=c*v+k*b+e,a[13]=g*v+l*b+d):(a[0]=p*c,a[1]=q*l,a[4]=r*c,a[5]=t*l,a[12]=c*v+e,a[13]=l*b+d)},_updateWorldMatrix:function(){if(this._parent&&this._parent._updateWorldMatrix(),this._worldMatDirty){this._calculWorldMatrix();for(var a=this._children,c=0,b=a.length;c<b;c++)a[c]._worldMatDirty=!0}},setLocalDirty:function(a){this._localMatDirty|=a;this._worldMatDirty=!0;a===T.POSITION?this._renderFlag|=p.FLAG_WORLD_TRANSFORM:this._renderFlag|=p.FLAG_TRANSFORM},setWorldDirty:function(){this._worldMatDirty=
!0},getLocalMatrix:function(c){return this._updateLocalMatrix(),a.mat4.copy(c,this._matrix)},getWorldMatrix:function(c){return this._updateWorldMatrix(),a.mat4.copy(c,this._worldMatrix)},convertToNodeSpaceAR:function(c,b){return this._updateWorldMatrix(),a.mat4.invert(O,this._worldMatrix),c instanceof cc.Vec2?(b=b||new cc.Vec2,a.vec2.transformMat4(b,c,O)):(b=b||new cc.Vec3,a.vec3.transformMat4(b,c,O))},convertToWorldSpaceAR:function(c,b){return this._updateWorldMatrix(),c instanceof cc.Vec2?(b=b||
new cc.Vec2,a.vec2.transformMat4(b,c,this._worldMatrix)):(b=b||new cc.Vec3,a.vec3.transformMat4(b,c,this._worldMatrix))},convertToNodeSpace:function(c){this._updateWorldMatrix();a.mat4.invert(O,this._worldMatrix);var b=new cc.Vec2;return a.vec2.transformMat4(b,c,O),b.x+=this._anchorPoint.x*this._contentSize.width,b.y+=this._anchorPoint.y*this._contentSize.height,b},convertToWorldSpace:function(c){this._updateWorldMatrix();c=new cc.Vec2(c.x-this._anchorPoint.x*this._contentSize.width,c.y-this._anchorPoint.y*
this._contentSize.height);return a.vec2.transformMat4(c,c,this._worldMatrix)},getNodeToParentTransform:function(c){c||(c=k.identity());this._updateLocalMatrix();var b=this._contentSize;return H.x=-this._anchorPoint.x*b.width,H.y=-this._anchorPoint.y*b.height,a.mat4.copy(O,this._matrix),a.mat4.translate(O,O,H),k.fromMat4(c,O)},getNodeToParentTransformAR:function(a){return a||(a=k.identity()),this._updateLocalMatrix(),k.fromMat4(a,this._matrix)},getNodeToWorldTransform:function(c){c||(c=k.identity());
this._updateWorldMatrix();var b=this._contentSize;return H.x=-this._anchorPoint.x*b.width,H.y=-this._anchorPoint.y*b.height,a.mat4.copy(O,this._worldMatrix),a.mat4.translate(O,O,H),k.fromMat4(c,O)},getNodeToWorldTransformAR:function(a){return a||(a=k.identity()),this._updateWorldMatrix(),k.fromMat4(a,this._worldMatrix)},getParentToNodeTransform:function(c){return c||(c=k.identity()),this._updateLocalMatrix(),a.mat4.invert(O,this._matrix),k.fromMat4(c,O)},getWorldToNodeTransform:function(c){return c||
(c=k.identity()),this._updateWorldMatrix(),a.mat4.invert(O,this._worldMatrix),k.fromMat4(c,O)},convertTouchToNodeSpace:function(a){return this.convertToNodeSpace(a.getLocation())},convertTouchToNodeSpaceAR:function(a){return this.convertToNodeSpaceAR(a.getLocation())},getBoundingBox:function(){this._updateLocalMatrix();var a=this._contentSize.width,c=this._contentSize.height;a=cc.rect(-this._anchorPoint.x*a,-this._anchorPoint.y*c,a,c);return a.transformMat4(a,this._matrix)},getBoundingBoxToWorld:function(){return this._parent?
(this._parent._updateWorldMatrix(),this._getBoundingBoxTo(this._parent._worldMatrix)):this.getBoundingBox()},_getBoundingBoxTo:function(c){this._updateLocalMatrix();var b=this._contentSize.width,d=this._contentSize.height;b=cc.rect(-this._anchorPoint.x*b,-this._anchorPoint.y*d,b,d);c=a.mat4.mul(this._worldMatrix,c,this._matrix);if(b.transformMat4(b,c),!this._children)return b;d=this._children;for(var g=0;g<d.length;g++){var k=d[g];k&&k.active&&(k=k._getBoundingBoxTo(c))&&b.union(b,k)}return b},_updateOrderOfArrival:function(){var a=
this._parent?++this._parent._childArrivalOrder:0;if(this._localZOrder=4294901760&this._localZOrder|a,65535===a)a=this._parent._children,a.forEach(function(a,c){a._localZOrder=4294901760&a._localZOrder|c+1}),this._parent._childArrivalOrder=a.length;this.emit(Q.SIBLING_ORDER_CHANGED)},addChild:function(a,c,b){cc.assertID(a,1606);cc.assertID(null===a._parent,1605);a.parent=this;void 0!==c&&(a.zIndex=c);void 0!==b&&(a.name=b)},cleanup:function(){E&&cc.director.getActionManager().removeAllActionsFromTarget(this);
l.removeListeners(this);var a,c,b=this._children.length;for(a=0;a<b;++a)(c=this._children[a])&&c.cleanup()},sortAllChildren:function(){if(this._reorderChildDirty){l._setDirtyForNode(this);this._reorderChildDirty=!1;var a=this._children;if(1<a.length){var c,b,d=a.length;for(c=1;c<d;c++){var g=a[c];for(b=c-1;0<=b&&g._localZOrder<a[b]._localZOrder;)a[b+1]=a[b],b--;a[b+1]=g}this.emit(Q.CHILD_REORDER,this)}cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)}},_delaySort:function(){this._reorderChildDirty||
(this._reorderChildDirty=!0,cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this))},_restoreProperties:!1,onRestore:!1};var ia=cc.Class(m);m=ia.prototype;r.getset(m,"position",m.getPosition,m.setPosition,!1,!0);cc.Node=n.exports=ia},{"./event-manager":97,"./event/event":100,"./event/event-target":99,"./platform/CCMacro":135,"./platform/js":150,"./renderer/render-flow":179,"./utils/affine-transform":211,"./utils/base-node":212,"./utils/prefab-helper":223,"./utils/trans-pool":229,
"./vmath":246}],31:[function(f,n,m){var h=f("./CCNode"),e=f("./renderer/render-flow"),d=(cc.Object.Flags.HideInHierarchy,h._LocalDirtyFlag);f=cc.Class({name:"cc.PrivateNode",extends:h,properties:{x:{get:function(){return this._originPos.x},set:function(b){var a=this._originPos;b!==a.x&&(a.x=b,this._posDirty(!0))},override:!0},y:{get:function(){return this._originPos.y},set:function(b){var a=this._originPos;b!==a.y&&(a.y=b,this._posDirty(!0))},override:!0},zIndex:{get:function(){return cc.macro.MIN_ZINDEX},
set:function(){cc.warnID(1638)},override:!0},showInEditor:{default:!1,editorOnly:!0,override:!0}},ctor:function(b){this._localZOrder=cc.macro.MIN_ZINDEX<<16;this._originPos=cc.v2()},_posDirty:function(b){this.setLocalDirty(d.POSITION);this._renderFlag|=e.FLAG_TRANSFORM;!0===b&&1&this._eventMask&&this.emit(h.EventType.POSITION_CHANGED)},_updateLocalMatrix:function(){if(this._localMatDirty){var b=this.parent;b&&(this._trs[0]=this._originPos.x-(b._anchorPoint.x-.5)*b._contentSize.width,this._trs[1]=
this._originPos.y-(b._anchorPoint.y-.5)*b._contentSize.height);this._super()}},getPosition:function(){return new cc.Vec2(this._originPos)},setPosition:function(b,a){void 0===a&&(a=(b=b.x).y);var c=this._originPos;c.x===b&&c.y===a||(c.x=b,c.y=a,this._posDirty(!0))},setParent:function(b){var a=this._parent;this._super(b);a!==b&&(a&&a.off(h.EventType.ANCHOR_CHANGED,this._posDirty,this),b&&b.on(h.EventType.ANCHOR_CHANGED,this._posDirty,this))},_updateOrderOfArrival:function(){}});cc.js.getset(f.prototype,
"parent",f.prototype.getParent,f.prototype.setParent);cc.js.getset(f.prototype,"position",f.prototype.getPosition,f.prototype.setPosition);cc.PrivateNode=n.exports=f},{"./CCNode":30,"./renderer/render-flow":179}],32:[function(f,n,m){cc.Scene=cc.Class({name:"cc.Scene",extends:f("./CCNode"),properties:{_is3DNode:{default:!0,override:!0},autoReleaseAssets:{default:void 0,type:cc.Boolean}},ctor:function(){this._anchorPoint.x=0;this._anchorPoint.y=0;this._activeInHierarchy=!1;this._inited=!cc.game._isCloning;
this.dependAssets=null},destroy:function(){if(cc.Object.prototype.destroy.call(this))for(var f=this._children,e=0;e<f.length;++e)f[e].active=!1;this._activeInHierarchy=this._active=!1},_onHierarchyChanged:function(){},_instantiate:null,_load:function(){this._inited||(this._onBatchCreated(),this._inited=!0)},_activate:function(f){cc.director._nodeActivator.activateNode(this,!1!==f)}});n.exports=cc.Scene},{"./CCNode":30}],33:[function(f,n,m){function h(){this._lock=!1;this._scheduler=null;this._elapsed=
-1;this._useDelay=this._runForever=!1;this._interval=this._delay=this._repeat=this._timesExecuted=0;this._callback=this._target=null}var e=f("./platform/js"),d=new (f("./platform/id-generater"))("Scheduler"),b=function(a,c,b,d){this.target=a;this.priority=c;this.paused=b;this.markedForDeletion=d},a=[];b.get=function(c,d,g,k){var l=a.pop();return l?(l.target=c,l.priority=d,l.paused=g,l.markedForDeletion=k):l=new b(c,d,g,k),l};b.put=function(c){20>a.length&&(c.target=null,a.push(c))};var c=function(a,
c,b,d){this.list=a;this.entry=c;this.target=b;this.callback=d},g=[];c.get=function(a,b,d,k){var l=g.pop();return l?(l.list=a,l.entry=b,l.target=d,l.callback=k):l=new c(a,b,d,k),l};c.put=function(a){20>g.length&&(a.list=a.entry=a.target=a.callback=null,g.push(a))};var k=function(a,c,b,d,g,k){this.timers=a;this.target=c;this.timerIndex=b;this.currentTimer=d;this.currentTimerSalvaged=g;this.paused=k},l=[];k.get=function(a,c,b,d,g,e){var p=l.pop();return p?(p.timers=a,p.target=c,p.timerIndex=b,p.currentTimer=
d,p.currentTimerSalvaged=g,p.paused=e):p=new k(a,c,b,d,g,e),p};k.put=function(a){20>l.length&&(a.timers=a.target=a.currentTimer=null,l.push(a))};f=h.prototype;f.initWithCallback=function(a,c,b,d,g,k){return this._lock=!1,this._scheduler=a,this._target=b,this._callback=c,this._elapsed=-1,this._interval=d,this._delay=k,this._useDelay=0<this._delay,this._repeat=g,this._runForever=this._repeat===cc.macro.REPEAT_FOREVER,!0};f.getInterval=function(){return this._interval};f.setInterval=function(a){this._interval=
a};f.update=function(a){-1===this._elapsed?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=a,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))};
f.getCallback=function(){return this._callback};f.trigger=function(){this._target&&this._callback&&(this._lock=!0,this._callback.call(this._target,this._elapsed),this._lock=!1)};f.cancel=function(){this._scheduler.unschedule(this._callback,this._target)};var q=[];h.get=function(){return q.pop()||new h};h.put=function(a){20>q.length&&!a._lock&&(a._scheduler=a._target=a._callback=null,q.push(a))};cc.Scheduler=function(){this._timeScale=1;this._updatesNegList=[];this._updates0List=[];this._updatesPosList=
[];this._hashForUpdates=e.createMap(!0);this._hashForTimers=e.createMap(!0);this._currentTarget=null;this._updateHashLocked=this._currentTargetSalvaged=!1;this._arrayForTimers=[]};cc.Scheduler.prototype={constructor:cc.Scheduler,_removeHashElement:function(a){delete this._hashForTimers[a.target._id];for(var c=this._arrayForTimers,b=0,d=c.length;b<d;b++)if(c[b]===a){c.splice(b,1);break}k.put(a)},_removeUpdateFromHash:function(a){a=a.target._id;var d=this._hashForUpdates[a];if(d){for(var g=d.list,k=
d.entry,l=0,e=g.length;l<e;l++)if(g[l]===k){g.splice(l,1);break}delete this._hashForUpdates[a];b.put(k);c.put(d)}},_priorityIn:function(a,c,b){for(var d=0;d<a.length;d++)if(b<a[d].priority)return void a.splice(d,0,c);a.push(c)},_appendIn:function(a,c){a.push(c)},enableForTarget:function(a){a._id||(a.__instanceId?cc.warnID(1513):a._id=d.getNewId())},setTimeScale:function(a){this._timeScale=a},getTimeScale:function(){return this._timeScale},update:function(a){var c,b,d;this._updateHashLocked=!0;1!==
this._timeScale&&(a*=this._timeScale);var g=0;for(b=(c=this._updatesNegList).length;g<b;g++)(d=c[g]).paused||d.markedForDeletion||d.target.update(a);g=0;for(b=(c=this._updates0List).length;g<b;g++)(d=c[g]).paused||d.markedForDeletion||d.target.update(a);g=0;for(b=(c=this._updatesPosList).length;g<b;g++)(d=c[g]).paused||d.markedForDeletion||d.target.update(a);var k;c=this._arrayForTimers;for(g=0;g<c.length;g++){if(k=c[g],this._currentTarget=k,this._currentTargetSalvaged=!1,!k.paused)for(k.timerIndex=
0;k.timerIndex<k.timers.length;++k.timerIndex)k.currentTimer=k.timers[k.timerIndex],k.currentTimerSalvaged=!1,k.currentTimer.update(a),k.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&(this._removeHashElement(this._currentTarget),--g)}g=0;for(c=this._updatesNegList;g<c.length;)(d=c[g]).markedForDeletion?this._removeUpdateFromHash(d):g++;g=0;for(c=this._updates0List;g<c.length;)(d=c[g]).markedForDeletion?this._removeUpdateFromHash(d):g++;g=0;for(c=this._updatesPosList;g<
c.length;)(d=c[g]).markedForDeletion?this._removeUpdateFromHash(d):g++;this._updateHashLocked=!1;this._currentTarget=null},schedule:function(a,c,b,d,g,l){if("function"!=typeof a){var e=a;a=c;c=e}4!==arguments.length&&5!==arguments.length||(l=!!d,d=cc.macro.REPEAT_FOREVER,g=0);cc.assertID(c,1502);var p=c._id;p||(c.__instanceId?(cc.warnID(1513),p=c._id=c.__instanceId):cc.errorID(1510));var q;e=this._hashForTimers[p];if(e?e.paused!==l&&cc.warnID(1511):(e=k.get(null,c,0,null,null,l),this._arrayForTimers.push(e),
this._hashForTimers[p]=e),null==e.timers)e.timers=[];else for(p=0;p<e.timers.length;++p)if((q=e.timers[p])&&a===q._callback)return cc.logID(1507,q.getInterval(),b),void(q._interval=b);(q=h.get()).initWithCallback(this,a,c,b,d,g);e.timers.push(q);this._currentTarget===e&&this._currentTargetSalvaged&&(this._currentTargetSalvaged=!1)},scheduleUpdate:function(a,d,g){var k=a._id;k||(a.__instanceId?(cc.warnID(1513),k=a._id=a.__instanceId):cc.errorID(1510));var l=this._hashForUpdates[k];if(l&&l.entry){if(l.entry.priority===
d)return l.entry.markedForDeletion=!1,void(l.entry.paused=g);if(this._updateHashLocked)return cc.logID(1506),l.entry.markedForDeletion=!1,void(l.entry.paused=g);this.unscheduleUpdate(a)}var e;g=b.get(a,d,g,!1);0===d?(e=this._updates0List,this._appendIn(e,g)):(e=0>d?this._updatesNegList:this._updatesPosList,this._priorityIn(e,g,d));this._hashForUpdates[k]=c.get(e,g,a,null)},unschedule:function(a,c){if(c&&a){var b=c._id;b||(c.__instanceId?(cc.warnID(1513),b=c._id=c.__instanceId):cc.errorID(1510));if(c=
this._hashForTimers[b]){b=c.timers;for(var d=0,g=b.length;d<g;d++){var k=b[d];if(a===k._callback)return k!==c.currentTimer||c.currentTimerSalvaged||(c.currentTimerSalvaged=!0),b.splice(d,1),h.put(k),c.timerIndex>=d&&c.timerIndex--,void(0===b.length&&(this._currentTarget===c?this._currentTargetSalvaged=!0:this._removeHashElement(c)))}}}},unscheduleUpdate:function(a){if(a){var c=a._id;c||(a.__instanceId?(cc.warnID(1513),c=a._id=a.__instanceId):cc.errorID(1510));(a=this._hashForUpdates[c])&&(this._updateHashLocked?
a.entry.markedForDeletion=!0:this._removeUpdateFromHash(a.entry))}},unscheduleAllForTarget:function(a){if(a){var c=a._id;c||(a.__instanceId?(cc.warnID(1513),c=a._id=a.__instanceId):cc.errorID(1510));if(c=this._hashForTimers[c]){var b=c.timers;-1<b.indexOf(c.currentTimer)&&!c.currentTimerSalvaged&&(c.currentTimerSalvaged=!0);for(var d=0,g=b.length;d<g;d++)h.put(b[d]);b.length=0;this._currentTarget===c?this._currentTargetSalvaged=!0:this._removeHashElement(c)}this.unscheduleUpdate(a)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},
unscheduleAllWithMinPriority:function(a){var c,b,d=this._arrayForTimers;for(c=d.length-1;0<=c;c--){var g=d[c];this.unscheduleAllForTarget(g.target)}if(0>a)for(c=0;c<this._updatesNegList.length;)g=this._updatesNegList.length,(b=this._updatesNegList[c])&&b.priority>=a&&this.unscheduleUpdate(b.target),g==this._updatesNegList.length&&c++;if(0>=a)for(c=0;c<this._updates0List.length;)g=this._updates0List.length,(b=this._updates0List[c])&&this.unscheduleUpdate(b.target),g==this._updates0List.length&&c++;
for(c=0;c<this._updatesPosList.length;)g=this._updatesPosList.length,(b=this._updatesPosList[c])&&b.priority>=a&&this.unscheduleUpdate(b.target),g==this._updatesPosList.length&&c++},isScheduled:function(a,c){cc.assertID(a,1508);cc.assertID(c,1509);var b=c._id;b||(c.__instanceId?(cc.warnID(1513),b=c._id=c.__instanceId):cc.errorID(1510));c=this._hashForTimers[b];if(!c||null==c.timers)return!1;c=c.timers;for(b=0;b<c.length;++b)if(a===c[b]._callback)return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},
pauseAllTargetsWithMinPriority:function(a){var c,b,d,g=[],k=this._arrayForTimers;var l=0;for(b=k.length;l<b;l++)(c=k[l])&&(c.paused=!0,g.push(c.target));if(0>a)for(l=0;l<this._updatesNegList.length;l++)(d=this._updatesNegList[l])&&d.priority>=a&&(d.paused=!0,g.push(d.target));if(0>=a)for(l=0;l<this._updates0List.length;l++)(d=this._updates0List[l])&&(d.paused=!0,g.push(d.target));for(l=0;l<this._updatesPosList.length;l++)(d=this._updatesPosList[l])&&d.priority>=a&&(d.paused=!0,g.push(d.target));return g},
resumeTargets:function(a){if(a)for(var c=0;c<a.length;c++)this.resumeTarget(a[c])},pauseTarget:function(a){cc.assertID(a,1503);var c=a._id;c||(a.__instanceId?(cc.warnID(1513),c=a._id=a.__instanceId):cc.errorID(1510));(a=this._hashForTimers[c])&&(a.paused=!0);(c=this._hashForUpdates[c])&&(c.entry.paused=!0)},resumeTarget:function(a){cc.assertID(a,1504);var c=a._id;c||(a.__instanceId?(cc.warnID(1513),c=a._id=a.__instanceId):cc.errorID(1510));(a=this._hashForTimers[c])&&(a.paused=!1);(c=this._hashForUpdates[c])&&
(c.entry.paused=!1)},isTargetPaused:function(a){cc.assertID(a,1505);var c=a._id;c||(a.__instanceId?(cc.warnID(1513),c=a._id=a.__instanceId):cc.errorID(1510));if(a=this._hashForTimers[c])return a.paused;c=this._hashForUpdates[c];return!!c&&c.entry.paused}};cc.Scheduler.PRIORITY_SYSTEM=-2147483648;cc.Scheduler.PRIORITY_NON_SYSTEM=cc.Scheduler.PRIORITY_SYSTEM+1;n.exports=cc.Scheduler},{"./platform/id-generater":146,"./platform/js":150}],34:[function(f,n,m){f=f("./CCRawAsset");cc.Asset=cc.Class({name:"cc.Asset",
extends:f,ctor:function(){this.loaded=!0;this.url=""},properties:{nativeUrl:{get:function(){if(this._native){var f=this._native;if(47===f.charCodeAt(0))return f.slice(1);if(cc.AssetLibrary){var e=cc.AssetLibrary.getLibUrlNoExt(this._uuid,!0);return 46===f.charCodeAt(0)?e+f:e+"/"+f}cc.errorID(6400)}return""},visible:!1},_native:"",_nativeAsset:{get:function(){return this._$nativeAsset},set:function(f){this._$nativeAsset=f}}},statics:{deserialize:!1,preventDeferredLoadDependents:!1,preventPreloadNativeObject:!1},
toString:function(){return this.nativeUrl},serialize:!1,createNode:null,_setRawAsset:function(f,e){this._native=!1!==e?f||void 0:"/"+f}});n.exports=cc.Asset},{"./CCRawAsset":43}],35:[function(f,n,m){m=f("./CCAsset");f=f("../event/event-target");var h=cc.Enum({WEB_AUDIO:0,DOM_AUDIO:1}),e=cc.Class({name:"cc.AudioClip",extends:m,mixins:[f],ctor:function(){this.loaded=!1;this._audio=null},properties:{loadMode:{default:h.WEB_AUDIO,type:h},_nativeAsset:{get:function(){return this._audio},set:function(d){d instanceof
cc.AudioClip?this._audio=d._nativeAsset:this._audio=d;this._audio&&(this.loaded=!0,this.emit("load"))},override:!0}},statics:{LoadMode:h,_loadByUrl:function(d,b){var a=cc.loader.getItem(d)||cc.loader.getItem(d+"?useDom=1");a&&a.complete?a._owner instanceof e?b(null,a._owner):b(null,a.content):cc.loader.load(d,function(c,g){if(c)return b(c);a=cc.loader.getItem(d)||cc.loader.getItem(d+"?useDom=1");b(null,a.content)})}},destroy:function(){cc.audioEngine.uncache(this);this._super()}});cc.AudioClip=e;
n.exports=e},{"../event/event-target":99,"./CCAsset":34}],36:[function(f,n,m){var h=function(){this.textureID=this.offsetY=this.offsetX=this.h=this.w=this.v=this.u=0;this.valid=!1;this.xAdvance=0},e=function(d){this._letterDefinitions={};this._texture=d};e.prototype={constructor:e,addLetterDefinitions:function(d,b){this._letterDefinitions[d]=b},cloneLetterDefinition:function(){var d={},b;for(b in this._letterDefinitions){var a=new h;cc.js.mixin(a,this._letterDefinitions[b]);d[b]=a}return d},getTexture:function(){return this._texture},
getLetter:function(d){return this._letterDefinitions[d]},getLetterDefinitionForChar:function(d){d=d.charCodeAt(0);return this._letterDefinitions.hasOwnProperty(d)?this._letterDefinitions[d]:null},clear:function(){this._letterDefinitions={}}};f=cc.Class({name:"cc.BitmapFont",extends:cc.Font,properties:{fntDataStr:{default:""},spriteFrame:{default:null,type:cc.SpriteFrame},fontSize:{default:-1},_fntConfig:null,_fontDefDictionary:null},onLoad:function(){var d=this.spriteFrame;!this._fontDefDictionary&&
d&&(this._fontDefDictionary=new e(d._texture));if(d=this._fntConfig){d=d.fontDefDictionary;for(var b in d){var a=new h,c=d[b].rect;a.offsetX=d[b].xOffset;a.offsetY=d[b].yOffset;a.w=c.width;a.h=c.height;a.u=c.x;a.v=c.y;a.textureID=0;a.valid=!0;a.xAdvance=d[b].xAdvance;this._fontDefDictionary.addLetterDefinitions(b,a)}}}});cc.BitmapFont=f;cc.BitmapFont.FontLetterDefinition=h;cc.BitmapFont.FontAtlas=e;n.exports=f},{}],37:[function(f,n,m){f=cc.Class({name:"cc.BufferAsset",extends:cc.Asset,ctor:function(){this._buffer=
null},properties:{_nativeAsset:{get:function(){return this._buffer},set:function(f){this._buffer=f.buffer||f},override:!0},buffer:function(){return this._buffer}}});cc.BufferAsset=n.exports=f},{}],38:[function(f,n,m){m=f("./CCAsset");var h=f("../../renderer/core/effect");f=cc.Class({name:"cc.EffectAsset",extends:m,ctor:function(){this._effect=null},properties:{properties:Object,techniques:[],shaders:[]},onLoad:function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){for(var e=cc.renderer._forward._programLib,
d=0;d<this.shaders.length;d++)e.define(this.shaders[d]);this._initEffect()}},_initEffect:function(){this._effect||(this._effect=h.parseEffect(this))},getInstantiatedEffect:function(){return this._initEffect(),this._effect.clone()}});n.exports=cc.EffectAsset=f},{"../../renderer/core/effect":269,"./CCAsset":34}],39:[function(f,n,m){f=cc.Class({name:"cc.Font",extends:cc.Asset});cc.Font=n.exports=f},{}],40:[function(f,n,m){f=cc.Class({name:"cc.JsonAsset",extends:cc.Asset,properties:{json:null}});n.exports=
cc.JsonAsset=f},{}],41:[function(f,n,m){f=cc.Class({name:"cc.LabelAtlas",extends:cc.BitmapFont,onLoad:function(){this.spriteFrame?this._fntConfig?this._super():cc.warnID(9101,this.name):cc.warnID(9100,this.name)}});cc.LabelAtlas=f;n.exports=f},{}],42:[function(f,n,m){var h=cc.Enum({AUTO:0,SINGLE_INSTANCE:1,MULTI_INSTANCE:2}),e=cc.Class({name:"cc.Prefab",extends:cc.Asset,ctor:function(){this._createFunction=null;this._instantiatedTimes=0},properties:{data:null,optimizationPolicy:h.AUTO,asyncLoadAssets:!1,
readonly:{default:!1,editorOnly:!0}},statics:{OptimizationPolicy:h,OptimizationPolicyThreshold:3},createNode:!1,compileCreateFunction:function(){this._createFunction=f("../platform/instantiate-jit").compile(this.data)},_doInstantiate:function(d){return this.data._prefab?this.data._prefab._synced=!0:cc.warnID(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(d)},_instantiate:function(){var d;return this.optimizationPolicy!==h.SINGLE_INSTANCE&&(this.optimizationPolicy===
h.MULTI_INSTANCE||this._instantiatedTimes+1>=e.OptimizationPolicyThreshold)?(d=this._doInstantiate(),this.data._instantiate(d)):(this.data._prefab._synced=!0,d=this.data._instantiate()),++this._instantiatedTimes,d},destroy:function(){this.data&&this.data.destroy();this._super()}});cc.Prefab=n.exports=e;cc.js.obsolete(cc,"cc._Prefab","Prefab")},{"../platform/instantiate-jit":148}],43:[function(f,n,m){m=f("../platform/CCObject");var h=f("../platform/js");cc.RawAsset=cc.Class({name:"cc.RawAsset",extends:m,
ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0})}});h.value(cc.RawAsset,"isRawAssetType",function(e){return h.isChildClassOf(e,cc.RawAsset)&&!h.isChildClassOf(e,cc.Asset)});h.value(cc.RawAsset,"wasRawAssetType",function(e){return e===cc.Texture2D||e===cc.AudioClip||e===cc.ParticleAsset||e===cc.Asset});n.exports=cc.RawAsset},{"../platform/CCObject":136,"../platform/js":150}],44:[function(f,n,m){var h=function(d){return d&&d.__esModule?d:{default:d}}(f("../../renderer/gfx")),
e=f("../renderer");f=f("./CCTexture2D");f=cc.Class({name:"cc.RenderTexture",extends:f,ctor:function(){this._framebuffer=null},initWithSize:function(d,b,a){this.width=Math.floor(d||cc.visibleRect.width);this.height=Math.floor(b||cc.visibleRect.height);this._resetUnderlyingMipmaps();var c={colors:[this._texture]};this._depthStencilBuffer&&this._depthStencilBuffer.destroy();var g=void 0;a&&(g=new h.default.RenderBuffer(e.device,a,d,b),a===h.default.RB_FMT_D24S8?c.depthStencil=g:a===h.default.RB_FMT_S8?
c.stencil=g:a===h.default.RB_FMT_D16&&(c.depth=g));this._depthStencilBuffer=g;this._framebuffer&&this._framebuffer.destroy();this._framebuffer=new h.default.FrameBuffer(e.device,d,b,c);this._packable=!1;this.loaded=!0;this.emit("load")},updateSize:function(d,b){this.width=Math.floor(d||cc.visibleRect.width);this.height=Math.floor(b||cc.visibleRect.height);this._resetUnderlyingMipmaps();var a=this._depthStencilBuffer;a&&a.update(this.width,this.height);this._framebuffer._width=d;this._framebuffer._height=
b},drawTextureAt:function(d,b,a){d._image&&this._texture.updateSubImage({x:b,y:a,image:d._image,width:d.width,height:d.height,level:0,flipY:!1,premultiplyAlpha:d._premultiplyAlpha})},readPixels:function(d,b,a,c,g){if(!this._framebuffer||!this._texture)return d;b=b||0;a=a||0;c=c||this.width;g=g||this.height;d=d||new Uint8Array(c*g*4);var k=cc.game._renderContext,l=k.getParameter(k.FRAMEBUFFER_BINDING);return k.bindFramebuffer(k.FRAMEBUFFER,this._framebuffer.getHandle()),k.readPixels(b,a,c,g,k.RGBA,
k.UNSIGNED_BYTE,d),k.bindFramebuffer(k.FRAMEBUFFER,l),d},destroy:function(){this._super();this._framebuffer&&(this._framebuffer.destroy(),this._framebuffer=null)}});cc.RenderTexture=n.exports=f},{"../../renderer/gfx":280,"../renderer":178,"./CCTexture2D":51}],45:[function(f,n,m){f=cc.Class({name:"cc.SceneAsset",extends:cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=f;n.exports=f},{}],46:[function(f,n,m){f=cc.Class({name:"cc.Script",extends:cc.Asset});cc._Script=f;n=cc.Class({name:"cc.JavaScript",
extends:f});cc._JavaScript=n;n=cc.Class({name:"cc.CoffeeScript",extends:f});cc._CoffeeScript=n;f=cc.Class({name:"cc.TypeScript",extends:f});cc._TypeScript=f},{}],47:[function(f,n,m){f=cc.Class({name:"cc.SpriteAtlas",extends:cc.Asset,properties:{_spriteFrames:{default:{}}},getTexture:function(){var f=Object.keys(this._spriteFrames);return 0<f.length?(f=this._spriteFrames[f[0]])?f.getTexture():null:null},getSpriteFrame:function(f){var e=this._spriteFrames[f];return e?(e.name||(e.name=f),e):null},getSpriteFrames:function(){var f=
[],e=this._spriteFrames,d;for(d in e)f.push(this.getSpriteFrame(d));return f}});cc.SpriteAtlas=f;n.exports=f},{}],48:[function(f,n,m){var h=f("../event/event-target"),e=f("../utils/texture-util"),d=[{u:0,v:0},{u:0,v:0},{u:0,v:0},{u:0,v:0}],b=cc.Class({name:"cc.SpriteFrame",extends:f("../assets/CCAsset"),mixins:[h],properties:{_textureSetter:{set:function(a){a&&(this._texture!==a&&this._refreshTexture(a),this._textureFilename=a.url)}},insetTop:{get:function(){return this._capInsets[1]},set:function(a){this._capInsets[1]=
a;this._texture&&this._calculateSlicedUV()}},insetBottom:{get:function(){return this._capInsets[3]},set:function(a){this._capInsets[3]=a;this._texture&&this._calculateSlicedUV()}},insetLeft:{get:function(){return this._capInsets[0]},set:function(a){this._capInsets[0]=a;this._texture&&this._calculateSlicedUV()}},insetRight:{get:function(){return this._capInsets[2]},set:function(a){this._capInsets[2]=a;this._texture&&this._calculateSlicedUV()}}},ctor:function(a,c,b,d,l){h.call(this);this._rect=null;
this.uv=[];this._originalSize=this._offset=this._original=this._texture=null;this._rotated=!1;this.vertices=null;this._capInsets=[0,0,0,0];this.uvSliced=[];this._textureFilename="";void 0!==a&&this.setTexture(a,c,b,d,l)},textureLoaded:function(){return this._texture&&this._texture.loaded},isRotated:function(){return this._rotated},setRotated:function(a){this._rotated=a;this._texture&&this._calculateUV()},getRect:function(){return cc.rect(this._rect)},setRect:function(a){this._rect=a;this._texture&&
this._calculateUV()},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(a){this._originalSize?(this._originalSize.width=a.width,this._originalSize.height=a.height):this._originalSize=cc.size(a)},getTexture:function(){return this._texture},_textureLoadedCallback:function(){var a=this._texture;if(a){var c=a.width;a=a.height;this._rect?this._checkRect(this._texture):this._rect=cc.rect(0,0,c,a);this._originalSize||this.setOriginalSize(cc.size(c,a));this._offset||this.setOffset(cc.v2(0,
0));this._calculateUV();this.emit("load")}},_refreshTexture:function(a){this._texture=a;a.loaded?this._textureLoadedCallback():a.once("load",this._textureLoadedCallback,this)},getOffset:function(){return cc.v2(this._offset)},setOffset:function(a){this._offset=cc.v2(a)},clone:function(){return new b(this._texture||this._textureFilename,this._rect,this._rotated,this._offset,this._originalSize)},setTexture:function(a,c,b,d,l){this._rect=c||null;d?this.setOffset(d):this._offset=null;l?this.setOriginalSize(l):
this._originalSize=null;this._rotated=b||!1;return"string"==typeof a&&a&&(this._textureFilename=a,this._loadTexture()),a instanceof cc.Texture2D&&this._texture!==a&&this._refreshTexture(a),!0},_loadTexture:function(){if(this._textureFilename){var a=e.loadImage(this._textureFilename);this._refreshTexture(a)}},ensureLoadTexture:function(){this._texture?this._texture.loaded||(this._refreshTexture(this._texture),e.postLoadTexture(this._texture)):this._textureFilename&&this._loadTexture()},_checkRect:function(a){var c=
this._rect,b=c.x,d=c.y;this._rotated?(b+=c.height,d+=c.width):(b+=c.width,d+=c.height);b>a.width&&cc.errorID(3300,a.url+"/"+this.name,b,a.width);d>a.height&&cc.errorID(3400,a.url+"/"+this.name,d,a.height)},_calculateSlicedUV:function(){var a=this._rect,c=this._texture.width,b=this._texture.height,k=this._capInsets[0],l=a.width-k-this._capInsets[2],e=this._capInsets[1],r=this._capInsets[3],t=a.height-e-r,p=this.uvSliced;if(p.length=0,this._rotated)for(d[0].u=a.x/c,d[1].u=(a.x+r)/c,d[2].u=(a.x+r+t)/
c,d[3].u=(a.x+a.height)/c,d[3].v=a.y/b,d[2].v=(a.y+k)/b,d[1].v=(a.y+k+l)/b,d[0].v=(a.y+a.width)/b,a=0;4>a;++a)for(c=d[a],b=0;4>b;++b)p.push({u:c.u,v:d[3-b].v});else for(d[0].u=a.x/c,d[1].u=(a.x+k)/c,d[2].u=(a.x+k+l)/c,d[3].u=(a.x+a.width)/c,d[3].v=a.y/b,d[2].v=(a.y+e)/b,d[1].v=(a.y+e+t)/b,d[0].v=(a.y+a.height)/b,a=0;4>a;++a)for(c=d[a],b=0;4>b;++b)p.push({u:d[b].u,v:c.v})},_setDynamicAtlasFrame:function(a){a&&(this._original={_texture:this._texture,_x:this._rect.x,_y:this._rect.y},this._texture=a.texture,
this._rect.x=a.x,this._rect.y=a.y,this._calculateUV())},_resetDynamicAtlasFrame:function(){this._original&&(this._rect.x=this._original._x,this._rect.y=this._original._y,this._texture=this._original._texture,this._original=null,this._calculateUV())},_calculateUV:function(){var a=this._rect,c=this._texture,b=this.uv,d=c.width;c=c.height;if(this._rotated){var l=0===d?0:a.x/d,e=0===d?0:(a.x+a.height)/d,r=0===c?0:(a.y+a.width)/c;a=0===c?0:a.y/c;b[0]=l;b[1]=a;b[2]=l;b[3]=r;b[4]=e;b[5]=a;b[6]=e;b[7]=r}else l=
0===d?0:a.x/d,e=0===d?0:(a.x+a.width)/d,r=0===c?0:(a.y+a.height)/c,a=0===c?0:a.y/c,b[0]=l,b[1]=r,b[2]=e,b[3]=r,b[4]=l,b[5]=a,b[6]=e,b[7]=a;if(b=this.vertices)for(b.nu.length=0,a=b.nv.length=0;a<b.u.length;a++)b.nu[a]=b.u[a]/d,b.nv[a]=b.v[a]/c;this._calculateSlicedUV()},_serialize:!1,_deserialize:function(a,c){var b=a.rect;b&&(this._rect=new cc.Rect(b[0],b[1],b[2],b[3]));a.offset&&this.setOffset(new cc.Vec2(a.offset[0],a.offset[1]));a.originalSize&&this.setOriginalSize(new cc.Size(a.originalSize[0],
a.originalSize[1]));this._rotated=1===a.rotated;this._name=a.name;(b=a.capInsets)&&(this._capInsets[0]=b[0],this._capInsets[1]=b[1],this._capInsets[2]=b[2],this._capInsets[3]=b[3]);(this.vertices=a.vertices)&&(this.vertices.nu=[],this.vertices.nv=[]);(a=a.texture)&&c.result.push(this,"_textureSetter",a)}});f=b.prototype;f.copyWithZone=f.clone;f.copy=f.clone;f.initWithTexture=f.setTexture;cc.SpriteFrame=b;n.exports=b},{"../assets/CCAsset":34,"../event/event-target":99,"../utils/texture-util":228}],
49:[function(f,n,m){f=f("./CCFont");f=cc.Class({name:"cc.TTFFont",extends:f,properties:{_fontFamily:null,_nativeAsset:{type:cc.String,get:function(){return this._fontFamily},set:function(f){this._fontFamily=f||"Arial"},override:!0}}});cc.TTFFont=n.exports=f},{"./CCFont":39}],50:[function(f,n,m){f=cc.Class({name:"cc.TextAsset",extends:cc.Asset,properties:{text:""},toString:function(){return this.text}});n.exports=cc.TextAsset=f},{}],51:[function(f,n,m){function h(){for(var a in r)r[a]=void 0;return q.length=
0,r.images=q,r.flipY=!1,r}m=function(a){return a&&a.__esModule?a:{default:a}}(f("../../renderer/gfx"));var e=f("../event/event-target"),d=f("../renderer");f("../platform/CCClass");var b=new (f("../platform/id-generater"))("Tex"),a=1024,c=cc.Enum({RGB565:m.default.TEXTURE_FMT_R5_G6_B5,RGB5A1:m.default.TEXTURE_FMT_R5_G5_B5_A1,RGBA4444:m.default.TEXTURE_FMT_R4_G4_B4_A4,RGB888:m.default.TEXTURE_FMT_RGB8,RGBA8888:m.default.TEXTURE_FMT_RGBA8,RGBA32F:m.default.TEXTURE_FMT_RGBA32F,A8:m.default.TEXTURE_FMT_A8,
I8:m.default.TEXTURE_FMT_L8,AI8:m.default.TEXTURE_FMT_L8_A8,RGB_PVRTC_2BPPV1:m.default.TEXTURE_FMT_RGB_PVRTC_2BPPV1,RGBA_PVRTC_2BPPV1:m.default.TEXTURE_FMT_RGBA_PVRTC_2BPPV1,RGB_A_PVRTC_2BPPV1:a++,RGB_PVRTC_4BPPV1:m.default.TEXTURE_FMT_RGB_PVRTC_4BPPV1,RGBA_PVRTC_4BPPV1:m.default.TEXTURE_FMT_RGBA_PVRTC_4BPPV1,RGB_A_PVRTC_4BPPV1:a++,RGB_ETC1:m.default.TEXTURE_FMT_RGB_ETC1,RGBA_ETC1:a++,RGB_ETC2:m.default.TEXTURE_FMT_RGB_ETC2,RGBA_ETC2:m.default.TEXTURE_FMT_RGBA_ETC2}),g=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,
MIRRORED_REPEAT:33648}),k=cc.Enum({LINEAR:9729,NEAREST:9728}),l={9728:0,9729:1},q=[],r={width:void 0,height:void 0,minFilter:void 0,magFilter:void 0,wrapS:void 0,wrapT:void 0,format:void 0,genMipmaps:void 0,images:void 0,image:void 0,flipY:void 0,premultiplyAlpha:void 0},t=cc.Class({name:"cc.Texture2D",extends:f("../assets/CCAsset"),mixins:[e],properties:{_nativeAsset:{get:function(){return this._image},set:function(a){a._compressed&&a._data?this.initWithData(a._data,this._format,a.width,a.height):
this.initWithElement(a)},override:!0},_format:c.RGBA8888,_premultiplyAlpha:!1,_flipY:!1,_minFilter:k.LINEAR,_magFilter:k.LINEAR,_mipFilter:k.LINEAR,_wrapS:g.CLAMP_TO_EDGE,_wrapT:g.CLAMP_TO_EDGE,_genMipmaps:!1,genMipmaps:{get:function(){return this._genMipmaps},set:function(a){if(this._genMipmaps!==a){var c=h();c.genMipmaps=a;this.update(c)}}},_packable:!0,packable:{get:function(){return this._packable},set:function(a){this._packable=a}}},statics:{PixelFormat:c,WrapMode:g,Filter:k,_FilterIndex:l,extnames:".png .jpg .jpeg .bmp .webp .pvr .pkm".split(" ")},
ctor:function(){this._id=b.getNewId();this.loaded=!1;this.height=this.width=0;this._hashDirty=!0;this._hash=0;this._texture=null},getImpl:function(){return this._texture},getId:function(){return this._id},toString:function(){return this.url||""},update:function(a){if(a){var c=!1;void 0!==a.width&&(this.width=a.width);void 0!==a.height&&(this.height=a.height);void 0!==a.minFilter&&(this._minFilter=a.minFilter,a.minFilter=l[a.minFilter]);void 0!==a.magFilter&&(this._magFilter=a.magFilter,a.magFilter=
l[a.magFilter]);void 0!==a.mipFilter&&(this._mipFilter=a.mipFilter,a.mipFilter=l[a.mipFilter]);void 0!==a.wrapS&&(this._wrapS=a.wrapS);void 0!==a.wrapT&&(this._wrapT=a.wrapT);void 0!==a.format&&(this._format=a.format);void 0!==a.flipY&&(this._flipY=a.flipY,c=!0);void 0!==a.premultiplyAlpha&&(this._premultiplyAlpha=a.premultiplyAlpha,c=!0);void 0!==a.genMipmaps&&(this._genMipmaps=a.genMipmaps);c&&this._image&&(a.image=this._image);a.images&&0<a.images.length?this._image=a.images[0]:void 0!==a.image&&
(this._image=a.image,a.images||(q.length=0,a.images=q),a.images.push(a.image));a.images&&0<a.images.length&&this._texture.update(a);this._hashDirty=!0}},initWithElement:function(a){if(a)if(this._image=a,a.complete||a instanceof HTMLCanvasElement)this.handleLoadedTexture();else{var c=this;a.addEventListener("load",function(){c.handleLoadedTexture()});a.addEventListener("error",function(a){cc.warnID(3119,a.message)})}},initWithData:function(a,c,b,g){var k=h();return k.image=a,k.images=[k.image],k.genMipmaps=
this._genMipmaps,k.premultiplyAlpha=this._premultiplyAlpha,k.flipY=this._flipY,k.minFilter=l[this._minFilter],k.magFilter=l[this._magFilter],k.wrapS=this._wrapS,k.wrapT=this._wrapT,k.format=this._getGFXPixelFormat(c),k.width=b,k.height=g,this._texture?this._texture.update(k):this._texture=new d.Texture2D(d.device,k),this.width=b,this.height=g,this._checkPackable(),this.loaded=!0,this.emit("load"),!0},getHtmlElementObj:function(){return this._image},destroy:function(){this._image=null;this._texture&&
this._texture.destroy();this._super()},getPixelFormat:function(){return this._format},hasPremultipliedAlpha:function(){return this._premultiplyAlpha||!1},handleLoadedTexture:function(){if(this._image&&this._image.width&&this._image.height){this.width=this._image.width;this.height=this._image.height;var a=h();a.image=this._image;a.images=[a.image];a.width=this.width;a.height=this.height;a.genMipmaps=this._genMipmaps;a.format=this._getGFXPixelFormat(this._format);a.premultiplyAlpha=this._premultiplyAlpha;
a.flipY=this._flipY;a.minFilter=l[this._minFilter];a.magFilter=l[this._magFilter];a.wrapS=this._wrapS;a.wrapT=this._wrapT;this._texture?this._texture.update(a):this._texture=new d.Texture2D(d.device,a);this._checkPackable();this.loaded=!0;this.emit("load");cc.macro.CLEANUP_IMAGE_CACHE&&this._image instanceof HTMLImageElement&&this._clearImage()}},description:function(){return"<cc.Texture2D | Name = "+this.url+" | Dimensions = "+this.width+" x "+this.height+">"},releaseTexture:function(){this._image=
null;this._texture&&this._texture.destroy()},setWrapMode:function(a,c){if(this._wrapS!==a||this._wrapT!==c){var b=h();b.wrapS=a;b.wrapT=c;this.update(b)}},setFilters:function(a,c){if(this._minFilter!==a||this._magFilter!==c){var b=h();b.minFilter=a;b.magFilter=c;this.update(b)}},setFlipY:function(a){if(this._flipY!==a){var c=h();c.flipY=a;this.update(c)}},setPremultiplyAlpha:function(a){if(this._premultiplyAlpha!==a){var c=h();c.premultiplyAlpha=a;this.update(c)}},_checkPackable:function(){var a=
cc.dynamicAtlasManager;if(a)if(this._isCompressed())this._packable=!1;else{var c=this.width,b=this.height;!this._image||c>a.maxFrameSize||b>a.maxFrameSize||c<=a.minFrameSize||b<=a.minFrameSize||this._getHash()!==a.Atlas.DEFAULT_HASH?this._packable=!1:this._image&&this._image instanceof HTMLCanvasElement&&(this._packable=!0)}},_getOpts:function(){var a=h();return a.width=this.width,a.height=this.height,a.genMipmaps=this._genMipmaps,a.format=this._format,a.premultiplyAlpha=this._premultiplyAlpha,a.anisotropy=
this._anisotropy,a.flipY=this._flipY,a.minFilter=l[this._minFilter],a.magFilter=l[this._magFilter],a.mipFilter=l[this._mipFilter],a.wrapS=this._wrapS,a.wrapT=this._wrapT,a},_getGFXPixelFormat:function(a){return a===c.RGBA_ETC1?a=c.RGB_ETC1:a===c.RGB_A_PVRTC_4BPPV1?a=c.RGB_PVRTC_4BPPV1:a===c.RGB_A_PVRTC_2BPPV1&&(a=c.RGB_PVRTC_2BPPV1),a},_resetUnderlyingMipmaps:function(a){var c=this._getOpts();c.images=a||[null];this._texture?this._texture.update(c):this._texture=new d.Texture2D(d.device,c)},_serialize:!1,
_deserialize:function(a,b){var d=cc.renderer.device;a=a.split(",");var g=a[0];if(g){g=g.split("_");for(var k="",l="",e=999,q=this._format,p=cc.macro.SUPPORT_TEXTURE_FORMATS,r=0;r<g.length;r++){var v=g[r].split("@"),f=v[0];f=t.extnames[f.charCodeAt(0)-48]||f;var h=p.indexOf(f);if(-1!==h&&h<e){if(v=v[1]?parseInt(v[1]):this._format,".pvr"!==f||d.ext("WEBGL_compressed_texture_pvrtc"))if(v!==c.RGB_ETC1&&v!==c.RGBA_ETC1||d.ext("WEBGL_compressed_texture_etc1"))if(v!==c.RGB_ETC2&&v!==c.RGBA_ETC2||d.ext("WEBGL_compressed_texture_etc"))if(".webp"!==
f||cc.sys.capabilities.webp)e=h,l=f,q=v}else k||(k=f)}l?(this._setRawAsset(l),this._format=q):(this._setRawAsset(k),cc.warnID(3120,b.customEnv.url,k,k))}8===a.length&&(this._minFilter=parseInt(a[1]),this._magFilter=parseInt(a[2]),this._wrapS=parseInt(a[3]),this._wrapT=parseInt(a[4]),this._premultiplyAlpha=49===a[5].charCodeAt(0),this._genMipmaps=49===a[6].charCodeAt(0),this._packable=49===a[7].charCodeAt(0))},_getHash:function(){if(!this._hashDirty)return this._hash;var a=this._genMipmaps?1:0,c=this._premultiplyAlpha?
1:0,b=this._flipY?1:0,d=this._minFilter===k.LINEAR?1:2,l=this._magFilter===k.LINEAR?1:2,e=this._wrapS===g.REPEAT?1:this._wrapS===g.CLAMP_TO_EDGE?2:3,q=this._wrapT===g.REPEAT?1:this._wrapT===g.CLAMP_TO_EDGE?2:3,r=this._format;this._image;return this._hash=Number(""+d+l+r+e+q+a+c+b),this._hashDirty=!1,this._hash},_isCompressed:function(){return this._texture&&this._texture._compressed},_clearImage:function(){cc.loader.removeItem(this._image.id||this._image.src);this._image.src=""}});cc.Texture2D=n.exports=
t},{"../../renderer/gfx":280,"../assets/CCAsset":34,"../event/event-target":99,"../platform/CCClass":130,"../platform/id-generater":146,"../renderer":178}],52:[function(f,n,m){f("./CCRawAsset");f("./CCAsset");f("./CCFont");f("./CCPrefab");f("./CCAudioClip");f("./CCScripts");f("./CCSceneAsset");f("./CCSpriteFrame");f("./CCTexture2D");f("./CCRenderTexture");f("./CCTTFFont");f("./CCSpriteAtlas");f("./CCBitmapFont");f("./CCLabelAtlas");f("./CCTextAsset");f("./CCJsonAsset");f("./CCBufferAsset");f("./CCEffectAsset");
f("./material/CCMaterial")},{"./CCAsset":34,"./CCAudioClip":35,"./CCBitmapFont":36,"./CCBufferAsset":37,"./CCEffectAsset":38,"./CCFont":39,"./CCJsonAsset":40,"./CCLabelAtlas":41,"./CCPrefab":42,"./CCRawAsset":43,"./CCRenderTexture":44,"./CCSceneAsset":45,"./CCScripts":46,"./CCSpriteAtlas":47,"./CCSpriteFrame":48,"./CCTTFFont":49,"./CCTextAsset":50,"./CCTexture2D":51,"./material/CCMaterial":53}],53:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}var e=h(f("../../../renderer/murmurhash2_gc")),
d=h(f("./utils")),b=h(f("./material-pool"));m=f("../CCAsset");var a=f("../CCTexture2D"),c=a.PixelFormat,g=f("../CCEffectAsset"),k=f("../../utils/texture-util"),l=cc.Class({name:"cc.Material",extends:m,ctor:function(){this._manualHash=!1;this._dirty=!0;this._owner=this._effect=null;this._hash=0},properties:{_effectAsset:{type:g,default:null},_defines:{default:{},type:Object},_props:{default:{},type:Object},effectName:void 0,effectAsset:{get:function(){return this._effectAsset},set:function(a){cc.game.renderType!==
cc.game.RENDER_TYPE_CANVAS&&(this._effectAsset=a,a?this._effect=this._effectAsset.getInstantiatedEffect():cc.error("Can not set an empty effect asset."))}},effect:{get:function(){return this._effect}},owner:{get:function(){return this._owner}}},statics:{getBuiltinMaterial:function(a){return cc.AssetLibrary.getBuiltin("material","builtin-"+a)},getInstantiatedBuiltinMaterial:function(a,c){a=this.getBuiltinMaterial(a);return l.getInstantiatedMaterial(a,c)},getInstantiatedMaterial:function(a,c){return a._owner===
c?a:b.default.get(a,c)}},copy:function(a){for(var c in this.effectAsset=a.effectAsset,a._defines)this.define(c,a._defines[c]);for(var b in a._props)this.setProperty(b,a._props[b])},setProperty:function(b,d,g){(this._props[b]!==d||g)&&(this._props[b]=d,this._dirty=!0,this._effect)&&(d instanceof a?(g=function(){this._effect.setProperty(b,d);var a=d.getPixelFormat();a!==c.RGBA_ETC1&&a!==c.RGB_A_PVRTC_4BPPV1&&a!==c.RGB_A_PVRTC_2BPPV1||this.define("CC_USE_ALPHA_ATLAS_"+b.toUpperCase(),!0)},d.loaded?g.call(this):
(d.once("load",g,this),k.postLoadTexture(d))):this._effect.setProperty(b,d))},getProperty:function(a){return this._props[a]},define:function(a,c,b){(this._defines[a]!==c||b)&&(this._defines[a]=c,this._dirty=!0,this._effect&&this._effect.define(a,c))},getDefine:function(a){return this._defines[a]},setDirty:function(a){this._dirty=a},updateHash:function(a){void 0===a||null===a?a=this.computeHash():this._manualHash=!0;this._dirty=!1;this._hash=a;this._effect&&this._effect.updateHash(this._hash)},computeHash:function(){var a=
this._effect,c="";return a&&(c+=d.default.serializeDefines(a._defines),c+=d.default.serializeTechniques(a._techniques),c+=d.default.serializeUniforms(a._properties)),(0,e.default)(c,666)},getHash:function(){return this._dirty?(this._manualHash||this.updateHash(),this._dirty=!1,this._hash):this._hash},onLoad:function(){if(this.effectAsset=this._effectAsset,this._effect){for(var a in this._defines)this.define(a,this._defines[a],!0);for(var c in this._props)this.setProperty(c,this._props[c],!0)}}});
n.exports=cc.Material=l},{"../../../renderer/murmurhash2_gc":298,"../../utils/texture-util":228,"../CCAsset":34,"../CCEffectAsset":38,"../CCTexture2D":51,"./material-pool":54,"./utils":55}],54:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function d(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}m.__esModule=!0;var b=h(f("./utils"));f=h(f("../../utils/pool"));var a=new (function(a){function c(){var b,d;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");for(var g=arguments.length,r=Array(g),t=0;t<g;t++)r[t]=arguments[t];return b=d=e(this,a.call.apply(a,[this].concat(r))),d.enabled=
!1,d._pool={},e(d,b)}return d(c,a),c.prototype.get=function(a,c){var d=this._pool,g=void 0;if(this.enabled){var k=a.effectAsset._uuid;d[k]&&(g=b.default.serializeDefines(a._effect._defines)+b.default.serializeTechniques(a._effect._techniques),g=d[k][g]&&d[k][g].pop())}return g?this.count--:((g=new cc.Material).copy(a),g._name=a._name+" (Instance)",g._uuid=a._uuid),g._owner=c,g},c.prototype.put=function(a){if(this.enabled&&a._owner){var c=this._pool,d=a.effectAsset._uuid;c[d]||(c[d]={});var g=b.default.serializeDefines(a._effect._defines)+
b.default.serializeTechniques(a._effect._techniques);c[d][g]||(c[d][g]=[]);this.count>this.maxSize||(this._clean(a),c[d][g].push(a),this.count++)}},c.prototype.clear=function(){this._pool={};this.count=0},c.prototype._clean=function(a){a._owner=null},c}(f.default));f.default.register("material",a);m.default=a;n.exports=m.default},{"../../utils/pool":222,"./utils":55}],55:[function(f,n,m){m.__esModule=!0;var h=function(e){return e&&e.__esModule?e:{default:e}}(f("../../../renderer/enums"));m.default=
{serializeDefines:function(e){var d="",b;for(b in e)d+=b+e[b];return d},serializeTechniques:function(e){for(var d="",b=0;b<e.length;b++){var a=e[b];d+=a.stageIDs;for(var c=0;c<a.passes.length;c++){var g=a.passes[c];var k=g._programName+g._cullMode;g=(g._blend&&(k+=g._blendEq+g._blendAlphaEq+g._blendSrc+g._blendDst+g._blendSrcAlpha+g._blendDstAlpha+g._blendColor),g._depthTest&&(k+=g._depthWrite+g._depthFunc),g._stencilTest&&(k+=g._stencilFuncFront+g._stencilRefFront+g._stencilMaskFront+g._stencilFailOpFront+
g._stencilZFailOpFront+g._stencilZPassOpFront+g._stencilWriteMaskFront+g._stencilFuncBack+g._stencilRefBack+g._stencilMaskBack+g._stencilFailOpBack+g._stencilZFailOpBack+g._stencilZPassOpBack+g._stencilWriteMaskBack),k);d+=g}}return d},serializeUniforms:function(e){var d="",b;for(b in e){var a=e[b],c=a.value;c&&(a.type===h.default.PARAM_TEXTURE_2D||a.type===h.default.PARAM_TEXTURE_CUBE?d+=c._id+";":d+=c.toString()+";")}return d}};n.exports=m.default},{"../../../renderer/enums":275}],56:[function(f,
n,m){function h(c,d){var g,k,l,e=d._target;if(e)a:{for(var v=g=e,f=k=b,h=l=a,x=c._parent.scaleX,y=c._parent.scaleY,u=0,B=0,m=c._parent;;){if(u+=m.x,B+=m.y,!(m=m._parent)){f.x=f.y=0;h.x=h.y=1;break a}if(m===v)break;var z=m.scaleX,A=m.scaleY;u*=z;B*=A;x*=z;y*=A}h.x=0!==x?1/x:1;h.y=0!==y?1/y:1;f.x=-u;f.y=-B}else g=c._parent;v=g instanceof cc.Scene?cc.visibleRect:g._contentSize;f=g._anchorPoint;g=g instanceof cc.Scene;x=c.x;y=c.y;h=c._anchorPoint;if(d._alignFlags&56){var D,n;B=v.width;g?(D=cc.visibleRect.left.x,
n=cc.visibleRect.right.x):n=(D=-f.x*B)+B;D+=d._isAbsLeft?d._left:d._left*B;n-=d._isAbsRight?d._right:d._right*B;e&&(D+=k.x,D*=l.x,n+=k.x,n*=l.x);u=h.x;m=c.scaleX;(0>m&&(u=1-u,m=-m),d.isStretchWidth)?(x=n-D,0!==m&&(c.width=x/m),x=D+u*x):(x=c.width*m,d.isAlignHorizontalCenter)?(D=d._isAbsHorizontalCenter?d._horizontalCenter:d._horizontalCenter*B,n=(.5-f.x)*v.width,e&&(D*=l.x,n+=k.x,n*=l.x),x=n+(u-.5)*x+D):x=d.isAlignLeft?D+u*x:n+(u-1)*x}if(d._alignFlags&7){var F,G;D=v.height;g?(G=cc.visibleRect.bottom.y,
F=cc.visibleRect.top.y):F=(G=-f.y*D)+D;G+=d._isAbsBottom?d._bottom:d._bottom*D;F-=d._isAbsTop?d._top:d._top*D;e&&(G+=k.y,G*=l.y,F+=k.y,F*=l.y);g=h.y;h=c.scaleY;(0>h&&(g=1-g,h=-h),d.isStretchHeight)?(n=F-G,0!==h&&(c.height=n/h),y=G+g*n):(n=c.height*h,d.isAlignVerticalCenter)?(d=d._isAbsVerticalCenter?d._verticalCenter:d._verticalCenter*D,F=(.5-f.y)*v.height,e&&(d*=l.y,F+=k.y,F*=l.y),y=F+(g-.5)*n+d):y=d.isAlignBottom?G+g*n:F+(g-1)*n}c.setPosition(x,y)}function e(a){var b=a._widget;b&&(h(a,b),b.alignMode!==
d.ALWAYS?b.enabled=!1:c.push(b));a=a._children;for(b=0;b<a.length;b++){var g=a[b];g._active&&e(g)}}f("../CCNode").EventType;var d=cc.Enum({ONCE:0,ON_WINDOW_RESIZE:1,ALWAYS:2}),b=cc.Vec2.ZERO,a=cc.Vec2.ONE,c=[],g=cc._widgetManager=n.exports={_AlignFlags:{TOP:1,MID:2,BOT:4,LEFT:8,CENTER:16,RIGHT:32},isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new cc.js.array.MutableForwardIterator(c),init:function(a){cc.sys.isMobile?window.addEventListener("resize",this.onResized.bind(this)):cc.view.on("canvas-resize",
this.onResized,this)},checkRefreshScene:function(){var a=cc.director.getScene();if(a){if(g.isAligning=!0,g._nodesOrderDirty)c.length=0,e(a),g._nodesOrderDirty=!1;else{var b;a=g._activeWidgetsIterator;for(a.i=0;a.i<c.length;++a.i)h((b=c[a.i]).node,b)}g.isAligning=!1}},add:function(a){a.node._widget=a;this._nodesOrderDirty=!0},remove:function(a){a.node._widget=null;this._activeWidgetsIterator.remove(a)},onResized:function(){var a=cc.director.getScene();a&&this.refreshWidgetOnResized(a)},refreshWidgetOnResized:function(a){var c=
cc.Node.isNode(a)&&a.getComponent(cc.Widget);c&&c.alignMode===d.ON_WINDOW_RESIZE&&(c.enabled=!0);a=a._children;for(c=0;c<a.length;c++)this.refreshWidgetOnResized(a[c])},updateAlignment:function q(a){var c=a._parent;cc.Node.isNode(c)&&q(c);var b=a._widget||a.getComponent(cc.Widget);b&&c&&h(a,b)},AlignMode:d}},{"../CCNode":30}],57:[function(f,n,m){function h(){if(x){var a=x.getNode(),c=cc.game.canvas;a.z=c.height/1.1566;a.x=c.width/2;a.y=c.height/2}}var e=function(a){return a&&a.__esModule?a:{default:a}}(f("../geom-utils")),
d=f("../utils/affine-transform"),b=f("../renderer/index"),a=f("../renderer/render-flow"),c=f("../CCGame"),g=null;g=f("../../renderer/scene/camera");var k=cc.vmath.mat4,l=cc.vmath.vec2,q=cc.vmath.vec3,r=k.create(),t=k.create(),p=cc.v3(),v=cc.v3(),w=cc.v3(),E=[],x=null;f=cc.Enum({COLOR:1,DEPTH:2,STENCIL:4});var y=cc.Enum({OPAQUE:1,TRANSPARENT:2});f=cc.Class({name:"cc.Camera",extends:cc.Component,ctor:function(){if(c.renderType!==c.RENDER_TYPE_CANVAS){var a=new g;a.setStages(["opaque"]);a.dirty=!0;this._inited=
!1;this._camera=a}else this._inited=!0},editor:!1,properties:{_cullingMask:4294967295,_clearFlags:f.DEPTH|f.STENCIL,_backgroundColor:cc.color(0,0,0,255),_depth:0,_zoomRatio:1,_targetTexture:null,_fov:60,_orthoSize:10,_nearClip:1,_farClip:4096,_ortho:!0,_rect:cc.rect(0,0,1,1),_renderStages:1,_alignWithScreen:!0,zoomRatio:{get:function(){return this._zoomRatio},set:function(a){this._zoomRatio=a},tooltip:!1},fov:{get:function(){return this._fov},set:function(a){this._fov=a},tooltip:!1},orthoSize:{get:function(){return this._orthoSize},
set:function(a){this._orthoSize=a},tooltip:!1},nearClip:{get:function(){return this._nearClip},set:function(a){this._nearClip=a;this._updateClippingpPlanes()},tooltip:!1},farClip:{get:function(){return this._farClip},set:function(a){this._farClip=a;this._updateClippingpPlanes()},tooltip:!1},ortho:{get:function(){return this._ortho},set:function(a){this._ortho=a;this._updateProjection()},tooltip:!1},rect:{get:function(){return this._rect},set:function(a){this._rect=a;this._updateRect()},tooltip:!1},
cullingMask:{get:function(){return this._cullingMask},set:function(a){this._cullingMask=a;this._updateCameraMask()},tooltip:!1},clearFlags:{get:function(){return this._clearFlags},set:function(a){this._clearFlags=a;this._camera&&this._camera.setClearFlags(a)},tooltip:!1},backgroundColor:{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a;this._updateBackgroundColor()},tooltip:!1},depth:{get:function(){return this._depth},set:function(a){this._depth=a;this._camera&&
this._camera.setPriority(a)},tooltip:!1},targetTexture:{get:function(){return this._targetTexture},set:function(a){this._targetTexture=a;this._updateTargetTexture()},tooltip:!1},renderStages:{get:function(){return this._renderStages},set:function(a){this._renderStages=a;this._updateStages()},tooltip:!1},alignWithScreen:{get:function(){return this._alignWithScreen},set:function(a){this._alignWithScreen=a}},_is3D:{get:function(){return this.node&&this.node._is3DNode}}},statics:{main:null,cameras:E,
ClearFlags:f,findCamera:function(a){for(var c=0,b=E.length;c<b;c++){var d=E[c];if(d.containsNode(a))return d}return null},_findRendererCamera:function(a){for(var c=b.scene._cameras,d=0;d<c._count;d++)if(c._data[d]._cullingMask&a._cullingMask)return c._data[d];return null},_setupDebugCamera:function(){if(!x&&c.renderType!==c.RENDER_TYPE_CANVAS){var a=new g;x=a;a.setStages(["opaque"]);a.setFov(60*Math.PI/180);a.setNear(.1);a.setFar(4096);a.dirty=!0;a.cullingMask=1<<cc.Node.BuiltinGroupIndex.DEBUG;a.setPriority(cc.macro.MAX_ZINDEX);
a.setClearFlags(0);a.setColor(0,0,0,0);var d=new cc.Node;a.setNode(d);h();cc.view.on("design-resolution-changed",h);b.scene.addCamera(a)}}},_updateCameraMask:function(){this._camera&&(this._camera.cullingMask=this._cullingMask&~(1<<cc.Node.BuiltinGroupIndex.DEBUG))},_updateBackgroundColor:function(){if(this._camera){var a=this._backgroundColor;this._camera.setColor(a.r/255,a.g/255,a.b/255,a.a/255)}},_updateTargetTexture:function(){if(this._camera){var a=this._targetTexture;this._camera.setFrameBuffer(a?
a._framebuffer:null)}},_updateClippingpPlanes:function(){this._camera&&(this._camera.setNear(this._nearClip),this._camera.setFar(this._farClip))},_updateProjection:function(){this._camera&&this._camera.setType(this._ortho?1:0)},_updateRect:function(){if(this._camera){var a=this._rect;this._camera.setRect(a.x,a.y,a.width,a.height)}},_updateStages:function(){var a=this._renderStages,c=[];a&y.OPAQUE&&c.push("opaque");a&y.TRANSPARENT&&c.push("transparent");this._camera.setStages(c)},_init:function(){if(!this._inited){this._inited=
!0;var a=this._camera;a&&(a.setNode(this.node),a.setClearFlags(this._clearFlags),a.setPriority(this._depth),this._updateBackgroundColor(),this._updateCameraMask(),this._updateTargetTexture(),this._updateClippingpPlanes(),this._updateProjection(),this._updateStages(),this._updateRect(),this.beforeDraw())}},onLoad:function(){this._init()},onEnable:function(){c.renderType!==c.RENDER_TYPE_CANVAS&&(cc.director.on(cc.Director.EVENT_BEFORE_DRAW,this.beforeDraw,this),b.scene.addCamera(this._camera));E.push(this)},
onDisable:function(){c.renderType!==c.RENDER_TYPE_CANVAS&&(cc.director.off(cc.Director.EVENT_BEFORE_DRAW,this.beforeDraw,this),b.scene.removeCamera(this._camera));cc.js.array.remove(E,this)},getScreenToWorldMatrix2D:function(a){return this.getWorldToScreenMatrix2D(a),k.invert(a,a),a},getWorldToScreenMatrix2D:function(a){this.node.getWorldRT(r);var c=this.zoomRatio,b=r.m;b[0]*=c;b[1]*=c;b[4]*=c;b[5]*=c;c=b[12];var d=b[13],g=cc.visibleRect.center;return b[12]=g.x-(b[0]*c+b[4]*d),b[13]=g.y-(b[1]*c+b[5]*
d),a!==r&&k.copy(a,r),a},getScreenToWorldPoint:function(a,c){return this.node.is3DNode?(c=c||new cc.Vec3,this._camera.screenToWorld(c,a,cc.visibleRect.width,cc.visibleRect.height)):(c=c||new cc.Vec2,this.getScreenToWorldMatrix2D(r),l.transformMat4(c,a,r)),c},getWorldToScreenPoint:function(a,c){return this.node.is3DNode?(c=c||new cc.Vec3,this._camera.worldToScreen(c,a,cc.visibleRect.width,cc.visibleRect.height)):(c=c||new cc.Vec2,this.getWorldToScreenMatrix2D(r),l.transformMat4(c,a,r)),c},getRay:function(a){return e.default?
(q.set(w,a.x,a.y,1),this._camera.screenToWorld(v,w,cc.visibleRect.width,cc.visibleRect.height),this.ortho?(q.set(w,a.x,a.y,-1),this._camera.screenToWorld(p,w,cc.visibleRect.width,cc.visibleRect.height)):this.node.getWorldPosition(p),e.default.Ray.fromPoints(e.default.Ray.create(),p,v)):a},containsNode:function(a){return a._cullingMask&this.cullingMask},render:function(c){if(!(c=c||cc.director.getScene()))return null;this.node.getWorldMatrix(r);this.beforeDraw();a.render(c);b._forward.renderCamera(this._camera,
b.scene)},_onAlignWithScreen:function(){var a=cc.game.canvas.height/cc.view._scaleY;this._targetTexture&&(a=cc.visibleRect.height);var c=this._fov*cc.macro.RAD;this.node.z=a/(2*Math.tan(c/2));c=2*Math.atan(Math.tan(c/2)/this.zoomRatio);this._camera.setFov(c);this._camera.setOrthoHeight(a/2/this.zoomRatio);this.node.setRotation(0,0,0,1)},beforeDraw:function(){if(this._camera){if(this._alignWithScreen)this._onAlignWithScreen();else{var a=this._fov*cc.macro.RAD;a=2*Math.atan(Math.tan(a/2)/this.zoomRatio);
this._camera.setFov(a);this._camera.setOrthoHeight(this._orthoSize*this.zoomRatio)}this._camera.dirty=!0}}});cc.js.mixin(f.prototype,{getNodeToCameraTransform:function(a){var c=d.identity();return a.getWorldMatrix(t),this.containsNode(a)&&(this.getWorldToCameraMatrix(r),k.mul(t,t,r)),d.fromMat4(c,t),c},getCameraToWorldPoint:function(a,c){return this.getScreenToWorldPoint(a,c)},getWorldToCameraPoint:function(a,c){return this.getWorldToScreenPoint(a,c)},getCameraToWorldMatrix:function(a){return this.getScreenToWorldMatrix2D(a)},
getWorldToCameraMatrix:function(a){return this.getWorldToScreenMatrix2D(a)}});n.exports=cc.Camera=f},{"../../renderer/scene/camera":300,"../CCGame":29,"../geom-utils":void 0,"../renderer/index":178,"../renderer/render-flow":179,"../utils/affine-transform":211}],58:[function(f,n,m){function h(a,c){var b=c.constructor._executionOrder;c=c._id;for(var d=0,g=a.length-1,k=g>>>1;d<=g;k=d+g>>>1){var l=a[k],e=l.constructor._executionOrder;if(e>b)g=k-1;else if(e<b)d=k+1;else if(l=l._id,l>c)g=k-1;else{if(!(l<
c))return k;d=k+1}}return~d}function e(a,c){for(var b=a.array,d=a.i+1;d<b.length;){var g=b[d];g._enabled&&g.node._activeInHierarchy?++d:(a.removeAt(d),c&&(g._objFlags&=~c))}}function d(a,c){return a.constructor._executionOrder-c.constructor._executionOrder}function b(a,c,b,d){var g="var a=it.array;for(it.i=0;it.i<a.length;++it.i){var c=a[it.i];"+a+"}";return d=c?Function("it","dt",g):Function("it",g),a=Function("c","dt",a),function(c,g){try{d(c,g)}catch(z){cc._throw(z);var k=c.array;b&&(k[c.i]._objFlags|=
b);for(++c.i;c.i<k.length;++c.i)try{a(k[c.i],g)}catch(A){cc._throw(A),b&&(k[c.i]._objFlags|=b)}}}}function a(){this.startInvoker=new l(r);this.updateInvoker=new q(t);this.lateUpdateInvoker=new q(p);this.scheduleInNextFrame=[];this._updating=!1}f("./platform/CCClass");m=f("./platform/CCObject").Flags;var c=f("./platform/js").array,g=m.IsStartCalled,k=m.IsOnEnableCalled;m.IsEditorOnEnableCalled;f=cc.Class({__ctor__:function(a){var b=c.MutableForwardIterator;this._zero=new b([]);this._neg=new b([]);
this._pos=new b([]);this._invoke=a},statics:{stableRemoveInactive:e},add:null,remove:null,invoke:null});var l=cc.Class({extends:f,add:function(a){var c=a.constructor._executionOrder;(0===c?this._zero:0>c?this._neg:this._pos).array.push(a)},remove:function(a){var c=a.constructor._executionOrder;(0===c?this._zero:0>c?this._neg:this._pos).fastRemove(a)},cancelInactive:function(a){e(this._zero,a);e(this._neg,a);e(this._pos,a)},invoke:function(){var a=this._neg;0<a.array.length&&(a.array.sort(d),this._invoke(a),
a.array.length=0);this._invoke(this._zero);this._zero.array.length=0;a=this._pos;0<a.array.length&&(a.array.sort(d),this._invoke(a),a.array.length=0)}}),q=cc.Class({extends:f,add:function(a){var c=a.constructor._executionOrder;if(0===c)this._zero.array.push(a);else{c=0>c?this._neg.array:this._pos.array;var b=h(c,a);0>b&&c.splice(~b,0,a)}},remove:function(a){var c=a.constructor._executionOrder;0===c?this._zero.fastRemove(a):(c=0>c?this._neg:this._pos,a=h(c.array,a),0<=a&&c.removeAt(a))},invoke:function(a){0<
this._neg.array.length&&this._invoke(this._neg,a);this._invoke(this._zero,a);0<this._pos.array.length&&this._invoke(this._pos,a)}}),r=b("c.start();c._objFlags|="+g,!1,g),t=b("c.update(dt)",!0),p=b("c.lateUpdate(dt)",!0);f=cc.Class({ctor:a,unscheduleAll:a,statics:{LifeCycleInvoker:f,OneOffInvoker:l,createInvokeImpl:b,invokeOnEnable:function(a){var c=cc.director._compScheduler,b=a.array;for(a.i=0;a.i<b.length;++a.i){var d=b[a.i];d._enabled&&(d.onEnable(),!d.node._activeInHierarchy||c._onEnabled(d))}}},
_onEnabled:function(a){cc.director.getScheduler().resumeTarget(a);a._objFlags|=k;this._updating?this.scheduleInNextFrame.push(a):this._scheduleImmediate(a)},_onDisabled:function(a){cc.director.getScheduler().pauseTarget(a);a._objFlags&=~k;var b=this.scheduleInNextFrame.indexOf(a);0<=b?c.fastRemoveAt(this.scheduleInNextFrame,b):(!a.start||a._objFlags&g||this.startInvoker.remove(a),a.update&&this.updateInvoker.remove(a),a.lateUpdate&&this.lateUpdateInvoker.remove(a))},enableComp:function(a,c){if(!(a._objFlags&
k)){if(a.onEnable){if(c)return void c.add(a);if(a.onEnable(),!a.node._activeInHierarchy)return}this._onEnabled(a)}},disableComp:function(a){a._objFlags&k&&(a.onDisable&&a.onDisable(),this._onDisabled(a))},_scheduleImmediate:function(a){!a.start||a._objFlags&g||this.startInvoker.add(a);a.update&&this.updateInvoker.add(a);a.lateUpdate&&this.lateUpdateInvoker.add(a)},_deferredSchedule:function(){for(var a=this.scheduleInNextFrame,c=0,b=a.length;c<b;c++)this._scheduleImmediate(a[c]);a.length=0},startPhase:function(){this._updating=
!0;0<this.scheduleInNextFrame.length&&this._deferredSchedule();this.startInvoker.invoke()},updatePhase:function(a){this.updateInvoker.invoke(a)},lateUpdatePhase:function(a){this.lateUpdateInvoker.invoke(a);this._updating=!1}});n.exports=f},{"./platform/CCClass":130,"./platform/CCObject":136,"./platform/js":150,"./utils/misc":220}],59:[function(f,n,m){var h=f("../../animation/animation-animator"),e=f("../../animation/animation-clip");m=f("../event/event-target");var d=f("../platform/js"),b=cc.Enum({PLAY:"play",
STOP:"stop",PAUSE:"pause",RESUME:"resume",LASTFRAME:"lastframe",FINISHED:"finished"});f=cc.Class({name:"cc.Animation",extends:f("./CCComponent"),mixins:[m],editor:!1,statics:{EventType:b},ctor:function(){cc.EventTarget.call(this);this._animator=null;this._nameToState=d.createMap(!0);this._didInit=!1;this._currentClip=null},properties:{_defaultClip:{default:null,type:e},defaultClip:{type:e,get:function(){return this._defaultClip},set:function(a){},tooltip:!1},currentClip:{get:function(){return this._currentClip},
set:function(a){this._currentClip=a},type:e,visible:!1},_writableClips:{get:function(){return this._clips},set:function(a){this._didInit=!1;this._clips=a;this._init()},type:[e]},_clips:{default:[],type:[e],tooltip:!1,visible:!0},playOnLoad:{default:!1,tooltip:!1}},start:function(){if(this.playOnLoad&&this._defaultClip&&(!this._animator||!this._animator.isPlaying)){var a=this.getAnimationState(this._defaultClip.name);this._animator.playState(a)}},onEnable:function(){this._animator&&this._animator.resume()},
onDisable:function(){this._animator&&this._animator.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(a,c){a=this.playAdditive(a,c);return this._animator.stopStatesExcept(a),a},playAdditive:function(a,c){this._init();if(a=this.getAnimationState(a||this._defaultClip&&this._defaultClip.name)){this.enabled=!0;var b=this._animator;b.isPlaying&&a.isPlaying?a.isPaused?b.resumeState(a):(b.stopState(a),b.playState(a,c)):b.playState(a,c);this.enabledInHierarchy||
b.pause();this.currentClip=a.clip}return a},stop:function(a){this._didInit&&(a?(a=this._nameToState[a])&&this._animator.stopState(a):this._animator.stop())},pause:function(a){this._didInit&&(a?(a=this._nameToState[a])&&this._animator.pauseState(a):this.enabled=!1)},resume:function(a){this._didInit&&(a?(a=this._nameToState[a])&&this._animator.resumeState(a):this.enabled=!0)},setCurrentTime:function(a,c){(this._init(),c)?(c=this._nameToState[c])&&this._animator.setStateTime(c,a):this._animator.setStateTime(a)},
getAnimationState:function(a){this._init();a=this._nameToState[a];return a&&!a.curveLoaded&&this._animator._reloadClip(a),a||null},addClip:function(a,c){if(a){this._init();cc.js.array.contains(this._clips,a)||this._clips.push(a);c=c||a.name;var b=this._nameToState[c];if(b){if(b.clip===a)return b;b=this._clips.indexOf(b.clip);-1!==b&&this._clips.splice(b,1)}a=new cc.AnimationState(a,c);return this._nameToState[c]=a,a}cc.warnID(3900)},removeClip:function(a,c){if(a){this._init();var b=void 0,d;for(d in this._nameToState)if((b=
this._nameToState[d]).clip===a)break;if(a===this._defaultClip){if(!c)return void cc.warnID(3902);this._defaultClip=null}if(b&&b.isPlaying){if(!c)return void cc.warnID(3903);this.stop(b.name)}this._clips=this._clips.filter(function(c){return c!==a});b&&delete this._nameToState[b.name]}else cc.warnID(3901)},sample:function(a){(this._init(),a)?(a=this._nameToState[a])&&a.sample():this._animator.sample()},on:function(a,c,b,d){this._init();c=this._EventTargetOn(a,c,b,d);if("lastframe"===a){a=this._nameToState;
for(var g in a)a[g]._lastframeEventOn=!0}return c},off:function(a,c,b,d){if(this._init(),"lastframe"===a){var g=this._nameToState,k;for(k in g)g[k]._lastframeEventOn=!1}this._EventTargetOff(a,c,b,d)},_init:function(){this._didInit||(this._didInit=!0,this._animator=new h(this.node,this),this._createStates())},_createStates:function(){this._nameToState=d.createMap(!0);for(var a=null,c=!1,b=0;b<this._clips.length;++b){var k=this._clips[b];if(k){a=new cc.AnimationState(k);this._nameToState[a.name]=a;
var l=this._defaultClip;(l===k||l&&k&&(l.name===k.name||l._uuid===k._uuid))&&(c=a)}}this._defaultClip&&!c&&(a=new cc.AnimationState(this._defaultClip),this._nameToState[a.name]=a)}});f.prototype._EventTargetOn=m.prototype.on;f.prototype._EventTargetOff=m.prototype.off;cc.Animation=n.exports=f},{"../../animation/animation-animator":9,"../../animation/animation-clip":10,"../event/event-target":99,"../platform/js":150,"./CCComponent":64}],60:[function(f,n,m){var h=f("../utils/misc");m=f("./CCComponent");
var e=f("../assets/CCAudioClip");f=cc.Class({name:"cc.AudioSource",extends:m,editor:!1,ctor:function(){this.audio=new cc.Audio},properties:{_clip:{default:null,type:e},_volume:1,_mute:!1,_loop:!1,_pausedFlag:{default:!1,serializable:!1},isPlaying:{get:function(){return this.audio.getState()===cc.Audio.State.PLAYING},visible:!1},clip:{get:function(){return this._clip},set:function(d){if("string"!=typeof d)d!==this._clip&&(this._clip=d,this.audio.stop(),this.preload&&(this.audio.src=this._clip));else{cc.warnID(8401,
"cc.AudioSource","cc.AudioClip","AudioClip","cc.AudioClip","audio");var b=this;e._loadByUrl(d,function(a,c){c&&(b.clip=c)})}},type:e,tooltip:!1,animatable:!1},volume:{get:function(){return this._volume},set:function(d){return d=h.clamp01(d),this._volume=d,this._mute||this.audio.setVolume(d),d},tooltip:!1},mute:{get:function(){return this._mute},set:function(d){return this._mute=d,this.audio.setVolume(d?0:this._volume),d},animatable:!1,tooltip:!1},loop:{get:function(){return this._loop},set:function(d){return this._loop=
d,this.audio.setLoop(d),d},animatable:!1,tooltip:!1},playOnLoad:{default:!1,tooltip:!1,animatable:!1},preload:{default:!1,animatable:!1}},_ensureDataLoaded:function(){this.audio.src!==this._clip&&(this.audio.src=this._clip)},_pausedCallback:function(){this.audio.getState()===cc.Audio.State.PLAYING&&(this.audio.pause(),this._pausedFlag=!0)},_restoreCallback:function(){this._pausedFlag&&this.audio.resume();this._pausedFlag=!1},onLoad:function(){this.audio.setVolume(this._mute?0:this._volume);this.audio.setLoop(this._loop)},
onEnable:function(){this.preload&&(this.audio.src=this._clip);this.playOnLoad&&this.play();cc.game.on(cc.game.EVENT_HIDE,this._pausedCallback,this);cc.game.on(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDisable:function(){this.stop();cc.game.off(cc.game.EVENT_HIDE,this._pausedCallback,this);cc.game.off(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDestroy:function(){this.stop();this.audio.destroy();cc.audioEngine.uncache(this._clip)},play:function(){if(this._clip){var d=this.audio;this._clip.loaded&&
d.stop();this._ensureDataLoaded();d.setCurrentTime(0);d.play()}},stop:function(){this.audio.stop()},pause:function(){this.audio.pause()},resume:function(){this._ensureDataLoaded();this.audio.resume()},rewind:function(){this.audio.setCurrentTime(0)},getCurrentTime:function(){return this.audio.getCurrentTime()},setCurrentTime:function(d){return this.audio.setCurrentTime(d),d},getDuration:function(){return this.audio.getDuration()}});cc.AudioSource=n.exports=f},{"../assets/CCAudioClip":35,"../utils/misc":220,
"./CCComponent":64}],61:[function(f,n,m){function h(d){d.stopPropagation()}var e="touchstart touchmove touchend mousedown mousemove mouseup mouseenter mouseleave mousewheel".split(" ");f=cc.Class({name:"cc.BlockInputEvents",extends:f("./CCComponent"),editor:{menu:"i18n:MAIN_MENU.component.ui/Block Input Events",inspector:"packages://inspector/inspectors/comps/block-input-events.js",help:"i18n:COMPONENT.help_url.block_input_events"},onEnable:function(){for(var d=0;d<e.length;d++)this.node.on(e[d],
h,this)},onDisable:function(){for(var d=0;d<e.length;d++)this.node.off(e[d],h,this)}});cc.BlockInputEvents=n.exports=f},{"./CCComponent":64}],62:[function(f,n,m){m=f("./CCComponent");f=f("../utils/gray-sprite-state");var h=cc.Enum({NONE:0,COLOR:1,SPRITE:2,SCALE:3}),e=cc.Enum({NORMAL:0,HOVER:1,PRESSED:2,DISABLED:3});f=cc.Class({name:"cc.Button",extends:m,mixins:[f],ctor:function(){this._hovered=this._pressed=!1;this._toColor=this._fromColor=null;this._time=0;this._transitionFinished=!0;this._toScale=
this._fromScale=cc.Vec2.ZERO;this._sprite=this._spriteMaterial=this._graySpriteMaterial=this._originalScale=null},editor:!1,properties:{interactable:{default:!0,tooltip:!1,notify:function(){this._updateState(!0);this.interactable||this._resetState()},animatable:!1},_resizeToTarget:{animatable:!1,set:function(d){d&&this._resizeNodeToTargetNode()}},enableAutoGrayEffect:{default:!1,tooltip:!1,notify:function(){this._updateDisabledState()}},transition:{default:h.NONE,tooltip:!1,type:h,animatable:!1,notify:function(d){this._updateTransition(d)},
formerlySerializedAs:"transition"},normalColor:{default:cc.Color.WHITE,displayName:"Normal",tooltip:!1,notify:function(){this.transition===h.Color&&this._getButtonState()===e.NORMAL&&(this._getTarget().opacity=this.normalColor.a);this._updateState()}},pressedColor:{default:cc.color(211,211,211),displayName:"Pressed",tooltip:!1,notify:function(){this.transition===h.Color&&this._getButtonState()===e.PRESSED&&(this._getTarget().opacity=this.pressedColor.a);this._updateState()},formerlySerializedAs:"pressedColor"},
hoverColor:{default:cc.Color.WHITE,displayName:"Hover",tooltip:!1,notify:function(){this.transition===h.Color&&this._getButtonState()===e.HOVER&&(this._getTarget().opacity=this.hoverColor.a);this._updateState()},formerlySerializedAs:"hoverColor"},disabledColor:{default:cc.color(124,124,124),displayName:"Disabled",tooltip:!1,notify:function(){this.transition===h.Color&&this._getButtonState()===e.DISABLED&&(this._getTarget().opacity=this.disabledColor.a);this._updateState()}},duration:{default:.1,range:[0,
10],tooltip:!1},zoomScale:{default:1.2,tooltip:!1},normalSprite:{default:null,type:cc.SpriteFrame,displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedSprite:{default:null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:!1,formerlySerializedAs:"pressedSprite",notify:function(){this._updateState()}},hoverSprite:{default:null,type:cc.SpriteFrame,displayName:"Hover",tooltip:!1,formerlySerializedAs:"hoverSprite",notify:function(){this._updateState()}},disabledSprite:{default:null,
type:cc.SpriteFrame,displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},target:{default:null,type:cc.Node,tooltip:!1,notify:function(d){this._applyTarget();d&&this.target!==d&&this._unregisterTargetEvent(d)}},clickEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Transition:h},__preload:function(){this._applyTarget();this._resetState()},_resetState:function(){this._hovered=this._pressed=!1;var d=this._getTarget(),b=this.transition,a=this._originalScale;
b===h.COLOR&&this.interactable?this._setTargetColor(this.normalColor):b===h.SCALE&&a&&d.setScale(a.x,a.y);this._transitionFinished=!0},onEnable:function(){this.normalSprite&&this.normalSprite.ensureLoadTexture();this.hoverSprite&&this.hoverSprite.ensureLoadTexture();this.pressedSprite&&this.pressedSprite.ensureLoadTexture();this.disabledSprite&&this.disabledSprite.ensureLoadTexture();this._registerNodeEvent()},onDisable:function(){this._resetState();this._unregisterNodeEvent()},_getTarget:function(){return this.target?
this.target:this.node},_onTargetSpriteFrameChanged:function(d){this.transition===h.SPRITE&&this._setCurrentStateSprite(d.spriteFrame)},_onTargetColorChanged:function(d){this.transition===h.COLOR&&this._setCurrentStateColor(d)},_onTargetScaleChanged:function(){var d=this._getTarget();this._originalScale&&(this.transition!==h.SCALE||this._transitionFinished)&&(this._originalScale.x=d.scaleX,this._originalScale.y=d.scaleY)},_setTargetColor:function(d){var b=this._getTarget();b.color=d;b.opacity=d.a},
_getStateColor:function(d){switch(d){case e.NORMAL:return this.normalColor;case e.HOVER:return this.hoverColor;case e.PRESSED:return this.pressedColor;case e.DISABLED:return this.disabledColor}},_getStateSprite:function(d){switch(d){case e.NORMAL:return this.normalSprite;case e.HOVER:return this.hoverSprite;case e.PRESSED:return this.pressedSprite;case e.DISABLED:return this.disabledSprite}},_setCurrentStateColor:function(d){switch(this._getButtonState()){case e.NORMAL:this.normalColor=d;break;case e.HOVER:this.hoverColor=
d;break;case e.PRESSED:this.pressedColor=d;break;case e.DISABLED:this.disabledColor=d}},_setCurrentStateSprite:function(d){switch(this._getButtonState()){case e.NORMAL:this.normalSprite=d;break;case e.HOVER:this.hoverSprite=d;break;case e.PRESSED:this.pressedSprite=d;break;case e.DISABLED:this.disabledSprite=d}},update:function(d){var b=this._getTarget();this._transitionFinished||this.transition!==h.COLOR&&this.transition!==h.SCALE||(this.time+=d,d=1,(0<this.duration&&(d=this.time/this.duration),
1<=d&&(d=1),this.transition===h.COLOR)?(b=this._fromColor.lerp(this._toColor,d),this._setTargetColor(b)):this.transition===h.SCALE&&this._originalScale&&(b.scale=this._fromScale.lerp(this._toScale,d)),1===d&&(this._transitionFinished=!0))},_registerNodeEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this);this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this);this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this);this.node.on(cc.Node.EventType.TOUCH_CANCEL,
this._onTouchCancel,this);this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this);this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_unregisterNodeEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this);this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this);this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this);this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this);this.node.off(cc.Node.EventType.MOUSE_ENTER,
this._onMouseMoveIn,this);this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_registerTargetEvent:function(d){d.on(cc.Node.EventType.SCALE_CHANGED,this._onTargetScaleChanged,this)},_unregisterTargetEvent:function(d){d.off(cc.Node.EventType.SCALE_CHANGED,this._onTargetScaleChanged,this)},_getTargetSprite:function(d){var b=null;return d&&(b=d.getComponent(cc.Sprite)),b},_applyTarget:function(){var d=this._getTarget();this._sprite=this._getTargetSprite(d);this._originalScale||(this._originalScale=
cc.Vec2.ZERO);this._originalScale.x=d.scaleX;this._originalScale.y=d.scaleY;this._registerTargetEvent(d)},_onTouchBegan:function(d){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),d.stopPropagation())},_onTouchMove:function(d){if(this.interactable&&this.enabledInHierarchy&&this._pressed){var b=this.node._hitTest(d.touch.getLocation()),a=this._getTarget(),c=this._originalScale;this.transition===h.SCALE&&c?b?(this._fromScale.x=c.x,this._fromScale.y=c.y,this._toScale.x=
c.x*this.zoomScale,this._toScale.y=c.y*this.zoomScale,this._transitionFinished=!1):(this.time=0,this._transitionFinished=!0,a.setScale(c.x,c.y)):this._applyTransition(b?e.PRESSED:e.NORMAL);d.stopPropagation()}},_onTouchEnded:function(d){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,d),this.node.emit("click",this)),this._pressed=!1,this._updateState(),d.stopPropagation())},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&
(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==h.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var d=this._getButtonState();this._applyTransition(d);this._updateDisabledState()},_getButtonState:function(){return this.interactable?this._pressed?e.PRESSED:this._hovered?
e.HOVER:e.NORMAL:e.DISABLED},_updateColorTransitionImmediately:function(d){d=this._getStateColor(d);this._setTargetColor(d);this._fromColor=d.clone();this._toColor=d},_updateColorTransition:function(d){if(d===e.DISABLED)this._updateColorTransitionImmediately(d);else{var b=this._getTarget();d=this._getStateColor(d);this._fromColor=b.color.clone();this._toColor=d;this.time=0;this._transitionFinished=!1}},_updateSpriteTransition:function(d){d=this._getStateSprite(d);this._sprite&&d&&(this._sprite.spriteFrame=
d)},_updateScaleTransition:function(d){d===e.PRESSED?this._zoomUp():this._zoomBack()},_zoomUp:function(){this._originalScale&&(this._fromScale.x=this._originalScale.x,this._fromScale.y=this._originalScale.y,this._toScale.x=this._originalScale.x*this.zoomScale,this._toScale.y=this._originalScale.y*this.zoomScale,this.time=0,this._transitionFinished=!1)},_zoomBack:function(){if(this._originalScale){var d=this._getTarget();this._fromScale.x=d.scaleX;this._fromScale.y=d.scaleY;this._toScale.x=this._originalScale.x;
this._toScale.y=this._originalScale.y;this.time=0;this._transitionFinished=!1}},_updateTransition:function(d){d===h.COLOR?this._updateColorTransitionImmediately(e.NORMAL):d===h.SPRITE&&this._updateSpriteTransition(e.NORMAL);this._updateState()},_applyTransition:function(d){var b=this.transition;b===h.COLOR?this._updateColorTransition(d):b===h.SPRITE?this._updateSpriteTransition(d):b===h.SCALE&&this._updateScaleTransition(d)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(){if(this._sprite){var d=
!1;this.enableAutoGrayEffect&&(this.transition===h.SPRITE&&this.disabledSprite||this.interactable||(d=!0));this._switchGrayMaterial(d,this._sprite)}}});cc.Button=n.exports=f},{"../utils/gray-sprite-state":217,"./CCComponent":64}],63:[function(f,n,m){var h=f("../camera/CCCamera");f=f("./CCComponent");var e=cc.Class({name:"cc.Canvas",extends:f,editor:!1,resetInEditor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},
set:function(d){this._designResolution.width=d.width;this._designResolution.height=d.height;this.applySettings();this.alignWithScreen()},tooltip:!1},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(d){this._fitHeight!==d&&(this._fitHeight=d,this.applySettings(),this.alignWithScreen())},tooltip:!1},fitWidth:{get:function(){return this._fitWidth},set:function(d){this._fitWidth!==d&&(this._fitWidth=d,this.applySettings(),this.alignWithScreen())},tooltip:!1}},
ctor:function(){this._thisOnResized=this.alignWithScreen.bind(this)},__preload:function(){if(e.instance)return cc.errorID(6700,this.node.name,e.instance.node.name);e.instance=this;cc.sys.isMobile?window.addEventListener("resize",this._thisOnResized):cc.view.on("canvas-resize",this._thisOnResized);this.applySettings();this.alignWithScreen();var d=cc.find("Main Camera",this.node);d||((d=new cc.Node("Main Camera")).parent=this.node,d.setSiblingIndex(0));var b=d.getComponent(h);b||(b=d.addComponent(h),
d=h.ClearFlags,b.clearFlags=d.COLOR|d.DEPTH|d.STENCIL,b.depth=-1);h.main=b},onDestroy:function(){cc.sys.isMobile?window.removeEventListener("resize",this._thisOnResized):cc.view.off("canvas-resize",this._thisOnResized);e.instance===this&&(e.instance=null)},alignWithScreen:function(){var d,b=d=cc.visibleRect;var a=cc.view.getDesignResolutionSize();var c=0,g=0;!this.fitHeight&&!this.fitWidth&&(c=.5*(a.width-b.width),g=.5*(a.height-b.height));this.node.setPosition(.5*b.width+c,.5*b.height+g);this.node.width=
d.width;this.node.height=d.height},applySettings:function(){var d=cc.ResolutionPolicy,b=this._designResolution;cc.view.setDesignResolutionSize(b.width,b.height,this.fitHeight&&this.fitWidth?d.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?d.FIXED_WIDTH:d.FIXED_HEIGHT:d.NO_BORDER)}});cc.Canvas=n.exports=e},{"../camera/CCCamera":57,"./CCComponent":64}],64:[function(f,n,m){var h=f("../platform/CCObject");m=f("../platform/js");var e=new (f("../platform/id-generater"))("Comp"),d=(h.Flags.IsOnEnableCalled,
h.Flags.IsOnLoadCalled);f=cc.Class({name:"cc.Component",extends:h,ctor:function(){this._id=e.getNewId();this.__eventTargets=[]},properties:{node:{default:null,visible:!1},name:{get:function(){if(this._name)return this._name;var b=cc.js.getClassName(this),a=b.lastIndexOf(".");return 0<=a&&(b=b.slice(a+1)),this.node.name+"<"+b+">"},set:function(b){this._name=b},visible:!1},uuid:{get:function(){return this._id},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(b){if(this._enabled!==
b&&(this._enabled=b,this.node._activeInHierarchy)){var a=cc.director._compScheduler;b?a.enableComp(this):a.disableComp(this)}},visible:!1,animatable:!0},enabledInHierarchy:{get:function(){return this._enabled&&this.node._activeInHierarchy},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&d}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(b){return this.node.addComponent(b)},
getComponent:function(b){return this.node.getComponent(b)},getComponents:function(b){return this.node.getComponents(b)},getComponentInChildren:function(b){return this.node.getComponentInChildren(b)},getComponentsInChildren:function(b){return this.node.getComponentsInChildren(b)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&cc.director._compScheduler.disableComp(this)},_onPreDestroy:function(){this.unscheduleAllCallbacks();for(var b=
this.__eventTargets,a=0,c=b.length;a<c;++a){var d=b[a];d&&d.targetOff(this)}b.length=0;cc.director._nodeActivator.destroyComp(this);this.node._removeComponent(this)},_instantiate:function(b){return b||(b=cc.instantiate._clone(this,this)),b.node=null,b},schedule:function(b,a,c,d){cc.assertID(b,1619);cc.assertID(0<=a,1620);a=a||0;c=isNaN(c)?cc.macro.REPEAT_FOREVER:c;d=d||0;var g=cc.director.getScheduler(),l=g.isTargetPaused(this);g.schedule(b,this,a,c,d,l)},scheduleOnce:function(b,a){this.schedule(b,
0,0,a)},unschedule:function(b){b&&cc.director.getScheduler().unschedule(b,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});f._requireComponent=null;f._executionOrder=0;m.value(f,"_registerEditorProps",function(b,a){var c=a.requireComponent;c&&(b._requireComponent=c);(a=a.executionOrder)&&"number"==typeof a&&(b._executionOrder=a)});f.prototype.__scriptUuid="";cc.Component=n.exports=f},{"../platform/CCObject":136,"../platform/id-generater":146,"../platform/js":150}],
65:[function(f,n,m){cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{default:null,type:cc.Node},component:"",_componentId:"",_componentName:{get:function(){return this._genCompIdIfNeeded(),this._compId2Name(this._componentId)},set:function(f){this._componentId=this._compName2Id(f)}},handler:{default:""},customEventData:{default:""}},statics:{emitEvents:function(f){var e=void 0;if(0<arguments.length)for(var d=0,b=(e=Array(arguments.length-1)).length;d<b;d++)e[d]=arguments[d+
1];d=0;for(b=f.length;d<b;d++){var a=f[d];a instanceof cc.Component.EventHandler&&a.emit(e)}}},emit:function(f){var e=this.target;if(cc.isValid(e)){this._genCompIdIfNeeded();var d=cc.js._getClassById(this._componentId);e=e.getComponent(d);cc.isValid(e)&&(d=e[this.handler],"function"==typeof d&&(null!=this.customEventData&&""!==this.customEventData&&(f=f.slice()).push(this.customEventData),d.apply(e,f)))}},_compName2Id:function(f){f=cc.js.getClassByName(f);return cc.js._getClassId(f)},_compId2Name:function(f){f=
cc.js._getClassById(f);return cc.js.getClassName(f)},_genCompIdIfNeeded:function(){this._componentId||(this._componentName=this.component,this.component="")}})},{}],66:[function(f,n,m){m=f("../platform/CCMacro");var h=f("./CCRenderComponent"),e=f("../assets/material/CCMaterial"),d=f("../renderer/utils/label/label-frame"),b=f("../platform/CCSys");f=m.TextAlignment;m=m.VerticalTextAlignment;var a=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3}),c=cc.Enum({NONE:0,BITMAP:1,CHAR:2}),g=cc.Class({name:"cc.Label",
extends:h,ctor:function(){this._fontSizeScale=1;this._actualFontSize=0;this._letterTexture=this._ttfTexture=this._frame=this._assemblerData=null;cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?this._activateMaterial=this._activateMaterialCanvas:this._activateMaterial=this._activateMaterialWebgl},editor:!1,properties:{_useOriginalSize:!0,_string:{default:"",formerlySerializedAs:"_N$string"},string:{get:function(){return this._string},set:function(a){var c=this._string;this._string=""+a;this.string!==
c&&this._lazyUpdateRenderData();this._checkStringEmpty()},multiline:!0,tooltip:!1},horizontalAlign:{default:f.LEFT,type:f,tooltip:!1,notify:function(a){this.horizontalAlign!==a&&this._lazyUpdateRenderData()},animatable:!1},verticalAlign:{default:m.TOP,type:m,tooltip:!1,notify:function(a){this.verticalAlign!==a&&this._lazyUpdateRenderData()},animatable:!1},actualFontSize:{displayName:"Actual Font Size",animatable:!1,readonly:!0,get:function(){return this._actualFontSize},tooltip:!1},_fontSize:40,fontSize:{get:function(){return this._fontSize},
set:function(a){this._fontSize!==a&&(this._fontSize=a,this._lazyUpdateRenderData())},range:[0,512],tooltip:!1},fontFamily:{default:"Arial",tooltip:!1,notify:function(a){this.fontFamily!==a&&this._lazyUpdateRenderData()},animatable:!1},_lineHeight:40,lineHeight:{get:function(){return this._lineHeight},set:function(a){this._lineHeight!==a&&(this._lineHeight=a,this._lazyUpdateRenderData())},tooltip:!1},overflow:{default:a.NONE,type:a,tooltip:!1,notify:function(a){this.overflow!==a&&this._lazyUpdateRenderData()},
animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return this._enableWrapText},set:function(a){this._enableWrapText!==a&&(this._enableWrapText=a,this._lazyUpdateRenderData())},animatable:!1,tooltip:!1},_N$file:null,font:{get:function(){return this._N$file},set:function(a){this.font!==a&&(a||(this._isSystemFontUsed=!0),this._N$file=a,a&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),"string"==typeof a&&cc.warnID(4E3),this._resetAssembler(),this._applyFontTexture(!0),this._lazyUpdateRenderData())},
type:cc.Font,tooltip:!1,animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(a){this._isSystemFontUsed!==a&&(this._isSystemFontUsed=!!a,a&&(this.font=null,this._resetAssembler(),this._applyFontTexture(!0),this._lazyUpdateRenderData(),this._checkStringEmpty()))},animatable:!1,tooltip:!1},_bmFontOriginalSize:{displayName:"BMFont Original Size",get:function(){return this._N$file instanceof cc.BitmapFont?this._N$file.fontSize:-1},visible:!0,animatable:!1},
_spacingX:0,spacingX:{get:function(){return this._spacingX},set:function(a){this._spacingX=a;this._lazyUpdateRenderData()},tooltip:!1},_batchAsBitmap:!1,cacheMode:{default:c.NONE,type:c,tooltip:!1,notify:function(a){this.cacheMode!==a&&(a!==c.BITMAP||this.font instanceof cc.BitmapFont||this._frame&&this._frame._resetDynamicAtlasFrame(),a===c.CHAR&&(this._ttfTexture=null),this._resetAssembler(),this._applyFontTexture(!0),this._lazyUpdateRenderData())},animatable:!1},_isBold:{default:!1,serializable:!1},
_isItalic:{default:!1,serializable:!1},_isUnderline:{default:!1,serializable:!1}},statics:{HorizontalAlign:f,VerticalAlign:m,Overflow:a,CacheMode:c,_shareAtlas:null,clearCharCache:function(){g._shareAtlas&&g._shareAtlas.clearAllCache()}},onLoad:function(){this._batchAsBitmap&&this.cacheMode===c.NONE&&(this.cacheMode=c.BITMAP,this._batchAsBitmap=!1);cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&(this.cacheMode=c.NONE)},onEnable:function(){this._super();this.node.on(cc.Node.EventType.SIZE_CHANGED,
this._lazyUpdateRenderData,this);this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._lazyUpdateRenderData,this);this._forceUpdateRenderData();this._checkStringEmpty();cc.director.once(cc.Director.EVENT_BEFORE_DRAW,this.onAfterUpdateEvent,this)},onAfterUpdateEvent:function(){(this.node._renderFlag&cc.RenderFlow.FLAG_UPDATE_RENDER_DATA)==cc.RenderFlow.FLAG_UPDATE_RENDER_DATA&&this._assembler.updateRenderData(this)},onDisable:function(){this._super();this.node.off(cc.Node.EventType.SIZE_CHANGED,this._lazyUpdateRenderData,
this);this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._lazyUpdateRenderData,this)},onDestroy:function(){this._assembler&&this._assembler._resetAssemblerData&&this._assembler._resetAssemblerData(this._assemblerData);this._letterTexture=this._assemblerData=null;this._ttfTexture&&(this._ttfTexture.destroy(),this._ttfTexture=null);this._super()},_updateColor:function(){this.font instanceof cc.BitmapFont||this._lazyUpdateRenderData();h.prototype._updateColor.call(this)},_resetAssembler:function(){this._frame=
null;h.prototype._resetAssembler.call(this)},_canRender:function(){var a=this._super(),c=this.font;c instanceof cc.BitmapFont&&((c=c.spriteFrame)&&c.textureLoaded()||(a=!1));return a},_checkStringEmpty:function(){this.markForRender(!!this.string)},_on3DNodeChanged:function(){this._resetAssembler();this._applyFontTexture(!0)},_applyFontTexture:function(a){var g=this.font;if(g instanceof cc.BitmapFont){var k=g.spriteFrame;this._frame=k;this._fontSizeScale=1;var e=this;g=function(){e._frame._texture=
k._texture;e._activateMaterial(a);a&&e._assembler&&e._assembler.updateRenderData(e)};k&&k.textureLoaded()?g():(this.disableRender(),k&&(k.once("load",g,this),k.ensureLoadTexture()))}else this._fontSizeScale=b.FONT_SCALE,this._frame||(this._frame=new d),this.cacheMode===c.CHAR?(this._letterTexture=this._assembler._getAssemblerData(),this._frame._refreshTexture(this._letterTexture)):this._ttfTexture||(this._ttfTexture=new cc.Texture2D,this._assemblerData=this._assembler._getAssemblerData(),this._ttfTexture.initWithElement(this._assemblerData.canvas)),
this.cacheMode!==c.CHAR&&(this._frame._resetDynamicAtlasFrame(),this._frame._refreshTexture(this._ttfTexture)),this._activateMaterial(a),a&&this._assembler&&this._assembler.updateRenderData(this)},_activateMaterialCanvas:function(a){a&&(this._frame._texture.url=this.uuid+"_texture",this.markForUpdateRenderData(!0),this.markForRender(!0))},_activateMaterialWebgl:function(a){a&&(this._frame?(a=this.sharedMaterials[0],(a=a?e.getInstantiatedMaterial(a,this):e.getInstantiatedBuiltinMaterial("2d-sprite",
this)).setProperty("texture",this._frame._texture),this.setMaterial(0,a),this.markForUpdateRenderData(!0),this.markForRender(!0)):this.disableRender())},_lazyUpdateRenderData:function(){this.setVertsDirty();this.markForUpdateRenderData(!0)},_forceUpdateRenderData:function(){this.setVertsDirty();this._resetAssembler();this._applyFontTexture(!0);this.markForUpdateRenderData(!0)},_enableBold:function(a){this._isBold=!!a},_enableItalics:function(a){this._isItalic=!!a},_enableUnderline:function(a){this._isUnderline=
!!a}});cc.Label=n.exports=g},{"../assets/material/CCMaterial":53,"../platform/CCMacro":135,"../platform/CCSys":139,"../renderer/utils/label/label-frame":183,"./CCRenderComponent":74}],67:[function(f,n,m){f=cc.Class({name:"cc.LabelOutline",extends:f("./CCComponent"),editor:!1,properties:{_color:cc.Color.WHITE,_width:1,color:{tooltip:!1,get:function(){return this._color},set:function(f){this._color=f;this._updateRenderData()}},width:{tooltip:!1,get:function(){return this._width},set:function(f){this._width=
f;this._updateRenderData()},range:[0,512]}},onEnable:function(){this._updateRenderData()},onDisable:function(){this._updateRenderData()},_updateRenderData:function(){var f=this.node.getComponent(cc.Label);f&&f._lazyUpdateRenderData()}});cc.LabelOutline=n.exports=f},{"./CCComponent":64}],68:[function(f,n,m){f=cc.Class({name:"cc.LabelShadow",extends:f("./CCComponent"),editor:!1,properties:{_color:cc.Color.WHITE,_offset:cc.v2(2,2),_blur:2,color:{tooltip:!1,get:function(){return this._color},set:function(f){this._color=
f;this._updateRenderData()}},offset:{tooltip:!1,get:function(){return this._offset},set:function(f){this._offset=f;this._updateRenderData()}},blur:{tooltip:!1,get:function(){return this._blur},set:function(f){this._blur=f;this._updateRenderData()},range:[0,1024]}},onEnable:function(){this._updateRenderData()},onDisable:function(){this._updateRenderData()},_updateRenderData:function(){var f=this.node.getComponent(cc.Label);f&&f._lazyUpdateRenderData()}});cc.LabelShadow=n.exports=f},{"./CCComponent":64}],
69:[function(f,n,m){var h=f("../CCNode").EventType,e=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),d=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),b=cc.Enum({HORIZONTAL:0,VERTICAL:1}),a=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),c=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),g=[];f=cc.Class({name:"cc.Layout",extends:f("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{default:!0,serializable:!1},_resize:d.NONE,_N$layoutType:e.NONE,type:{type:e,get:function(){return this._N$layoutType},
set:function(a){this._N$layoutType=a;this._doLayoutDirty()},tooltip:!1,animatable:!1},resizeMode:{type:d,tooltip:!1,animatable:!1,get:function(){return this._resize},set:function(a){this.type===e.NONE&&a===d.CHILDREN||(this._resize=a,this._doLayoutDirty())}},cellSize:{default:cc.size(40,40),tooltip:!1,type:cc.Size,notify:function(){this._doLayoutDirty()}},startAxis:{default:b.HORIZONTAL,tooltip:!1,type:b,notify:function(){this._doLayoutDirty()},animatable:!1},_N$padding:{default:0},paddingLeft:{default:0,
tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingRight:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingTop:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingBottom:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},spacingX:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},spacingY:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},verticalDirection:{default:a.TOP_TO_BOTTOM,type:a,notify:function(){this._doLayoutDirty()},
tooltip:!1,animatable:!1},horizontalDirection:{default:c.LEFT_TO_RIGHT,type:c,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},affectedByScale:{default:!1,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:!1}},statics:{Type:e,VerticalDirection:a,HorizontalDirection:c,ResizeMode:d,AxisDirection:b,UpdateLayout:function(){if(0<g.length){var a=g;g=[];for(var c=a.length-1;0<=c;c--){var b=a[c];b.node&&b.enabled&&b.updateLayout()}return!0}return!1},HasDirtyLayout:function(){return 0<
g.length}},_migratePaddingData:function(){this.paddingBottom=this.paddingTop=this.paddingRight=this.paddingLeft=this._N$padding;this._N$padding=0},onEnable:function(){this._addEventListeners();this.node.getContentSize().equals(cc.size(0,0))&&this.node.setContentSize(this._layoutSize);0!==this._N$padding&&this._migratePaddingData();this._layoutDirty||(this._layoutDirty=!0);g.push(this)},onDisable:function(){this._removeEventListeners()},_doLayoutDirty:function(){this._layoutDirty||(this._layoutDirty=
!0,g.push(this))},_doScaleDirty:function(){this._layoutDirty||this.affectedByScale&&(this._layoutDirty=!0,g.push(this))},_addEventListeners:function(){this.node.on(h.SIZE_CHANGED,this._resized,this);this.node.on(h.ANCHOR_CHANGED,this._doLayoutDirty,this);this.node.on(h.CHILD_ADDED,this._childAdded,this);this.node.on(h.CHILD_REMOVED,this._childRemoved,this);this.node.on(h.CHILD_REORDER,this._doLayoutDirty,this);this._addChildrenEventListeners()},_removeEventListeners:function(){this.node.off(h.SIZE_CHANGED,
this._resized,this);this.node.off(h.ANCHOR_CHANGED,this._doLayoutDirty,this);this.node.off(h.CHILD_ADDED,this._childAdded,this);this.node.off(h.CHILD_REMOVED,this._childRemoved,this);this.node.off(h.CHILD_REORDER,this._doLayoutDirty,this);this._removeChildrenEventListeners()},_addChildrenEventListeners:function(){for(var a=this.node.children,c=0;c<a.length;++c){var b=a[c];b.on(h.SCALE_CHANGED,this._doScaleDirty,this);b.on(h.SIZE_CHANGED,this._doLayoutDirty,this);b.on(h.POSITION_CHANGED,this._doLayoutDirty,
this);b.on(h.ANCHOR_CHANGED,this._doLayoutDirty,this);b.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}},_removeChildrenEventListeners:function(){for(var a=this.node.children,c=0;c<a.length;++c){var b=a[c];b.off(h.SCALE_CHANGED,this._doScaleDirty,this);b.off(h.SIZE_CHANGED,this._doLayoutDirty,this);b.off(h.POSITION_CHANGED,this._doLayoutDirty,this);b.off(h.ANCHOR_CHANGED,this._doLayoutDirty,this);b.off("active-in-hierarchy-changed",this._doLayoutDirty,this)}},_childAdded:function(a){a.on(h.SCALE_CHANGED,
this._doScaleDirty,this);a.on(h.SIZE_CHANGED,this._doLayoutDirty,this);a.on(h.POSITION_CHANGED,this._doLayoutDirty,this);a.on(h.ANCHOR_CHANGED,this._doLayoutDirty,this);a.on("active-in-hierarchy-changed",this._doLayoutDirty,this);this._doLayoutDirty()},_childRemoved:function(a){a.off(h.SCALE_CHANGED,this._doScaleDirty,this);a.off(h.SIZE_CHANGED,this._doLayoutDirty,this);a.off(h.POSITION_CHANGED,this._doLayoutDirty,this);a.off(h.ANCHOR_CHANGED,this._doLayoutDirty,this);a.off("active-in-hierarchy-changed",
this._doLayoutDirty,this);this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize();this._doLayoutDirty()},_doLayoutHorizontally:function(b,g,q,r){var k=this.node.getAnchorPoint(),l=this.node.children,f=1,w=this.paddingLeft,h=-k.x*b;this.horizontalDirection===c.RIGHT_TO_LEFT&&(f=-1,h=(1-k.x)*b,w=this.paddingRight);for(var x=h+f*w-f*this.spacingX,y=0,u=0,B=0,m=0,z=0,A=0,D=0,n=0;n<l.length;++n)l[n].activeInHierarchy&&D++;var F=this.cellSize.width;this.type!==e.GRID&&this.resizeMode===
d.CHILDREN&&(F=(b-(this.paddingLeft+this.paddingRight)-(D-1)*this.spacingX)/D);for(n=0;n<l.length;++n){D=l[n];var G=this._getUsedScaleValue(D.scaleX),J=this._getUsedScaleValue(D.scaleY);if(D.activeInHierarchy){this._resize===d.CHILDREN&&(D.width=F/G,this.type===e.GRID&&(D.height=this.cellSize.height/J));var N=D.anchorX;G*=D.width;var K=D.height*J;B>u&&(u=B);K>=u&&(B=u,u=K,A=D.getAnchorPoint().y);this.horizontalDirection===c.RIGHT_TO_LEFT&&(N=1-D.anchorX);x=x+f*N*G+f*this.spacingX;J=f*(1-N)*G;if(g){var P=
x+J+f*(0<f?this.paddingRight:this.paddingLeft),L=this.horizontalDirection===c.RIGHT_TO_LEFT&&P<-k.x*b;(this.horizontalDirection===c.LEFT_TO_RIGHT&&P>(1-k.x)*b||L)&&(K>=u?(0===B&&(B=u),y+=B,B=u):(y+=u,B=K,u=0),x=h+f*(w+N*G),m++)}N=q(D,y,m);b>=G+this.paddingLeft+this.paddingRight&&r&&D.setPosition(cc.v2(x,N));var M;D=0===u?K:u;this.verticalDirection===a.TOP_TO_BOTTOM?(z=z||this.node._contentSize.height,(M=N+-1*(D*A+this.paddingBottom))<z&&(z=M)):(z=z||-this.node._contentSize.height,(M=N+1*(D*A+this.paddingTop))>
z&&(z=M));x+=J}}return z},_getVerticalBaseHeight:function(a){var c=0,b=0;if(this.resizeMode===d.CONTAINER){for(var g=0;g<a.length;++g){var k=a[g];k.activeInHierarchy&&(b++,c+=k.height*this._getUsedScaleValue(k.scaleY))}c+=(b-1)*this.spacingY+this.paddingBottom+this.paddingTop}else c=this.node.getContentSize().height;return c},_doLayoutVertically:function(b,g,q,r){var k=this.node.getAnchorPoint(),l=this.node.children,f=1,w=this.paddingBottom,h=-k.y*b;this.verticalDirection===a.TOP_TO_BOTTOM&&(f=-1,
h=(1-k.y)*b,w=this.paddingTop);for(var x=h+f*w-f*this.spacingY,y=0,u=0,B=0,m=0,z=0,A=0,D=0,n=0;n<l.length;++n)l[n].activeInHierarchy&&D++;var F=this.cellSize.height;this.type!==e.GRID&&this.resizeMode===d.CHILDREN&&(F=(b-(this.paddingTop+this.paddingBottom)-(D-1)*this.spacingY)/D);for(n=0;n<l.length;++n){D=l[n];var G=this._getUsedScaleValue(D.scaleX),J=this._getUsedScaleValue(D.scaleY);if(D.activeInHierarchy){this.resizeMode===d.CHILDREN&&(D.height=F/J,this.type===e.GRID&&(D.width=this.cellSize.width/
G));var N=D.anchorY;G*=D.width;var K=D.height*J;B>u&&(u=B);G>=u&&(B=u,u=G,A=D.getAnchorPoint().x);this.verticalDirection===a.TOP_TO_BOTTOM&&(N=1-D.anchorY);x=x+f*N*K+f*this.spacingY;J=f*(1-N)*K;if(g){var P=x+J+f*(0<f?this.paddingTop:this.paddingBottom),L=this.verticalDirection===a.TOP_TO_BOTTOM&&P<-k.y*b;(this.verticalDirection===a.BOTTOM_TO_TOP&&P>(1-k.y)*b||L)&&(G>=u?(0===B&&(B=u),y+=B,B=u):(y+=u,B=G,u=0),x=h+f*(w+N*K),m++)}N=q(D,y,m);b>=K+(this.paddingTop+this.paddingBottom)&&r&&D.setPosition(cc.v2(N,
x));var M;D=1;G=0===u?G:u;this.horizontalDirection===c.RIGHT_TO_LEFT?(D=-1,z=z||this.node._contentSize.width,(M=N+D*(G*A+this.paddingLeft))<z&&(z=M)):(z=z||-this.node._contentSize.width,(M=N+D*(G*A+this.paddingRight))>z&&(z=M));x+=J}}return z},_doLayoutBasic:function(){for(var a=this.node.children,c=null,b=0;b<a.length;++b){var d=a[b];d.activeInHierarchy&&(c?c.union(c,d.getBoundingBoxToWorld()):c=d.getBoundingBoxToWorld())}c&&(a=this.node.convertToNodeSpaceAR(cc.v2(c.x,c.y)),a=cc.v2(a.x-this.paddingLeft,
a.y-this.paddingBottom),c=this.node.convertToNodeSpaceAR(cc.v2(c.xMax,c.yMax)),c=cc.v2(c.x+this.paddingRight,c.y+this.paddingTop).sub(a),0!==(c=cc.size(parseFloat(c.x.toFixed(2)),parseFloat(c.y.toFixed(2)))).width&&(this.node.anchorX=parseFloat((-a.x/c.width).toFixed(2))),0!==c.height&&(this.node.anchorY=parseFloat((-a.y/c.height).toFixed(2))),this.node.setContentSize(c))},_doLayoutGridAxisHorizontal:function(c,b){var g=b.width,k=1,l=-c.y*b.height,e=this.paddingBottom;this.verticalDirection===a.TOP_TO_BOTTOM&&
(k=-1,l=(1-c.y)*b.height,e=this.paddingTop);b=function(a,c,b){return l+k*(c+a.anchorY*a.height*this._getUsedScaleValue(a.scaleY)+e+b*this.spacingY)}.bind(this);var f=0;if(this.resizeMode===d.CONTAINER){var w=this._doLayoutHorizontally(g,!0,b,!1);0>(f=l-w)&&(f*=-1);l=-c.y*f;this.verticalDirection===a.TOP_TO_BOTTOM&&(k=-1,l=(1-c.y)*f)}this._doLayoutHorizontally(g,!0,b,!0);this.resizeMode===d.CONTAINER&&this.node.setContentSize(g,f)},_doLayoutGridAxisVertical:function(a,b){var g=b.height,k=1,l=-a.x*
b.width,e=this.paddingLeft;this.horizontalDirection===c.RIGHT_TO_LEFT&&(k=-1,l=(1-a.x)*b.width,e=this.paddingRight);b=function(a,c,b){return l+k*(c+a.anchorX*a.width*this._getUsedScaleValue(a.scaleX)+e+b*this.spacingX)}.bind(this);var f=0;if(this.resizeMode===d.CONTAINER){var w=this._doLayoutVertically(g,!0,b,!1);0>(f=l-w)&&(f*=-1);l=-a.x*f;this.horizontalDirection===c.RIGHT_TO_LEFT&&(k=-1,l=(1-a.x)*f)}this._doLayoutVertically(g,!0,b,!0);this.resizeMode===d.CONTAINER&&this.node.setContentSize(f,g)},
_doLayoutGrid:function(){var a=this.node.getAnchorPoint(),c=this.node.getContentSize();this.startAxis===b.HORIZONTAL?this._doLayoutGridAxisHorizontal(a,c):this.startAxis===b.VERTICAL&&this._doLayoutGridAxisVertical(a,c)},_getHorizontalBaseWidth:function(a){var c=0,b=0;if(this.resizeMode===d.CONTAINER){for(var g=0;g<a.length;++g){var k=a[g];k.activeInHierarchy&&(b++,c+=k.width*this._getUsedScaleValue(k.scaleX))}c+=(b-1)*this.spacingX+this.paddingLeft+this.paddingRight}else c=this.node.getContentSize().width;
return c},_doLayout:function(){if(this.type===e.HORIZONTAL){var a=this._getHorizontalBaseWidth(this.node.children);this._doLayoutHorizontally(a,!1,function(a){return a.y},!0);this.node.width=a}else this.type===e.VERTICAL?(a=this._getVerticalBaseHeight(this.node.children),this._doLayoutVertically(a,!1,function(a){return a.x},!0),this.node.height=a):this.type===e.NONE?this.resizeMode===d.CONTAINER&&this._doLayoutBasic():this.type===e.GRID&&this._doLayoutGrid()},_getUsedScaleValue:function(a){return this.affectedByScale?
Math.abs(a):1},updateLayout:function(){this._layoutDirty&&0<this.node.children.length&&this._doLayout();this._layoutDirty=!1}});Object.defineProperty(f.prototype,"padding",{get:function(){return cc.warnID(4100),this.paddingLeft},set:function(a){this._N$padding=a;this._migratePaddingData();this._doLayoutDirty()}});cc.Layout=n.exports=f},{"../CCNode":30,"./CCComponent":64}],70:[function(f,n,m){var h=function(a){return a&&a.__esModule?a:{default:a}}(f("../../renderer/gfx")),e=f("../vmath"),d=f("../utils/misc"),
b=f("../assets/material/CCMaterial");m=f("./CCRenderComponent");var a=f("../renderer/render-flow"),c=f("../graphics/graphics"),g=f("../CCNode"),k=cc.v2(),l=e.mat4.create(),q=[],r=cc.Enum({RECT:0,ELLIPSE:1,IMAGE_STENCIL:2});f=cc.Class({name:"cc.Mask",extends:m,editor:!1,ctor:function(){this._clearMaterial=this._exitMaterial=this._enableMaterial=this._graphics=null},properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:r.RECT,type:{get:function(){return this._type},set:function(a){this._type!==
a&&this._resetAssembler();this._type=a;this._type!==r.IMAGE_STENCIL&&(this.spriteFrame=null,this.alphaThreshold=0,this._updateGraphics());this._activateMaterial()},type:r,tooltip:!1},spriteFrame:{type:cc.SpriteFrame,tooltip:!1,get:function(){return this._spriteFrame},set:function(a){var c=this._spriteFrame;c!==a&&(this._spriteFrame=a,this._applySpriteFrame(c))}},alphaThreshold:{default:.1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){var a=
this.sharedMaterials[0];a&&a.setProperty("alphaThreshold",this.alphaThreshold)}else cc.warnID(4201)}},inverted:{default:!1,type:cc.Boolean,tooltip:!1,notify:function(){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS||cc.warnID(4202)}},_segments:64,segements:{get:function(){return this._segments},set:function(a){this._segments=d.clampf(a,3,1E4);this._updateGraphics()},type:cc.Integer,tooltip:!1},_resizeToTarget:{animatable:!1,set:function(a){a&&this._resizeNodeToTargetNode()}}},statics:{Type:r},onLoad:function(){this._createGraphics()},
onRestore:function(){this._createGraphics();this._type!==r.IMAGE_STENCIL?this._updateGraphics():this._applySpriteFrame()},onEnable:function(){this._super();this._type===r.IMAGE_STENCIL?this._spriteFrame&&this._spriteFrame.textureLoaded()||(this.markForRender(!1),this._spriteFrame&&(this.markForUpdateRenderData(!1),this._spriteFrame.once("load",this._onTextureLoaded,this),this._spriteFrame.ensureLoadTexture())):this._updateGraphics();this.node.on(cc.Node.EventType.POSITION_CHANGED,this._updateGraphics,
this);this.node.on(cc.Node.EventType.ROTATION_CHANGED,this._updateGraphics,this);this.node.on(cc.Node.EventType.SCALE_CHANGED,this._updateGraphics,this);this.node.on(cc.Node.EventType.SIZE_CHANGED,this._updateGraphics,this);this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._updateGraphics,this);this.node._renderFlag|=a.FLAG_POST_RENDER;this._activateMaterial()},onDisable:function(){this._super();this.node.off(cc.Node.EventType.POSITION_CHANGED,this._updateGraphics,this);this.node.off(cc.Node.EventType.ROTATION_CHANGED,
this._updateGraphics,this);this.node.off(cc.Node.EventType.SCALE_CHANGED,this._updateGraphics,this);this.node.off(cc.Node.EventType.SIZE_CHANGED,this._updateGraphics,this);this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._updateGraphics,this);this.node._renderFlag&=~(a.FLAG_RENDER|a.FLAG_POST_RENDER)},onDestroy:function(){this._super();this._removeGraphics()},_resizeNodeToTargetNode:!1,_onTextureLoaded:function(){this.setVertsDirty();this._assembler&&this._assembler._renderData&&this.markForUpdateRenderData(!0);
this.enabledInHierarchy&&this._activateMaterial()},_applySpriteFrame:function(a){a&&a.off&&a.off("load",this._onTextureLoaded,this);(a=this._spriteFrame)?a.textureLoaded()?this._onTextureLoaded(null):(a.once("load",this._onTextureLoaded,this),a.ensureLoadTexture()):this.disableRender()},_activateMaterial:function(){if(this._type!==r.IMAGE_STENCIL||this.spriteFrame&&this.spriteFrame.textureLoaded()){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){var a=this.sharedMaterials[0];if((a=a?b.getInstantiatedMaterial(a,
this):b.getInstantiatedBuiltinMaterial("2d-sprite",this)).define("USE_ALPHA_TEST",!0),this._type===r.IMAGE_STENCIL){var c=this.spriteFrame.getTexture();a.define("CC_USE_MODEL",!1);a.define("USE_TEXTURE",!0);a.setProperty("texture",c);a.setProperty("alphaThreshold",this.alphaThreshold)}else a.define("CC_USE_MODEL",!0),a.define("USE_TEXTURE",!1);this._enableMaterial||(this._enableMaterial=b.getInstantiatedBuiltinMaterial("2d-sprite",this));this._exitMaterial||(this._exitMaterial=b.getInstantiatedBuiltinMaterial("2d-sprite",
this),this._exitMaterial.effect.setStencilEnabled(h.default.STENCIL_DISABLE));this._clearMaterial||(this._clearMaterial=b.getInstantiatedBuiltinMaterial("clear-stencil",this));this.setMaterial(0,a)}this.markForRender(!0)}else this.markForRender(!1)},_createGraphics:function(){this._graphics||(this._graphics=new c,cc.Assembler.init(this._graphics),this._graphics.node=this.node,this._graphics.lineWidth=0,this._graphics.strokeColor=cc.color(0,0,0,0));this._clearGraphics||(this._clearGraphics=new c,cc.Assembler.init(this._clearGraphics),
this._clearGraphics.node=new g,this._clearGraphics._activateMaterial(),this._clearGraphics.lineWidth=0,this._clearGraphics.rect(-1,-1,2,2),this._clearGraphics.fill())},_updateGraphics:function(){var a=this.node,c=this._graphics;c.clear(!1);var b=a._contentSize.width,d=a._contentSize.height,g=-b*a._anchorPoint.x;a=-d*a._anchorPoint.y;if(this._type===r.RECT)c.rect(g,a,b,d);else if(this._type===r.ELLIPSE){g=cc.v2(g+b/2,a+d/2);b/=2;d/=2;a=this._segments;q.length=0;for(var k=2*Math.PI/a,l=0;l<a;++l)q.push(cc.v2(b*
Math.cos(k*l)+g.x,d*Math.sin(k*l)+g.y));for(g=0;g<q.length;++g)d=q[g],0===g?c.moveTo(d.x,d.y):c.lineTo(d.x,d.y);c.close()}cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?c.stroke():c.fill()},_removeGraphics:function(){this._graphics&&(this._graphics.destroy(),this._graphics=null);this._clearGraphics&&(this._clearGraphics.destroy(),this._clearGraphics=null)},_hitTest:function(a){var c=this.node,b=c.getContentSize(),d=b.width;b=b.height;if(c._updateWorldMatrix(),!e.mat4.invert(l,c._worldMatrix))return!1;
e.vec2.transformMat4(k,a,l);k.x+=c._anchorPoint.x*d;k.y+=c._anchorPoint.y*b;a=!1;this.type===r.RECT||this.type===r.IMAGE_STENCIL?a=0<=k.x&&0<=k.y&&k.x<=d&&k.y<=b:this.type===r.ELLIPSE&&(a=d/2,c=b/2,d=k.x-.5*d,b=k.y-.5*b,a=1>d*d/(a*a)+b*b/(c*c));return this.inverted&&(a=!a),a},markForUpdateRenderData:function(c){c&&this.enabledInHierarchy?this.node._renderFlag|=a.FLAG_UPDATE_RENDER_DATA:c||(this.node._renderFlag&=~a.FLAG_UPDATE_RENDER_DATA)},markForRender:function(c){c&&this.enabledInHierarchy?this.node._renderFlag=
this.node._renderFlag|a.FLAG_RENDER|a.FLAG_UPDATE_RENDER_DATA|a.FLAG_POST_RENDER:c||(this.node._renderFlag&=~(a.FLAG_RENDER|a.FLAG_POST_RENDER))},disableRender:function(){this.node._renderFlag&=~(a.FLAG_RENDER|a.FLAG_UPDATE_RENDER_DATA|a.FLAG_POST_RENDER)}});cc.Mask=n.exports=f},{"../../renderer/gfx":280,"../CCNode":30,"../assets/material/CCMaterial":53,"../graphics/graphics":103,"../renderer/render-flow":179,"../utils/misc":220,"../vmath":246,"./CCRenderComponent":74}],71:[function(f,n,m){var h=
cc.Enum({Unified:0,Free:1}),e=cc.Enum({Horizontal:0,Vertical:1}),d=cc.Enum({PAGE_TURNING:0});f=cc.Class({name:"cc.PageView",extends:cc.ScrollView,editor:!1,ctor:function(){this._lastPageIdx=this._curPageIdx=0;this._pages=[];this._initContentPos=cc.v2();this._scrollCenterOffsetX=[];this._scrollCenterOffsetY=[]},properties:{sizeMode:{default:h.Unified,type:h,tooltip:!1,notify:function(){this._syncSizeMode()}},direction:{default:e.Horizontal,type:e,tooltip:!1,notify:function(){this._syncScrollDirection()}},
scrollThreshold:{default:.5,type:cc.Float,slide:!0,range:[0,1,.01],tooltip:!1},autoPageTurningThreshold:{default:100,type:cc.Float,tooltip:!1},pageTurningEventTiming:{default:.1,type:cc.Float,range:[0,1,.01],tooltip:!1},indicator:{default:null,type:cc.PageViewIndicator,tooltip:!1,notify:function(){this.indicator&&this.indicator.setPageView(this)}},pageTurningSpeed:{default:.3,type:cc.Float,tooltip:!1},pageEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{SizeMode:h,Direction:e,
EventType:d},__preload:function(){this.node.on(cc.Node.EventType.SIZE_CHANGED,this._updateAllPagesSize,this)},onEnable:function(){this._super();this.node.on("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onDisable:function(){this._super();this.node.off("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onLoad:function(){this._initPages();this.indicator&&this.indicator.setPageView(this)},onDestroy:function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._updateAllPagesSize,
this)},getCurrentPageIndex:function(){return this._curPageIdx},setCurrentPageIndex:function(b){this.scrollToPage(b,!0)},getPages:function(){return this._pages},addPage:function(b){b&&-1===this._pages.indexOf(b)&&this.content&&(this.content.addChild(b),this._pages.push(b),this._updatePageView())},insertPage:function(b,a){0>a||!b||-1!==this._pages.indexOf(b)||!this.content||(a>=this._pages.length?this.addPage(b):(this._pages.splice(a,0,b),this.content.addChild(b),this._updatePageView()))},removePage:function(b){if(b&&
this.content){var a=this._pages.indexOf(b);-1!==a?this.removePageAtIndex(a):cc.warnID(4300,b.name)}},removePageAtIndex:function(b){var a=this._pages;if(!(0>b||b>=a.length)){var c=a[b];c&&(this.content.removeChild(c),a.splice(b,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var b=this._pages,a=0,c=b.length;a<c;a++)this.content.removeChild(b[a]);this._pages.length=0;this._updatePageView()}},scrollToPage:function(b,a){0>b||b>=this._pages.length||(a=void 0!==a?a:.3,this._curPageIdx=
b,this.scrollToOffset(this._moveOffsetValue(b),a,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_syncScrollDirection:function(){this.horizontal=this.direction===e.Horizontal;this.vertical=this.direction===e.Vertical},_syncSizeMode:function(){if(this.content){var b=this.content.getComponent(cc.Layout);if(b){if(this.sizeMode===h.Free&&0<this._pages.length){var a=this._pages[this._pages.length-1];this.direction===e.Horizontal?
(b.paddingLeft=(this._view.width-this._pages[0].width)/2,b.paddingRight=(this._view.width-a.width)/2):this.direction===e.Vertical&&(b.paddingTop=(this._view.height-this._pages[0].height)/2,b.paddingBottom=(this._view.height-a.height)/2)}b.updateLayout()}}},_updatePageView:function(){var b=this.content.getComponent(cc.Layout);b&&b.enabled&&b.updateLayout();b=this._pages.length;this._curPageIdx>=b&&(this._curPageIdx=0===b?0:b-1,this._lastPageIdx=this._curPageIdx);for(var a=this._initContentPos,c=0;c<
b;++c){var d=this._pages[c];d.setSiblingIndex(c);this.direction===e.Horizontal?this._scrollCenterOffsetX[c]=Math.abs(a.x+d.x):this._scrollCenterOffsetY[c]=Math.abs(a.y+d.y)}this.indicator&&this.indicator._refresh()},_updateAllPagesSize:function(){if(this.sizeMode===h.Unified)for(var b=this._pages,a=this._view.getContentSize(),c=0,d=b.length;c<d;c++)b[c].setContentSize(a)},_initPages:function(){if(this.content){this._initContentPos=this.content.position;for(var b=this.content.children,a=0;a<b.length;++a){var c=
b[a];0<=this._pages.indexOf(c)||this._pages.push(c)}this._syncScrollDirection();this._syncSizeMode();this._updatePageView()}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,d.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(b,a,c){if(this.sizeMode===h.Free){var d,k;if(this.direction===e.Horizontal)return d=this._scrollCenterOffsetX[a],k=this._scrollCenterOffsetX[c],
Math.abs(b.x)>=Math.abs(d-k)*this.scrollThreshold;if(this.direction===e.Vertical)return d=this._scrollCenterOffsetY[a],k=this._scrollCenterOffsetY[c],Math.abs(b.y)>=Math.abs(d-k)*this.scrollThreshold}else{if(this.direction===e.Horizontal)return Math.abs(b.x)>=this._view.width*this.scrollThreshold;if(this.direction===e.Vertical)return Math.abs(b.y)>=this._view.height*this.scrollThreshold}},_isQuicklyScrollable:function(b){if(this.direction===e.Horizontal){if(Math.abs(b.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===
e.Vertical&&Math.abs(b.y)>this.autoPageTurningThreshold)return!0;return!1},_moveOffsetValue:function(b){var a=cc.v2(0,0);return this.sizeMode===h.Free?this.direction===e.Horizontal?a.x=this._scrollCenterOffsetX[b]:this.direction===e.Vertical&&(a.y=this._scrollCenterOffsetY[b]):this.direction===e.Horizontal?a.x=b*this._view.width:this.direction===e.Vertical&&(a.y=b*this._view.height),a},_getDragDirection:function(b){return this.direction===e.Horizontal?0===b.x?0:0<b.x?1:-1:this.direction===e.Vertical?
0===b.y?0:0>b.y?1:-1:void 0},_handleReleaseLogic:function(b){this._autoScrollToPage();this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent("scroll-ended"))},_autoScrollToPage:function(){var b=this._startBounceBackIfNeeded(),a=this._touchBeganPosition.sub(this._touchEndPosition);if(b)a=this._getDragDirection(a),0!==a&&(this._curPageIdx=0<a?this._pages.length-1:0,this.indicator&&this.indicator._changedState());else{b=this._curPageIdx;var c=b+this._getDragDirection(a),d=this.pageTurningSpeed*
Math.abs(b-c);if(c<this._pages.length){if(this._isScrollable(a,b,c))return void this.scrollToPage(c,d);a=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(a))return void this.scrollToPage(c,d)}this.scrollToPage(b,d)}},_onTouchBegan:function(b,a){this._touchBeganPosition=b.touch.getLocation();this._super(b,a)},_onTouchMoved:function(b,a){this._super(b,a)},_onTouchEnded:function(b,a){this._touchEndPosition=b.touch.getLocation();this._super(b,a)},_onTouchCancelled:function(b,a){this._touchEndPosition=
b.touch.getLocation();this._super(b,a)},_onMouseWheel:function(){}});cc.PageView=n.exports=f},{}],72:[function(f,n,m){var h=cc.Enum({HORIZONTAL:0,VERTICAL:1});f=cc.Class({name:"cc.PageViewIndicator",extends:f("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1},direction:{default:h.HORIZONTAL,type:h,tooltip:!1},cellSize:{default:cc.size(20,20),tooltip:!1},spacing:{default:0,tooltip:!1}},statics:{Direction:h},onLoad:function(){this._updateLayout()},
setPageView:function(e){this._pageView=e;this._refresh()},_updateLayout:function(){(this._layout=this.getComponent(cc.Layout))||(this._layout=this.addComponent(cc.Layout));this.direction===h.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===h.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL,this._layout.spacingY=this.spacing);this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var e=new cc.Node;return e.addComponent(cc.Sprite).spriteFrame=
this.spriteFrame,e.parent=this.node,e.width=this.cellSize.width,e.height=this.cellSize.height,e},_changedState:function(){var e=this._indicators;if(0!==e.length){var d=this._pageView._curPageIdx;if(!(d>=e.length)){for(var b=0;b<e.length;++b)e[b].opacity=127.5;e[d].opacity=255}}},_refresh:function(){if(this._pageView){var e=this._indicators,d=this._pageView.getPages();if(d.length!==e.length){var b;if(d.length>e.length)for(b=0;b<d.length;++b)e[b]||(e[b]=this._createIndicator());else for(b=e.length-
d.length;0<b;--b)this.node.removeChild(e[b-1]),e.splice(b-1,1);this._layout&&this._layout.enabledInHierarchy&&this._layout.updateLayout();this._changedState()}}}});cc.PageViewIndicator=n.exports=f},{"./CCComponent":64}],73:[function(f,n,m){var h=f("../utils/misc");f=f("./CCComponent");var e=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2});f=cc.Class({name:"cc.ProgressBar",extends:f,editor:!1,_initBarSprite:function(){if(this.barSprite){var d=this.barSprite.node;if(d){var b=this.node.getContentSize(),a=
this.node.getAnchorPoint(),c=d.getContentSize();d.parent===this.node&&this.node.setContentSize(c);this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=e.FILLED);c=d.getContentSize();(this.mode===e.HORIZONTAL?this.totalLength=c.width:this.mode===e.VERTICAL?this.totalLength=c.height:this.totalLength=this.barSprite.fillRange,d.parent===this.node)&&d.setPosition(cc.v2(-b.width*a.x,0))}}},_updateBarStatus:function(){if(this.barSprite){var d=this.barSprite.node;if(d){var b=d.getAnchorPoint(),
a=d.getContentSize(),c=d.getPosition(),g=cc.v2(0,.5),k=h.clamp01(this.progress);k*=this.totalLength;switch(this.mode){case e.HORIZONTAL:this.reverse&&(g=cc.v2(1,.5));var l=cc.size(k,a.height);var q=this.totalLength;var f=a.height;break;case e.VERTICAL:g=this.reverse?cc.v2(.5,1):cc.v2(.5,0),l=cc.size(a.width,k),q=a.width,f=this.totalLength}this.mode===e.FILLED?this.barSprite.type!==cc.Sprite.Type.FILLED?cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this.reverse&&(k*=
-1),this.barSprite.fillRange=k):this.barSprite.type!==cc.Sprite.Type.FILLED?(q=cc.v2(q*(g.x-b.x),f*(g.y-b.y)),d.setPosition(c.x+q.x,c.y+q.y),d.setAnchorPoint(g),d.setContentSize(l)):cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}}},properties:{barSprite:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._initBarSprite()},animatable:!1},mode:{default:e.HORIZONTAL,type:e,tooltip:!1,notify:function(){if(this.barSprite){var d=this.barSprite.node;d&&
(d=d.getContentSize(),this.mode===e.HORIZONTAL?this.totalLength=d.width:this.mode===e.VERTICAL?this.totalLength=d.height:this.mode===e.FILLED&&(this.totalLength=this.barSprite.fillRange))}},animatable:!1},_N$totalLength:1,totalLength:{range:[0,Number.MAX_VALUE],tooltip:!1,get:function(){return this._N$totalLength},set:function(d){this.mode===e.FILLED&&(d=h.clamp01(d));this._N$totalLength=d;this._updateBarStatus()}},progress:{default:1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateBarStatus()}},
reverse:{default:!1,tooltip:!1,notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart);this._updateBarStatus()},animatable:!1}},statics:{Mode:e}});cc.ProgressBar=n.exports=f},{"../utils/misc":220,"./CCComponent":64}],74:[function(f,n,m){var h=function(b){return b&&b.__esModule?b:{default:b}}(f("../renderer/assembler"));m=f("./CCComponent");var e=f("../renderer/render-flow"),d=f("../assets/material/CCMaterial");f=cc.Class({name:"RenderComponent",extends:m,editor:!1,
properties:{_materials:{default:[],type:d},sharedMaterials:{get:function(){return this._materials},set:function(b){this._materials=b;this._activateMaterial(!0)},type:[d],displayName:"Materials",animatable:!1}},ctor:function(){this._vertsDirty=!0;this._assembler=this._material=null},_resetAssembler:function(){this.setVertsDirty(!0);h.default.init(this);this._updateColor()},__preload:function(){this._resetAssembler()},onEnable:function(){this.node._renderComponent&&(this.node._renderComponent.enabled=
!1);this.node._renderComponent=this;this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onNodeSizeDirty,this);this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._onNodeSizeDirty,this);this.node._renderFlag=this.node._renderFlag|e.FLAG_RENDER|e.FLAG_UPDATE_RENDER_DATA|e.FLAG_OPACITY_COLOR},onDisable:function(){this.node._renderComponent=null;this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onNodeSizeDirty,this);this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._onNodeSizeDirty,this);this.disableRender()},
onDestroy:function(){for(var b=this._materials,a=0;a<b.length;a++)cc.pool.material.put(b[a]);b.length=0;cc.pool.assembler.put(this._assembler)},setVertsDirty:function(){this._vertsDirty=!0;this.markForUpdateRenderData(!0)},_onNodeSizeDirty:function(){this.setVertsDirty()},_on3DNodeChanged:function(){this.setVertsDirty()},_canRender:function(){return this._enabled&&this.node._activeInHierarchy},markForUpdateRenderData:function(b){b&&this._canRender()?this.node._renderFlag|=e.FLAG_UPDATE_RENDER_DATA:
b||(this.node._renderFlag&=~e.FLAG_UPDATE_RENDER_DATA)},markForRender:function(b){b&&this._canRender()?this.node._renderFlag|=e.FLAG_RENDER:b||(this.node._renderFlag&=~e.FLAG_RENDER)},disableRender:function(){this.node._renderFlag&=~(e.FLAG_RENDER|e.FLAG_UPDATE_RENDER_DATA)},getMaterial:function(b){if(0>b||b>=this._materials.length)return null;var a=this._materials[b];if(!a)return null;var c=d.getInstantiatedMaterial(a,this);return c!==a&&this.setMaterial(b,c),this._materials[b]},setMaterial:function(b,
a){(this._materials[b]=a)&&this.markForUpdateRenderData(!0)},_activateMaterial:function(b){},_updateColor:function(){this._assembler.updateColor&&this._assembler.updateColor(this)},_checkBacth:function(b,a){var c=this.sharedMaterials[0];(c&&c.getHash()!==b.material.getHash()||b.cullingMask!==a)&&(b._flush(),b.node=c.getDefine("CC_USE_MODEL")?this.node:b._dummyNode,b.material=c,b.cullingMask=a)}});cc.RenderComponent=n.exports=f},{"../assets/material/CCMaterial":53,"../renderer/assembler":158,"../renderer/render-flow":179,
"./CCComponent":64}],75:[function(f,n,m){m=f("../platform/js");var h=f("../platform/CCMacro"),e=f("../utils/text-utils"),d=new (f("../utils/html-text-parser")),b=h.TextAlignment,a=h.VerticalTextAlignment,c=new m.Pool(function(a){return!!cc.isValid(a)&&!a.getComponent(cc.LabelOutline)},20);c.get=function(c,d){var g=this._get();g||(g=new cc.PrivateNode("RICHTEXT_CHILD"));var k=g.getComponent(cc.Label);return k||(k=g.addComponent(cc.Label)),g.setPosition(0,0),g.setAnchorPoint(.5,.5),g.setContentSize(128,
128),g.skewX=0,"string"!=typeof c&&(c=""+c),d.font instanceof cc.Font?k.font=d.font:k.fontFamily=d.fontFamily,k.string=c,k.horizontalAlign=b.LEFT,k.verticalAlign=a.TOP,k.fontSize=d.fontSize||40,k.overflow=0,k.enableWrapText=!0,k.lineHeight=40,k._enableBold(!1),k._enableItalics(!1),k._enableUnderline(!1),g};f=cc.Class({name:"cc.RichText",extends:cc.Component,ctor:function(){this._textArray=null;this._labelSegments=[];this._labelSegmentsCache=[];this._linesWidth=[];this._updateRichTextStatus=this._updateRichText},
editor:!1,properties:{string:{default:"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,tooltip:!1,notify:function(){this._updateRichTextStatus()}},horizontalAlign:{default:b.LEFT,type:b,tooltip:!1,animatable:!1,notify:function(a){this.horizontalAlign!==a&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:40,tooltip:!1,notify:function(a){this.fontSize!==a&&(this._layoutDirty=!0,this._updateRichTextStatus())}},_fontFamily:"Arial",fontFamily:{tooltip:!1,get:function(){return this._fontFamily},
set:function(a){this._fontFamily!==a&&(this._fontFamily=a,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1},font:{default:null,type:cc.TTFFont,tooltip:!1,notify:function(a){this.font!==a&&(this._layoutDirty=!0,this.font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(a){this._isSystemFontUsed!==a&&(this._isSystemFontUsed=a,this._layoutDirty=
!0,this._updateRichTextStatus())},animatable:!1,tooltip:!1},maxWidth:{default:0,tooltip:!1,notify:function(a){this.maxWidth!==a&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:40,tooltip:!1,notify:function(a){this.lineHeight!==a&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,notify:function(a){this.imageAtlas!==a&&(this._layoutDirty=!0,this._updateRichTextStatus())}},handleTouchEvent:{default:!0,tooltip:!1,
notify:function(a){this.handleTouchEvent!==a&&this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners())}}},statics:{HorizontalAlign:b,VerticalAlign:a},onEnable:function(){this.handleTouchEvent&&this._addEventListeners();this._updateRichText();this._activateChildren(!0)},onDisable:function(){this.handleTouchEvent&&this._removeEventListeners();this._activateChildren(!1)},start:function(){this._onTTFLoaded()},_onColorChanged:function(a){this.node.children.forEach(function(c){c.color=
a})},_addEventListeners:function(){this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this);this.node.on(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_removeEventListeners:function(){this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this);this.node.off(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(a){this._applyTextAttribute(a)}.bind(this))},_createFontLabel:function(a){return c.get(a,
this)},_onTTFLoaded:function(){if(this.font instanceof cc.TTFFont)if(this.font._nativeAsset)this._layoutDirty=!0,this._updateRichText();else{var a=this;cc.loader.load(this.font.nativeUrl,function(c,b){a._layoutDirty=!0;a._updateRichText()})}else this._layoutDirty=!0,this._updateRichText()},_measureText:function(a,c){var b=this,d=function(c){var d=void 0;return 0===b._labelSegmentsCache.length?(d=b._createFontLabel(c),b._labelSegmentsCache.push(d)):(d=b._labelSegmentsCache[0]).getComponent(cc.Label).string=
c,d._styleIndex=a,b._applyTextAttribute(d),d.getContentSize().width};return c?d(c):d},_onTouchEnded:function(a){for(var c=this,b=this.node.getComponents(cc.Component),d=function(d){d=c._labelSegments[d];var g=d._clickHandler,k=d._clickParam;g&&c._containsTouchLocation(d,a.touch.getLocation())&&(b.forEach(function(c){c.enabledInHierarchy&&c[g]&&c[g](a,k)}),a.stopPropagation())},g=0;g<this._labelSegments.length;++g)d(g)},_containsTouchLocation:function(a,c){return a.getBoundingBoxToWorld().contains(c)},
_resetState:function(){for(var a=this.node.children,b=a.length-1;0<=b;b--){var d=a[b];"RICHTEXT_CHILD"!==d.name&&"RICHTEXT_Image_CHILD"!==d.name||(d.parent===this.node?d.parent=null:a.splice(b,1),"RICHTEXT_CHILD"===d.name&&c.put(d))}this._labelSegments.length=0;this._labelSegmentsCache.length=0;this._lineOffsetX=this._linesWidth.length=0;this._lineCount=1;this._labelHeight=this._labelWidth=0;this._layoutDirty=!0},onRestore:!1,_activateChildren:function(a){for(var c=this.node.children.length-1;0<=
c;c--){var b=this.node.children[c];"RICHTEXT_CHILD"!==b.name&&"RICHTEXT_Image_CHILD"!==b.name||(b.active=a)}},_addLabelSegment:function(a,c){var b=void 0;return 0===this._labelSegmentsCache.length?b=this._createFontLabel(a):(b=this._labelSegmentsCache.pop()).getComponent(cc.Label).string=a,b._styleIndex=c,b._lineCount=this._lineCount,b.active=this.node.active,b.setAnchorPoint(0,0),this._applyTextAttribute(b),this.node.addChild(b),this._labelSegments.push(b),b},_updateRichTextWithMaxWidth:function(a,
c,b){var d=c;if(0<=this._lineOffsetX&&d+this._lineOffsetX>this.maxWidth)for(c=0;this._lineOffsetX<=this.maxWidth;){var g=this._getFirstWordLen(a,c,a.length),k=a.substr(c,g);k=this._measureText(b,k);if(!(this._lineOffsetX+k<=this.maxWidth)){0<c&&(d=a.substr(0,c),this._addLabelSegment(d,b),a=a.substr(c,a.length),d=this._measureText(b,a));this._updateLineInfo();break}this._lineOffsetX+=k;c+=g}if(d>this.maxWidth)for(a=e.fragmentText(a,d,this.maxWidth,this._measureText(b)),c=0;c<a.length;++c)d=this._addLabelSegment(a[c],
b).getContentSize(),this._lineOffsetX+=d.width,1<a.length&&c<a.length-1&&this._updateLineInfo();else this._lineOffsetX+=d,this._addLabelSegment(a,b)},_isLastComponentCR:function(a){return a.length-1===a.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX);this._lineOffsetX=0;this._lineCount++},_needsUpdateTextLayout:function(a){if(this._layoutDirty||!this._textArray||!a||this._textArray.length!==a.length)return!0;for(var c=0;c<this._textArray.length;++c){var b=this._textArray[c],
d=a[c];if(b.text!==d.text)return!0;if(b.style)if(d.style){if(!!d.style.outline!=!!b.style.outline||b.style.size!==d.style.size||b.style.italic!==d.style.italic||b.style.isImage!==d.style.isImage||b.style.isImage===d.style.isImage&&b.style.src!==d.style.src)return!0}else{if(b.style.size||b.style.italic||b.style.isImage||b.style.outline)return!0}else if(d.style&&(d.style.size||d.style.italic||d.style.isImage||d.style.outline))return!0}return!1},_addRichTextImageElement:function(a){var c=this.imageAtlas.getSpriteFrame(a.style.src);
if(c){var b=new cc.PrivateNode("RICHTEXT_Image_CHILD"),d=b.addComponent(cc.Sprite);b.setAnchorPoint(0,0);d.type=cc.Sprite.Type.SLICED;d.sizeMode=cc.Sprite.SizeMode.CUSTOM;this.node.addChild(b);this._labelSegments.push(b);var g=c.getRect(),e=1,p=g.width;g=g.height;var f=a.style.imageWidth,w=a.style.imageHeight;0<w&&w<this.lineHeight?(p*=e=w/g,g*=e):(p*=e=this.lineHeight/g,g*=e);0<f&&(p=f);0<this.maxWidth?(this._lineOffsetX+p>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=p):(this._lineOffsetX+=
p,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX));d.spriteFrame=c;b.setContentSize(p,g);b._lineCount=this._lineCount;a.style.event?(a.style.event.click&&(b._clickHandler=a.style.event.click),a.style.event.param?b._clickParam=a.style.event.param:b._clickParam=""):b._clickHandler=null}else cc.warnID(4400)},_updateRichText:function(){if(this.enabled){var a=d.parse(this.string);if(!this._needsUpdateTextLayout(a))return this._textArray=a,void this._updateLabelSegmentTextAttributes();
this._textArray=a;this._resetState();a=!1;for(var c,b=0;b<this._textArray.length;++b){var q=this._textArray[b],f=q.text;if(""===f){if(q.style&&q.style.newline){this._updateLineInfo();continue}if(q.style&&q.style.isImage&&this.imageAtlas){this._addRichTextImageElement(q);continue}}q=f.split("\n");for(var t=0;t<q.length;++t)if(c=q[t],""!==c){if(a=!1,0<this.maxWidth){var p=this._measureText(b,c);this._updateRichTextWithMaxWidth(c,p,b)}else c=this._addLabelSegment(c,b).getContentSize(),this._lineOffsetX+=
c.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX);1<q.length&&t<q.length-1&&this._updateLineInfo()}else this._isLastComponentCR(f)&&t===q.length-1||(this._updateLineInfo(),a=!0)}a||this._linesWidth.push(this._lineOffsetX);0<this.maxWidth&&(this._labelWidth=this.maxWidth);this._labelHeight=(this._lineCount+e.BASELINE_RATIO)*this.lineHeight;this.node.setContentSize(this._labelWidth,this._labelHeight);this._updateRichTextPosition();this._layoutDirty=!1}},_getFirstWordLen:function(a,
c,b){var d=a.charAt(c);if(e.isUnicodeCJK(d)||e.isUnicodeSpace(d))return 1;var g=1;for(c+=1;c<b&&(d=a.charAt(c),!e.isUnicodeSpace(d)&&!e.isUnicodeCJK(d));++c)g++;return g},_updateRichTextPosition:function(){for(var a=0,c=1,d=this._lineCount,e=0;e<this._labelSegments.length;++e){var f=this._labelSegments[e],t=f._lineCount;t>c&&(a=0,c=t);var p=0;switch(this.horizontalAlign){case b.LEFT:p=-this._labelWidth/2;break;case b.CENTER:p=-this._linesWidth[t-1]/2;break;case b.RIGHT:p=this._labelWidth/2-this._linesWidth[t-
1]}f.x=a+p;p=f.getContentSize();f.y=this.lineHeight*(d-t)-this._labelHeight/2;t===c&&(a+=p.width)}},_convertLiteralColorValue:function(a){var c=a.toUpperCase();return cc.Color[c]?cc.Color[c]:cc.color().fromHEX(a)},_applyTextAttribute:function(c){var d=c.getComponent(cc.Label);if(d){var g=c._styleIndex;this._isSystemFontUsed&&(d.fontFamily=this._fontFamily);d.useSystemFont=this._isSystemFontUsed;d.lineHeight=this.lineHeight;d.horizontalAlign=b.LEFT;d.verticalAlign=a.CENTER;var e=null;if(this._textArray[g]&&
(e=this._textArray[g].style),e&&e.color?c.color=this._convertLiteralColorValue(e.color):c.color=this.node.color,d._enableBold(e&&e.bold),d._enableItalics(e&&e.italic),e&&e.italic&&(c.skewX=12),d._enableUnderline(e&&e.underline),e&&e.outline)(g=c.getComponent(cc.LabelOutline))||(g=c.addComponent(cc.LabelOutline)),g.color=this._convertLiteralColorValue(e.outline.color),g.width=e.outline.width;e&&e.size?d.fontSize=e.size:d.fontSize=this.fontSize;d._forceUpdateRenderData();e&&e.event?(e.event.click&&
(c._clickHandler=e.event.click),e.event.param?c._clickParam=e.event.param:c._clickParam=""):c._clickHandler=null}},onDestroy:function(){for(var a=0;a<this._labelSegments.length;++a)this._labelSegments[a].removeFromParent(),c.put(this._labelSegments[a])}});cc.RichText=n.exports=f},{"../platform/CCMacro":135,"../platform/js":150,"../utils/html-text-parser":218,"../utils/text-utils":227}],76:[function(f,n,m){var h=f("../utils/misc"),e=(f("./CCComponent"),cc.Enum({HORIZONTAL:0,VERTICAL:1}));f=cc.Class({name:"cc.Scrollbar",
extends:f("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{default:0,serializable:!1},_opacity:255,handle:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._onScroll(cc.v2(0,0))},animatable:!1},direction:{default:e.HORIZONTAL,type:e,tooltip:!1,notify:function(){this._onScroll(cc.v2(0,0))},animatable:!1},enableAutoHide:{default:!0,animatable:!1,tooltip:!1},autoHideTime:{default:1,animatable:!1,tooltip:!1}},statics:{Direction:e},setTargetScrollView:function(d){this._scrollView=
d},_convertToScrollViewSpace:function(d){var b=this._scrollView.node;d=d.convertToWorldSpaceAR(cc.v2(-d.anchorX*d.width,-d.anchorY*d.height));d=b.convertToNodeSpaceAR(d);return d.x+=b.anchorX*b.width,d.y+=b.anchorY*b.height,d},_setOpacity:function(d){this.handle&&(this.node.opacity=d,this.handle.node.opacity=d)},_onScroll:function(d){if(this._scrollView){var b=this._scrollView.content;if(b){var a=b.getContentSize(),c=this._scrollView.node.getContentSize(),g=this.node.getContentSize();if(!this._conditionalDisableScrollBar(a,
c)){this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var k=0,l=0,q=0,f=0,t=0;this.direction===e.HORIZONTAL?(k=a.width,l=c.width,t=g.width,q=d.x,f=-this._convertToScrollViewSpace(b).x):this.direction===e.VERTICAL&&(k=a.height,l=c.height,t=g.height,q=d.y,f=-this._convertToScrollViewSpace(b).y);d=this._calculateLength(k,l,t,q);k=this._calculatePosition(k,l,t,f,q,d);this._updateLength(d);this._updateHanlderPosition(k)}}}},_updateHanlderPosition:function(d){if(this.handle){var b=
this._fixupHandlerPosition();this.handle.node.setPosition(d.x+b.x,d.y+b.y)}},_fixupHandlerPosition:function(){var d=this.node.getContentSize(),b=this.node.getAnchorPoint(),a=this.handle.node.getContentSize(),c=this.handle.node.parent;b=this.node.convertToWorldSpaceAR(cc.v2(-d.width*b.x,-d.height*b.y));c=c.convertToNodeSpaceAR(b);return this.direction===e.HORIZONTAL?c=cc.v2(c.x,c.y+(d.height-a.height)/2):this.direction===e.VERTICAL&&(c=cc.v2(c.x+(d.width-a.width)/2,c.y)),this.handle.node.setPosition(c),
c},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(d,b){return d.width<=b.width&&this.direction===e.HORIZONTAL||d.height<=b.height&&this.direction===e.VERTICAL},_onTouchEnded:function(){if(this.enableAutoHide&&(this._touching=!1,!(0>=this.autoHideTime))){if(this._scrollView){var d=this._scrollView.content;if(d){d=d.getContentSize();var b=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(d,b))return}}this._autoHideRemainingTime=
this.autoHideTime}},_calculateLength:function(d,b,a,c){return c&&(d+=20*(0<c?c:-c)),b/d*a},_calculatePosition:function(d,b,a,c,g,k){d-=b;g&&(d+=Math.abs(g));g=0;d&&(g=c/d,g=h.clamp01(g));a=(a-k)*g;return this.direction===e.VERTICAL?cc.v2(0,a):cc.v2(a,0)},_updateLength:function(d){if(this.handle){var b=this.handle.node,a=b.getContentSize();b.setAnchorPoint(cc.v2(0,0));this.direction===e.HORIZONTAL?b.setContentSize(d,a.height):b.setContentSize(a.width,d)}},_processAutoHide:function(d){this.enableAutoHide&&
!(0>=this._autoHideRemainingTime)&&!this._touching&&(this._autoHideRemainingTime-=d,this._autoHideRemainingTime<=this.autoHideTime)&&(this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime),this._setOpacity(this._autoHideRemainingTime/this.autoHideTime*this._opacity))},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0;this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime;this._setOpacity(this._opacity)},
update:function(d){this._processAutoHide(d)}});cc.Scrollbar=n.exports=f},{"../utils/misc":220,"./CCComponent":64}],77:[function(f,n,m){var h=f("../CCNode").EventType;m=cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,SCROLL_ENDED:9,TOUCH_UP:10,AUTOSCROLL_ENDED_WITH_THRESHOLD:11,SCROLL_BEGAN:12});var e={"scroll-to-top":m.SCROLL_TO_TOP,"scroll-to-bottom":m.SCROLL_TO_BOTTOM,"scroll-to-left":m.SCROLL_TO_LEFT,
"scroll-to-right":m.SCROLL_TO_RIGHT,scrolling:m.SCROLLING,"bounce-bottom":m.BOUNCE_BOTTOM,"bounce-left":m.BOUNCE_LEFT,"bounce-right":m.BOUNCE_RIGHT,"bounce-top":m.BOUNCE_TOP,"scroll-ended":m.SCROLL_ENDED,"touch-up":m.TOUCH_UP,"scroll-ended-with-threshold":m.AUTOSCROLL_ENDED_WITH_THRESHOLD,"scroll-began":m.SCROLL_BEGAN};f=cc.Class({name:"cc.ScrollView",extends:f("./CCViewGroup"),editor:!1,ctor:function(){this._rightBoundary=this._leftBoundary=this._bottomBoundary=this._topBoundary=0;this._touchMoveDisplacements=
[];this._touchMoveTimeDeltas=[];this._touchMovePreviousTimestamp=0;this._autoScrollAttenuate=this._autoScrolling=this._touchMoved=!1;this._autoScrollStartPosition=cc.v2(0,0);this._autoScrollTargetDelta=cc.v2(0,0);this._autoScrollAccumulatedTime=this._autoScrollTotalTime=0;this._autoScrollBraking=this._autoScrollCurrentlyOutOfBoundary=!1;this._autoScrollBrakingStartPosition=cc.v2(0,0);this._outOfBoundaryAmount=cc.v2(0,0);this._outOfBoundaryAmountDirty=!0;this._stopMouseWheel=!1;this._mouseWheelEventElapsedTime=
0;this._isScrollEndedWithThresholdEventFired=!1;this._scrollEventEmitMask=0;this._scrolling=this._isBouncing=!1},properties:{content:{default:void 0,type:cc.Node,tooltip:!1,formerlySerializedAs:"content",notify:function(d){this._calculateBoundary()}},horizontal:{default:!0,animatable:!1,tooltip:!1},vertical:{default:!0,animatable:!1,tooltip:!1},inertia:{default:!0,tooltip:!1},brake:{default:.5,type:cc.Float,range:[0,1,.1],tooltip:!1},elastic:{default:!0,animatable:!1,tooltip:!1},bounceDuration:{default:1,
range:[0,10],tooltip:!1},horizontalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.horizontalScrollBar&&(this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},verticalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.verticalScrollBar&&(this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},scrollEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1},cancelInnerEvents:{default:!0,
animatable:!1,tooltip:!1},_view:{get:function(){if(this.content)return this.content.parent}}},statics:{EventType:m},scrollToBottom:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!1,applyToVertical:!0});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a,!0)},scrollToTop:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(0,1),applyToHorizontal:!1,applyToVertical:!0});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a)},scrollToLeft:function(d,
b){var a=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!0,applyToVertical:!1});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a)},scrollToRight:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(1,0),applyToHorizontal:!0,applyToVertical:!1});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a)},scrollToTopLeft:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(0,1),applyToHorizontal:!0,applyToVertical:!0});d?this._startAutoScroll(a,d,
!1!==b):this._moveContent(a)},scrollToTopRight:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(1,1),applyToHorizontal:!0,applyToVertical:!0});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a)},scrollToBottomLeft:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!0,applyToVertical:!0});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a)},scrollToBottomRight:function(d,b){var a=this._calculateMovePercentDelta({anchor:cc.v2(1,0),applyToHorizontal:!0,
applyToVertical:!0});d?this._startAutoScroll(a,d,!1!==b):this._moveContent(a)},scrollToOffset:function(d,b,a){var c=this.getMaxScrollOffset(),g=cc.v2(0,0);0===c.x?g.x=0:g.x=d.x/c.x;0===c.y?g.y=1:g.y=(c.y-d.y)/c.y;this.scrollTo(g,b,a)},getScrollOffset:function(){var d=this._getContentTopBoundary()-this._topBoundary,b=this._getContentLeftBoundary()-this._leftBoundary;return cc.v2(b,d)},getMaxScrollOffset:function(){var d=this._view.getContentSize(),b=this.content.getContentSize(),a=b.width-d.width;
d=b.height-d.height;return a=0<=a?a:0,d=0<=d?d:0,cc.v2(a,d)},scrollToPercentHorizontal:function(d,b,a){d=this._calculateMovePercentDelta({anchor:cc.v2(d,0),applyToHorizontal:!0,applyToVertical:!1});b?this._startAutoScroll(d,b,!1!==a):this._moveContent(d)},scrollTo:function(d,b,a){d=this._calculateMovePercentDelta({anchor:cc.v2(d),applyToHorizontal:!0,applyToVertical:!0});b?this._startAutoScroll(d,b,!1!==a):this._moveContent(d)},scrollToPercentVertical:function(d,b,a){d=this._calculateMovePercentDelta({anchor:cc.v2(0,
d),applyToHorizontal:!1,applyToVertical:!0});b?this._startAutoScroll(d,b,!1!==a):this._moveContent(d)},stopAutoScroll:function(){this._autoScrolling=!1;this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(d){d.fuzzyEquals(this.getContentPosition(),1E-4)||(this.content.setPosition(d),this._outOfBoundaryAmountDirty=!0)},getContentPosition:function(){return this.content.getPosition()},isScrolling:function(){return this._scrolling},isAutoScrolling:function(){return this._autoScrolling},
_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0);this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0);this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0);this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0);this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0);this.node.off(cc.Node.EventType.TOUCH_MOVE,
this._onTouchMoved,this,!0);this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0);this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0);this.node.off(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(d,b){this.enabledInHierarchy&&!this._hasNestedViewGroup(d,b)&&(b=cc.v2(0,0),0,this.vertical?b=cc.v2(0,-.1*d.getScrollY()):this.horizontal&&(b=cc.v2(-.1*d.getScrollY(),0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(b),
this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(d))},_checkMouseWheel:function(d){if(!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1E-4))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=d;.1<this._mouseWheelEventElapsedTime&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._stopMouseWheel=
!1)},_calculateMovePercentDelta:function(d){var b=d.anchor,a=d.applyToHorizontal;d=d.applyToVertical;this._calculateBoundary();b=b.clampf(cc.v2(0,0),cc.v2(1,1));var c=this._view.getContentSize(),g=this.content.getContentSize(),k=this._getContentBottomBoundary()-this._bottomBoundary;k=-k;var l=this._getContentLeftBoundary()-this._leftBoundary;l=-l;var e=cc.v2(0,0),f=0;return a&&(f=g.width-c.width,e.x=l-f*b.x),d&&(f=g.height-c.height,e.y=k-f*b.y),e},_moveContentToTopLeft:function(d){var b=this.content.getContentSize(),
a=this._getContentBottomBoundary()-this._bottomBoundary;a=-a;var c=cc.v2(0,0),g=0,k=this._getContentLeftBoundary()-this._leftBoundary;b.height<d.height&&(g=b.height-d.height,c.y=a-g);b.width<d.width&&(c.x=-k);this._updateScrollBarState();this._moveContent(c);this._adjustContentOutOfBoundary()},_calculateBoundary:function(){if(this.content){var d=this.content.getComponent(cc.Layout);d&&d.enabledInHierarchy&&d.updateLayout();d=this._view.getContentSize();var b=d.height*this._view.anchorY;this._leftBoundary=
-(d.width*this._view.anchorX);this._bottomBoundary=-b;this._rightBoundary=this._leftBoundary+d.width;this._topBoundary=this._bottomBoundary+d.height;this._moveContentToTopLeft(d)}},_hasNestedViewGroup:function(d,b){if(d.eventPhase===cc.Event.CAPTURING_PHASE){if(b)for(var a=0;a<b.length;++a){var c=b[a];if(this.node===c)return!!d.target.getComponent(cc.ViewGroup);if(c.getComponent(cc.ViewGroup))return!0}return!1}},_stopPropagationIfTargetIsMe:function(d){d.eventPhase===cc.Event.AT_TARGET&&d.target===
this.node&&d.stopPropagation()},_onTouchBegan:function(d,b){this.enabledInHierarchy&&!this._hasNestedViewGroup(d,b)&&(b=d.touch,this.content&&this._handlePressLogic(b),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(d))},_onTouchMoved:function(d,b){this.enabledInHierarchy&&!this._hasNestedViewGroup(d,b)&&(b=d.touch,this.content&&this._handleMoveLogic(b),this.cancelInnerEvents)&&(7<b.getLocation().sub(b.getStartLocation()).mag()&&!this._touchMoved&&d.target!==this.node&&(b=new cc.Event.EventTouch(d.getTouches(),
d.bubbles),b.type=cc.Node.EventType.TOUCH_CANCEL,b.touch=d.touch,b.simulate=!0,d.target.dispatchEvent(b),this._touchMoved=!0),this._stopPropagationIfTargetIsMe(d))},_onTouchEnded:function(d,b){this.enabledInHierarchy&&!this._hasNestedViewGroup(d,b)&&(this._dispatchEvent("touch-up"),b=d.touch,this.content&&this._handleReleaseLogic(b),this._touchMoved?d.stopPropagation():this._stopPropagationIfTargetIsMe(d))},_onTouchCancelled:function(d,b){this.enabledInHierarchy&&!this._hasNestedViewGroup(d,b)&&(d.simulate||
(b=d.touch,this.content&&this._handleReleaseLogic(b)),this._stopPropagationIfTargetIsMe(d))},_processDeltaMove:function(d){this._scrollChildren(d);this._gatherTouchMove(d)},_handleMoveLogic:function(d){d=d.getDelta();this._processDeltaMove(d)},_scrollChildren:function(d){d=this._clampDelta(d);var b=void 0;this.elastic&&(b=this._getHowMuchOutOfBoundary(),d.x*=0===b.x?1:.5,d.y*=0===b.y?1:.5);this.elastic||(b=this._getHowMuchOutOfBoundary(d),d=d.add(b));b=-1;0<d.y?this.content.y-this.content.anchorY*
this.content.height+d.y>this._bottomBoundary&&(b="scroll-to-bottom"):0>d.y&&this.content.y-this.content.anchorY*this.content.height+this.content.height+d.y<=this._topBoundary&&(b="scroll-to-top");0>d.x?this.content.x-this.content.anchorX*this.content.width+this.content.width+d.x<=this._rightBoundary&&(b="scroll-to-right"):0<d.x&&this.content.x-this.content.anchorX*this.content.width+d.x>=this._leftBoundary&&(b="scroll-to-left");this._moveContent(d,!1);0===d.x&&0===d.y||(this._scrolling||(this._scrolling=
!0,this._dispatchEvent("scroll-began")),this._dispatchEvent("scrolling"));-1!==b&&this._dispatchEvent(b)},_handlePressLogic:function(){this._autoScrolling&&this._dispatchEvent("scroll-ended");this._isBouncing=this._autoScrolling=!1;this._touchMovePreviousTimestamp=(new Date).getMilliseconds();this._touchMoveDisplacements.length=0;this._touchMoveTimeDeltas.length=0;this._onScrollBarTouchBegan()},_clampDelta:function(d){var b=this.content.getContentSize(),a=this._view.getContentSize();return b.width<
a.width&&(d.x=0),b.height<a.height&&(d.y=0),d},_gatherTouchMove:function(d){for(d=this._clampDelta(d);5<=this._touchMoveDisplacements.length;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(d);d=(new Date).getMilliseconds();this._touchMoveTimeDeltas.push((d-this._touchMovePreviousTimestamp)/1E3);this._touchMovePreviousTimestamp=d},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var d=this._getHowMuchOutOfBoundary();return(d=this._clampDelta(d)).fuzzyEquals(cc.v2(0,
0),1E-4)?!1:(this._startAutoScroll(d,Math.max(this.bounceDuration,0),!0),this._isBouncing||(0<d.y&&this._dispatchEvent("bounce-top"),0>d.y&&this._dispatchEvent("bounce-bottom"),0<d.x&&this._dispatchEvent("bounce-right"),0>d.x&&this._dispatchEvent("bounce-left"),this._isBouncing=!0),!0)},_processInertiaScroll:function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var d=this._calculateTouchMoveVelocity();!d.fuzzyEquals(cc.v2(0,0),1E-4)&&1>this.brake&&this._startInertiaScroll(d)}this._onScrollBarTouchEnded()},
_handleReleaseLogic:function(d){d=d.getDelta();this._gatherTouchMove(d);this._processInertiaScroll();this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent("scroll-ended"))},_isOutOfBoundary:function(){return!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1E-4)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=
!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},getScrollEndedEventTiming:function(){return 1E-4},_processAutoScrolling:function(d){var b=this._isNecessaryAutoScrollBrake(),a=b?.05:1;this._autoScrollAccumulatedTime+=1/a*d;var c=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(d=c,c=--d*d*d*d*d+1);var g=this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(c));
d=1E-4>=Math.abs(c-1);(Math.abs(c-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent("scroll-ended-with-threshold"),this._isScrollEndedWithThresholdEventFired=!0),this.elastic)?(g=g.sub(this._autoScrollBrakingStartPosition),b&&(g=g.mul(a)),g=this._autoScrollBrakingStartPosition.add(g)):(b=g.sub(this.getContentPosition()),b=this._getHowMuchOutOfBoundary(b),b.fuzzyEquals(cc.v2(0,0),1E-4)||(g=g.add(b),d=!0));d&&(this._autoScrolling=!1);b=g.sub(this.getContentPosition());
this._moveContent(this._clampDelta(b),d);this._dispatchEvent("scrolling");this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent("scroll-ended"))},_startInertiaScroll:function(d){var b=d.mul(.7);this._startAttenuatingAutoScroll(b,d)},_calculateAttenuatedFactor:function(d){return 0>=this.brake?1-this.brake:1/(1+1.4E-5*d+d*d*8E-9)*(1-this.brake)},_startAttenuatingAutoScroll:function(d,b){b=this._calculateAutoScrollTimeByInitalSpeed(b.mag());var a=d.normalize(),c=this.content.getContentSize(),
g=this._view.getContentSize(),k=c.width-g.width;c=c.height-g.height;g=this._calculateAttenuatedFactor(k);var l=this._calculateAttenuatedFactor(c);a=cc.v2(a.x*k*(1-this.brake)*g,a.y*c*l*(1-this.brake));k=d.mag();k=a.mag()/k;a=a.add(d);0<this.brake&&7<k&&(k=Math.sqrt(k),a=d.mul(k).add(d));0<this.brake&&3<k&&(b*=k=3);0===this.brake&&1<k&&(b*=k);this._startAutoScroll(a,b,!0)},_calculateAutoScrollTimeByInitalSpeed:function(d){return Math.sqrt(Math.sqrt(d/5))},_startAutoScroll:function(d,b,a){d=this._flattenVectorByDirection(d);
this._autoScrolling=!0;this._autoScrollTargetDelta=d;this._autoScrollAttenuate=a;this._autoScrollStartPosition=this.getContentPosition();this._autoScrollTotalTime=b;this._autoScrollAccumulatedTime=0;this._isScrollEndedWithThresholdEventFired=this._autoScrollBraking=!1;this._autoScrollBrakingStartPosition=cc.v2(0,0);this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1E-4)||(this._autoScrollCurrentlyOutOfBoundary=!0)},_calculateTouchMoveVelocity:function(){var d=0;if(0>=(d=this._touchMoveTimeDeltas.reduce(function(a,
c){return a+c},d))||.5<=d)return cc.v2(0,0);var b=cc.v2(0,0);return b=this._touchMoveDisplacements.reduce(function(a,c){return a.add(c)},b),cc.v2(b.x*(1-this.brake)/d,b.y*(1-this.brake)/d)},_flattenVectorByDirection:function(d){return d.x=this.horizontal?d.x:0,d.y=this.vertical?d.y:0,d},_moveContent:function(d,b){d=this._flattenVectorByDirection(d);d=this.getContentPosition().add(d);this.setContentPosition(d);d=this._getHowMuchOutOfBoundary();this._updateScrollBar(d);this.elastic&&b&&this._startBounceBackIfNeeded()},
_getContentLeftBoundary:function(){return this.getContentPosition().x-this.content.getAnchorPoint().x*this.content.getContentSize().width},_getContentRightBoundary:function(){var d=this.content.getContentSize();return this._getContentLeftBoundary()+d.width},_getContentTopBoundary:function(){var d=this.content.getContentSize();return this._getContentBottomBoundary()+d.height},_getContentBottomBoundary:function(){return this.getContentPosition().y-this.content.getAnchorPoint().y*this.content.getContentSize().height},
_getHowMuchOutOfBoundary:function(d){if((d=d||cc.v2(0,0)).fuzzyEquals(cc.v2(0,0),1E-4)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var b=cc.v2(0,0);return this._getContentLeftBoundary()+d.x>this._leftBoundary?b.x=this._leftBoundary-(this._getContentLeftBoundary()+d.x):this._getContentRightBoundary()+d.x<this._rightBoundary&&(b.x=this._rightBoundary-(this._getContentRightBoundary()+d.x)),this._getContentTopBoundary()+d.y<this._topBoundary?b.y=this._topBoundary-(this._getContentTopBoundary()+
d.y):this._getContentBottomBoundary()+d.y>this._bottomBoundary&&(b.y=this._bottomBoundary-(this._getContentBottomBoundary()+d.y)),d.fuzzyEquals(cc.v2(0,0),1E-4)&&(this._outOfBoundaryAmount=b,this._outOfBoundaryAmountDirty=!1),this._clampDelta(b)},_updateScrollBarState:function(){if(this.content){var d=this.content.getContentSize(),b=this._view.getContentSize();this.verticalScrollBar&&(d.height<b.height?this.verticalScrollBar.hide():this.verticalScrollBar.show());this.horizontalScrollBar&&(d.width<
b.width?this.horizontalScrollBar.hide():this.horizontalScrollBar.show())}},_updateScrollBar:function(d){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(d);this.verticalScrollBar&&this.verticalScrollBar._onScroll(d)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan();this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded();this.verticalScrollBar&&
this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(d){if("scroll-ended"===d)this._scrollEventEmitMask=0;else if("scroll-to-top"===d||"scroll-to-bottom"===d||"scroll-to-left"===d||"scroll-to-right"===d){var b=1<<e[d];if(this._scrollEventEmitMask&b)return;this._scrollEventEmitMask|=b}cc.Component.EventHandler.emitEvents(this.scrollEvents,this,e[d]);this.node.emit(d,this)},_adjustContentOutOfBoundary:function(){if(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()){var d=this._getHowMuchOutOfBoundary(cc.v2(0,
0));d=this.getContentPosition().add(d);this.content&&(this.content.setPosition(d),this._updateScrollBar(0))}},start:function(){this._calculateBoundary();this.content&&cc.director.once(cc.Director.EVENT_BEFORE_DRAW,this._adjustContentOutOfBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide();this.verticalScrollBar&&this.verticalScrollBar.hide()},onDisable:function(){this._unregisterEvent();this.content&&(this.content.off(h.SIZE_CHANGED,this._calculateBoundary,
this),this.content.off(h.SCALE_CHANGED,this._calculateBoundary,this),this._view&&(this._view.off(h.POSITION_CHANGED,this._calculateBoundary,this),this._view.off(h.SCALE_CHANGED,this._calculateBoundary,this),this._view.off(h.SIZE_CHANGED,this._calculateBoundary,this)));this._hideScrollbar();this.stopAutoScroll()},onEnable:function(){this._registerEvent();this.content&&(this.content.on(h.SIZE_CHANGED,this._calculateBoundary,this),this.content.on(h.SCALE_CHANGED,this._calculateBoundary,this),this._view&&
(this._view.on(h.POSITION_CHANGED,this._calculateBoundary,this),this._view.on(h.SCALE_CHANGED,this._calculateBoundary,this),this._view.on(h.SIZE_CHANGED,this._calculateBoundary,this)));this._updateScrollBarState()},update:function(d){this._autoScrolling&&this._processAutoScrolling(d)}});cc.ScrollView=n.exports=f},{"../CCNode":30,"./CCViewGroup":84}],78:[function(f,n,m){var h=f("../utils/misc");f=f("./CCComponent");var e=cc.Enum({Horizontal:0,Vertical:1});f=cc.Class({name:"cc.Slider",extends:f,editor:!1,
ctor:function(){this._offset=cc.v2();this._dragging=this._touchHandle=!1},properties:{handle:{default:null,type:cc.Button,tooltip:!1,notify:function(){0}},direction:{default:e.Horizontal,type:e,tooltip:!1},progress:{default:.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateHandlePosition()}},slideEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Direction:e},__preload:function(){this._updateHandlePosition()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,
this._onTouchBegan,this);this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this);this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this);this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this);this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,
this._onTouchBegan,this);this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this);this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this);this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this);this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},
_onHandleDragStart:function(d){this._touchHandle=this._dragging=!0;this._offset=this.handle.node.convertToNodeSpaceAR(d.touch.getLocation());d.stopPropagation()},_onTouchBegan:function(d){this.handle&&(this._dragging=!0,this._touchHandle||this._handleSliderLogic(d.touch),d.stopPropagation())},_onTouchMoved:function(d){this._dragging&&(this._handleSliderLogic(d.touch),d.stopPropagation())},_onTouchEnded:function(d){this._touchHandle=this._dragging=!1;this._offset=cc.v2();d.stopPropagation()},_onTouchCancelled:function(d){this._dragging=
!1;d.stopPropagation()},_handleSliderLogic:function(d){this._updateProgress(d);this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this);this.node.emit("slide",this)},_updateProgress:function(d){if(this.handle){var b=this.node;d=b.convertToNodeSpaceAR(d.getLocation());this.direction===e.Horizontal?this.progress=h.clamp01((d.x-this._offset.x+b.anchorX*b.width)/b.width):this.progress=h.clamp01((d.y-this._offset.y+b.anchorY*b.height)/b.height)}},_updateHandlePosition:function(){if(this.handle){var d=
this.direction===e.Horizontal?cc.v2(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.v2(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);d=this.node.convertToWorldSpaceAR(d);this.handle.node.position=this.handle.node.parent.convertToNodeSpaceAR(d)}}});cc.Slider=n.exports=f},{"../utils/misc":220,"./CCComponent":64}],79:[function(f,n,m){var h=f("../utils/misc");m=(f("../CCNode").EventType,f("./CCRenderComponent"));var e=f("../utils/blend-func"),d=(f("../renderer/render-flow"),
f("../assets/material/CCMaterial")),b=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3,MESH:4});f=cc.Enum({HORIZONTAL:0,VERTICAL:1,RADIAL:2});var a=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),c=cc.Enum({NORMAL:0,GRAY:1});m=cc.Class({name:"cc.Sprite",extends:m,mixins:[e],editor:!1,ctor:function(){cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?this._activateMaterial=this._activateMaterialCanvas:this._activateMaterial=this._activateMaterialWebgl},properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:b.SIMPLE,
_sizeMode:a.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_atlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(a,c){c=this._spriteFrame;c!==a&&(this._spriteFrame=a,this.markForUpdateRenderData(!1),this._applySpriteFrame(c))},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(a){this._type!==a&&(this._type=a,this._resetAssembler())},
type:b,animatable:!1,tooltip:!1},fillType:{get:function(){return this._fillType},set:function(a){a!==this._fillType&&(this._fillType=a,this._resetAssembler())},type:f,tooltip:!1},fillCenter:{get:function(){return this._fillCenter},set:function(a){this._fillCenter.x=a.x;this._fillCenter.y=a.y;this._type===b.FILLED&&this.setVertsDirty()},tooltip:!1},fillStart:{get:function(){return this._fillStart},set:function(a){this._fillStart=h.clampf(a,-1,1);this._type===b.FILLED&&this.setVertsDirty()},tooltip:!1},
fillRange:{get:function(){return this._fillRange},set:function(a){this._fillRange=h.clampf(a,-1,1);this._type===b.FILLED&&this.setVertsDirty()},tooltip:!1},trim:{get:function(){return this._isTrimmedMode},set:function(a){this._isTrimmedMode!==a&&(this._isTrimmedMode=a,this._type!==b.SIMPLE&&this._type!==b.MESH||this.setVertsDirty())},animatable:!1,tooltip:!1},sizeMode:{get:function(){return this._sizeMode},set:function(c){this._sizeMode=c;c!==a.CUSTOM&&this._applySpriteSize()},animatable:!1,type:a,
tooltip:!1}},statics:{FillType:f,Type:b,SizeMode:a,State:c},setVisible:function(a){this.enabled=a},setState:function(){},getState:function(){},onEnable:function(){this._super();this._spriteFrame&&this._spriteFrame.textureLoaded()?this._activateMaterial():(this.disableRender(),this._spriteFrame&&(this._spriteFrame.once("load",this._onTextureLoaded,this),this._spriteFrame.ensureLoadTexture()))},_on3DNodeChanged:function(){this._resetAssembler()},_activateMaterialCanvas:function(){this.setVertsDirty();
this.markForUpdateRenderData(!0);this.markForRender(!0)},_activateMaterialWebgl:function(){var a=this._spriteFrame;if(a&&a.textureLoaded()){var c=this.sharedMaterials[0];(c=c?d.getInstantiatedMaterial(c,this):d.getInstantiatedBuiltinMaterial("2d-sprite",this)).setProperty("texture",a.getTexture());this.setVertsDirty();this.setMaterial(0,c);this.markForRender(!0)}else this.disableRender()},_applyAtlas:!1,_canRender:function(){if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS){if(!this._enabled)return!1}else if(!this._enabled||
!this.sharedMaterials[0]||!this.node._activeInHierarchy)return!1;var a=this._spriteFrame;return!(!a||!a.textureLoaded())},_applySpriteSize:function(){if(this._spriteFrame){if(a.RAW===this._sizeMode)this.node.setContentSize(this._spriteFrame._originalSize);else if(a.TRIMMED===this._sizeMode){var c=this._spriteFrame._rect;this.node.setContentSize(c.width,c.height)}this.setVertsDirty();this._activateMaterial()}},_onTextureLoaded:function(){this.isValid&&this._applySpriteSize()},_applySpriteFrame:function(a){a&&
!a.textureLoaded()&&a.off("load",this._onTextureLoaded,this);(a=this._spriteFrame)?a.textureLoaded()?this._applySpriteSize():(this.markForRender(!1),a.once("load",this._onTextureLoaded,this),a.ensureLoadTexture()):this.markForRender(!1)},_resized:!1});cc.Sprite=n.exports=m},{"../CCNode":30,"../assets/material/CCMaterial":53,"../renderer/render-flow":179,"../utils/blend-func":214,"../utils/misc":220,"./CCRenderComponent":74}],80:[function(f,n,m){m=cc.Enum({NONE:0,CHECKBOX:1,TEXT_ATLAS:2,SLIDER_BAR:3,
LIST_VIEW:4,PAGE_VIEW:5});var h=cc.Enum({VERTICAL:0,HORIZONTAL:1}),e=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),d=cc.Enum({LEFT:0,CENTER:1,RIGHT:2});m=cc.Class({name:"cc.StudioComponent",extends:cc.Component,editor:!1,properties:!1,statics:{ComponentType:m,ListDirection:h,VerticalAlign:e,HorizontalAlign:d}});var b=f("../utils/prefab-helper");m.PlaceHolder=cc.Class({name:"cc.StudioComponent.PlaceHolder",extends:cc.Component,properties:{_baseUrl:"",nestedPrefab:cc.Prefab},onLoad:function(){this.nestedPrefab&&
this._replaceWithNestedPrefab()},_replaceWithNestedPrefab:function(){var a=this.node,c=a._prefab;c.root=a;c.asset=this.nestedPrefab;b.syncWithPrefab(a)}});cc.StudioComponent=n.exports=m;f=cc.Class({name:"cc.StudioWidget",extends:cc.Widget,editor:!1,_validateTargetInDEV:function(){}});cc.StudioWidget=n.exports=f},{"../utils/prefab-helper":223}],81:[function(f,n,m){m=f("../utils/gray-sprite-state");m=cc.Class({name:"cc.Toggle",extends:f("./CCButton"),mixins:[m],editor:!1,properties:{_N$isChecked:!0,
isChecked:{get:function(){return this._N$isChecked},set:function(f){if(f!==this._N$isChecked){var e=this.toggleGroup||this._toggleContainer;e&&e.enabled&&this._N$isChecked&&!e.allowSwitchOff||(this._N$isChecked=f,this._updateCheckMark(),e&&e.enabled&&e.updateToggles(this),this._emitToggleEvents())}},tooltip:!1},toggleGroup:{default:null,tooltip:!1,type:f("./CCToggleGroup")},checkMark:{default:null,type:cc.Sprite,tooltip:!1},checkEvents:{default:[],type:cc.Component.EventHandler},_resizeToTarget:{animatable:!1,
set:function(f){f&&this._resizeNodeToTargetNode()}}},onEnable:function(){this._super();this._registerToggleEvent();this.toggleGroup&&this.toggleGroup.enabledInHierarchy&&this.toggleGroup.addToggle(this)},onDisable:function(){this._super();this._unregisterToggleEvent();this.toggleGroup&&this.toggleGroup.enabledInHierarchy&&this.toggleGroup.removeToggle(this)},_hideCheckMark:function(){this._N$isChecked=!1;this._updateCheckMark()},toggle:function(f){this.isChecked=!this.isChecked},check:function(){this.isChecked=
!0},uncheck:function(){this.isChecked=!1},_updateCheckMark:function(){this.checkMark&&(this.checkMark.node.active=!!this.isChecked)},_updateDisabledState:function(){(this._super(),this.enableAutoGrayEffect&&this.checkMark)&&this._switchGrayMaterial(!this.interactable,this.checkMark)},_registerToggleEvent:function(){this.node.on("click",this.toggle,this)},_unregisterToggleEvent:function(){this.node.off("click",this.toggle,this)},_emitToggleEvents:function(){this.node.emit("toggle",this);this.checkEvents&&
cc.Component.EventHandler.emitEvents(this.checkEvents,this)}});cc.Toggle=n.exports=m;f("../platform/js").get(m.prototype,"_toggleContainer",function(){var f=this.node.parent;return cc.Node.isNode(f)?f.getComponent(cc.ToggleContainer):null})},{"../platform/js":150,"../utils/gray-sprite-state":217,"./CCButton":62,"./CCToggleGroup":83}],82:[function(f,n,m){m=cc.Class({name:"cc.ToggleContainer",extends:cc.Component,editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},checkEvents:{default:[],type:cc.Component.EventHandler}},
updateToggles:function(f){this.enabledInHierarchy&&f.isChecked&&(this.toggleItems.forEach(function(e){e!==f&&e.isChecked&&e.enabled&&e._hideCheckMark()}),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,f))},_allowOnlyOneToggleChecked:function(){var f=!1;return this.toggleItems.forEach(function(e){f?e._hideCheckMark():e.isChecked&&(f=!0)}),f},_makeAtLeastOneToggleChecked:function(){if(!this._allowOnlyOneToggleChecked()&&!this.allowSwitchOff){var f=this.toggleItems;0<f.length&&
f[0].check()}},onEnable:function(){this.node.on("child-added",this._allowOnlyOneToggleChecked,this);this.node.on("child-removed",this._makeAtLeastOneToggleChecked,this)},onDisable:function(){this.node.off("child-added",this._allowOnlyOneToggleChecked,this);this.node.off("child-removed",this._makeAtLeastOneToggleChecked,this)},start:function(){this._makeAtLeastOneToggleChecked()}});f("../platform/js").get(m.prototype,"toggleItems",function(){return this.node.getComponentsInChildren(cc.Toggle)});cc.ToggleContainer=
n.exports=m},{"../platform/js":150}],83:[function(f,n,m){var h=cc.Class({name:"cc.ToggleGroup",extends:cc.Component,ctor:function(){this._toggleItems=[]},editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},toggleItems:{get:function(){return this._toggleItems}}},updateToggles:function(d){this.enabledInHierarchy&&this._toggleItems.forEach(function(b){d.isChecked&&b!==d&&b.isChecked&&b.enabled&&b._hideCheckMark()})},addToggle:function(d){-1===this._toggleItems.indexOf(d)&&this._toggleItems.push(d);
this._allowOnlyOneToggleChecked()},removeToggle:function(d){d=this._toggleItems.indexOf(d);-1<d&&this._toggleItems.splice(d,1);this._makeAtLeastOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var d=!1;return this._toggleItems.forEach(function(b){d&&b.enabled&&b._hideCheckMark();b.isChecked&&b.enabled&&(d=!0)}),d},_makeAtLeastOneToggleChecked:function(){this._allowOnlyOneToggleChecked()||this.allowSwitchOff||0<this._toggleItems.length&&(this._toggleItems[0].isChecked=!0)},start:function(){this._makeAtLeastOneToggleChecked()}}),
e=!1;f("../platform/js").get(cc,"ToggleGroup",function(){return e||(cc.logID(1405,"cc.ToggleGroup","cc.ToggleContainer"),e=!0),h});n.exports=h},{"../platform/js":150}],84:[function(f,n,m){f=cc.Class({name:"cc.ViewGroup",extends:f("./CCComponent")});cc.ViewGroup=n.exports=f},{"./CCComponent":64}],85:[function(f,n,m){var h=f("../base-ui/CCWidgetManager"),e=h.AlignMode;m=h._AlignFlags;var d=m.TOP,b=m.MID,a=m.BOT,c=m.LEFT,g=m.CENTER,k=m.RIGHT,l=d|a,q=c|k;f=cc.Class({name:"cc.Widget",extends:f("./CCComponent"),
editor:!1,properties:{target:{get:function(){return this._target},set:function(a){this._target=a},type:cc.Node,tooltip:!1},isAlignTop:{get:function(){return 0<(this._alignFlags&d)},set:function(a){this._setAlign(d,a)},animatable:!1,tooltip:!1},isAlignVerticalCenter:{get:function(){return 0<(this._alignFlags&b)},set:function(a){a?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=b):this._alignFlags&=~b},animatable:!1,tooltip:!1},isAlignBottom:{get:function(){return 0<(this._alignFlags&a)},
set:function(c){this._setAlign(a,c)},animatable:!1,tooltip:!1},isAlignLeft:{get:function(){return 0<(this._alignFlags&c)},set:function(a){this._setAlign(c,a)},animatable:!1,tooltip:!1},isAlignHorizontalCenter:{get:function(){return 0<(this._alignFlags&g)},set:function(a){a?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=g):this._alignFlags&=~g},animatable:!1,tooltip:!1},isAlignRight:{get:function(){return 0<(this._alignFlags&k)},set:function(a){this._setAlign(k,a)},animatable:!1,tooltip:!1},
isStretchWidth:{get:function(){return(this._alignFlags&q)===q},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&l)===l},visible:!1},top:{get:function(){return this._top},set:function(a){this._top=a},tooltip:!1},bottom:{get:function(){return this._bottom},set:function(a){this._bottom=a},tooltip:!1},left:{get:function(){return this._left},set:function(a){this._left=a},tooltip:!1},right:{get:function(){return this._right},set:function(a){this._right=a},tooltip:!1},horizontalCenter:{get:function(){return this._horizontalCenter},
set:function(a){this._horizontalCenter=a},tooltip:!1},verticalCenter:{get:function(){return this._verticalCenter},set:function(a){this._verticalCenter=a},tooltip:!1},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(a){this._isAbsHorizontalCenter=a},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(a){this._isAbsVerticalCenter=a},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(a){this._isAbsTop=
a},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(a){this._isAbsBottom=a},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(a){this._isAbsLeft=a},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(a){this._isAbsRight=a},animatable:!1},alignMode:{default:e.ON_WINDOW_RESIZE,type:e,tooltip:!1},_wasAlignOnce:{default:void 0,formerlySerializedAs:"isAlignOnce"},_target:null,_alignFlags:0,_left:0,_right:0,
_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},statics:{AlignMode:e},onLoad:function(){void 0!==this._wasAlignOnce&&(this.alignMode=this._wasAlignOnce?e.ONCE:e.ALWAYS,this._wasAlignOnce=void 0)},onEnable:function(){h.add(this)},onDisable:function(){h.remove(this)},_validateTargetInDEV:!1,_setAlign:function(a,c){if(c!==0<(this._alignFlags&a)){var b=
0<(a&q);c?(this._alignFlags|=a,b?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(b?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~a)}},updateAlignment:function(){h.updateAlignment(this.node)}});Object.defineProperty(f.prototype,"isAlignOnce",{get:function(){return this.alignMode===
e.ONCE},set:function(a){this.alignMode=a?e.ONCE:e.ALWAYS}});cc.Widget=n.exports=f},{"../base-ui/CCWidgetManager":56,"./CCComponent":64}],86:[function(f,n,m){function h(a){return a.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})}var e=f("../../platform/CCMacro");m=f("../editbox/EditBoxImplBase");var d=f("../CCLabel"),b=f("./types"),a=b.InputMode,c=b.InputFlag;b=b.KeyboardReturnType;var g=cc.Class({name:"cc.EditBox",extends:cc.Component,editor:!1,properties:{_useOriginalSize:!0,_string:"",
string:{tooltip:!1,get:function(){return this._string},set:function(a){a=""+a;0<=this.maxLength&&a.length>=this.maxLength&&(a=a.slice(0,this.maxLength));this._string=a;this._updateString(a)}},textLabel:{tooltip:!1,default:null,type:d,notify:function(a){this.textLabel&&this.textLabel!==a&&(this._updateTextLabel(),this._updateLabels())}},placeholderLabel:{tooltip:!1,default:null,type:d,notify:function(a){this.placeholderLabel&&this.placeholderLabel!==a&&(this._updatePlaceholderLabel(),this._updateLabels())}},
background:{tooltip:!1,default:null,type:cc.Sprite,notify:function(a){this.background&&this.background!==a&&this._updateBackgroundSprite()}},_N$backgroundImage:{default:void 0,type:cc.SpriteFrame},backgroundImage:{get:function(){return this.background?this.background.spriteFrame:null},set:function(a){this.background&&(this.background.spriteFrame=a)}},returnType:{default:b.DEFAULT,tooltip:!1,displayName:"KeyboardReturnType",type:b},_N$returnType:{default:void 0,type:cc.Float},inputFlag:{tooltip:!1,
default:c.DEFAULT,type:c,notify:function(){this._updateString(this._string)}},inputMode:{tooltip:!1,default:a.ANY,type:a,notify:function(a){this.inputMode!==a&&(this._updateTextLabel(),this._updatePlaceholderLabel())}},fontSize:{get:function(){return this.textLabel?this.textLabel.fontSize:null},set:function(a){this.textLabel&&(this.textLabel.fontSize=a)}},_N$fontSize:{default:void 0,type:cc.Float},lineHeight:{get:function(){return this.textLabel?this.textLabel.lineHeight:null},set:function(a){this.textLabel&&
(this.textLabel.lineHeight=a)}},_N$lineHeight:{default:void 0,type:cc.Float},fontColor:{get:function(){return this.textLabel?this.textLabel.node.color:null},set:function(a){this.textLabel&&(this.textLabel.node.color=a,this.textLabel.node.opacity=a.a)}},_N$fontColor:void 0,placeholder:{tooltip:!1,get:function(){return this.placeholderLabel?this.placeholderLabel.string:""},set:function(a){this.placeholderLabel&&(this.placeholderLabel.string=a)}},_N$placeholder:{default:void 0,type:cc.String},placeholderFontSize:{get:function(){return this.placeholderLabel?
this.placeholderLabel.fontSize:null},set:function(a){this.placeholderLabel&&(this.placeholderLabel.fontSize=a)}},_N$placeholderFontSize:{default:void 0,type:cc.Float},placeholderFontColor:{get:function(){return this.placeholderLabel?this.placeholderLabel.node.color:null},set:function(a){this.placeholderLabel&&(this.placeholderLabel.node.color=a,this.placeholderLabel.node.opacity=a.a)}},_N$placeholderFontColor:void 0,maxLength:{tooltip:!1,default:20},_N$maxLength:{default:void 0,type:cc.Float},stayOnTop:{default:!1,
notify:function(){cc.warn("editBox.stayOnTop is removed since v2.1.")}},_tabIndex:0,tabIndex:{tooltip:!1,get:function(){return this._tabIndex},set:function(a){this._tabIndex!==a&&(this._tabIndex=a,this._impl&&this._impl.setTabIndex(a))}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{_ImplClass:m,KeyboardReturnType:b,
InputFlag:c,InputMode:a},_init:function(){this._upgradeComp();this._isLabelVisible=!0;this.node.on(cc.Node.EventType.SIZE_CHANGED,this._syncSize,this);(this._impl=new g._ImplClass).init(this);this._updateString(this._string);this._syncSize()},_updateBackgroundSprite:function(){var a=this.background;if(!a){var c=this.node.getChildByName("BACKGROUND_SPRITE");c||(c=new cc.Node("BACKGROUND_SPRITE"));(a=c.getComponent(cc.Sprite))||(a=c.addComponent(cc.Sprite));c.parent=this.node;this.background=a}a.type=
cc.Sprite.Type.SLICED;void 0!==this._N$backgroundImage&&(a.spriteFrame=this._N$backgroundImage,this._N$backgroundImage=void 0)},_updateTextLabel:function(){var c=this.textLabel;if(!c){var b=this.node.getChildByName("TEXT_LABEL");b||(b=new cc.Node("TEXT_LABEL"));(c=b.getComponent(d))||(c=b.addComponent(d));b.parent=this.node;this.textLabel=c}c.node.setAnchorPoint(0,1);c.overflow=d.Overflow.CLAMP;this.inputMode===a.ANY?(c.verticalAlign=e.VerticalTextAlignment.TOP,c.enableWrapText=!0):(c.verticalAlign=
e.VerticalTextAlignment.CENTER,c.enableWrapText=!1);c.string=this._updateLabelStringStyle(this._string);void 0!==this._N$fontColor&&(c.node.color=this._N$fontColor,c.node.opacity=this._N$fontColor.a,this._N$fontColor=void 0);void 0!==this._N$fontSize&&(c.fontSize=this._N$fontSize,this._N$fontSize=void 0);void 0!==this._N$lineHeight&&(c.lineHeight=this._N$lineHeight,this._N$lineHeight=void 0)},_updatePlaceholderLabel:function(){var c=this.placeholderLabel;if(!c){var b=this.node.getChildByName("PLACEHOLDER_LABEL");
b||(b=new cc.Node("PLACEHOLDER_LABEL"));(c=b.getComponent(d))||(c=b.addComponent(d));b.parent=this.node;this.placeholderLabel=c}c.node.setAnchorPoint(0,1);c.overflow=d.Overflow.CLAMP;this.inputMode===a.ANY?(c.verticalAlign=e.VerticalTextAlignment.TOP,c.enableWrapText=!0):(c.verticalAlign=e.VerticalTextAlignment.CENTER,c.enableWrapText=!1);c.string=this.placeholder;void 0!==this._N$placeholderFontColor&&(c.node.color=this._N$placeholderFontColor,c.node.opacity=this._N$placeholderFontColor.a,this._N$placeholderFontColor=
void 0);void 0!==this._N$placeholderFontSize&&(c.fontSize=this._N$placeholderFontSize,this._N$placeholderFontSize=void 0)},_upgradeComp:function(){void 0!==this._N$returnType&&(this.returnType=this._N$returnType,this._N$returnType=void 0);void 0!==this._N$maxLength&&(this.maxLength=this._N$maxLength,this._N$maxLength=void 0);void 0!==this._N$backgroundImage&&this._updateBackgroundSprite();void 0===this._N$fontColor&&void 0===this._N$fontSize&&void 0===this._N$lineHeight||this._updateTextLabel();void 0===
this._N$placeholderFontColor&&void 0===this._N$placeholderFontSize||this._updatePlaceholderLabel();void 0!==this._N$placeholder&&(this.placeholder=this._N$placeholder,this._N$placeholder=void 0)},_syncSize:function(){if(this._impl){var a=this.node.getContentSize();this._impl.setSize(a.width,a.height)}},_showLabels:function(){this._isLabelVisible=!0;this._updateLabels()},_hideLabels:function(){this._isLabelVisible=!1;this.textLabel&&(this.textLabel.node.active=!1);this.placeholderLabel&&(this.placeholderLabel.node.active=
!1)},_updateLabels:function(){if(this._isLabelVisible){var a=this._string;this.textLabel&&(this.textLabel.node.active=""!==a);this.placeholderLabel&&(this.placeholderLabel.node.active=""===a)}},_updateString:function(a){var c=this.textLabel;c&&(a&&(a=this._updateLabelStringStyle(a)),c.string=a,this._updateLabels())},_updateLabelStringStyle:function(a,b){var d=this.inputFlag;if(b||d!==c.PASSWORD)d===c.INITIAL_CAPS_ALL_CHARACTERS?a=a.toUpperCase():d===c.INITIAL_CAPS_WORD?a=h(a):d===c.INITIAL_CAPS_SENTENCE&&
(a=a.charAt(0).toUpperCase()+a.slice(1));else{b="";a=a.length;for(d=0;d<a;++d)b+="\u25cf";a=b}return a},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this);this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this);this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(a){this.string=a=this._updateLabelStringStyle(a,!0);cc.Component.EventHandler.emitEvents(this.textChanged,
a,this);this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this);this.node.emit("editing-return",this)},onEnable:function(){this._registerEvent();this._impl&&this._impl.enable()},onDisable:function(){this._unregisterEvent();this._impl&&this._impl.disable()},onDestroy:function(){this._impl&&this._impl.clear()},__preload:function(){this._init()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,
this);this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this);this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_onTouchBegan:function(a){a.stopPropagation()},_onTouchCancel:function(a){a.stopPropagation()},_onTouchEnded:function(a){this._impl&&this._impl.beginEditing();a.stopPropagation()},setFocus:function(){cc.warnID(1400,"setFocus()","focus()");this._impl&&this._impl.setFocus(!0)},
focus:function(){this._impl&&this._impl.setFocus(!0)},blur:function(){this._impl&&this._impl.setFocus(!1)},isFocused:function(){return!!this._impl&&this._impl.isFocused()},update:function(){this._impl&&this._impl.update()}});cc.EditBox=n.exports=g;cc.sys.isBrowser&&f("./WebEditBoxImpl")},{"../../platform/CCMacro":135,"../CCLabel":66,"../editbox/EditBoxImplBase":87,"./WebEditBoxImpl":88,"./types":90}],87:[function(f,n,m){f=cc.Class({ctor:function(){this._delegate=null;this._editing=!1},init:function(f){},
enable:function(){},disable:function(){this._editing&&this.endEditing()},clear:function(){},update:function(){},setTabIndex:function(f){},setSize:function(f,e){},setFocus:function(f){f?this.beginEditing():this.endEditing()},isFocused:function(){return this._editing},beginEditing:function(){},endEditing:function(){}});n.exports=f},{}],88:[function(f,n,m){function h(){E.call(this);this._domId="EditBoxId_"+ ++r;this._elem=this._placeholderStyleSheet=null;this._isTextArea=!1;this._worldMat=l.mat4.create();
this._cameraMat=l.mat4.create();this._h=this._w=this._m13=this._m12=this._m05=this._m04=this._m01=this._m00=0;this._returnType=this._inputFlag=this._inputMode=null;this._eventListeners={};this._placeholderLineHeight=this._placeholderLabelAlign=this._placeholderLabelFontColor=this._placeholderLabelFontSize=this._placeholderLabelFont=this._textLabelAlign=this._textLabelFontColor=this._textLabelFontSize=this._textLabelFont=null}var e=f("../../platform/utils"),d=f("../../platform/CCMacro");n=f("./types");
var b=f("../CCLabel"),a=f("./tabIndexUtil");f=cc.EditBox;m=cc.js;var c=n.InputMode,g=n.InputFlag,k=n.KeyboardReturnType,l=cc.vmath,q=!1;cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(q=!0);var r=0,t=cc.v3(),p=null,v=!1,w=!1,E=f._ImplClass;m.extend(h,E);f._ImplClass=h;Object.assign(h.prototype,{init:function(b){b&&(this._delegate=b,b.inputMode===c.ANY?this._createTextArea():this._createInput(),a.add(this),this.setTabIndex(b.tabIndex),
this._initStyleSheet(),this._registerEventListeners(),this._addDomToGameContainer(),v=cc.view.isAutoFullScreenEnabled(),w=cc.view._resizeWithBrowserSize)},clear:function(){this._removeEventListeners();this._removeDomFromGameContainer();a.remove(this);p===this&&(p=null)},update:function(){this._updateMatrix()},setTabIndex:function(c){this._elem.tabIndex=c;a.resort()},setSize:function(a,c){var b=this._elem;b.style.width=a+"px";b.style.height=c+"px"},beginEditing:function(){p&&p!==this&&p.setFocus(!1);
this._editing=!0;p=this;this._delegate.editBoxEditingDidBegan();this._showDom();this._elem.focus()},endEditing:function(){this._elem&&this._elem.blur()},_createInput:function(){this._isTextArea=!1;this._elem=document.createElement("input")},_createTextArea:function(){this._isTextArea=!0;this._elem=document.createElement("textarea")},_addDomToGameContainer:function(){cc.game.container.appendChild(this._elem);document.head.appendChild(this._placeholderStyleSheet)},_removeDomFromGameContainer:function(){e.contains(cc.game.container,
this._elem)&&cc.game.container.removeChild(this._elem);e.contains(document.head,this._placeholderStyleSheet)&&document.head.removeChild(this._placeholderStyleSheet);delete this._elem;delete this._placeholderStyleSheet},_showDom:function(){this._updateMaxLength();this._updateInputType();this._updateStyleSheet();this._elem.style.display="";this._delegate._hideLabels();cc.sys.isMobile&&this._showDomOnMobile()},_hideDom:function(){this._elem.style.display="none";this._delegate._showLabels();cc.sys.isMobile&&
this._hideDomOnMobile()},_showDomOnMobile:function(){cc.sys.os===cc.sys.OS_ANDROID&&(v&&(cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()),w&&cc.view.resizeWithBrowserSize(!1),this._adjustWindowScroll())},_hideDomOnMobile:function(){cc.sys.os===cc.sys.OS_ANDROID&&setTimeout(function(){p||(v&&cc.view.enableAutoFullScreen(!0),w&&cc.view.resizeWithBrowserSize(!0))},800);this._scrollBackWindow()},_adjustWindowScroll:function(){var a=this;setTimeout(function(){100>window.scrollY&&a._elem.scrollIntoView({block:"start",
inline:"nearest",behavior:"smooth"})},800)},_scrollBackWindow:function(){setTimeout(function(){var a=cc.sys;a.browserType!==a.BROWSER_TYPE_WECHAT||a.os!==a.OS_IOS?window.scrollTo(0,0):window.top&&window.top.scrollTo(0,0)},800)},_updateMatrix:function(){var a=this._delegate.node;a.getWorldMatrix(this._worldMat);var c=this._worldMat,b=c.m;if(this._m00!==b[0]||this._m01!==b[1]||this._m04!==b[4]||this._m05!==b[5]||this._m12!==b[12]||this._m13!==b[13]||this._w!==a._contentSize.width||this._h!==a._contentSize.height){this._m00=
b[0];this._m01=b[1];this._m04=b[4];this._m05=b[5];this._m12=b[12];this._m13=b[13];this._w=a._contentSize.width;this._h=a._contentSize.height;var d=cc.view._scaleX;b=cc.view._scaleY;var g=cc.view._viewportRect,k=cc.view._devicePixelRatio;t.x=-a._anchorPoint.x*this._w;t.y=-a._anchorPoint.y*this._h;l.mat4.translate(c,c,t);cc.Camera.findCamera(a).getWorldToScreenMatrix2D(this._cameraMat);var e=this._cameraMat;l.mat4.mul(e,e,c);d/=k;b/=k;var p=cc.game.container,f=e.m;c=f[0]*d;e=f[1];var r=f[4],v=f[5]*
b,w=p&&p.style.paddingLeft&&parseInt(p.style.paddingLeft);w+=g.x/k;p=p&&p.style.paddingBottom&&parseInt(p.style.paddingBottom);p+=g.y/k;d=f[12]*d+w;b=f[13]*b+p;q&&(this.setSize(a.width*c,a.height*v),c=1,v=1);a=this._elem;b="matrix("+c+","+-e+","+-r+","+v+","+d+","+-b+")";a.style.transform=b;a.style["-webkit-transform"]=b;a.style["transform-origin"]="0px 100% 0px";a.style["-webkit-transform-origin"]="0px 100% 0px"}},_updateInputType:function(){var a=this._delegate,b=a.inputMode,d=a.inputFlag,l=a.returnType;
a=this._elem;if(this._inputMode!==b||this._inputFlag!==d||this._returnType!==l){if(this._inputMode=b,this._inputFlag=d,this._returnType=l,this._isTextArea)return b="none",d===g.INITIAL_CAPS_ALL_CHARACTERS?b="uppercase":d===g.INITIAL_CAPS_WORD&&(b="capitalize"),void(a.style.textTransform=b);if(d!==g.PASSWORD){var e=a.type;b===c.EMAIL_ADDR?e="email":b===c.NUMERIC||b===c.DECIMAL?e="number":b===c.PHONE_NUMBER?(e="number",a.pattern="[0-9]*"):b===c.URL?e="url":(e="text",l===k.SEARCH&&(e="search"));a.type=
e;b="none";d===g.INITIAL_CAPS_ALL_CHARACTERS?b="uppercase":d===g.INITIAL_CAPS_WORD&&(b="capitalize");a.style.textTransform=b}else a.type="password"}},_updateMaxLength:function(){var a=this._delegate.maxLength;0>a&&(a=65535);this._elem.maxLength=a},_initStyleSheet:function(){var a=this._elem;a.style.display="none";a.style.border=0;a.style.background="transparent";a.style.width="100%";a.style.height="100%";a.style.active=0;a.style.outline="medium";a.style.padding="0";a.style.textTransform="uppercase";
a.style.position="absolute";a.style.bottom="0px";a.style.left="2px";a.className="cocosEditBox";a.id=this._domId;this._isTextArea?(a.style.resize="none",a.style.overflow_y="scroll"):(a.type="text",a.style["-moz-appearance"]="textfield");this._placeholderStyleSheet=document.createElement("style")},_updateStyleSheet:function(){var a=this._delegate,c=this._elem;c.value=a.string;c.placeholder=a.placeholder;this._updateTextLabel(a.textLabel);this._updatePlaceholderLabel(a.placeholderLabel)},_updateTextLabel:function(a){if(a){var c=
a.font;c=!c||c instanceof cc.BitmapFont?a.fontFamily:c._fontFamily;var d=a.fontSize*a.node.scaleY;if(this._textLabelFont!==c||this._textLabelFontSize!==d||this._textLabelFontColor!==a.fontColor||this._textLabelAlign!==a.horizontalAlign){this._textLabelFont=c;this._textLabelFontSize=d;this._textLabelFontColor=a.fontColor;this._textLabelAlign=a.horizontalAlign;var g=this._elem;switch(g.style.fontSize=d+"px",g.style.color=a.node.color.toCSS("rgba"),g.style.fontFamily=c,a.horizontalAlign){case b.HorizontalAlign.LEFT:g.style.textAlign=
"left";break;case b.HorizontalAlign.CENTER:g.style.textAlign="center";break;case b.HorizontalAlign.RIGHT:g.style.textAlign="right"}}}},_updatePlaceholderLabel:function(a){if(a){var c=a.font;c=!c||c instanceof cc.BitmapFont?a.fontFamily:a.font._fontFamily;var d=a.fontSize*a.node.scaleY;if(this._placeholderLabelFont!==c||this._placeholderLabelFontSize!==d||this._placeholderLabelFontColor!==a.fontColor||this._placeholderLabelAlign!==a.horizontalAlign||this._placeholderLineHeight!==a.fontSize){this._placeholderLabelFont=
c;this._placeholderLabelFontSize=d;this._placeholderLabelFontColor=a.fontColor;this._placeholderLabelAlign=a.horizontalAlign;this._placeholderLineHeight=a.fontSize;var g=this._placeholderStyleSheet,k=a.node.color.toCSS("rgba"),l=a.fontSize,e=void 0;switch(a.horizontalAlign){case b.HorizontalAlign.LEFT:e="left";break;case b.HorizontalAlign.CENTER:e="center";break;case b.HorizontalAlign.RIGHT:e="right"}g.innerHTML="#"+this._domId+"::-webkit-input-placeholder,#"+this._domId+"::-moz-placeholder,#"+this._domId+
":-ms-input-placeholder{text-transform: initial; font-family: "+c+"; font-size: "+d+"px; color: "+k+"; line-height: "+l+"px; text-align: "+e+";}";cc.sys.browserType===cc.sys.BROWSER_TYPE_EDGE&&(g.innerHTML+="#"+this._domId+"::-ms-clear{display: none;}")}}},_registerEventListeners:function(){var c=this,b=this._elem,g=!1,k=this._eventListeners;k.compositionStart=function(){g=!0};k.compositionEnd=function(){g=!1;c._delegate.editBoxTextChanged(b.value)};k.onInput=function(){g||c._delegate.editBoxTextChanged(b.value)};
k.onClick=function(a){c._editing&&cc.sys.isMobile&&c._adjustWindowScroll()};k.onKeydown=function(g){g.keyCode===d.KEY.enter?(g.stopPropagation(),c._delegate.editBoxEditingReturn(),c._isTextArea||b.blur()):g.keyCode===d.KEY.tab&&(g.stopPropagation(),g.preventDefault(),a.next(c))};k.onBlur=function(){c._editing=!1;p=null;c._hideDom();c._delegate.editBoxEditingDidEnded()};b.addEventListener("compositionstart",k.compositionStart);b.addEventListener("compositionend",k.compositionEnd);b.addEventListener("input",
k.onInput);b.addEventListener("keydown",k.onKeydown);b.addEventListener("blur",k.onBlur);b.addEventListener("touchstart",k.onClick)},_removeEventListeners:function(){var a=this._elem,c=this._eventListeners;a.removeEventListener("compositionstart",c.compositionStart);a.removeEventListener("compositionend",c.compositionEnd);a.removeEventListener("input",c.onInput);a.removeEventListener("keydown",c.onKeydown);a.removeEventListener("blur",c.onBlur);a.removeEventListener("touchstart",c.onClick);c.compositionStart=
null;c.compositionEnd=null;c.onInput=null;c.onKeydown=null;c.onBlur=null;c.onClick=null}})},{"../../platform/CCMacro":135,"../../platform/utils":154,"../CCLabel":66,"./tabIndexUtil":89,"./types":90}],89:[function(f,n,m){n.exports={_tabIndexList:[],add:function(f){var e=this._tabIndexList;-1===e.indexOf(f)&&e.push(f)},remove:function(f){var e=this._tabIndexList;f=e.indexOf(f);-1!==f&&e.splice(f,1)},resort:function(){this._tabIndexList.sort(function(f,e){return f._delegate._tabIndex-e._delegate._tabIndex})},
next:function(f){var e=this._tabIndexList,d=e.indexOf(f);(f.setFocus(!1),-1!==d)&&(f=e[d+1])&&0<=f._delegate._tabIndex&&f.setFocus(!0)}}},{}],90:[function(f,n,m){f=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4,NEXT:5});m=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6});var h=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5});n.exports={KeyboardReturnType:f,InputMode:m,InputFlag:h}},{}],91:[function(f,
n,m){f("./CCComponent");f("./CCComponentEventHandler");f("./missing-script");m=f("./WXSubContextView");var h=f("./SwanSubContextView");m||(m=cc.Class({name:"cc.WXSubContextView",extends:cc.Component}));h||(h=cc.Class({name:"cc.SwanSubContextView",extends:cc.Component}));f=[f("./CCSprite"),f("./CCWidget"),f("./CCCanvas"),f("./CCAudioSource"),f("./CCAnimation"),f("./CCButton"),f("./CCLabel"),f("./CCProgressBar"),f("./CCMask"),f("./CCScrollBar"),f("./CCScrollView"),f("./CCPageViewIndicator"),f("./CCPageView"),
f("./CCSlider"),f("./CCLayout"),f("./editbox/CCEditBox"),f("./CCLabelOutline"),f("./CCLabelShadow"),f("./CCRichText"),f("./CCToggleContainer"),f("./CCToggleGroup"),f("./CCToggle"),f("./CCBlockInputEvents"),f("./CCMotionStreak"),m,h];n.exports=f},{"./CCAnimation":59,"./CCAudioSource":60,"./CCBlockInputEvents":61,"./CCButton":62,"./CCCanvas":63,"./CCComponent":64,"./CCComponentEventHandler":65,"./CCLabel":66,"./CCLabelOutline":67,"./CCLabelShadow":68,"./CCLayout":69,"./CCMask":70,"./CCMotionStreak":void 0,
"./CCPageView":71,"./CCPageViewIndicator":72,"./CCProgressBar":73,"./CCRichText":75,"./CCScrollBar":76,"./CCScrollView":77,"./CCSlider":78,"./CCSprite":79,"./CCToggle":81,"./CCToggleContainer":82,"./CCToggleGroup":83,"./CCWidget":85,"./SwanSubContextView":void 0,"./WXSubContextView":void 0,"./editbox/CCEditBox":86,"./missing-script":92}],92:[function(f,n,m){var h=cc.js,e=f("../utils/misc").BUILTIN_CLASSID_RE,d=cc.Class({name:"cc.MissingClass",properties:{_$erialized:{default:null,visible:!1,editorOnly:!0}}}),
b=cc.Class({name:"cc.MissingScript",extends:cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{default:!1,serializable:!1},_$erialized:{default:null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(a,c){return h._getClassById(a)||(a?(cc.deserialize.reportMissingClass(a),b.getMissingWrapper(a,c)):null)},getMissingWrapper:function(a,c){return c.node&&(/^[0-9a-zA-Z+/]{23}$/.test(a)||e.test(a))?b:d}},onLoad:function(){cc.warnID(4600,
this.node.name)}});cc._MissingScript=n.exports=b},{"../utils/misc":220}],93:[function(f,n,m){m=cc.js;f("../event/event");f=function(b,a){cc.Event.call(this,cc.Event.MOUSE,a);this._eventType=b;this._scrollY=this._scrollX=this._prevY=this._prevX=this._y=this._x=this._button=0};m.extend(f,cc.Event);var h=f.prototype;h.setScrollData=function(b,a){this._scrollX=b;this._scrollY=a};h.getScrollX=function(){return this._scrollX};h.getScrollY=function(){return this._scrollY};h.setLocation=function(b,a){this._x=
b;this._y=a};h.getLocation=function(){return cc.v2(this._x,this._y)};h.getLocationInView=function(){return cc.v2(this._x,cc.view._designResolutionSize.height-this._y)};h._setPrevCursor=function(b,a){this._prevX=b;this._prevY=a};h.getPreviousLocation=function(){return cc.v2(this._prevX,this._prevY)};h.getDelta=function(){return cc.v2(this._x-this._prevX,this._y-this._prevY)};h.getDeltaX=function(){return this._x-this._prevX};h.getDeltaY=function(){return this._y-this._prevY};h.setButton=function(b){this._button=
b};h.getButton=function(){return this._button};h.getLocationX=function(){return this._x};h.getLocationY=function(){return this._y};f.NONE=0;f.DOWN=1;f.UP=2;f.MOVE=3;f.SCROLL=4;f.BUTTON_LEFT=0;f.BUTTON_RIGHT=2;f.BUTTON_MIDDLE=1;f.BUTTON_4=3;f.BUTTON_5=4;f.BUTTON_6=5;f.BUTTON_7=6;f.BUTTON_8=7;var e=function(b,a){cc.Event.call(this,cc.Event.TOUCH,a);this._eventCode=0;this._touches=b||[];this.currentTouch=this.touch=null};m.extend(e,cc.Event);(h=e.prototype).getEventCode=function(){return this._eventCode};
h.getTouches=function(){return this._touches};h._setEventCode=function(b){this._eventCode=b};h._setTouches=function(b){this._touches=b};h.setLocation=function(b,a){this.touch&&this.touch.setTouchInfo(this.touch.getID(),b,a)};h.getLocation=function(){return this.touch?this.touch.getLocation():cc.v2()};h.getLocationInView=function(){return this.touch?this.touch.getLocationInView():cc.v2()};h.getPreviousLocation=function(){return this.touch?this.touch.getPreviousLocation():cc.v2()};h.getStartLocation=
function(){return this.touch?this.touch.getStartLocation():cc.v2()};h.getID=function(){return this.touch?this.touch.getID():null};h.getDelta=function(){return this.touch?this.touch.getDelta():cc.v2()};h.getDeltaX=function(){return this.touch?this.touch.getDelta().x:0};h.getDeltaY=function(){return this.touch?this.touch.getDelta().y:0};h.getLocationX=function(){return this.touch?this.touch.getLocationX():0};h.getLocationY=function(){return this.touch?this.touch.getLocationY():0};e.MAX_TOUCHES=5;e.BEGAN=
0;e.MOVED=1;e.ENDED=2;e.CANCELED=3;h=function(b,a){cc.Event.call(this,cc.Event.ACCELERATION,a);this.acc=b};m.extend(h,cc.Event);var d=function(b,a,c){cc.Event.call(this,cc.Event.KEYBOARD,c);this.keyCode=b;this.isPressed=a};m.extend(d,cc.Event);cc.Event.EventMouse=f;cc.Event.EventTouch=e;cc.Event.EventAcceleration=h;cc.Event.EventKeyboard=d;n.exports=cc.Event},{"../event/event":100}],94:[function(f,n,m){f=f("../platform/js");cc.EventListener=function(a,c,b){this._onEvent=b;this._type=a||0;this._listenerID=
c||"";this._registered=!1;this._fixedPriority=0;this._target=this._node=null;this._isEnabled=this._paused=!0};cc.EventListener.prototype={constructor:cc.EventListener,_setPaused:function(a){this._paused=a},_isPaused:function(){return this._paused},_setRegistered:function(a){this._registered=a},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(a){this._fixedPriority=a},_getFixedPriority:function(){return this._fixedPriority},
_setSceneGraphPriority:function(a){this._node=this._target=a},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(a){this._isEnabled=a},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}};cc.EventListener.UNKNOWN=0;cc.EventListener.TOUCH_ONE_BY_ONE=1;cc.EventListener.TOUCH_ALL_AT_ONCE=2;cc.EventListener.KEYBOARD=3;cc.EventListener.MOUSE=4;cc.EventListener.ACCELERATION=
6;cc.EventListener.CUSTOM=8;var h=cc.EventListener.ListenerID={MOUSE:"__cc_mouse",TOUCH_ONE_BY_ONE:"__cc_touch_one_by_one",TOUCH_ALL_AT_ONCE:"__cc_touch_all_at_once",KEYBOARD:"__cc_keyboard",ACCELERATION:"__cc_acceleration"},e=function(a,c){this._onCustomEvent=c;cc.EventListener.call(this,cc.EventListener.CUSTOM,a,this._callback)};f.extend(e,cc.EventListener);f.mixin(e.prototype,{_onCustomEvent:null,_callback:function(a){null!==this._onCustomEvent&&this._onCustomEvent(a)},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&
null!==this._onCustomEvent},clone:function(){return new e(this._listenerID,this._onCustomEvent)}});var d=function(){cc.EventListener.call(this,cc.EventListener.MOUSE,h.MOUSE,this._callback)};f.extend(d,cc.EventListener);f.mixin(d.prototype,{onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,_callback:function(a){var c=cc.Event.EventMouse;switch(a._eventType){case c.DOWN:this.onMouseDown&&this.onMouseDown(a);break;case c.UP:this.onMouseUp&&this.onMouseUp(a);break;case c.MOVE:this.onMouseMove&&
this.onMouseMove(a);break;case c.SCROLL:this.onMouseScroll&&this.onMouseScroll(a)}},clone:function(){var a=new d;return a.onMouseDown=this.onMouseDown,a.onMouseUp=this.onMouseUp,a.onMouseMove=this.onMouseMove,a.onMouseScroll=this.onMouseScroll,a},checkAvailable:function(){return!0}});var b=function(){cc.EventListener.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,h.TOUCH_ONE_BY_ONE,null);this._claimedTouches=[]};f.extend(b,cc.EventListener);f.mixin(b.prototype,{constructor:b,_claimedTouches:null,swallowTouches:!1,
onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,setSwallowTouches:function(a){this.swallowTouches=a},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var a=new b;return a.onTouchBegan=this.onTouchBegan,a.onTouchMoved=this.onTouchMoved,a.onTouchEnded=this.onTouchEnded,a.onTouchCancelled=this.onTouchCancelled,a.swallowTouches=this.swallowTouches,a},checkAvailable:function(){return!!this.onTouchBegan||(cc.logID(1801),!1)}});var a=function(){cc.EventListener.call(this,
cc.EventListener.TOUCH_ALL_AT_ONCE,h.TOUCH_ALL_AT_ONCE,null)};f.extend(a,cc.EventListener);f.mixin(a.prototype,{constructor:a,onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,clone:function(){var c=new a;return c.onTouchesBegan=this.onTouchesBegan,c.onTouchesMoved=this.onTouchesMoved,c.onTouchesEnded=this.onTouchesEnded,c.onTouchesCancelled=this.onTouchesCancelled,c},checkAvailable:function(){return null!==this.onTouchesBegan||null!==this.onTouchesMoved||null!==
this.onTouchesEnded||null!==this.onTouchesCancelled||(cc.logID(1802),!1)}});var c=function(a){this._onAccelerationEvent=a;cc.EventListener.call(this,cc.EventListener.ACCELERATION,h.ACCELERATION,this._callback)};f.extend(c,cc.EventListener);f.mixin(c.prototype,{constructor:c,_onAccelerationEvent:null,_callback:function(a){this._onAccelerationEvent(a.acc,a)},checkAvailable:function(){return cc.assertID(this._onAccelerationEvent,1803),!0},clone:function(){return new c(this._onAccelerationEvent)}});var g=
function(){cc.EventListener.call(this,cc.EventListener.KEYBOARD,h.KEYBOARD,this._callback)};f.extend(g,cc.EventListener);f.mixin(g.prototype,{constructor:g,onKeyPressed:null,onKeyReleased:null,_callback:function(a){a.isPressed?this.onKeyPressed&&this.onKeyPressed(a.keyCode,a):this.onKeyReleased&&this.onKeyReleased(a.keyCode,a)},clone:function(){var a=new g;return a.onKeyPressed=this.onKeyPressed,a.onKeyReleased=this.onKeyReleased,a},checkAvailable:function(){return null!==this.onKeyPressed||null!==
this.onKeyReleased||(cc.logID(1800),!1)}});cc.EventListener.create=function(k){cc.assertID(k&&k.event,1900);var l=k.event;delete k.event;var q=null,f;for(f in l===cc.EventListener.TOUCH_ONE_BY_ONE?q=new b:l===cc.EventListener.TOUCH_ALL_AT_ONCE?q=new a:l===cc.EventListener.MOUSE?q=new d:l===cc.EventListener.CUSTOM?(q=new e(k.eventName,k.callback),delete k.eventName,delete k.callback):l===cc.EventListener.KEYBOARD?q=new g:l===cc.EventListener.ACCELERATION&&(q=new c(k.callback),delete k.callback),k)q[f]=
k[f];return q};n.exports=cc.EventListener},{"../platform/js":150}],95:[function(f,n,m){m=f("../platform/js");f("./CCEventListener");var h=cc.EventListener.ListenerID,e=function(){this._fixedListeners=[];this._sceneGraphListeners=[];this.gt0Index=0};e.prototype={constructor:e,size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(b){0===b._getFixedPriority()?this._sceneGraphListeners.push(b):
this._fixedListeners.push(b)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0;this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}};var d={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},
_nodeListenersMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyListeners:{},_inDispatch:0,_isEnabled:!1,_internalCustomListenerIDs:[],_setDirtyForNode:function(b){var a=this._nodeListenersMap[b._id];if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var k=a[c]._getListenerID();null==this._dirtyListeners[k]&&(this._dirtyListeners[k]=!0)}if(b.getChildren)for(b=b.getChildren(),a=0,d=b?b.length:0;a<d;a++)this._setDirtyForNode(b[a])},pauseTarget:function(b,a){if(b instanceof cc._BaseNode){var c,d=this._nodeListenersMap[b._id];
if(d){var k=0;for(c=d.length;k<c;k++)d[k]._setPaused(!0)}if(!0===a)for(b=b.getChildren(),k=0,c=b?b.length:0;k<c;k++)this.pauseTarget(b[k],!0)}else cc.warnID(3506)},resumeTarget:function(b,a){if(b instanceof cc._BaseNode){var c,d=this._nodeListenersMap[b._id];if(d){var k=0;for(c=d.length;k<c;k++)d[k]._setPaused(!1)}if(this._setDirtyForNode(b),!0===a&&b.getChildren)for(b=b.getChildren(),k=0,c=b?b.length:0;k<c;k++)this.resumeTarget(b[k],!0)}else cc.warnID(3506)},_addListener:function(b){0===this._inDispatch?
this._forceAddEventListener(b):this._toAddedListeners.push(b)},_forceAddEventListener:function(b){var a=b._getListenerID(),c=this._listenersMap[a];(c||(c=new e,this._listenersMap[a]=c),c.push(b),0===b._getFixedPriority())?(this._setDirty(a,this.DIRTY_SCENE_GRAPH_PRIORITY),a=b._getSceneGraphPriority(),null===a&&cc.logID(3507),this._associateNodeAndEventListener(a,b),a.activeInHierarchy&&this.resumeTarget(a)):this._setDirty(a,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(b){return this._listenersMap[b]},
_updateDirtyFlagForSceneGraph:function(){var b=this._dirtyListeners,a;for(a in b)this._setDirty(a,this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyListeners={}},_removeAllListenersInVector:function(b){if(b)for(var a,c=b.length-1;0<=c;c--)(a=b[c])._setRegistered(!1),null!=a._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(a._getSceneGraphPriority(),a),a._setSceneGraphPriority(null)),0===this._inDispatch&&cc.js.array.removeAt(b,c)},_removeListenersForListenerID:function(b){var a;if(a=this._listenersMap[b]){var c=
a.getFixedPriorityListeners(),d=a.getSceneGraphPriorityListeners();this._removeAllListenersInVector(d);this._removeAllListenersInVector(c);delete this._priorityDirtyFlagMap[b];this._inDispatch||(a.clear(),delete this._listenersMap[b])}var k;c=this._toAddedListeners;for(a=c.length-1;0<=a;a--)(k=c[a])&&k._getListenerID()===b&&cc.js.array.removeAt(c,a)},_sortEventListeners:function(b){var a=this.DIRTY_NONE,c=this._priorityDirtyFlagMap;(c[b]&&(a=c[b]),a!==this.DIRTY_NONE)&&(c[b]=this.DIRTY_NONE,a&this.DIRTY_FIXED_PRIORITY&&
this._sortListenersOfFixedPriority(b),a&this.DIRTY_SCENE_GRAPH_PRIORITY&&cc.director.getScene()&&this._sortListenersOfSceneGraphPriority(b))},_sortListenersOfSceneGraphPriority:function(b){if(b=this._getListeners(b)){var a=b.getSceneGraphPriorityListeners();a&&0!==a.length&&b.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes)}},_sortEventListenersOfSceneGraphPriorityDes:function(b,a){var c=b._getSceneGraphPriority(),d=a._getSceneGraphPriority();if(!(a&&d&&d._activeInHierarchy&&
null!==d._parent))return-1;if(!b||!c||!c._activeInHierarchy||null===c._parent)return 1;b=c;a=d;for(var k=!1;b._parent._id!==a._parent._id;)b=null===b._parent._parent?(k=!0,d):b._parent,a=null===a._parent._parent?(k=!0,c):a._parent;if(b._id===a._id){if(b._id===d._id)return-1;if(b._id===c._id)return 1}return k?b._localZOrder-a._localZOrder:a._localZOrder-b._localZOrder},_sortListenersOfFixedPriority:function(b){if(b=this._listenersMap[b]){var a=b.getFixedPriorityListeners();if(a&&0!==a.length){a.sort(this._sortListenersOfFixedPriorityAsc);
for(var c=0,d=a.length;c<d&&!(0<=a[c]._getFixedPriority());)++c;b.gt0Index=c}}},_sortListenersOfFixedPriorityAsc:function(b,a){return b._getFixedPriority()-a._getFixedPriority()},_onUpdateListeners:function(b){var a,c,d,k=b.getFixedPriorityListeners(),l=b.getSceneGraphPriorityListeners(),e=this._toRemovedListeners;if(l)for(a=l.length-1;0<=a;a--)(c=l[a])._isRegistered()||(cc.js.array.removeAt(l,a),-1!==(d=e.indexOf(c))&&e.splice(d,1));if(k)for(a=k.length-1;0<=a;a--)(c=k[a])._isRegistered()||(cc.js.array.removeAt(k,
a),-1!==(d=e.indexOf(c))&&e.splice(d,1));l&&0===l.length&&b.clearSceneGraphListeners();k&&0===k.length&&b.clearFixedListeners()},frameUpdateListeners:function(){var b=this._listenersMap,a=this._priorityDirtyFlagMap,c;for(c in b)b[c].empty()&&(delete a[c],delete b[c]);b=this._toAddedListeners;if(0!==b.length){a=0;for(c=b.length;a<c;a++)this._forceAddEventListener(b[a]);b.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()},_updateTouchListeners:function(b){b=this._inDispatch;
if(cc.assertID(0<b,3508),!(1<b)){var a;(a=this._listenersMap[h.TOUCH_ONE_BY_ONE])&&this._onUpdateListeners(a);(a=this._listenersMap[h.TOUCH_ALL_AT_ONCE])&&this._onUpdateListeners(a);cc.assertID(1===b,3509);a=this._toAddedListeners;if(0!==a.length){b=0;for(var c=a.length;b<c;b++)this._forceAddEventListener(a[b]);this._toAddedListeners.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var b=this._toRemovedListeners,a=0;a<b.length;a++){var c=
b[a],d=this._listenersMap[c._getListenerID()];if(d){var k,l=d.getFixedPriorityListeners();(d=d.getSceneGraphPriorityListeners())&&-1!==(k=d.indexOf(c))&&d.splice(k,1);l&&-1!==(k=l.indexOf(c))&&l.splice(k,1)}}b.length=0},_onTouchEventCallback:function(b,a){if(!b._isRegistered())return!1;var c=a.event,g=c.currentTouch;c.currentTarget=b._node;var k,l=!1,e=c.getEventCode(),f=cc.Event.EventTouch;return e===f.BEGAN?b.onTouchBegan&&(l=b.onTouchBegan(g,c))&&b._registered&&b._claimedTouches.push(g):0<b._claimedTouches.length&&
-1!==(k=b._claimedTouches.indexOf(g))&&(l=!0,e===f.MOVED&&b.onTouchMoved?b.onTouchMoved(g,c):e===f.ENDED?(b.onTouchEnded&&b.onTouchEnded(g,c),b._registered&&b._claimedTouches.splice(k,1)):e===f.CANCELLED&&(b.onTouchCancelled&&b.onTouchCancelled(g,c),b._registered&&b._claimedTouches.splice(k,1))),c.isStopped()?(d._updateTouchListeners(c),!0):!(!l||!b.swallowTouches)&&(a.needsMutableSet&&a.touches.splice(g,1),!0)},_dispatchTouchEvent:function(b){this._sortEventListeners(h.TOUCH_ONE_BY_ONE);this._sortEventListeners(h.TOUCH_ALL_AT_ONCE);
var a=this._getListeners(h.TOUCH_ONE_BY_ONE),c=this._getListeners(h.TOUCH_ALL_AT_ONCE);if(null!==a||null!==c){var d=b.getTouches(),k=cc.js.array.copy(d),l={event:b,needsMutableSet:a&&c,touches:k,selTouch:null};if(a)for(var e=0;e<d.length;e++)b.currentTouch=d[e],b._propagationStopped=b._propagationImmediateStopped=!1,this._dispatchEventToListeners(a,this._onTouchEventCallback,l);c&&0<k.length&&(this._dispatchEventToListeners(c,this._onTouchesEventCallback,{event:b,touches:k}),b.isStopped())||this._updateTouchListeners(b)}},
_onTouchesEventCallback:function(b,a){if(!b._registered)return!1;var c=cc.Event.EventTouch,g=a.event;a=a.touches;var k=g.getEventCode();return g.currentTarget=b._node,k===c.BEGAN&&b.onTouchesBegan?b.onTouchesBegan(a,g):k===c.MOVED&&b.onTouchesMoved?b.onTouchesMoved(a,g):k===c.ENDED&&b.onTouchesEnded?b.onTouchesEnded(a,g):k===c.CANCELLED&&b.onTouchesCancelled&&b.onTouchesCancelled(a,g),!!g.isStopped()&&(d._updateTouchListeners(g),!0)},_associateNodeAndEventListener:function(b,a){var c=this._nodeListenersMap[b._id];
c||(c=[],this._nodeListenersMap[b._id]=c);c.push(a)},_dissociateNodeAndEventListener:function(b,a){var c=this._nodeListenersMap[b._id];c&&(cc.js.array.remove(c,a),0===c.length&&delete this._nodeListenersMap[b._id])},_dispatchEventToListeners:function(b,a,c){var d,k=!1,l=b.getFixedPriorityListeners(),e=b.getSceneGraphPriorityListeners(),f=0;if(l&&0!==l.length)for(;f<b.gt0Index;++f)if((d=l[f]).isEnabled()&&!d._isPaused()&&d._isRegistered()&&a(d,c)){k=!0;break}if(e&&!k)for(b=0;b<e.length;b++)if((d=e[b]).isEnabled()&&
!d._isPaused()&&d._isRegistered()&&a(d,c)){k=!0;break}if(l&&!k)for(;f<l.length&&(!(d=l[f]).isEnabled()||d._isPaused()||!d._isRegistered()||!a(d,c));++f);},_setDirty:function(b,a){var c=this._priorityDirtyFlagMap;null==c[b]?c[b]=a:c[b]|=a},_sortNumberAsc:function(b,a){return b-a},hasEventListener:function(b){return!!this._getListeners(b)},addListener:function(b,a){if(cc.assertID(b&&a,3503),cc.js.isNumber(a)||a instanceof cc._BaseNode){if(b instanceof cc.EventListener){if(b._isRegistered())return void cc.logID(3505)}else cc.assertID(!cc.js.isNumber(a),
3504),b=cc.EventListener.create(b);if(b.checkAvailable()){if(cc.js.isNumber(a)){if(0===a)return void cc.logID(3500);b._setSceneGraphPriority(null);b._setFixedPriority(a);b._setRegistered(!0);b._setPaused(!1)}else b._setSceneGraphPriority(a),b._setFixedPriority(0),b._setRegistered(!0);this._addListener(b);return b}}else cc.warnID(3506)},addCustomListener:function(b,a){b=new cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:b,callback:a});return this.addListener(b,1),b},removeListener:function(b){if(null!=
b){var a,c=this._listenersMap;for(e in c){var d=c[e],k=d.getFixedPriorityListeners(),l=d.getSceneGraphPriorityListeners();if((a=this._removeListenerInVector(l,b))?this._setDirty(b._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(a=this._removeListenerInVector(k,b))&&this._setDirty(b._getListenerID(),this.DIRTY_FIXED_PRIORITY),d.empty()&&(delete this._priorityDirtyFlagMap[b._getListenerID()],delete c[e]),a)break}if(!a)for(a=this._toAddedListeners,c=a.length-1;0<=c;c--){var e=a[c];if(e===b){cc.js.array.removeAt(a,
c);e._setRegistered(!1);break}}}},_removeListenerInCallback:function(b,a){if(null==b)return!1;for(var c=b.length-1;0<=c;c--){var d=b[c];if(d._onCustomEvent===a||d._onEvent===a)return d._setRegistered(!1),null!=d._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(d._getSceneGraphPriority(),d),d._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.removeAt(b,c):this._toRemovedListeners.push(d),!0}return!1},_removeListenerInVector:function(b,a){if(null==b)return!1;for(var c=b.length-
1;0<=c;c--){var d=b[c];if(d===a)return d._setRegistered(!1),null!=d._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(d._getSceneGraphPriority(),d),d._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.removeAt(b,c):this._toRemovedListeners.push(d),!0}return!1},removeListeners:function(b,a){if(cc.js.isNumber(b)||b instanceof cc._BaseNode)if(void 0!==b._id){var c;if(c=this._nodeListenersMap[b._id]){var d=cc.js.array.copy(c);for(c=0;c<d.length;c++)this.removeListener(d[c]);
delete this._nodeListenersMap[b._id]}d=this._toAddedListeners;for(c=0;c<d.length;){var k=d[c];k._getSceneGraphPriority()===b?(k._setSceneGraphPriority(null),k._setRegistered(!1),d.splice(c,1)):++c}if(!0===a)for(a=b.getChildren(),c=0,b=a.length;c<b;c++)this.removeListeners(a[c],!0)}else b===cc.EventListener.TOUCH_ONE_BY_ONE?this._removeListenersForListenerID(h.TOUCH_ONE_BY_ONE):b===cc.EventListener.TOUCH_ALL_AT_ONCE?this._removeListenersForListenerID(h.TOUCH_ALL_AT_ONCE):b===cc.EventListener.MOUSE?
this._removeListenersForListenerID(h.MOUSE):b===cc.EventListener.ACCELERATION?this._removeListenersForListenerID(h.ACCELERATION):b===cc.EventListener.KEYBOARD?this._removeListenersForListenerID(h.KEYBOARD):cc.logID(3501);else cc.warnID(3506)},removeCustomListeners:function(b){this._removeListenersForListenerID(b)},removeAllListeners:function(){var b=this._listenersMap,a=this._internalCustomListenerIDs,c;for(c in b)-1===a.indexOf(c)&&this._removeListenersForListenerID(c)},setPriority:function(b,a){if(null!=
b){var c=this._listenersMap,d;for(d in c){var k=c[d].getFixedPriorityListeners();if(k&&-1!==k.indexOf(b))return null!=b._getSceneGraphPriority()&&cc.logID(3502),void(b._getFixedPriority()!==a&&(b._setFixedPriority(a),this._setDirty(b._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(b){this._isEnabled=b},isEnabled:function(){return this._isEnabled},dispatchEvent:function(b){if(this._isEnabled)if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,b&&b.getType){if(b.getType().startsWith(cc.Event.TOUCH))return this._dispatchTouchEvent(b),
void this._inDispatch--;var a=cc.Event;var c=b.type;a=c===a.ACCELERATION?h.ACCELERATION:c===a.KEYBOARD?h.KEYBOARD:c.startsWith(a.MOUSE)?h.MOUSE:(c.startsWith(a.TOUCH)&&cc.logID(2E3),"");this._sortEventListeners(a);a=this._listenersMap[a];null!=a&&(this._dispatchEventToListeners(a,this._onListenerCallback,b),this._onUpdateListeners(a));this._inDispatch--}else cc.errorID(3511)},_onListenerCallback:function(b,a){return a.currentTarget=b._target,b._onEvent(a),a.isStopped()},dispatchCustomEvent:function(b,
a){b=new cc.Event.EventCustom(b);b.setUserData(a);this.dispatchEvent(b)}};m.get(cc,"eventManager",function(){return cc.warnID(1405,"cc.eventManager","cc.EventTarget or cc.systemEvent"),d});n.exports=d},{"../platform/js":150,"./CCEventListener":94}],96:[function(f,n,m){cc.Touch=function(f,e,d){this._lastModified=0;this.setTouchInfo(d,f,e)};cc.Touch.prototype={constructor:cc.Touch,getLocation:function(){return cc.v2(this._point.x,this._point.y)},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},
getPreviousLocation:function(){return cc.v2(this._prevPoint.x,this._prevPoint.y)},getStartLocation:function(){return cc.v2(this._startPoint.x,this._startPoint.y)},getDelta:function(){return this._point.sub(this._prevPoint)},getLocationInView:function(){return cc.v2(this._point.x,cc.view._designResolutionSize.height-this._point.y)},getPreviousLocationInView:function(){return cc.v2(this._prevPoint.x,cc.view._designResolutionSize.height-this._prevPoint.y)},getStartLocationInView:function(){return cc.v2(this._startPoint.x,
cc.view._designResolutionSize.height-this._startPoint.y)},getID:function(){return this._id},setTouchInfo:function(f,e,d){this._prevPoint=this._point;this._point=cc.v2(e||0,d||0);this._id=f;this._startPointCaptured||(this._startPoint=cc.v2(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(f,e){void 0===e?(this._point.x=f.x,this._point.y=f.y):(this._point.x=f,this._point.y=e)},_setPrevPoint:function(f,e){this._prevPoint=void 0===e?cc.v2(f.x,
f.y):cc.v2(f||0,e||0)}}},{}],97:[function(f,n,m){f("./CCEvent");f("./CCTouch");f("./CCEventListener");f=f("./CCEventManager");n.exports=f},{"./CCEvent":93,"./CCEventListener":94,"./CCEventManager":95,"./CCTouch":96}],98:[function(f,n,m){function h(){e.call(this)}m=cc.js;var e=f("../platform/callbacks-invoker");m.extend(h,e);h.prototype.emit=function(d,b){var a=this._callbackTable[d.type];if(a){var c=!a.isInvoking;a.isInvoking=!0;for(var g=a.callbackInfos,k=0,l=g.length;k<l;++k){var e=g[k];if(e&&e.callback&&
(e.callback.call(e.target,d,b),d._propagationImmediateStopped))break}c&&(a.isInvoking=!1,a.containCanceled&&a.purgeCanceled())}};n.exports=h},{"../platform/callbacks-invoker":143}],99:[function(f,n,m){function h(){e.call(this)}m=f("../platform/js");var e=f("../platform/callbacks-invoker"),d=m.array.fastRemove;m.extend(h,e);f=h.prototype;f.__on=f.on;f.on=function(b,a,c,d){if(a)return this.hasEventListener(b,a,c)||(this.__on(b,a,c,d),c&&c.__eventTargets&&c.__eventTargets.push(this)),a;cc.errorID(6800)};
f.__off=f.off;f.off=function(b,a,c){if(a)this.__off(b,a,c),c&&c.__eventTargets&&d(c.__eventTargets,this);else if(a=this._callbackTable[b]){a=a.callbackInfos;for(c=0;c<a.length;++c){var g=a[c]&&a[c].target;g&&g.__eventTargets&&d(g.__eventTargets,this)}this.removeAll(b)}};f.targetOff=function(b){this.removeAll(b);b&&b.__eventTargets&&d(b.__eventTargets,this)};f.once=function(b,a,c){this.on(b,a,c,!0)};f.dispatchEvent=function(b){this.emit(b.type,b)};cc.EventTarget=n.exports=h},{"../platform/callbacks-invoker":143,
"../platform/js":150}],100:[function(f,n,m){f=f("../platform/js");cc.Event=function(d,b){this.type=d;this.bubbles=!!b;this.currentTarget=this.target=null;this.eventPhase=0;this._propagationImmediateStopped=this._propagationStopped=!1};cc.Event.prototype={constructor:cc.Event,unuse:function(){this.type=cc.Event.NO_TYPE;this.currentTarget=this.target=null;this.eventPhase=cc.Event.NONE;this._propagationImmediateStopped=this._propagationStopped=!1},reuse:function(d,b){this.type=d;this.bubbles=b||!1},
stopPropagation:function(){this._propagationStopped=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0},isStopped:function(){return this._propagationStopped||this._propagationImmediateStopped},getCurrentTarget:function(){return this.currentTarget},getType:function(){return this.type}};cc.Event.NO_TYPE="no_type";cc.Event.TOUCH="touch";cc.Event.MOUSE="mouse";cc.Event.KEYBOARD="keyboard";cc.Event.ACCELERATION="acceleration";cc.Event.NONE=0;cc.Event.CAPTURING_PHASE=1;cc.Event.AT_TARGET=
2;cc.Event.BUBBLING_PHASE=3;var h=function(d,b){cc.Event.call(this,d,b);this.detail=null};f.extend(h,cc.Event);h.prototype.reset=h;h.prototype.setUserData=function(d){this.detail=d};h.prototype.getUserData=function(){return this.detail};h.prototype.getEventName=cc.Event.prototype.getType;var e=new f.Pool(10);h.put=function(d){e.put(d)};h.get=function(d,b){var a=e._get();return a?a.reset(d,b):a=new h(d,b),a};cc.Event.EventCustom=h;n.exports=cc.Event},{"../platform/js":150}],101:[function(f,n,m){f("./event");
f("./event-listeners");f("./event-target");f("./system-event")},{"./event":100,"./event-listeners":98,"./event-target":99,"./system-event":102}],102:[function(f,n,m){m=f("../event/event-target");var h=f("../event-manager"),e=f("../platform/CCInputManager"),d=cc.Enum({KEY_DOWN:"keydown",KEY_UP:"keyup",DEVICEMOTION:"devicemotion"}),b=null,a=null;f=cc.Class({name:"SystemEvent",extends:m,statics:{EventType:d},setAccelerometerEnabled:function(a){a&&window.DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?
DeviceMotionEvent.requestPermission().then(function(a){console.log("Device Motion Event request permission: "+a);e.setAccelerometerEnabled("granted"===a)}):e.setAccelerometerEnabled(a)},setAccelerometerInterval:function(a){e.setAccelerometerInterval(a)},on:function(c,g,k,l){this._super(c,g,k,l);c!==d.KEY_DOWN&&c!==d.KEY_UP||(b||(b=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(a,c){c.type=d.KEY_DOWN;cc.systemEvent.dispatchEvent(c)},onKeyReleased:function(a,c){c.type=
d.KEY_UP;cc.systemEvent.dispatchEvent(c)}})),h.hasEventListener(cc.EventListener.ListenerID.KEYBOARD)||h.addListener(b,1));c===d.DEVICEMOTION&&(a||(a=cc.EventListener.create({event:cc.EventListener.ACCELERATION,callback:function(a,c){c.type=d.DEVICEMOTION;cc.systemEvent.dispatchEvent(c)}})),h.hasEventListener(cc.EventListener.ListenerID.ACCELERATION)||h.addListener(a,1))},off:function(c,g,k){(this._super(c,g,k),!b||c!==d.KEY_DOWN&&c!==d.KEY_UP)||(g=this.hasEventListener(d.KEY_DOWN),k=this.hasEventListener(d.KEY_UP),
g||k||h.removeListener(b));a&&c===d.DEVICEMOTION&&h.removeListener(a)}});cc.SystemEvent=n.exports=f;cc.systemEvent=new cc.SystemEvent},{"../event-manager":97,"../event/event-target":99,"../platform/CCInputManager":134}],103:[function(f,n,m){m=f("../components/CCRenderComponent");var h=f("../assets/material/CCMaterial"),e=f("./types"),d=e.LineCap,b=e.LineJoin,a=cc.Class({name:"cc.Graphics",extends:m,editor:!1,ctor:function(){this._impl=new a._Impl(this)},properties:{_lineWidth:1,_strokeColor:cc.Color.BLACK,
_lineJoin:b.MITER,_lineCap:d.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return this._lineWidth},set:function(a){this._lineWidth=a;this._impl.lineWidth=a}},lineJoin:{get:function(){return this._lineJoin},set:function(a){this._lineJoin=a;this._impl.lineJoin=a},type:b},lineCap:{get:function(){return this._lineCap},set:function(a){this._lineCap=a;this._impl.lineCap=a},type:d},strokeColor:{get:function(){return this._strokeColor},set:function(a){this._impl.strokeColor=this._strokeColor=
cc.color(a)}},fillColor:{get:function(){return this._fillColor},set:function(a){this._impl.fillColor=this._fillColor=cc.color(a)}},miterLimit:{get:function(){return this._miterLimit},set:function(a){this._miterLimit=a;this._impl.miterLimit=a}}},statics:{LineJoin:b,LineCap:d},onRestore:function(){this._impl||(this._impl=new a._Impl(this))},onEnable:function(){this._super();this._activateMaterial()},onDestroy:function(){this.clear(!0);this._super();this._impl=null},_activateMaterial:function(){if(cc.game.renderType!==
cc.game.RENDER_TYPE_CANVAS){var a=this.sharedMaterials[0];(a=a?h.getInstantiatedMaterial(a,this):h.getInstantiatedBuiltinMaterial("2d-base",this)).define("CC_USE_MODEL",!0);this.setMaterial(0,a)}else this.disableRender()},moveTo:function(a,b){this._impl.moveTo(a,b)},lineTo:function(a,b){this._impl.lineTo(a,b)},bezierCurveTo:function(a,b,d,l,e,f){this._impl.bezierCurveTo(a,b,d,l,e,f)},quadraticCurveTo:function(a,b,d,l){this._impl.quadraticCurveTo(a,b,d,l)},arc:function(a,b,d,l,e,f){this._impl.arc(a,
b,d,l,e,f)},ellipse:function(a,b,d,l){this._impl.ellipse(a,b,d,l)},circle:function(a,b,d){this._impl.circle(a,b,d)},rect:function(a,b,d,l){this._impl.rect(a,b,d,l)},roundRect:function(a,b,d,l,e){this._impl.roundRect(a,b,d,l,e)},fillRect:function(a,b,d,l){this.rect(a,b,d,l);this.fill()},clear:function(a){this._impl.clear(a);this._assembler&&this._assembler.clear(a)},close:function(){this._impl.close()},stroke:function(){this._assembler||this._resetAssembler();this._assembler.stroke(this)},fill:function(){this._assembler||
this._resetAssembler();this._assembler.fill(this)}});cc.Graphics=n.exports=a;cc.Graphics.Types=e;cc.Graphics.Helper=f("./helper")},{"../assets/material/CCMaterial":53,"../components/CCRenderComponent":74,"./helper":104,"./types":106}],104:[function(f,n,m){var h=f("./types").PointFlags,e=Math.PI,d=Math.min,b=Math.max,a=Math.cos,c=Math.sin,g=Math.abs,k=Math.sign;n.exports={arc:function(k,q,f,t,p,v,w){var l,r,h,u,B,m=0,z=0,A=0,D=0;if(h=v-p,w=w||!1)if(g(h)>=2*e)h=2*e;else for(;0>h;)h+=2*e;else if(g(h)>=
2*e)h=2*-e;else for(;0<h;)h-=2*e;v=0|b(1,d(g(h)/(.5*e)+.5,5));var n=g(4/3*(1-a(l=h/v/2))/c(l));w||(n=-n);for(w=0;w<=v;w++)l=q+(u=a(r=p+w/v*h))*t,r=f+(B=c(r))*t,B=-B*t*n,u=u*t*n,0===w?k.moveTo(l,r):k.bezierCurveTo(m+A,z+D,l-B,r-u,l,r),m=l,z=r,A=B,D=u},ellipse:function(a,c,b,d,g){a.moveTo(c-d,b);a.bezierCurveTo(c-d,b+.5522847493*g,c-.5522847493*d,b+g,c,b+g);a.bezierCurveTo(c+.5522847493*d,b+g,c+d,b+.5522847493*g,c+d,b);a.bezierCurveTo(c+d,b-.5522847493*g,c+.5522847493*d,b-g,c,b-g);a.bezierCurveTo(c-
.5522847493*d,b-g,c-d,b-.5522847493*g,c-d,b);a.close()},roundRect:function(a,c,b,e,p,f){if(.1>f)a.rect(c,b,e,p);else{var l=d(f,.5*g(e))*k(e);f=d(f,.5*g(p))*k(p);a.moveTo(c,b+f);a.lineTo(c,b+p-f);a.bezierCurveTo(c,b+p-f*(1-.5522847493),c+l*(1-.5522847493),b+p,c+l,b+p);a.lineTo(c+e-l,b+p);a.bezierCurveTo(c+e-l*(1-.5522847493),b+p,c+e,b+p-f*(1-.5522847493),c+e,b+p-f);a.lineTo(c+e,b+f);a.bezierCurveTo(c+e,b+f*(1-.5522847493),c+e-l*(1-.5522847493),b,c+e-l,b);a.lineTo(c+l,b);a.bezierCurveTo(c+l*(1-.5522847493),
b,c,b+f*(1-.5522847493),c,b+f);a.close()}},tesselateBezier:function C(a,c,b,d,k,e,f,x,y,u,B){var p,q,r,t,v,w,E,m,n,P,L,M,U,R,O,H;10<u||(v=.5*(e+x),w=.5*(f+y),E=.5*((p=.5*(c+d))+(r=.5*(d+e))),m=.5*((q=.5*(b+k))+(t=.5*(k+f))),((O=g((d-x)*(R=y-b)-(k-y)*(U=x-c)))+(H=g((e-x)*R-(f-y)*U)))*(O+H)<a._tessTol*(U*U+R*R)?a._addPoint(x,y,0===B?B|h.PT_BEVEL:B):(C(a,c,b,p,q,E,m,L=.5*(E+(n=.5*(r+v))),M=.5*(m+(P=.5*(t+w))),u+1,0),C(a,L,M,n,P,v,w,x,y,u+1,B)))}}},{"./types":106}],105:[function(f,n,m){f("./graphics")},
{"./graphics":103}],106:[function(f,n,m){f=cc.Enum({BUTT:0,ROUND:1,SQUARE:2});m=cc.Enum({BEVEL:0,ROUND:1,MITER:2});var h=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});n.exports={LineCap:f,LineJoin:m,PointFlags:h}},{}],107:[function(f,n,m){f("./platform");f("./assets");f("./CCNode");f("./CCPrivateNode");f("./CCScene");f("./components");f("./graphics");f("./collider");f("./collider/CCIntersection");f("./physics");f("./camera/CCCamera");f("./geom-utils");f("./mesh");f("./3d");f("./3d/polyfill-3d");
f("./base-ui/CCWidgetManager")},{"./3d":void 0,"./3d/polyfill-3d":26,"./CCNode":30,"./CCPrivateNode":31,"./CCScene":32,"./assets":52,"./base-ui/CCWidgetManager":56,"./camera/CCCamera":57,"./collider":void 0,"./collider/CCIntersection":void 0,"./components":91,"./geom-utils":void 0,"./graphics":105,"./mesh":void 0,"./physics":void 0,"./platform":147}],108:[function(f,n,m){function h(a){var c,b;if("object"==typeof a){if(c=a,a.url)return c;a=a.uuid}else c={};return b=c.type?"uuid"===c.type:cc.AssetLibrary._uuidInSettings(a),
cc.AssetLibrary._getAssetInfoInRuntime(a,t),c.url=b?t.url:a,t.url&&"uuid"===c.type&&t.raw?(c.type=null,c.isRawAsset=!0):b||(c.isRawAsset=!0),c}function e(){var a=new c,l=new g,e=new k;b.call(this,[a,l,e]);this.assetLoader=a;this.md5Pipe=null;this.downloader=l;this.loader=e;this.onProgress=null;this._autoReleaseSetting=d.createMap(!0)}var d=f("../platform/js"),b=f("./pipeline"),a=f("./loading-items"),c=f("./asset-loader"),g=f("./downloader"),k=f("./loader");m=f("./asset-table");var l=f("../platform/utils").callInNextTick,
q=f("./auto-release-utils"),r=Object.create(null);r.assets=new m;r.internal=new m;var t={url:null,raw:!1},p=[],v=[];d.extend(e,b);f=e.prototype;f.init=function(a){};f.getXMLHttpRequest=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")};f.addDownloadHandlers=function(a){this.downloader.addHandlers(a)};f.addLoadHandlers=function(a){this.loader.addHandlers(a)};f.load=function(c,b,d){void 0===d&&(d=b,b=this.onProgress||null);var g,k=this,e=!1;c instanceof
Array||(c?(e=!0,c=[c]):c=[]);for(var f=p.length=0;f<c.length;++f){var q=c[f];(q&&q.id&&(cc.warnID(4920,q.id),q.uuid||q.url||(q.url=q.id)),(g=h(q)).url||g.uuid)&&p.push(this._cache[g.url]||g)}c=a.create(this,b,function(a,c){l(function(){d&&(e?d.call(k,a,c.getContent(g.url)):d.call(k,a,c),d=null);c.destroy()})});a.initQueueDeps(c);c.append(p);p.length=0};f.flowInDeps=function(c,b,d){for(var g=v.length=0;g<b.length;++g){var k=h(b[g]);if(k.url||k.uuid){var l=this._cache[k.url];l?v.push(l):v.push(k)}}b=
a.create(this,c?function(a,c,b){this._ownerQueue&&this._ownerQueue.onProgress&&this._ownerQueue._childOnProgress(b)}:null,function(a,b){d(a,b);c&&c.deps&&(c.deps.length=0);b.destroy()});c&&(g=a.getQueue(c),b._ownerQueue=g._ownerQueue||g);b=b.append(v,c);return v.length=0,b};f._assetTables=r;f._getResUuid=function(a,c,b,d){b=r[b||"assets"];if(!a||!b)return null;var g=a.indexOf("?");-1!==g&&(a=a.substr(0,g));g=b.getUuid(a,c);if(!g){var k=cc.path.extname(a);k&&(a=a.slice(0,-k.length),(g=b.getUuid(a,
c))&&!d&&cc.warnID(4901,a,k))}return g};f._getReferenceKey=function(a){var c;return"object"==typeof a?c=a._uuid||null:"string"==typeof a&&(c=this._getResUuid(a,null,null,!0)||a),c?(cc.AssetLibrary._getAssetInfoInRuntime(c,t),this._cache[t.url]?t.url:c):(cc.warnID(4800,a),c)};f._urlNotFound=function(a,c,b){l(function(){a=cc.url.normalize(a);var g=(c?d.getClassName(c):"Asset")+' in "resources/'+a+'" does not exist.';b&&b(Error(g),[])})};f._parseLoadResArgs=function(a,c,b){if(void 0===b){var g=a instanceof
Array||d.isChildClassOf(a,cc.RawAsset);c?(b=c,g&&(c=this.onProgress||null)):void 0!==c||g||(b=a,c=this.onProgress||null,a=null);void 0===c||g||(c=a,a=null)}return{type:a,onProgress:c,onComplete:b}};f.loadRes=function(a,c,b,d,g){5!==arguments.length&&(g=d,d=b,b="assets");var k=this._parseLoadResArgs(c,d,g);c=k.type;d=k.onProgress;g=k.onComplete;var l=this,e=l._getResUuid(a,c,b);e?this.load({type:"uuid",uuid:e},d,function(a,c){c&&l.setAutoReleaseRecursively(e,!1);g&&g(a,c)}):l._urlNotFound(a,c,g)};
f._loadResUuids=function(a,c,b,d){if(0<a.length){var g=this,k=a.map(function(a){return{type:"uuid",uuid:a}});this.load(k,c,function(a,c){if(b){for(var l=[],e=d&&[],p=0;p<k.length;++p){var f=k[p].uuid,q=this._getReferenceKey(f);(q=c.getContent(q))&&(g.setAutoReleaseRecursively(f,!1),l.push(q),e&&e.push(d[p]))}d?b(a,l,e):b(a,l)}})}else b&&l(function(){d?b(null,[],[]):b(null,[])})};f.loadResArray=function(a,c,b,d,g){5!==arguments.length&&(g=d,d=b,b="assets");var k=this._parseLoadResArgs(c,d,g);c=k.type;
d=k.onProgress;g=k.onComplete;k=[];for(var l=c instanceof Array,e=0;e<a.length;e++){var p=a[e],f=l?c[e]:c,q=this._getResUuid(p,f,b);if(!q)return void this._urlNotFound(p,f,g);k.push(q)}this._loadResUuids(k,d,g)};f.loadResDir=function(a,c,b,d,g){if(5!==arguments.length&&(g=d,d=b,b="assets"),r[b]){var k=this._parseLoadResArgs(c,d,g);c=k.type;d=k.onProgress;g=k.onComplete;k=[];var l=r[b].getUuidArray(a,c,k);this._loadResUuids(l,d,g,k)}};f.getRes=function(a,c){var b=this._cache[a];if(!b){a=this._getResUuid(a,
c,null,!0);if(!a)return null;a=this._getReferenceKey(a);b=this._cache[a]}return b&&b.alias&&(b=b.alias),b&&b.complete?b.content:null};f.getResCount=function(){return Object.keys(this._cache).length};f.getDependsRecursively=function(a){if(a){a=this._getReferenceKey(a);var c=q.getDependsRecursively(a);return c.push(a),c}return[]};f.release=function(a){if(Array.isArray(a))for(var c=0;c<a.length;c++)this.release(a[c]);else if(a&&(c=this._getReferenceKey(a),!(c&&c in cc.AssetLibrary.getBuiltinDeps()))){var b=
this.getItem(c);b&&(this.removeItem(c),a=b.content);a instanceof cc.Asset&&((c=a.nativeUrl)&&this.release(c),a.destroy())}};f.releaseAsset=function(a){(a=a._uuid)&&this.release(a)};f.releaseRes=function(a,c,b){(c=this._getResUuid(a,c,b))?this.release(c):cc.errorID(4914,a)};f.releaseResDir=function(a,c,b){if(r[b=b||"assets"])for(a=r[b].getUuidArray(a,c),c=0;c<a.length;c++)this.release(a[c])};f.releaseAll=function(){for(var a in this._cache)this.release(a)};f.removeItem=function(a){var c=b.prototype.removeItem.call(this,
a);return delete this._autoReleaseSetting[a],c};f.setAutoRelease=function(a,c){(a=this._getReferenceKey(a))&&(this._autoReleaseSetting[a]=!!c)};f.setAutoReleaseRecursively=function(a,c){c=!!c;if(a=this._getReferenceKey(a)){this._autoReleaseSetting[a]=c;a=q.getDependsRecursively(a);for(var b=0;b<a.length;b++)this._autoReleaseSetting[a[b]]=c}else 0};f.isAutoRelease=function(a){a=this._getReferenceKey(a);return!!a&&!!this._autoReleaseSetting[a]};cc.loader=new e;n.exports=cc.loader},{"../platform/js":150,
"../platform/utils":154,"./asset-loader":109,"./asset-table":110,"./auto-release-utils":112,"./downloader":114,"./loader":117,"./loading-items":118,"./pipeline":121,"./released-asset-checker":122}],109:[function(f,n,m){f("../utils/CCPath");var h=f("../CCDebug");m=f("./pipeline");var e=f("./loading-items");f=function(b){this.id="AssetLoader";this.async=!0;this.pipeline=null};f.ID="AssetLoader";var d=[];f.prototype.handle=function(b,a){var c=b.uuid;if(!c)return b.content||null;cc.AssetLibrary.queryAssetInfo(c,
function(g,k,l){if(g)a(g);else{if(b.url=b.rawUrl=k,b.isRawAsset=l,l){g=cc.path.extname(k).toLowerCase();if(!g)return void a(Error(h.getError(4931,c,k)));g=g.substr(1);l=e.getQueue(b);d[0]={queueId:b.queueId,id:k,url:k,type:g,error:null,alias:b,complete:!0};l.append(d);b.type=g}else b.type="uuid";a(null,b.content)}})};m.AssetLoader=n.exports=f},{"../CCDebug":27,"../utils/CCPath":210,"./loading-items":118,"./pipeline":121}],110:[function(f,n,m){function h(a,c){this.uuid=a;this.type=c}function e(){this._pathToUuid=
b.createMap(!0)}var d=f("../utils/misc").pushToMap,b=f("../platform/js");f=e.prototype;f.getUuid=function(a,c){a=cc.url.normalize(a);if(a=this._pathToUuid[a])if(Array.isArray(a)){if(!c)return a[0].uuid;for(var d=0;d<a.length;d++){var k=a[d];if(b.isChildClassOf(k.type,c))return k.uuid}}else if(!c||b.isChildClassOf(a.type,c))return a.uuid;return""};f.getUuidArray=function(a,c,d){"/"===(a=cc.url.normalize(a))[a.length-1]&&(a=a.slice(0,-1));var g=this._pathToUuid,l=[],e=b.isChildClassOf,f;for(f in g){var t;
if(t=f.startsWith(a))f.length>a.length?(t=f.charCodeAt(a.length),t=46===t||47===t):t=!0;if(t||!a)if(t=g[f],Array.isArray(t))for(var p=0;p<t.length;p++){var v=t[p];(!c||e(v.type,c))&&(l.push(v.uuid),d&&d.push(f))}else(!c||e(t.type,c))&&(l.push(t.uuid),d&&d.push(f))}return l};f.add=function(a,c,b,k){a=a.substring(0,a.length-cc.path.extname(a).length);c=new h(c,b);d(this._pathToUuid,a,c,k)};f._getInfo_DEBUG=!1;f.reset=function(){this._pathToUuid=b.createMap(!0)};n.exports=e},{"../platform/js":150,"../utils/misc":220}],
111:[function(f,n,m){function h(a,c){var d=document.createElement("audio");d.src=a.url;var g=function(){clearTimeout(k);d.removeEventListener("canplaythrough",e,!1);d.removeEventListener("error",p,!1);b.USE_LOADER_EVENT&&d.removeEventListener(b.USE_LOADER_EVENT,e,!1)},k=setTimeout(function(){0===d.readyState?p():e()},8E3),e=function(){g();c(null,d)},p=function(){g();var b="load audio failure - "+a.url;cc.log(b);c(b)};d.addEventListener("canplaythrough",e,!1);d.addEventListener("error",p,!1);b.USE_LOADER_EVENT&&
d.addEventListener(b.USE_LOADER_EVENT,e,!1)}function e(a,b){c||b(Error(d.getError(4926)));var g=cc.loader.getXMLHttpRequest();g.open("GET",a.url,!0);g.responseType="arraybuffer";g.onload=function(){c.decodeAudioData(g.response,function(a){b(null,a)},function(){b("decode error - "+a.id,null)})};g.onerror=function(){b("request error - "+a.id,null)};g.send()}m=f("../platform/CCSys");var d=f("../CCDebug"),b=m.__audioSupport,a=b.format,c=b.context;n.exports=function(c,k){if(0===a.length)return Error(d.getError(4927));
(b.WEB_AUDIO?c._owner instanceof cc.AudioClip?c._owner.loadMode===cc.AudioClip.LoadMode.WEB_AUDIO?e:h:c.urlParam&&c.urlParam.useDom?h:e:h)(c,k)}},{"../CCDebug":27,"../platform/CCSys":139}],112:[function(f,n,m){function h(a,c){if(a=cc.loader.getItem(a))if(a=a.dependKeys)for(var b=0;b<a.length;b++){var d=a[b];c[d]||(c[d]=!0,h(d,c))}}function e(a,c){a._uuid&&(a=cc.loader._getReferenceKey(a),c[a]||(c[a]=!0,h(a,c)))}function d(a,c){for(var b=0;b<a._components.length;b++)for(var k=a._components[b],l=c,
f=Object.getOwnPropertyNames(k),r=0;r<f.length;r++){var t=k[f[r]];if("object"==typeof t&&t)if(Array.isArray(t))for(var p=0;p<t.length;p++){var v=t[p];v instanceof cc.RawAsset&&e(v,l)}else if(t.constructor&&t.constructor!==Object)t instanceof cc.RawAsset&&e(t,l);else for(p=Object.getOwnPropertyNames(t),v=0;v<p.length;v++){var w=t[p[v]];w instanceof cc.RawAsset&&e(w,l)}}for(b=0;b<a._children.length;b++)d(a._children[b],c)}var b=f("../platform/js");n.exports={autoRelease:function(a,c,g){var k=cc.loader._autoReleaseSetting,
l=b.createMap();if(c)for(var e=0;e<c.length;e++)l[c[e]]=!0;for(c=0;c<g.length;c++)d(g[c],l);if(a)for(g=0;g<a.length;g++)c=a[g],!1===k[c]||l[c]||cc.loader.release(c);a=Object.keys(k);for(g=0;g<a.length;g++)c=a[g],!0!==k[c]||l[c]||cc.loader.release(c)},getDependsRecursively:function(a){var c={};return h(a,c),Object.keys(c)}}},{"../platform/js":150}],113:[function(f,n,m){n.exports=function(f,e){f=f.url;var d=cc.loader.getXMLHttpRequest(),b="Load binary data failed: "+f;d.open("GET",f,!0);d.responseType=
"arraybuffer";d.onload=function(){var a=d.response;a?(a=new Uint8Array(a),e(null,a)):e({status:d.status,errorMessage:b+"(no response)"})};d.onerror=function(){e({status:d.status,errorMessage:b+"(error)"})};d.ontimeout=function(){e({status:d.status,errorMessage:b+"(time out)"})};d.send(null)}},{}],114:[function(f,n,m){function h(){return null}function e(c,b,d){function g(){e.parentNode.removeChild(e);e.removeEventListener("load",g,!1);e.removeEventListener("error",k,!1);b(null,l)}function k(){e.parentNode.removeChild(e);
e.removeEventListener("load",g,!1);e.removeEventListener("error",k,!1);b(Error(a.getError(4928,l)))}var l=c.url;c=document;var e=document.createElement("script");"file:"!==window.location.protocol&&(e.crossOrigin="anonymous");e.async=d;e.src=q(l);e.addEventListener("load",g,!1);e.addEventListener("error",k,!1);c.body.appendChild(e)}function d(c,b,g,k){void 0===g&&(g=!0);var l=q(c.url);if(k=k||new Image,g&&"file:"!==window.location.protocol?k.crossOrigin="anonymous":k.crossOrigin=null,k.complete&&
0<k.naturalWidth&&k.src===l)return k;var e=function B(){k.removeEventListener("load",B);k.removeEventListener("error",p);k.id=c.id;b(null,k)},p=function C(){k.removeEventListener("load",e);k.removeEventListener("error",C);"https:"!==window.location.protocol&&k.crossOrigin&&"anonymous"===k.crossOrigin.toLowerCase()?d(c,b,!1,k):b(Error(a.getError(4930,l)))};k.addEventListener("load",e);k.addEventListener("error",p);k.src=l}var b=f("../platform/js"),a=f("../CCDebug");f("../utils/CCPath");var c;m=f("./pipeline");
var g=f("./pack-downloader"),k=f("./binary-downloader"),l=f("./text-downloader"),q=f("./utils").urlAppendTimestamp,r={js:e,png:d,jpg:d,bmp:d,jpeg:d,gif:d,ico:d,tiff:d,webp:d,image:d,pvr:k,pkm:k,mp3:c=f("./audio-downloader"),ogg:c,wav:c,m4a:c,txt:l,xml:l,vsh:l,fsh:l,atlas:l,tmx:l,tsx:l,json:l,ExportJson:l,plist:l,fnt:l,font:h,eot:h,ttf:h,woff:h,svg:h,ttc:h,uuid:function(a,c){var b=g.load(a,c);return void 0===b?this.extMap.json(a,c):b||void 0},binary:k,bin:k,dbbin:k,default:l};f=function(a){this.id=
"Downloader";this.async=!0;this.pipeline=null;this._curConcurrent=0;this._loadQueue=[];this._subpackages={};this.extMap=b.mixin(a,r)};f.ID="Downloader";f.PackDownloader=g;f.prototype.addHandlers=function(a){b.mixin(this.extMap,a)};f.prototype._handleLoadQueue=function(){for(;this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT;){var a=this._loadQueue.shift();if(!a)break;var c=this.handle(a.item,a.callback);void 0!==c&&(c instanceof Error?a.callback(c):a.callback(null,c))}};f.prototype.handle=function(a,
c){var b=this,d=this.extMap[a.type]||this.extMap.default,g=void 0;if(this._curConcurrent<cc.macro.DOWNLOAD_MAX_CONCURRENT){if(this._curConcurrent++,void 0!==(g=d.call(this,a,function(a,d){b._curConcurrent=Math.max(0,b._curConcurrent-1);b._handleLoadQueue();c&&c(a,d)})))return this._curConcurrent=Math.max(0,this._curConcurrent-1),this._handleLoadQueue(),g}else if(a.ignoreMaxConcurrency){if(void 0!==(g=d.call(this,a,c)))return g}else this._loadQueue.push({item:a,callback:c})};f.prototype.loadSubpackage=
function(a,c){var b=this._subpackages[a];b?b.loaded?c&&c():e({url:b.path+"index.c8eed.js"},function(a){a||(b.loaded=!0);c&&c(a)}):c&&c(Error("Can't find subpackage "+a))};m.Downloader=n.exports=f},{"../CCDebug":27,"../platform/js":150,"../utils/CCPath":210,"./audio-downloader":111,"./binary-downloader":113,"./pack-downloader":120,"./pipeline":121,"./text-downloader":124,"./utils":126}],115:[function(f,n,m){function h(){for(var a=!0,k=Date.now(),l=g.length-1;0<=l;l--){var e=g[l],f=e.fontFamilyName;
if(3E3<k-e.startTime)cc.warnID(4933,f),e.callback(null,f),g.splice(l,1);else{var w=e.refWidth;b.font="40px "+f;w!==d.safeMeasureText(b,"BES bswy:->@123\u4e01\u3041\u1101")?(g.splice(l,1),e.callback(null,f)):a=!1}}a&&(clearInterval(c),c=-1)}function e(a,c,b){var d=new Promise(function(b,d){(function u(){3E3<=Date.now()-a?d():document.fonts.load("40px "+c).then(function(a){1<=a.length?b():setTimeout(u,100)},function(){d()})})()}),g=null,k=new Promise(function(a,c){g=setTimeout(c,3E3)});Promise.race([k,
d]).then(function(){g&&(clearTimeout(g),g=null);b(null,c)},function(){cc.warnID(4933,c);b(null,c)})}var d=f("../utils/text-utils"),b=null,a={},c=-1,g=[],k=function(){var a=void 0;return function(){if(void 0===a)if(window.FontFace){var c=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),b=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);a=c?42<parseInt(c[1],10):!b}else a=!1;return a}}(),l={loadFont:function(f,r){var q=f.url;f=l._getFontFamily(f);
if(a[f])return f;if(!b){var p=document.createElement("canvas");p.width=100;p.height=100;b=p.getContext("2d")}b.font="40px "+f;var v=d.safeMeasureText(b,"BES bswy:->@123\u4e01\u3041\u1101");p=document.createElement("style");p.type="text/css";var w="";isNaN(f-0)?w+="@font-face { font-family:"+f+"; src:":w+="@font-face { font-family:'"+f+"'; src:";p.textContent=w+("url('"+q+"');}");document.body.appendChild(p);q=document.createElement("div");w=q.style;(w.fontFamily=f,q.innerHTML=".",w.position="absolute",
w.left="-100px",w.top="-100px",document.body.appendChild(q),k())?e(Date.now(),f,r):(r={fontFamilyName:f,refWidth:v,callback:r,startTime:Date.now()},g.push(r),-1===c&&(c=setInterval(h,100)));a[f]=p},_getFontFamily:function(a){if(a._owner&&".ttf"==a._owner._native)a=a._owner.name+"_LABEL";else{a=a.url;var c=a.lastIndexOf(".ttf");if(-1===c)return a;var b=a.lastIndexOf("/");a=-1===b?a.substring(0,c)+"_LABEL":a.substring(b+1,c)+"_LABEL"}return-1!==a.indexOf(" ")&&(a='"'+a+'"'),a}};n.exports=l},{"../utils/text-utils":227}],
116:[function(f,n,m){f("./downloader");f("./loader");f("./loading-items");f("./pipeline");f("./CCLoader")},{"./CCLoader":108,"./downloader":114,"./loader":117,"./loading-items":118,"./pipeline":121}],117:[function(f,n,m){function h(a){if("string"!=typeof a.content)return Error("JSON Loader: Input item doesn't contain string content");try{return JSON.parse(a.content)}catch(r){return Error("JSON Loader: Parse json ["+a.id+"] failed : "+r)}}function e(a){if(a._owner instanceof cc.Asset)return null;var c=
a.content;if(cc.sys.platform!==cc.sys.FB_PLAYABLE_ADS&&!(c instanceof Image))return Error("Image Loader: Input item doesn't contain Image content");var b=a.texture||new g;return b._uuid=a.uuid,b.url=a.url,b._setRawAsset(a.rawUrl,!1),b._nativeAsset=c,b}function d(a,c){if(a._owner instanceof cc.Asset)return null;c=new cc.AudioClip;return c._setRawAsset(a.rawUrl,!1),c._nativeAsset=a.content,c.url=a.url,c}function b(a){return a.load?a.load(a.content):null}var a=f("../platform/js"),c=f("../platform/CCSAXParser").plistParser;
m=f("./pipeline");var g=f("../assets/CCTexture2D"),k=f("./uuid-loader");f=f("./font-loader");var l={png:e,jpg:e,bmp:e,jpeg:e,gif:e,ico:e,tiff:e,webp:e,image:e,pvr:function(a){a=a.content instanceof ArrayBuffer?a.content:a.content.buffer;var c=new Int32Array(a,0,13);if(55727696!=c[0])return Error("Invalid magic number in PVR header");var b=c[7],d=c[6];return{_data:new Uint8Array(a,c[12]+52),_compressed:!0,width:b,height:d}},pkm:function(a){a=a.content instanceof ArrayBuffer?a.content:a.content.buffer;
var c=new Uint8Array(a),b=c[6]<<8|c[7];if(0!==b&&1!==b&&3!==b)return Error("Invalid magic number in ETC header");b=c[12]<<8|c[13];c=c[14]<<8|c[15];return{_data:new Uint8Array(a,16),_compressed:!0,width:b,height:c}},mp3:d,ogg:d,wav:d,m4a:d,json:h,ExportJson:h,plist:function(a){return"string"!=typeof a.content?Error("Plist Loader: Input item doesn't contain string content"):c.parse(a.content)||Error("Plist Loader: Parse ["+a.id+"] failed")},uuid:k,prefab:k,fire:k,scene:k,binary:b,dbbin:b,bin:b,font:f.loadFont,
eot:f.loadFont,ttf:f.loadFont,woff:f.loadFont,svg:f.loadFont,ttc:f.loadFont,default:function(){return null}};f=function(c){this.id="Loader";this.async=!0;this.pipeline=null;this.extMap=a.mixin(c,l)};f.ID="Loader";f.prototype.addHandlers=function(c){this.extMap=a.mixin(this.extMap,c)};f.prototype.handle=function(a,c){return(this.extMap[a.type]||this.extMap.default).call(this,a,c)};m.Loader=n.exports=f},{"../assets/CCTexture2D":51,"../platform/CCSAXParser":137,"../platform/js":150,"./font-loader":115,
"./pipeline":121,"./uuid-loader":127}],118:[function(f,n,m){function h(a){if(a&&(a=a.split("?"))&&a[0]&&a[1]){var c={};return a[1].split("&").forEach(function(a){a=a.split("=");c[a[0]]=a[1]}),c}}function e(c,b){var d="object"==typeof c?c.url:c;b={queueId:b,id:d,url:d,rawUrl:void 0,urlParam:h(d),type:"",error:null,content:null,complete:!1,states:{},deps:null};if("object"==typeof c&&(a.mixin(b,c),c.skips))for(var g=0;g<c.skips.length;g++)b.states[c.skips[g]]=l.COMPLETE;return b.rawUrl=b.url,d&&!b.type&&
(b.type=cc.path.extname(d).toLowerCase().substr(1)),b}function d(a,c,b){if(!a||!c)return!1;var g=!1;if(r.push(c.id),c.deps){var k,l=c.deps;for(c=0;c<l.length;c++){if((k=l[c]).id===a.id){g=!0;break}if(!(0<=r.indexOf(k.id))&&k.deps&&d(a,k,!0)){g=!0;break}}}return b||(r.length=0),g}var b=f("../platform/callbacks-invoker");f("../utils/CCPath");var a=f("../platform/js"),c=0|998*Math.random(),g=a.createMap(!0),k=[],l={WORKING:1,COMPLETE:2,ERROR:3},q=a.createMap(!0),r=[],t=function(d,k,l,e){b.call(this);
this._id=++c;g[this._id]=this;this._pipeline=d;this._errorUrls=a.createMap(!0);this._appending=!1;this._ownerQueue=null;this.onProgress=l;this.onComplete=e;this.map=a.createMap(!0);this.completed={};this.completedCount=this.totalCount=0;this._pipeline?this.active=!0:this.active=!1;k&&(0<k.length?this.append(k):this.allComplete())};t.ItemState=new cc.Enum(l);t.create=function(a,c,b,d){void 0===b?"function"==typeof c&&(d=c,c=b=null):void 0===d&&("function"==typeof c?(d=b,b=c,c=null):(d=b,b=null));var l=
k.pop();return l?(l._pipeline=a,l.onProgress=b,l.onComplete=d,g[l._id]=l,l._pipeline&&(l.active=!0),c&&l.append(c)):l=new t(a,c,b,d),l};t.getQueue=function(a){return a.queueId?g[a.queueId]:null};t.itemComplete=function(a){var c=g[a.queueId];c&&c.itemComplete(a.id)};t.initQueueDeps=function(a){var c=q[a._id];c?(c.completed.length=0,c.deps.length=0):q[a._id]={completed:[],deps:[]}};t.registerQueueDep=function(a,c){var b=a.queueId||a;if(!b)return!1;if(b=q[b])-1===b.deps.indexOf(c)&&b.deps.push(c);else if(a.id)for(var d in q)b=
q[d],-1!==b.deps.indexOf(a.id)&&-1===b.deps.indexOf(c)&&b.deps.push(c)};t.finishDep=function(a){for(var c in q){var b=q[c];-1!==b.deps.indexOf(a)&&-1===b.completed.indexOf(a)&&b.completed.push(a)}};f=t.prototype;a.mixin(f,b.prototype);f.append=function(a,c){if(!this.active)return[];c&&!c.deps&&(c.deps=[]);this._appending=!0;var b,k,l,f=[];for(b=0;b<a.length;++b)if(!(k=a[b]).queueId||this.map[k.id]){if("string"==typeof(k.url||k)){var p=(l=e(k,this._id)).id;this.map[p]||(this.map[p]=l,this.totalCount++,
c&&c.deps.push(l),t.registerQueueDep(c||this._id,p),f.push(l))}}else if(this.map[k.id]=k,c&&c.deps.push(k),k.complete||d(c,k))this.totalCount++,this.itemComplete(k.id);else{var q=this;(l=g[k.queueId])&&(this.totalCount++,t.registerQueueDep(c||this._id,k.id),l.addListener(k.id,function(a){q.itemComplete(a.id)}))}return this._appending=!1,this.completedCount===this.totalCount?this.allComplete():this._pipeline.flowIn(f),f};f._childOnProgress=function(a){if(this.onProgress){var c=q[this._id];this.onProgress(c?
c.completed.length:this.completedCount,c?c.deps.length:this.totalCount,a)}};f.allComplete=function(){var c=a.isEmptyObject(this._errorUrls)?null:this._errorUrls;this.onComplete&&this.onComplete(c,this)};f.isCompleted=function(){return this.completedCount>=this.totalCount};f.isItemCompleted=function(a){return!!this.completed[a]};f.exists=function(a){return!!this.map[a]};f.getContent=function(a){a=this.map[a];var c=null;return a&&(a.content?c=a.content:a.alias&&(c=a.alias.content)),c};f.getError=function(a){a=
this.map[a];var c=null;return a&&(a.error?c=a.error:a.alias&&(c=a.alias.error)),c};f.addListener=b.prototype.on;f.hasListener=b.prototype.hasEventListener;f.removeListener=b.prototype.off;f.removeAllListeners=b.prototype.removeAll;f.removeItem=function(a){var c=this.map[a];c&&this.completed[c.alias||a]&&(delete this.completed[a],delete this.map[a],c.alias&&(delete this.completed[c.alias.id],delete this.map[c.alias.id]),this.completedCount--,this.totalCount--)};f.itemComplete=function(c){var b=this.map[c];
if(b){var d=c in this._errorUrls;if(b.error instanceof Error||a.isString(b.error)?this._errorUrls[c]=b.error:b.error?a.mixin(this._errorUrls,b.error):!b.error&&d&&delete this._errorUrls[c],this.completed[c]=b,this.completedCount++,t.finishDep(b.id),this.onProgress)d=q[this._id],this.onProgress(d?d.completed.length:this.completedCount,d?d.deps.length:this.totalCount,b);this.emit(c,b);this.removeAll(c);!this._appending&&this.completedCount>=this.totalCount&&this.allComplete()}};f.destroy=function(){this._appending=
this.active=!1;this._ownerQueue=this._pipeline=null;a.clear(this._errorUrls);this.onComplete=this.onProgress=null;this.map=a.createMap(!0);this.completed={};this.completedCount=this.totalCount=0;b.call(this);q[this._id]&&(q[this._id].completed.length=0,q[this._id].deps.length=0);delete g[this._id];delete q[this._id];-1===k.indexOf(this)&&10>k.length&&k.push(this)};t.HasLoadingQueue=function(){return 0<Object.keys(g).length};t.LoadingQueueCount=function(){return Object.keys(g).length};cc.LoadingItems=
n.exports=t},{"../platform/callbacks-invoker":143,"../platform/js":150,"../utils/CCPath":210}],119:[function(f,n,m){f=f("./pipeline");var h=/.*[/\\][0-9a-fA-F]{2}[/\\]([0-9a-fA-F-]{8,})/;m=function(e,d,b){this.id="MD5Pipe";this.async=!1;this.pipeline=null;this.md5AssetsMap=e;this.md5NativeAssetsMap=d;this.libraryBase=b};m.ID="MD5Pipe";m.prototype.handle=function(e){return e.url=this.transformURL(e.url),null};m.prototype.transformURL=function(e){var d=e.startsWith(this.libraryBase)?this.md5AssetsMap:
this.md5NativeAssetsMap;return e=e.replace(h,function(b,a){return(a=d[a])?b+"."+a:b})};f.MD5Pipe=n.exports=m},{"./pipeline":121}],120:[function(f,n,m){function h(){this.unpacker=null;this.state=b.Invalid;this.duration=0}var e=f("./unpackers"),d=f("../utils/misc").pushToMap,b={Invalid:0,Removed:1,Downloading:2,Loaded:3},a={},c={},g={},k=[],l=null;n.exports={msToRelease:12E4,initPacks:function(b){for(var l in g={},k=[],c=b,a={},b)for(var e=b[l],f=0;f<e.length;f++)d(a,e[f],l,1===e.length)},_loadNewPack:function(a,
c,b){var d=this,k=cc.AssetLibrary.getLibUrlNoExt(c)+".json";cc.loader.load({url:k,ignoreMaxConcurrency:!0},function(l,e){if(l)return cc.errorID(4916,a),b(l);g[c]?(g[c].url=k,(l=d._doLoadNewPack(a,c,e))?b(null,l):b(Error("Can not retrieve "+a+" from packer "+c))):b("The globalUnpackers is dirty.")})},_doPreload:function(a,d){var k=g[a];k||((k=g[a]=new h).state=b.Downloading);k.state!==b.Loaded&&(k.unpacker=new e.JsonUnpacker,k.unpacker.load(c[a],d),k.state=b.Loaded)},_doLoadNewPack:function(a,d,f){var p=
g[d];if(p){if(p.state!==b.Loaded){"string"==typeof f&&(f=JSON.parse(f));Array.isArray(f)?p.unpacker=new e.JsonUnpacker:f.type===e.TextureUnpacker.ID&&(p.unpacker=new e.TextureUnpacker);p.unpacker.load(c[d],f);p.state=b.Loaded;p.duration=0;k.push(d);var q=this;l||(l=setInterval(function(){for(var a=q.msToRelease/5E3,c=k.length-1;0<=c;c--){var b=k[c];++g[b].duration>a&&q.release(b)}0===k.length&&(clearInterval(l),l=null)},5E3))}return p.unpacker.retrieve(a)}},_selectLoadedPack:function(a){for(var c=
b.Invalid,d="",k=0;k<a.length;k++){var l=a[k],e=g[l];if(e){e=e.state;if(e===b.Loaded)return l;e>c&&(c=e,d=l)}}return c!==b.Invalid?d:a[0]},load:function(c,d){c=c.uuid;var k=a[c];if(k){Array.isArray(k)&&(k=this._selectLoadedPack(k));var l=g[k];return l&&l.state===b.Loaded?(l.duration=0,l.unpacker.retrieve(c)||Error("Can not retrieve "+c+" from packer "+k)):(l||(console.log("Create unpacker %s for %s",k,c),(l=g[k]=new h).state=b.Downloading),this._loadNewPack(c,k,d),null)}},release:function(a){var c=
g[a];c&&(cc.loader.release(c.url),delete g[a],cc.js.array.fastRemove(k,a))}}},{"../utils/misc":220,"./unpackers":125}],121:[function(f,n,m){function h(a,c){var d=a.id,k=c.states[d],l=a.next,e=a.pipeline;c.error||k===b.WORKING||k===b.ERROR||(k===b.COMPLETE?l?h(l,c):e.flowOut(c):(c.states[d]=b.WORKING,a=a.handle(c,function(a,g){a?(c.error=a,c.states[d]=b.ERROR,e.flowOut(c)):(g&&(c.content=g),c.states[d]=b.COMPLETE,l?h(l,c):e.flowOut(c))}),a instanceof Error?(c.error=a,c.states[d]=b.ERROR,e.flowOut(c)):
void 0!==a&&(null!==a&&(c.content=a),c.states[d]=b.COMPLETE,l?h(l,c):e.flowOut(c))))}var e=f("../platform/js"),d=f("./loading-items"),b=d.ItemState;f=function(a){this._pipes=a;this._cache=e.createMap(!0);for(var c=0;c<a.length;++c){var b=a[c];b.handle&&b.id&&(b.pipeline=this,b.next=c<a.length-1?a[c+1]:null)}};f.ItemState=b;m=f.prototype;m.insertPipe=function(a,c){if(!a.handle||!a.id||c>this._pipes.length)cc.warnID(4921);else if(0<this._pipes.indexOf(a))cc.warnID(4922);else{a.pipeline=this;var b=null;
c<this._pipes.length&&(b=this._pipes[c]);var d=null;0<c&&(d=this._pipes[c-1]);d&&(d.next=a);a.next=b;this._pipes.splice(c,0,a)}};m.insertPipeAfter=function(a,c){a=this._pipes.indexOf(a);0>a||this.insertPipe(c,a+1)};m.appendPipe=function(a){a.handle&&a.id&&(a.pipeline=this,a.next=null,0<this._pipes.length&&(this._pipes[this._pipes.length-1].next=a),this._pipes.push(a))};m.flowIn=function(a){var c,b=this._pipes[0];if(b){for(c=0;c<a.length;c++){var d=a[c];this._cache[d.id]=d}for(c=0;c<a.length;c++)h(b,
a[c])}else for(c=0;c<a.length;c++)this.flowOut(a[c])};m.flowInDeps=function(a,c,b){return d.create(this,function(a,c){b(a,c);c.destroy()}).append(c,a)};m.flowOut=function(a){a.error?delete this._cache[a.id]:this._cache[a.id]||(this._cache[a.id]=a);a.complete=!0;d.itemComplete(a)};m.copyItemStates=function(a,c){if(c instanceof Array)for(var b=0;b<c.length;++b)c[b].states=a.states;else c.states=a.states};m.getItem=function(a){return(a=this._cache[a])?(a.alias&&(a=a.alias),a):a};m.removeItem=function(a){var c=
this._cache[a];return c&&c.complete&&delete this._cache[a],c};m.clear=function(){for(var a in this._cache){var c=this._cache[a];delete this._cache[a];c.complete||(c.error=Error("Canceled manually"),this.flowOut(c))}};cc.Pipeline=n.exports=f},{"../platform/js":150,"./loading-items":118}],122:[function(f,n,m){},{"../platform/js":150}],123:[function(f,n,m){f=f("./pipeline");var h=/.*[/\\][0-9a-fA-F]{2}[/\\]([0-9a-fA-F-]{8,})/,e=Object.create(null);m=function(d){for(var b in this.id="SubPackPipe",this.async=
!1,this.pipeline=null,d){var a=d[b];a.uuids&&a.uuids.forEach(function(c){e[c]=a.path})}};m.ID="SubPackPipe";m.prototype.handle=function(d){return d.url=this.transformURL(d.url),null};m.prototype.transformURL=function(d){var b;if(b=(b=d.match(h))?b[1]:"")if(b=e[b])return d.replace("res/raw-assets/",b+"raw-assets/");return d};f.SubPackPipe=n.exports=m},{"./pipeline":121}],124:[function(f,n,m){var h=f("./utils").urlAppendTimestamp;n.exports=function(e,d){e=e.url;e=h(e);var b=cc.loader.getXMLHttpRequest(),
a="Load text file failed: "+e;b.open("GET",e,!0);b.overrideMimeType&&b.overrideMimeType("text/plain; charset=utf-8");b.onload=function(){4===b.readyState?200===b.status||0===b.status?d(null,b.responseText):d({status:b.status,errorMessage:a+"(wrong status)"}):d({status:b.status,errorMessage:a+"(wrong readyState)"})};b.onerror=function(){d({status:b.status,errorMessage:a+"(error)"})};b.ontimeout=function(){d({status:b.status,errorMessage:a+"(time out)"})};b.send(null)}},{"./utils":126}],125:[function(f,
n,m){function h(){this.jsons={}}function e(){this.contents={}}m=f("../assets/CCTexture2D");f=f("../platform/js");h.prototype.load=function(d,b){b.length!==d.length&&cc.errorID(4915);for(var a=0;a<d.length;a++)this.jsons[d[a]]=b[a]};h.prototype.retrieve=function(d){return this.jsons[d]||null};e.ID=f._getClassId(m);e.prototype.load=function(d,b){b=b.data.split("|");b.length!==d.length&&cc.errorID(4915);for(var a=0;a<d.length;a++)this.contents[d[a]]=b[a]};e.prototype.retrieve=function(d){return(d=this.contents[d])?
{__type__:e.ID,content:d}:null};n.exports={JsonUnpacker:h,TextureUnpacker:e}},{"../assets/CCTexture2D":51,"../platform/js":150}],126:[function(f,n,m){var h=/\?/;n.exports={urlAppendTimestamp:function(e){return cc.game.config.noCache&&"string"==typeof e&&(h.test(e)?e+="&_t="+(new Date-0):e+="?_t="+(new Date-0)),e}}},{}],127:[function(f,n,m){function h(a){return a&&(a[0]&&"cc.Scene"===a[0].__type__||a[1]&&"cc.Scene"===a[1].__type__||a[0]&&"cc.Prefab"===a[0].__type__)}function e(a,c,b,d){var g,k=b.uuidList,
l=b.uuidObjList,e=b.uuidPropList;b=b._stillUseUrl;a=a.dependKeys=[];if(d)for(d=[],g=0;g<k.length;g++){var f=k[g];c=l[g];var q=e[g],r=cc.AssetLibrary._getAssetInfoInRuntime(f);r.raw?(f=r.url,c[q]=f,a.push(f)):d.push({type:"uuid",uuid:f,deferredLoadRaw:!0,_owner:c,_ownerProp:q,_stillUseUrl:b[g]})}else{d=Array(k.length);for(g=0;g<k.length;g++)f=k[g],d[g]={type:"uuid",uuid:f,_owner:l[g],_ownerProp:e[g],_stillUseUrl:b[g]};c._native&&!c.constructor.preventPreloadNativeObject&&d.push({url:c.nativeUrl,_owner:c,
_ownerProp:"_nativeAsset"})}return d}function d(a,c,b,d,g){c.content=b;var l=c.dependKeys;a.flowInDeps(c,d,function(a,c){function e(a){var c=a.content;this._stillUseUrl&&(c=c&&cc.RawAsset.wasRawAssetType(c.constructor)?c.nativeUrl:a.rawUrl);"_nativeAsset"===this._ownerProp&&(this._owner.url=a.url);this._owner[this._ownerProp]=c;a.uuid!==b._uuid&&0>l.indexOf(a.id)&&l.push(a.id)}var f;c=c.map;for(var p in c)(f=c[p]).uuid&&f.content&&(f.content._uuid=f.uuid);for(p=0;p<d.length;p++){var q=d[p],r=q.uuid;
f=q.url;q._owner;q._ownerProp;if(f=c[f])if(f.complete||f.content)f.error?cc._throw(f.error.message||f.error.errorMessage||f.error):e.call(q,f);else{f=k.getQueue(f);var t=f._callbackTable[r];t?t.unshift(e,q):f.addListener(r,e,q)}}if(!a&&b.onLoad)try{b.onLoad()}catch(A){cc._throw(A)}g(a,b)})}function b(a,c,b){c=c.deferredLoadRaw;return c?a instanceof cc.Asset&&a.constructor.preventDeferredLoadDependents&&(c=!1):b&&(a instanceof cc.SceneAsset||a instanceof cc.Prefab)&&(c=a.asyncLoadAssets),c}function a(a,
k){if("string"==typeof a.content)try{var l=JSON.parse(a.content)}catch(E){return Error(g.getError(4923,a.id,E.stack))}else{if("object"!=typeof a.content)return Error(g.getError(4924));l=a.content}var f=h(l);var p=f?cc._MissingScript.safeFindClass:function(a){return c._getClassById(a)||(cc.warnID(4903,a),Object)};var q=cc.deserialize.Details.pool.get();try{var w=cc.deserialize(l,q,{classFinder:p,target:a.existingAsset,customEnv:a})}catch(E){return cc.deserialize.Details.pool.put(q),Error(g.getError(4925,
a.id,E.stack))}w._uuid=a.uuid;w.url=w.nativeUrl;l=e(a,w,q,b(w,a,f));if(cc.deserialize.Details.pool.put(q),0===l.length)return w.onLoad&&w.onLoad(),k(null,w);d(this.pipeline,a,w,l,k)}var c=f("../platform/js"),g=f("../CCDebug");f("../platform/deserialize");var k=f("./loading-items");n.exports=a;a.isSceneObj=h},{"../CCDebug":27,"../platform/deserialize":145,"../platform/js":150,"./loading-items":118}],128:[function(f,n,m){function h(){this._activatingStack=[]}var e=f("./component-scheduler");m=f("./platform/CCObject").Flags;
var d=f("./platform/js"),b=m.IsPreloadStarted,a=m.IsOnLoadStarted,c=m.IsOnLoadCalled,g=m.Deactivating,k=cc.Class({extends:e.LifeCycleInvoker,add:function(a){this._zero.array.push(a)},remove:function(a){this._zero.fastRemove(a)},cancelInactive:function(a){e.LifeCycleInvoker.stableRemoveInactive(this._zero,a)},invoke:function(){this._invoke(this._zero);this._zero.array.length=0}}),l=e.createInvokeImpl("c.__preload();"),q=e.createInvokeImpl("c.onLoad();c._objFlags|="+c,!1,c),r=new d.Pool(4);r.get=function(){var a=
this._get()||{preload:new k(l),onLoad:new e.OneOffInvoker(q),onEnable:new e.OneOffInvoker(e.invokeOnEnable)};a.preload._zero.i=-1;var c=a.onLoad;return c._zero.i=-1,c._neg.i=-1,c._pos.i=-1,(c=a.onEnable)._zero.i=-1,c._neg.i=-1,c._pos.i=-1,a};f=cc.Class({ctor:h,reset:h,_activateNodeRecursively:function(a,c,b,k){if(a._objFlags&g)cc.errorID(3816,a.name);else{a._activeInHierarchy=!0;for(var l=a._components.length,e=0;e<l;++e){var f=a._components[e];if(f instanceof cc.Component)this.activateComp(f,c,b,
k);else{var p=a,q=e;f?p._removeComponent(f):d.array.removeAt(p._components,q);--e;--l}}a._childArrivalOrder=a._children.length;l=0;for(e=a._children.length;l<e;++l)f=a._children[l],f._localZOrder=4294901760&f._localZOrder|l+1,f._active&&this._activateNodeRecursively(f,c,b,k);a._onPostActivated(!0)}},_deactivateNodeRecursively:function(a){a._objFlags|=g;a._activeInHierarchy=!1;for(var c=a._components.length,b=0;b<c;++b){var d=a._components[b];if(d._enabled&&(cc.director._compScheduler.disableComp(d),
a._activeInHierarchy))return void(a._objFlags&=~g)}c=0;for(b=a._children.length;c<b;++c)if(d=a._children[c],d._activeInHierarchy&&(this._deactivateNodeRecursively(d),a._activeInHierarchy))return void(a._objFlags&=~g);a._onPostActivated(!1);a._objFlags&=~g},activateNode:function(c,d){if(d)d=r.get(),this._activatingStack.push(d),this._activateNodeRecursively(c,d.preload,d.onLoad,d.onEnable),d.preload.invoke(),d.onLoad.invoke(),d.onEnable.invoke(),this._activatingStack.pop(),r.put(d);else{this._deactivateNodeRecursively(c);
d=this._activatingStack;for(var g=0;g<d.length;g++){var k=d[g];k.preload.cancelInactive(b);k.onLoad.cancelInactive(a);k.onEnable.cancelInactive()}}c.emit("active-in-hierarchy-changed",c)},activateComp:function(d,g,k,l){cc.isValid(d,!0)&&(d._objFlags&b||(d._objFlags|=b,d.__preload&&(g?g.add(d):d.__preload())),d._objFlags&a||(d._objFlags|=a,d.onLoad?k?k.add(d):(d.onLoad(),d._objFlags|=c):d._objFlags|=c),d._enabled)&&d.node._activeInHierarchy&&cc.director._compScheduler.enableComp(d,l)},destroyComp:function(a){cc.director._compScheduler.disableComp(a);
a.onDestroy&&a._objFlags&c&&a.onDestroy()},resetComp:!1});n.exports=f},{"./component-scheduler":58,"./platform/CCObject":136,"./platform/js":150,"./utils/misc":220}],129:[function(f,n,m){function h(a){return a&&(a.constructor===cc.SceneAsset||a instanceof cc.Scene)}function e(a,c){this.url=a;this.type=c}function d(a,c,b){var d=x[a]={};cc.loader.loadResDir(a+"s",c,"internal",function(){},function(a,c){if(a)cc.error(a);else for(a=0;a<c.length;a++){var g=c[a];cc.loader.getDependsRecursively(g).forEach(function(a){return y[a]=
!0});d[""+g.name]=g}b()})}f("../assets/CCAsset");var b=f("./utils").callInNextTick,a=f("../load-pipeline/CCLoader"),c=f("../load-pipeline/asset-table"),g=f("../load-pipeline/pack-downloader"),k=f("../load-pipeline/auto-release-utils"),l=f("../utils/decode-uuid"),q=f("../load-pipeline/md5-pipe"),r=f("../load-pipeline/subpackage-pipe"),t=f("./js"),p="",v="",w=t.createMap(!0),E={loadAsset:function(c,d,g){if("string"!=typeof c)return b(d,Error("[AssetLibrary] uuid must be string"),null);var l={uuid:c,
type:"uuid"};g&&g.existingAsset&&(l.existingAsset=g.existingAsset);a.load(l,function(b,g){if(b||!g)b="string"==typeof b?b:b?b.message||b.errorMessage||JSON.stringify(b):"Unknown error",b=Error("[AssetLibrary] loading JSON or dependencies failed:"+b);else{if(g.constructor===cc.SceneAsset){var l=cc.loader._getReferenceKey(c);g.scene.dependAssets=k.getDependsRecursively(l)}h(g)&&(l=cc.loader._getReferenceKey(c),a.removeItem(l))}d&&d(b,g)})},getLibUrlNoExt:function(a,c){return a=l(a),(c?v+"assets/":p)+
a.slice(0,2)+"/"+a},_queryAssetInfoInEditor:function(a,c){0},_getAssetInfoInRuntime:function(a,c){c=c||{url:null,raw:!1};var b=w[a];return b&&!t.isChildClassOf(b.type,cc.Asset)?(c.url=v+b.url,c.raw=!0):(c.url=this.getLibUrlNoExt(a)+".json",c.raw=!1),c},_uuidInSettings:function(a){return a in w},queryAssetInfo:function(a,c){a=this._getAssetInfoInRuntime(a);c(null,a.url,a.raw)},parseUuidInEditor:function(a){},loadJson:function(c,b){var d=""+((new Date).getTime()+Math.random());a.load({uuid:d,type:"uuid",
content:c,skips:[a.assetLoader.id,a.downloader.id]},function(c,g){if(c)c=Error("[AssetLibrary] loading JSON or dependencies failed: "+c.message);else{if(g.constructor===cc.SceneAsset){var l=cc.loader._getReferenceKey(d);g.scene.dependAssets=k.getDependsRecursively(l)}h(g)&&(l=cc.loader._getReferenceKey(d),a.removeItem(l))}g._uuid="";b&&b(c,g)})},getAssetByUuid:function(a){return E._uuidToAsset[a]||null},init:function(b){var d=b.libraryPath;if(d=d.replace(/\\/g,"/"),p=cc.path.stripSep(d)+"/",v=b.rawAssetsBase,
b.subpackages)d=new r(b.subpackages),cc.loader.insertPipeAfter(cc.loader.assetLoader,d),cc.loader.subPackPipe=d;if((d=b.md5AssetsMap)&&d.import){var k,f=0,h=t.createMap(!0),E=d.import;for(k=0;k<E.length;k+=2)h[f=l(E[k])]=E[k+1];var x=t.createMap(!0);E=d["raw-assets"];for(k=0;k<E.length;k+=2)x[f=l(E[k])]=E[k+1];d=new q(h,x,p);cc.loader.insertPipeAfter(cc.loader.assetLoader,d);cc.loader.md5Pipe=d}d=a._assetTables;for(var u in d)d[u].reset();if(u=b.rawAssets)for(var y in u)for(f in k=u[y],k){x=k[f];
h=x[0];var m=x[1];(E=cc.js._getClassById(m))?(w[f]=new e(y+"/"+h,E),(m=cc.path.extname(h))&&(h=h.slice(0,-m.length)),x=1===x[2],d[y]||(d[y]=new c),d[y].add(h,f,E,!x)):cc.error("Cannot get",m)}b.packedAssets&&g.initPacks(b.packedAssets);cc.url._init(b.mountPaths&&b.mountPaths.assets||v+"assets")},_uuidToAsset:{}},x={effect:{},material:{}},y={};E._loadBuiltins=function(a){if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS)return a&&a();d("effect",cc.EffectAsset,function(){d("material",cc.Material,a)})};
E.getBuiltin=function(a,c){return x[a][c]};E.getBuiltins=function(a){return a?x[a]:x};E.resetBuiltins=function(){x={effect:{},material:{}};y={}};E.getBuiltinDeps=function(){return y};n.exports=cc.AssetLibrary=E},{"../assets/CCAsset":34,"../load-pipeline/CCLoader":108,"../load-pipeline/asset-table":110,"../load-pipeline/auto-release-utils":112,"../load-pipeline/md5-pipe":119,"../load-pipeline/pack-downloader":120,"../load-pipeline/subpackage-pipe":123,"../utils/decode-uuid":215,"./js":150,"./utils":154}],
130:[function(f,n,m){function h(a,c,b,d,g){x.setClassAttr(a,b,"default",d.default);g=a.__props__;0>g.indexOf(b)&&g.push(b);v(a,d,c,b,!1)}function e(a,c,b,d,g){var k=d.get,l=d.set,e=a.prototype,f=!Object.getOwnPropertyDescriptor(e,b);k&&(v(a,d,c,b,!0),x.setClassAttr(a,b,"serializable",!1),g||w.get(e,b,k,f,f));l&&(g||w.set(e,b,l,f,f))}function d(a){return"function"==typeof a?a():a}function b(a,c,b){for(var d in c)a.hasOwnProperty(d)||b&&!b(d)||Object.defineProperty(a,d,w.getPropertyDescriptor(c,d))}
function a(a,c,d,g){var k,e,f=g.__ctor__,r=g.ctor,t=g.__ES6__;t?(k=[r],e=r):(k=f?[f]:q(c,d,g),e=A(k,c,a,g),w.value(e,"extend",function(a){return a.extends=this,p(a)},!0));w.value(e,"__ctors__",0<k.length?k:null,!0);g=e.prototype;if(c&&(t||(w.extend(e,c),g=e.prototype),e.$super=c),d){for(c=d.length-1;0<=c;c--){var v=d[c];b(g,v.prototype);b(e,v,function(a){return v.hasOwnProperty(a)&&!0});p._isCCClass(v)&&b(x.getClassAttrs(e),x.getClassAttrs(v))}g.constructor=e}return t||(g.__initProps__=l),w.setClassName(a,
e),e}function c(c,b,d,g){var k=cc.Component,l=cc._RF.peek();if(l&&w.isChildClassOf(b,k)){if(w.isChildClassOf(l.cls,k))return cc.errorID(3615),null;0;c=c||l.script}c=a(c,b,d,g);l&&(w.isChildClassOf(b,k)?((b=l.uuid)&&w._setClassId(b,c),l.cls=c):w.isChildClassOf(l.cls,k)||(l.cls=c));return c}function g(a){var c=w.getClassName(a),b=a.constructor;c="new "+c+"(";for(var d=0;d<b.__props__.length;d++){var g=a[b.__props__[d]];0;c+=g;d<b.__props__.length-1&&(c+=",")}return c+")"}function k(a){return JSON.stringify(a).replace(/\u2028/g,
"\\u2028").replace(/\u2029/g,"\\u2029")}function l(a){var c=x.getClassAttrs(a),b=a.__props__;null===b&&(C.init(),b=a.__props__);for(var d=[],l="",e=0;e<b.length;e++){var f=b[e],p=f+y+"default";if(p in c){f=z.test(f)?"this."+f+"=":"this["+k(f)+"]=";p=c[p];if("object"==typeof p&&p)p=p instanceof cc.ValueType?g(p):Array.isArray(p)?"[]":"{}";else if("function"==typeof p){var q=d.length;d.push(p);p="F["+q+"]()"}else p="string"==typeof p?k(p):p;l+=f+p+";\n"}}c=0===d.length?Function(l):Function("F","return (function(){\n"+
l+"})")(d);a.prototype.__initProps__=c;c.call(this)}function q(a,c,b){var d=[];a=[a].concat(c);for(c=0;c<a.length;c++){var g=a[c];if(g){g=p._isCCClass(g)?g.__ctors__||[]:[g];for(var k=0;k<g.length;k++){var l=d,e=g[k];0>l.indexOf(e)&&l.push(e)}}}b=b.ctor;return b&&d.push(b),d}function r(a,c,b){b=!1;for(var d in c)if(!(0<=B.indexOf(d))){var g=c[d];if("function"==typeof g){var k=w.getPropertyDescriptor(a.prototype,d);if(k&&(k=k.value,"function"==typeof k)){D.test(g)&&(b=!0,c[d]=function(a,c){return function(){var b=
this._super;this._super=a;var d=c.apply(this,arguments);return this._super=b,d}}(k,g));continue}0}}return b}function t(a,c,b,d,g,k){if(a.__props__=[],d&&d.__props__&&(a.__props__=d.__props__.slice()),g)for(d=0;d<g.length;++d){var l=g[d];l.__props__&&(a.__props__=a.__props__.concat(l.__props__.filter(function(c){return 0>a.__props__.indexOf(c)})))}if(b)for(var f in u.preprocessAttrs(b,c,a,k),b)g=b[f],"default"in g?h(a,c,f,g):e(a,c,f,g,k);var p=x.getClassAttrs(a);a.__values__=a.__props__.filter(function(a){return!1!==
p[a+y+"serializable"]})}function p(a){var b=(a=a||{}).name,d=a.extends,g=a.mixins,k=c(b,d,g,a);b||(b=cc.js.getClassName(k));k._sealed=!0;d&&(d._sealed=!1);var l=a.properties;"function"==typeof l||d&&null===d.__props__||g&&g.some(function(a){return null===a.__props__})?(C.push({cls:k,props:l,mixins:g}),k.__props__=k.__values__=null):t(k,b,l,d,a.mixins,a.__ES6__);if(g=a.statics)for(f in g)k[f]=g[f];for(var e in a)if(!(0<=B.indexOf(e))){var f=a[e];u.validateMethodWithProps(f,e,b,k,d)&&w.value(k.prototype,
e,f,!0,!0)}a=a.editor;return a&&w.isChildClassOf(d,cc.Component)&&cc.Component._registerEditorProps(k,a),k}function v(a,c,b,d,g){function k(){return f=d+y,e=x.getClassAttrs(a)}function l(a,b){if(a in c){var d=c[a];typeof d===b&&((e||k())[f+a]=d)}}var e=null,f="";if(b=c.type)I[b]?(e||k())[f+"type"]=b:"Object"===b||(b===x.ScriptUuid?((e||k())[f+"type"]="Script",e[f+"ctor"]=cc.ScriptAsset):"object"==typeof b?E.isEnum(b)&&((e||k())[f+"type"]="Enum",e[f+"enumList"]=E.getList(b)):"function"==typeof b&&
((e||k())[f+"type"]="Object",e[f+"ctor"]=b));c.editorOnly&&((e||k())[f+"editorOnly"]=!0);c.url&&((e||k())[f+"saveUrlAsAsset"]=!0);!1===c.serializable&&((e||k())[f+"serializable"]=!1);l("formerlySerializedAs","string");(b=c.range)&&Array.isArray(b)&&2<=b.length&&((e||k())[f+"min"]=b[0],e[f+"max"]=b[1],2<b.length&&(e[f+"step"]=b[2]));l("min","number");l("max","number");l("step","number")}var w=f("./js"),E=f("./CCEnum");m=f("./utils");var x=(m.isPlainEmptyObj_DEV,m.cloneable_DEV,f("./attribute")),y=
x.DELIMETER,u=f("./preprocess-class");f("./requiring-frame");var B="name extends mixins ctor __ctor__ properties statics editor __ES6__".split(" "),C={datas:null,push:function(a){if(this.datas)this.datas.push(a);else{this.datas=[a];var c=this;setTimeout(function(){c.init()},0)}},init:function(){var a=this.datas;if(a){for(var c=0;c<a.length;++c){var b=a[c],d=b.cls,g=b.props;"function"==typeof g&&(g=g());var k=w.getClassName(d);g?t(d,k,g,d.$super,b.mixins):cc.errorID(3633,k)}this.datas=null}}},z=/^[A-Za-z_$][0-9A-Za-z_$]*$/,
A=function(a,c,b,d){var g="return function CCClass(){\n";c&&r(c,d,b)&&(g+="this._super=null;\n");g+="this.__initProps__(CCClass);\n";a=a.length;if(0<a){0;if(1===a)g+="CCClass.__ctors__[0].apply(this,arguments);\n";else for(g+="var cs=CCClass.__ctors__;\n",c=0;c<a;c++)g+="cs["+c+"].apply(this,arguments);\n";0}return g+="}",Function(g)()},D=/xyz/.test(function(){xyz})?/\b\._super\b/:/.*/;/xyz/.test(function(){xyz});p._isCCClass=function(a){return a&&a.hasOwnProperty("__ctors__")};p._fastDefine=function(a,
c,b){w.setClassName(a,c);a=c.__props__=c.__values__=Object.keys(b);c=x.getClassAttrs(c);for(var d=0;d<a.length;d++){var g=a[d];c[g+y+"visible"]=!1;c[g+y+"default"]=b[g]}};p.Attr=x;p.attr=x.attr;p.getInheritanceChain=function(a){for(var c=[];a=w.getSuper(a);)a!==Object&&c.push(a);return c};var I={Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"};cc.Class=p;n.exports={isArray:function(a){return a=d(a),Array.isArray(a)},fastDefine:p._fastDefine,getNewValueTypeCode:g,IDENTIFIER_RE:z,
escapeForJS:k,getDefault:d}},{"./CCEnum":132,"./attribute":142,"./js":150,"./preprocess-class":151,"./requiring-frame":152,"./utils":154}],131:[function(f,n,m){function h(a){return a}function e(a,c){return a[c]||(a[c]={})}function d(a){return function(c){return"function"==typeof c?a(c):function(b){return a(b,c)}}}function b(a,c,b){return function(a){return function(b){return c(b,a)}}}function a(a,c,b){return a(function(a,d){if(a=e(a,"__ccclassCache__"))d=void 0!==b?b:d,e(e(a,"proto"),"editor")[c]=
d},c)}f("./CCClass");var c=f("./preprocess-class"),g=f("./js"),k=b.bind(null,!1),l=b.bind(null,!1),q=b.bind(null,!1);f=d(function(a,c){var b=g.getSuper(a);b===Object&&(b=null);c={name:c,extends:b,ctor:a,__ES6__:!0};if(b=a.__ccclassCache__)(b=b.proto)&&g.mixin(c,b),a.__ccclassCache__=void 0;return cc.Class(c)});m=d(h);k=a(k,"requireComponent");var r=l(h);q=a(q,"executionOrder");var t=d(h),p=d(h),v=l(h),w=l(h);l=l(h);cc._decorator=n.exports={ccclass:f,property:function(a){function b(a,b,d){var k=e(a.constructor,
"__ccclassCache__");if(k){var f=e(e(k,"proto"),"properties");a=a.constructor;var p=l,q;p&&(q=c.getFullFormOfProperty(p));q=g.mixin(f[b]||{},q||p||{});if(d&&(d.get||d.set))d.get&&(q.get=d.get),d.set&&(q.set=d.set);else{0;p=void 0;if(d){if(d.initializer){a:{k=d.initializer;try{var r=k()}catch(K){break a}k="object"!=typeof r||null===r?r:k}p=k;!0}}else{if(!(r=k.default)){a:{try{var t=new a}catch(K){r={};break a}r=t}r=k.default=r}k=r;k.hasOwnProperty(b)&&(p=k[b],!0)}0;q.default=p}f[b]=q}}var d=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:void 0,k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,l=null;if(void 0===d)return l=a,b;b(a,d,k)},executeInEditMode:m,requireComponent:k,menu:r,executionOrder:q,disallowMultiple:t,playOnFocus:p,inspector:v,icon:w,help:l,mixins:function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return function(c){(c=e(c,"__ccclassCache__"))&&(e(c,"proto").mixins=a)}}}},{"./CCClass":130,"./js":150,"./preprocess-class":151,"./utils":154}],132:[function(f,
n,m){function h(d){if("__enums__"in d)return d;e.value(d,"__enums__",null,!0);for(var b=-1,a=Object.keys(d),c=0;c<a.length;c++){var g=a[c],k=d[g];if(-1===k)k=++b,d[g]=k;else if("number"==typeof k)b=k;else if("string"==typeof k&&Number.isInteger(parseFloat(g)))continue;k=""+k;g!==k&&e.value(d,k,g)}return d}var e=f("./js");h.isEnum=function(d){return d&&d.hasOwnProperty("__enums__")};h.getList=function(d){if(d.__enums__)return d.__enums__;var b=d.__enums__=[],a;for(a in d){var c=d[a];Number.isInteger(c)&&
b.push({name:a,value:c})}return b.sort(function(a,c){return a.value-c.value}),b};n.exports=cc.Enum=h},{"./js":150}],133:[function(f,n,m){var h=f("../event-manager");f=f("./CCInputManager");var e=void 0;cc.Acceleration=function(d,b,a,c){this.x=d||0;this.y=b||0;this.z=a||0;this.timestamp=c||0};f.setAccelerometerEnabled=function(d){this._accelEnabled!==d&&(this._accelEnabled=d,d=cc.director.getScheduler(),d.enableForTarget(this),this._accelEnabled?(this._registerAccelerometerEvent(),this._accelCurTime=
0,d.scheduleUpdate(this)):(this._unregisterAccelerometerEvent(),this._accelCurTime=0,d.unscheduleUpdate(this)))};f.setAccelerometerInterval=function(d){this._accelInterval!==d&&(this._accelInterval=d)};f._registerKeyboardEvent=function(){cc.game.canvas.addEventListener("keydown",function(d){h.dispatchEvent(new cc.Event.EventKeyboard(d.keyCode,!0));d.stopPropagation();d.preventDefault()},!1);cc.game.canvas.addEventListener("keyup",function(d){h.dispatchEvent(new cc.Event.EventKeyboard(d.keyCode,!1));
d.stopPropagation();d.preventDefault()},!1)};f._registerAccelerometerEvent=function(){var d=window;this._acceleration=new cc.Acceleration;this._accelDeviceEvent=d.DeviceMotionEvent||d.DeviceOrientationEvent;cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(this._accelDeviceEvent=window.DeviceOrientationEvent);var b=this._accelDeviceEvent===d.DeviceMotionEvent?"devicemotion":"deviceorientation",a=navigator.userAgent;(/Android/.test(a)||/Adr/.test(a)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(this._minus=
-1);e=this.didAccelerate.bind(this);d.addEventListener(b,e,!1)};f._unregisterAccelerometerEvent=function(){var d=window,b=this._accelDeviceEvent===d.DeviceMotionEvent?"devicemotion":"deviceorientation";e&&d.removeEventListener(b,e,!1)};f.didAccelerate=function(d){var b=window;if(this._accelEnabled){var a=this._acceleration;if(this._accelDeviceEvent===window.DeviceMotionEvent){var c=d.accelerationIncludingGravity;var g=this._accelMinus*c.x*.1;var k=this._accelMinus*c.y*.1;c=.1*c.z}else g=d.gamma/90*
.981,k=-d.beta/90*.981,c=d.alpha/90*.981;if(cc.view._isRotated){var l=g;g=-k;k=l}a.x=g;a.y=k;a.z=c;a.timestamp=d.timeStamp||Date.now();d=a.x;90===b.orientation?(a.x=-a.y,a.y=d):-90===b.orientation?(a.x=a.y,a.y=-d):180===b.orientation&&(a.x=-a.x,a.y=-a.y);cc.sys.os===cc.sys.OS_ANDROID&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ&&(a.x=-a.x,a.y=-a.y)}}},{"../event-manager":97,"./CCInputManager":134}],134:[function(f,n,m){m=f("./CCMacro");var h=f("./CCSys"),e=f("../event-manager"),d=m.TOUCH_TIMEOUT,
b=cc.v2();f={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.v2(0,0),_prevMousePoint:cc.v2(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:8,_accelEnabled:!1,_accelInterval:.2,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_canvasBoundingRect:{left:0,top:0,adjustedLeft:0,adjustedTop:0,width:0,height:0},_getUnUsedIndex:function(){for(var a=this._indexBitsUsed,c=cc.sys.now(),b=0;b<this._maxTouches;b++){if(!(1&
a))return this._indexBitsUsed|=1<<b,b;var k=this._touches[b];if(c-k._lastModified>d)return this._removeUsedIndexBit(b),delete this._touchesIntegerDict[k.getID()],b;a>>=1}return-1},_removeUsedIndexBit:function(a){0>a||a>=this._maxTouches||(a=~(1<<a),this._indexBitsUsed&=a)},_glView:null,_updateCanvasBoundingRect:function(){var a=cc.game.canvas,c=this._canvasBoundingRect,b=document.documentElement,d=window.pageXOffset-b.clientLeft;b=window.pageYOffset-b.clientTop;a.getBoundingClientRect?(a=a.getBoundingClientRect(),
c.left=a.left+d,c.top=a.top+b,c.width=a.width,c.height=a.height):a instanceof HTMLCanvasElement?(c.left=d,c.top=b,c.width=a.width,c.height=a.height):(c.left=d,c.top=b,c.width=parseInt(a.style.width),c.height=parseInt(a.style.height))},handleTouchesBegin:function(a){for(var c,b,d,l=[],f=this._touchesIntegerDict,r=h.now(),t=0,p=a.length;t<p;t++)if(null==f[d=(c=a[t]).getID()]){var v=this._getUnUsedIndex();-1===v?cc.logID(2300,v):((b=this._touches[v]=new cc.Touch(c._point.x,c._point.y,c.getID()))._lastModified=
r,b._setPrevPoint(c._prevPoint),f[d]=v,l.push(b))}0<l.length&&(this._glView._convertTouchesWithScale(l),a=new cc.Event.EventTouch(l),a._eventCode=cc.Event.EventTouch.BEGAN,e.dispatchEvent(a))},handleTouchesMove:function(a){for(var c,b=void 0,d,l=[],f=this._touches,r=h.now(),t=0,p=a.length;t<p;t++)d=(c=a[t]).getID(),null!=(b=this._touchesIntegerDict[d])&&f[b]&&(f[b]._setPoint(c._point),f[b]._setPrevPoint(c._prevPoint),f[b]._lastModified=r,l.push(f[b]));0<l.length&&(this._glView._convertTouchesWithScale(l),
a=new cc.Event.EventTouch(l),a._eventCode=cc.Event.EventTouch.MOVED,e.dispatchEvent(a))},handleTouchesEnd:function(a){a=this.getSetOfTouchesEndOrCancel(a);0<a.length&&(this._glView._convertTouchesWithScale(a),a=new cc.Event.EventTouch(a),a._eventCode=cc.Event.EventTouch.ENDED,e.dispatchEvent(a));this._preTouchPool.length=0},handleTouchesCancel:function(a){a=this.getSetOfTouchesEndOrCancel(a);0<a.length&&(this._glView._convertTouchesWithScale(a),a=new cc.Event.EventTouch(a),a._eventCode=cc.Event.EventTouch.CANCELLED,
e.dispatchEvent(a));this._preTouchPool.length=0},getSetOfTouchesEndOrCancel:function(a){for(var c=void 0,b=void 0,d=void 0,l=[],e=this._touches,f=this._touchesIntegerDict,t=0,p=a.length;t<p;t++)null!=(b=f[d=(c=a[t]).getID()])&&e[b]&&(e[b]._setPoint(c._point),e[b]._setPrevPoint(c._prevPoint),l.push(e[b]),this._removeUsedIndexBit(b),delete f[d]);return l},getPreTouch:function(a){for(var c=null,b=this._preTouchPool,d=a.getID(),l=b.length-1;0<=l;l--)if(b[l].getID()===d){c=b[l];break}return c||(c=a),c},
setPreTouch:function(a){for(var c=!1,b=this._preTouchPool,d=a.getID(),l=b.length-1;0<=l;l--)if(b[l].getID()===d){b[l]=a;c=!0;break}c||(50>=b.length?b.push(a):(b[this._preTouchPoolPointer]=a,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(a,c,b){var d=this._preTouchPoint;a=this._glView.convertToLocationInView(a,c,b);c=new cc.Touch(a.x,a.y,0);return c._setPrevPoint(d.x,d.y),d.x=a.x,d.y=a.y,c},getMouseEvent:function(a,c,b){var d=this._prevMousePoint;b=new cc.Event.EventMouse(b);
return b._setPrevCursor(d.x,d.y),d.x=a.x,d.y=a.y,this._glView._convertMouseToLocationInView(d,c),b.setLocation(d.x,d.y),b},getPointByEvent:function(a,c){return null!=a.pageX?{x:a.pageX,y:a.pageY}:(c.left-=document.body.scrollLeft,c.top-=document.body.scrollTop,{x:a.clientX,y:a.clientY})},getTouchesByEvent:function(a,c){for(var d=[],k=this._glView,l,e=void 0,f=void 0,t=this._preTouchPoint,p=a.changedTouches.length,v=0;v<p;v++)if(l=a.changedTouches[v]){var w=h.BROWSER_TYPE_FIREFOX===h.browserType?k.convertToLocationInView(l.pageX,
l.pageY,c,b):k.convertToLocationInView(l.clientX,l.clientY,c,b);null!=l.identifier?(e=new cc.Touch(w.x,w.y,l.identifier),f=this.getPreTouch(e).getLocation(),e._setPrevPoint(f.x,f.y),this.setPreTouch(e)):(e=new cc.Touch(w.x,w.y))._setPrevPoint(t.x,t.y);t.x=w.x;t.y=w.y;d.push(e)}return d},registerSystemEvent:function(a){if(!this._isRegisterEvent){this._glView=cc.view;var c=this,b=this._canvasBoundingRect;window.addEventListener("resize",this._updateCanvasBoundingRect.bind(this));var d=h.isMobile,l=
"touches"in h.capabilities;if("mouse"in h.capabilities){d||(window.addEventListener("mousedown",function(){c._mousePressed=!0},!1),window.addEventListener("mouseup",function(a){if(c._mousePressed){c._mousePressed=!1;var d=c.getPointByEvent(a,b);cc.rect(b.left,b.top,b.width,b.height).contains(d)||(c.handleTouchesEnd([c.getTouchByXY(d.x,d.y,b)]),d=c.getMouseEvent(d,b,cc.Event.EventMouse.UP),d.setButton(a.button),e.dispatchEvent(d))}},!1));var f=cc.Event.EventMouse;d=[!d&&["mousedown",f.DOWN,function(b,
d,g,k){c._mousePressed=!0;c.handleTouchesBegin([c.getTouchByXY(g.x,g.y,k)]);a.focus()}],!d&&["mouseup",f.UP,function(a,b,d,g){c._mousePressed=!1;c.handleTouchesEnd([c.getTouchByXY(d.x,d.y,g)])}],!d&&["mousemove",f.MOVE,function(a,b,d,g){c.handleTouchesMove([c.getTouchByXY(d.x,d.y,g)]);c._mousePressed||b.setButton(null)}],["mousewheel",f.SCROLL,function(a,c){c.setScrollData(0,a.wheelDelta)}],["DOMMouseScroll",f.SCROLL,function(a,c){c.setScrollData(0,-120*a.detail)}]];for(f=0;f<d.length;++f){var r=
d[f];r&&function(){var d=r[1],g=r[2];a.addEventListener(r[0],function(a){var k=c.getPointByEvent(a,b),l=c.getMouseEvent(k,b,d);l.setButton(a.button);g(a,l,k,b);e.dispatchEvent(l);a.stopPropagation();a.preventDefault()},!1)}()}}if(window.navigator.msPointerEnabled){var t={MSPointerDown:c.handleTouchesBegin,MSPointerMove:c.handleTouchesMove,MSPointerUp:c.handleTouchesEnd,MSPointerCancel:c.handleTouchesCancel};d=function(d){var g=t[d];a.addEventListener(d,function(a){var d=document.documentElement;b.adjustedLeft=
b.left-d.scrollLeft;b.adjustedTop=b.top-d.scrollTop;g.call(c,[c.getTouchByXY(a.clientX,a.clientY,b)]);a.stopPropagation()},!1)};for(var p in t)d(p)}if(l){var v={touchstart:function(b){c.handleTouchesBegin(b);a.focus()},touchmove:function(a){c.handleTouchesMove(a)},touchend:function(a){c.handleTouchesEnd(a)},touchcancel:function(a){c.handleTouchesCancel(a)}};l=function(d){var g=v[d];a.addEventListener(d,function(a){if(a.changedTouches){var d=document.body;b.adjustedLeft=b.left-(d.scrollLeft||0);b.adjustedTop=
b.top-(d.scrollTop||0);g(c.getTouchesByEvent(a,b));a.stopPropagation();a.preventDefault()}},!1)};for(p in v)l(p)}this._registerKeyboardEvent();this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(a){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,e.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration)));this._accelCurTime+=a}};n.exports=_cc.inputManager=f},{"../event-manager":97,"./CCMacro":135,
"./CCSys":139}],135:[function(f,n,m){cc.macro={RAD:Math.PI/180,DEG:180/Math.PI,REPEAT_FOREVER:Number.MAX_VALUE-1,FLT_EPSILON:1.192092896E-7,MIN_ZINDEX:-Math.pow(2,15),MAX_ZINDEX:Math.pow(2,15)-1,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,
DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX:!0,DIRECTOR_STATS_POSITION:cc.v2(0,0),ENABLE_STACKABLE_ACTIONS:!0,TOUCH_TIMEOUT:5E3,BATCH_VERTEX_COUNT:2E4,ENABLE_TILEDMAP_CULLING:!0,DOWNLOAD_MAX_CONCURRENT:64,ENABLE_TRANSPARENT_CANVAS:!1,ENABLE_WEBGL_ANTIALIAS:!1,ENABLE_CULLING:!1,CLEANUP_IMAGE_CACHE:!1,SHOW_MESH_WIREFRAME:!1,ROTATE_ACTION_CCW:!1};cc.macro.SUPPORT_TEXTURE_FORMATS=".pkm .pvr .webp .jpg .jpeg .bmp .png".split(" ");
cc.macro.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,
"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1E3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005};cc.macro.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10});
cc.macro.BlendFactor=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775});cc.macro.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2});cc.macro.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2});n.exports=cc.macro},{}],136:[function(f,n,m){function h(){this._name="";this._objFlags=0}var e=f("./js"),d=f("./CCClass");d.fastDefine("cc.Object",h,{_name:"",_objFlags:0});e.value(h,
"Flags",{Destroyed:1,DontSave:8,EditorOnly:16,Dirty:32,DontDestroy:64,PersistentMask:-4192741,Destroying:128,Deactivating:256,LockedInEditor:512,HideInHierarchy:1024,IsPreloadStarted:8192,IsOnLoadStarted:32768,IsOnLoadCalled:16384,IsOnEnableCalled:2048,IsStartCalled:65536,IsEditorOnEnableCalled:4096,IsPositionLocked:2097152,IsRotationLocked:131072,IsScaleLocked:262144,IsAnchorLocked:524288,IsSizeLocked:1048576});var b=[];e.value(h,"_deferredDestroy",function(){for(var a=b.length,c=0;c<a;++c){var d=
b[c];d._objFlags&1||d._destroyImmediate()}a===b.length?b.length=0:b.splice(0,a)});f=h.prototype;e.getset(f,"name",function(){return this._name},function(a){this._name=a},!0);e.get(f,"isValid",function(){return!(this._objFlags&1)},!0);f.destroy=function(){return this._objFlags&1?(cc.warnID(5E3),!1):!(4&this._objFlags)&&(this._objFlags|=4,b.push(this),!0)};f._destruct=function(){var a=this.constructor,c=a.__destruct__;if(!c){var b,k=this instanceof cc._BaseNode||this instanceof cc.Component,l=k?"_id":
null;c={};for(b in this)if(this.hasOwnProperty(b)&&b!==l)switch(typeof this[b]){case "string":c[b]="";break;case "object":case "function":c[b]=null}if(cc.Class._isCCClass(a)){l=cc.Class.Attr.getClassAttrs(a);for(var f=a.__props__,r=0;r<f.length;r++){var t=(b=f[r])+cc.Class.Attr.DELIMETER+"default";if(t in l&&(!k||"_id"!==b))switch(typeof l[t]){case "string":c[b]="";break;case "object":case "function":c[b]=null;break;case "undefined":c[b]=void 0}}}k="";for(b in c)l=d.IDENTIFIER_RE.test(b)?"o."+b+"=":
"o["+d.escapeForJS(b)+"]=",f=c[b],""===f&&(f='""'),k+=l+f+";\n";c=Function("o",k);e.value(a,"__destruct__",c,!0)}c(this)};f._onPreDestroy=null;f._destroyImmediate=function(){this._objFlags&1?cc.errorID(5E3):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),this._objFlags|=1)};f._deserialize=null;cc.isValid=function(a,c){return"object"==typeof a?!(!a||a._objFlags&(c?5:1)):void 0!==a};cc.Object=n.exports=h},{"./CCClass":130,"./js":150}],137:[function(f,n,m){f=f("../platform/js");cc.SAXParser=
function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):(this._isSupportDOMParser=!1,this._parser=null)};cc.SAXParser.prototype={constructor:cc.SAXParser,parse:function(f){return this._parseXML(f)},_parseXML:function(f){var e;return this._isSupportDOMParser?e=this._parser.parseFromString(f,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(f)),e}};cc.PlistParser=function(){cc.SAXParser.call(this)};f.extend(cc.PlistParser,cc.SAXParser);f.mixin(cc.PlistParser.prototype,
{parse:function(f){f=this._parseXML(f).documentElement;if("plist"!==f.tagName)return cc.warnID(5100),{};for(var e=null,d=0,b=f.childNodes.length;d<b&&1!==(e=f.childNodes[d]).nodeType;d++);return this._parseNode(e)},_parseNode:function(f){var e=null,d=f.tagName;if("dict"===d)e=this._parseDict(f);else if("array"===d)e=this._parseArray(f);else if("string"===d)if(1===f.childNodes.length)e=f.firstChild.nodeValue;else for(e="",d=0;d<f.childNodes.length;d++)e+=f.childNodes[d].nodeValue;else"false"===d?e=
!1:"true"===d?e=!0:"real"===d?e=parseFloat(f.firstChild.nodeValue):"integer"===d&&(e=parseInt(f.firstChild.nodeValue,10));return e},_parseArray:function(f){for(var e=[],d=0,b=f.childNodes.length;d<b;d++){var a=f.childNodes[d];1===a.nodeType&&e.push(this._parseNode(a))}return e},_parseDict:function(f){for(var e={},d=null,b=0,a=f.childNodes.length;b<a;b++){var c=f.childNodes[b];1===c.nodeType&&("key"===c.tagName?d=c.firstChild.nodeValue:e[d]=this._parseNode(c))}return e}});cc.saxParser=new cc.SAXParser;
cc.plistParser=new cc.PlistParser;n.exports={saxParser:cc.saxParser,plistParser:cc.plistParser}},{"../platform/js":150}],138:[function(f,n,m){cc.screen={_supportsFullScreen:!1,_onfullscreenchange:null,_onfullscreenerror:null,_preOnFullScreenChange:null,_preOnFullScreenError:null,_preOnTouch:null,_touchEvent:"",_fn:null,_fnMap:["requestFullscreen exitFullscreen fullscreenchange fullscreenEnabled fullscreenElement fullscreenerror".split(" "),"requestFullScreen exitFullScreen fullScreenchange fullScreenEnabled fullScreenElement fullscreenerror".split(" "),
"webkitRequestFullScreen webkitCancelFullScreen webkitfullscreenchange webkitIsFullScreen webkitCurrentFullScreenElement webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozfullscreenchange mozFullScreen mozFullScreenElement mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen MSFullscreenChange msFullscreenEnabled msFullscreenElement msfullscreenerror".split(" ")],init:function(){this._fn={};var f,e,d=this._fnMap;var b=0;for(f=d.length;b<f;b++)if((e=d[b])&&
void 0!==document[e[1]]){b=0;for(f=e.length;b<f;b++)this._fn[d[0][b]]=e[b];break}this._supportsFullScreen=void 0!==this._fn.requestFullscreen;this._touchEvent="ontouchend"in window?"touchend":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&!!(document[this._fn.fullscreenElement]||document[this._fn.webkitFullscreenElement]||document[this._fn.mozFullScreenElement])},requestFullScreen:function(f,e,d){if(f&&"video"===f.tagName.toLowerCase()){if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser&&
0<f.readyState)return void(f.webkitEnterFullscreen&&f.webkitEnterFullscreen());f.setAttribute("x5-video-player-fullscreen","true")}if(this._supportsFullScreen){if(f=f||document.documentElement,e){var b=this._fn.fullscreenchange;this._onfullscreenchange&&document.removeEventListener(b,this._onfullscreenchange);this._onfullscreenchange=e;document.addEventListener(b,e,!1)}d&&(e=this._fn.fullscreenerror,this._onfullscreenerror&&document.removeEventListener(e,this._onfullscreenerror),this._onfullscreenerror=
d,document.addEventListener(e,d,{once:!0}));f[this._fn.requestFullscreen]()}},exitFullScreen:function(f){if(f&&"video"===f.tagName.toLowerCase()){if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser)return void(f.webkitExitFullscreen&&f.webkitExitFullscreen());f.setAttribute("x5-video-player-fullscreen","false")}return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(f,e){f=f||document.body;this._ensureFullScreen(f,e);this.requestFullScreen(f,e)},disableAutoFullScreen:function(f){f=
cc.game.canvas||f;var e=this._touchEvent;this._preOnTouch&&(f.removeEventListener(e,this._preOnTouch),this._preOnTouch=null)},_ensureFullScreen:function(f,e){function d(){b._preOnFullScreenError=null;b._preOnTouch&&a.removeEventListener(g,b._preOnTouch);b._preOnTouch=function(){b._preOnTouch=null;b.requestFullScreen(f,e)};a.addEventListener(g,b._preOnTouch,{once:!0})}var b=this,a=cc.game.canvas||f,c=this._fn.fullscreenerror,g=this._touchEvent;this._preOnFullScreenError&&f.removeEventListener(c,this._preOnFullScreenError);
this._preOnFullScreenError=d;f.addEventListener(c,d,{once:!0})}};cc.screen.init()},{}],139:[function(f,n,m){window._CCSettings&&_CCSettings.platform;var h="undefined"==typeof window?global:window;f=cc&&cc.sys?cc.sys:function(){cc.sys={};var e=cc.sys;if(e.VERSION="2.2.1.6",e.FONT_SCALE=2,e.LANGUAGE_ENGLISH="en",e.LANGUAGE_CHINESE="zh",e.LANGUAGE_FRENCH="fr",e.LANGUAGE_ITALIAN="it",e.LANGUAGE_GERMAN="de",e.LANGUAGE_SPANISH="es",e.LANGUAGE_DUTCH="du",e.LANGUAGE_RUSSIAN="ru",e.LANGUAGE_KOREAN="ko",e.LANGUAGE_JAPANESE=
"ja",e.LANGUAGE_HUNGARIAN="hu",e.LANGUAGE_PORTUGUESE="pt",e.LANGUAGE_ARABIC="ar",e.LANGUAGE_NORWEGIAN="no",e.LANGUAGE_POLISH="pl",e.LANGUAGE_TURKISH="tr",e.LANGUAGE_UKRAINIAN="uk",e.LANGUAGE_ROMANIAN="ro",e.LANGUAGE_BULGARIAN="bg",e.LANGUAGE_UNKNOWN="unknown",e.OS_IOS="iOS",e.OS_ANDROID="Android",e.OS_WINDOWS="Windows",e.OS_MARMALADE="Marmalade",e.OS_LINUX="Linux",e.OS_BADA="Bada",e.OS_BLACKBERRY="Blackberry",e.OS_OSX="OS X",e.OS_WP8="WP8",e.OS_WINRT="WINRT",e.OS_UNKNOWN="Unknown",e.UNKNOWN=-1,e.WIN32=
0,e.LINUX=1,e.MACOS=2,e.ANDROID=3,e.IPHONE=4,e.IPAD=5,e.BLACKBERRY=6,e.NACL=7,e.EMSCRIPTEN=8,e.TIZEN=9,e.WINRT=10,e.WP8=11,e.MOBILE_BROWSER=100,e.DESKTOP_BROWSER=101,e.EDITOR_PAGE=102,e.EDITOR_CORE=103,e.WECHAT_GAME=104,e.QQ_PLAY=105,e.FB_PLAYABLE_ADS=106,e.BAIDU_GAME=107,e.VIVO_GAME=108,e.OPPO_GAME=109,e.HUAWEI_GAME=110,e.XIAOMI_GAME=111,e.JKW_GAME=112,e.ALIPAY_GAME=113,e.WECHAT_GAME_SUB=114,e.BAIDU_GAME_SUB=115,e.BROWSER_TYPE_WECHAT="wechat",e.BROWSER_TYPE_WECHAT_GAME="wechatgame",e.BROWSER_TYPE_WECHAT_GAME_SUB=
"wechatgamesub",e.BROWSER_TYPE_BAIDU_GAME="baidugame",e.BROWSER_TYPE_BAIDU_GAME_SUB="baidugamesub",e.BROWSER_TYPE_XIAOMI_GAME="xiaomigame",e.BROWSER_TYPE_ALIPAY_GAME="alipaygame",e.BROWSER_TYPE_QQ_PLAY="qqplay",e.BROWSER_TYPE_ANDROID="androidbrowser",e.BROWSER_TYPE_IE="ie",e.BROWSER_TYPE_EDGE="edge",e.BROWSER_TYPE_QQ="qqbrowser",e.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",e.BROWSER_TYPE_UC="ucbrowser",e.BROWSER_TYPE_UCBS="ucbs",e.BROWSER_TYPE_360="360browser",e.BROWSER_TYPE_BAIDU_APP="baiduboxapp",e.BROWSER_TYPE_BAIDU=
"baidubrowser",e.BROWSER_TYPE_MAXTHON="maxthon",e.BROWSER_TYPE_OPERA="opera",e.BROWSER_TYPE_OUPENG="oupeng",e.BROWSER_TYPE_MIUI="miuibrowser",e.BROWSER_TYPE_FIREFOX="firefox",e.BROWSER_TYPE_SAFARI="safari",e.BROWSER_TYPE_CHROME="chrome",e.BROWSER_TYPE_LIEBAO="liebao",e.BROWSER_TYPE_QZONE="qzone",e.BROWSER_TYPE_SOUGOU="sogou",e.BROWSER_TYPE_UNKNOWN="unknown",e.isNative=!1,e.isBrowser="object"==typeof window&&"object"==typeof document&&!0,e.glExtension=function(a){return!!cc.renderer.device.ext(a)},
e.getMaxJointMatrixSize=function(){if(!e._maxJointMatrixSize){var a=cc.game._renderContext;a=Math.floor(a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS)/4)-10;e._maxJointMatrixSize=50>a?0:50}return e._maxJointMatrixSize},h.__globalAdapter&&h.__globalAdapter.adaptSys)h.__globalAdapter.adaptSys(e);else{var d=window,b=d.navigator,a=document,c=a.documentElement,g=b.userAgent.toLowerCase();e.isMobile=/mobile|android|iphone|ipad/.test(g);"undefined"!=typeof FbPlayableAd?e.platform=e.FB_PLAYABLE_ADS:e.platform=
e.isMobile?e.MOBILE_BROWSER:e.DESKTOP_BROWSER;var k=b.language;k=k||b.browserLanguage;e.languageCode=k.toLowerCase();k=k?k.split("-")[0]:e.LANGUAGE_ENGLISH;e.language=k;var l=!1;k=!1;var f="",r=0,t=/android (\d+(?:\.\d+)*)/i.exec(g)||/android (\d+(?:\.\d+)*)/i.exec(b.platform);t&&(l=!0,f=t[1]||"",r=parseInt(f)||0);(t=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(g))?(k=!0,f=t[2]||"",r=parseInt(f)||0):(/(iPhone|iPad|iPod)/.exec(b.platform)||"MacIntel"===b.platform&&b.maxTouchPoints&&1<b.maxTouchPoints)&&
(k=!0,f="",r=0);t=e.OS_UNKNOWN;-1!==b.appVersion.indexOf("Win")?t=e.OS_WINDOWS:k?t=e.OS_IOS:-1!==b.appVersion.indexOf("Mac")?t=e.OS_OSX:-1!==b.appVersion.indexOf("X11")&&-1===b.appVersion.indexOf("Linux")?t=e.OS_UNIX:l?t=e.OS_ANDROID:-1===b.appVersion.indexOf("Linux")&&-1===g.indexOf("ubuntu")||(t=e.OS_LINUX);e.os=t;e.osVersion=f;e.osMainVersion=r;e.browserType=e.BROWSER_TYPE_UNKNOWN;(function(){var a=/mqqbrowser|micromessenger|qq|sogou|qzone|liebao|maxthon|ucbs|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(g)||
/qqbrowser|ucbrowser|ubrowser|edge/i.exec(g)||/chrome|safari|firefox|trident|opera|opr\/|oupeng/i.exec(g);a=a?a[0].toLowerCase():e.BROWSER_TYPE_UNKNOWN;"safari"===a&&l?a=e.BROWSER_TYPE_ANDROID:"qq"===a&&g.match(/android.*applewebkit/i)&&(a=e.BROWSER_TYPE_ANDROID);e.browserType={micromessenger:e.BROWSER_TYPE_WECHAT,trident:e.BROWSER_TYPE_IE,edge:e.BROWSER_TYPE_EDGE,"360 aphone":e.BROWSER_TYPE_360,mxbrowser:e.BROWSER_TYPE_MAXTHON,"opr/":e.BROWSER_TYPE_OPERA,ubrowser:e.BROWSER_TYPE_UC}[a]||a})();e.browserVersion=
"";(function(){var a=g.match(/(mqqbrowser|micromessenger|qq|sogou|qzone|liebao|maxthon|uc|ucbs|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui(?:.hybrid)?)(mobile)?(browser)?\/?([\d.]+)/i);a||(a=g.match(/(qqbrowser|chrome|safari|firefox|trident|opera|opr\/|oupeng)(mobile)?(browser)?\/?([\d.]+)/i));e.browserVersion=a?a[4]:""})();k=window.devicePixelRatio||1;e.windowPixelResolution={width:k*(window.innerWidth||document.documentElement.clientWidth),height:k*(window.innerHeight||document.documentElement.clientHeight)};
e._checkWebGLRenderMode=function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_WEBGL)throw Error("This feature supports WebGL render mode only.");};k=document.createElement("canvas");try{var p=e.localStorage=d.localStorage;p.setItem("storage","");p.removeItem("storage");p=null}catch(E){p=function(){cc.warnID(5200)},e.localStorage={getItem:p,setItem:p,removeItem:p,clear:p}}p=k.toDataURL("image/webp").startsWith("data:image/webp");k=!!k.getContext("2d");f=!1;d.WebGLRenderingContext&&(f=!0);p=e.capabilities=
{canvas:k,opengl:f,webp:p};(void 0!==c.ontouchstart||void 0!==a.ontouchstart||b.msPointerEnabled)&&(p.touches=!0);void 0!==c.onmouseup&&(p.mouse=!0);void 0!==c.onkeyup&&(p.keyboard=!0);(d.DeviceMotionEvent||d.DeviceOrientationEvent)&&(p.accelerometer=!0);e.browserVersion;var v={ONLY_ONE:!1,WEB_AUDIO:!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),DELAY_CREATE_CTX:!1};e.os===e.OS_IOS&&(v.USE_LOADER_EVENT="loadedmetadata");e.browserType===e.BROWSER_TYPE_FIREFOX&&(v.DELAY_CREATE_CTX=
!0,v.USE_LOADER_EVENT="canplay");e.os===e.OS_ANDROID&&e.browserType===e.BROWSER_TYPE_UC&&(v.ONE_SOURCE=!0);try{v.WEB_AUDIO&&(v.context=new (window.AudioContext||window.webkitAudioContext||window.mozAudioContext),v.DELAY_CREATE_CTX&&setTimeout(function(){v.context=new (window.AudioContext||window.webkitAudioContext||window.mozAudioContext)},0))}catch(E){v.WEB_AUDIO=!1,cc.logID(5201)}var w=[];(function(){var a=document.createElement("audio");a.canPlayType&&(a.canPlayType('audio/ogg; codecs="vorbis"')&&
w.push(".ogg"),a.canPlayType("audio/mpeg")&&w.push(".mp3"),a.canPlayType('audio/wav; codecs="1"')&&w.push(".wav"),a.canPlayType("audio/mp4")&&w.push(".mp4"),a.canPlayType("audio/x-m4a")&&w.push(".m4a"))})();v.format=w;e.__audioSupport=v}return e.NetworkType={NONE:0,LAN:1,WWAN:2},e.getNetworkType=function(){return e.NetworkType.LAN},e.getBatteryLevel=function(){return 1},e.garbageCollect=function(){},e.restartVM=function(){},e.getSafeAreaRect=function(){var a=cc.view.getVisibleSize();return cc.rect(0,
0,a.width,a.height)},e.isObjectValid=function(a){return!!a},e.dump=function(){var a="ver : "+this.VERSION;a+="isMobile : "+this.isMobile+"\r\n";a+="language : "+this.language+"\r\n";a+="browserType : "+this.browserType+"\r\n";a+="browserVersion : "+this.browserVersion+"\r\n";a+="capabilities : "+JSON.stringify(this.capabilities)+"\r\n";a+="os : "+this.os+"\r\n";a+="osVersion : "+this.osVersion+"\r\n";a+="platform : "+this.platform+"\r\n";a+="Using "+(cc.game.renderType===cc.game.RENDER_TYPE_WEBGL?
"WEBGL":"CANVAS")+" renderer.\r\n";cc.log(a)},e.openURL=function(a){window.open(a)},e.now=function(){return Date.now?Date.now():+new Date},e}();n.exports=f},{}],140:[function(f,n,m){var h=f("../event/event-target");m=f("../platform/js");var e=f("../renderer");f("../platform/CCClass");var d={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(a){return a&&a!==this.html?a.clientWidth:window.innerWidth},availHeight:function(a){return a&&a!==this.html?a.clientHeight:
window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(cc.sys.os===cc.sys.OS_IOS&&(d.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),d.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:d.meta["minimal-ui"]="true";case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:d.availWidth=function(a){return a.clientWidth},d.availHeight=function(a){return a.clientHeight}}var b=null,a=function(){h.call(this);var a=cc.ContainerStrategy,b=cc.ContentStrategy;d.init(this);this._frameSize=
cc.size(0,0);this._designResolutionSize=cc.size(0,0);this._originalDesignResolutionSize=cc.size(0,0);this._scaleY=this._scaleX=1;this._viewportRect=cc.rect(0,0,0,0);this._visibleRect=cc.rect(0,0,0,0);this._autoFullScreen=!1;this._devicePixelRatio=1;this._maxPixelRatio=2;this._retinaEnabled=!1;this._resizeCallback=null;this._resizeWithBrowserSize=this._resizing=!1;this._orientationChanging=!0;this._isRotated=!1;this._orientation=cc.macro.ORIENTATION_AUTO;this._isAdjustViewport=!0;this._antiAliasEnabled=
!1;this._resolutionPolicy=null;this._rpExactFit=new cc.ResolutionPolicy(a.EQUAL_TO_FRAME,b.EXACT_FIT);this._rpShowAll=new cc.ResolutionPolicy(a.EQUAL_TO_FRAME,b.SHOW_ALL);this._rpNoBorder=new cc.ResolutionPolicy(a.EQUAL_TO_FRAME,b.NO_BORDER);this._rpFixedHeight=new cc.ResolutionPolicy(a.EQUAL_TO_FRAME,b.FIXED_HEIGHT);this._rpFixedWidth=new cc.ResolutionPolicy(a.EQUAL_TO_FRAME,b.FIXED_WIDTH);cc.game.once(cc.game.EVENT_ENGINE_INITED,this.init,this)};cc.js.extend(a,h);cc.js.mixin(a.prototype,{init:function(){this._initFrameSize();
this.enableAntiAlias(!0);var a=cc.game.canvas.width,b=cc.game.canvas.height;this._designResolutionSize.width=a;this._designResolutionSize.height=b;this._originalDesignResolutionSize.width=a;this._originalDesignResolutionSize.height=b;this._viewportRect.width=a;this._viewportRect.height=b;this._visibleRect.width=a;this._visibleRect.height=b;cc.winSize.width=this._visibleRect.width;cc.winSize.height=this._visibleRect.height;cc.visibleRect&&cc.visibleRect.init(this._visibleRect)},_resizeEvent:function(a){var c,
b=(c=this.setDesignResolutionSize?this:cc.view)._frameSize.width,d=c._frameSize.height,e=c._isRotated;if(cc.sys.isMobile){var f=cc.game.container.style,t=f.margin;f.margin="0";f.display="none";c._initFrameSize();f.margin=t;f.display="block"}else c._initFrameSize();if(!0===a||c._isRotated!==e||c._frameSize.width!==b||c._frameSize.height!==d)a=c._originalDesignResolutionSize.width,b=c._originalDesignResolutionSize.height,c._resizing=!0,0<a&&c.setDesignResolutionSize(a,b,c._resolutionPolicy),c._resizing=
!1,c.emit("canvas-resize"),c._resizeCallback&&c._resizeCallback.call()},_orientationChange:function(){cc.view._orientationChanging=!0;cc.view._resizeEvent()},resizeWithBrowserSize:function(a){a?this._resizeWithBrowserSize||(this._resizeWithBrowserSize=!0,window.addEventListener("resize",this._resizeEvent),window.addEventListener("orientationchange",this._orientationChange)):this._resizeWithBrowserSize&&(this._resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",
this._orientationChange))},setResizeCallback:function(a){"function"!=typeof a&&null!=a||(this._resizeCallback=a)},setOrientation:function(a){(a&=cc.macro.ORIENTATION_AUTO)&&this._orientation!==a&&(this._orientation=a,this.setDesignResolutionSize(this._originalDesignResolutionSize.width,this._originalDesignResolutionSize.height,this._resolutionPolicy))},_initFrameSize:function(){var a=this._frameSize,b=d.availWidth(cc.game.frame),k=d.availHeight(cc.game.frame),l=b>=k;!cc.sys.isMobile||l&&this._orientation&
cc.macro.ORIENTATION_LANDSCAPE||!l&&this._orientation&cc.macro.ORIENTATION_PORTRAIT?(a.width=b,a.height=k,cc.game.container.style["-webkit-transform"]="rotate(0deg)",cc.game.container.style.transform="rotate(0deg)",this._isRotated=!1):(a.width=k,a.height=b,cc.game.container.style["-webkit-transform"]="rotate(90deg)",cc.game.container.style.transform="rotate(90deg)",cc.game.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.game.container.style.transformOrigin="0px 0px 0px",this._isRotated=
!0);this._orientationChanging&&setTimeout(function(){cc.view._orientationChanging=!1},1E3)},_setViewportMeta:function(a,b){var c=document.getElementById("cocosMetaElement");c&&b&&document.head.removeChild(c);var d,g,e,f=(d=document.getElementsByName("viewport"))?d[0]:null;for(g in d=f?f.content:"",(c=c||document.createElement("meta")).id="cocosMetaElement",c.name="viewport",c.content="",a)-1==d.indexOf(g)?d+=","+g+"="+a[g]:b&&(e=new RegExp(g+"s*=s*[^,]+"),d.replace(e,g+"="+a[g]));/^,/.test(d)&&(d=
d.substr(1));c.content=d;f&&(f.content=d);document.head.appendChild(c)},_adjustViewportMeta:function(){this._isAdjustViewport&&(this._setViewportMeta(d.meta,!1),this._isAdjustViewport=!1)},adjustViewportMeta:function(a){this._isAdjustViewport=a},enableRetina:function(a){this._retinaEnabled=!!a},isRetinaEnabled:function(){return this._retinaEnabled},enableAntiAlias:function(a){if(this._antiAliasEnabled!==a)if(this._antiAliasEnabled=a,cc.game.renderType===cc.game.RENDER_TYPE_WEBGL){var c=cc.loader._cache,
b;for(b in c){var d=c[b];if(d=d&&d.content instanceof cc.Texture2D?d.content:null){var e=cc.Texture2D.Filter;a?d.setFilters(e.LINEAR,e.LINEAR):d.setFilters(e.NEAREST,e.NEAREST)}}}else cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&(c=cc.game.canvas.getContext("2d"),c.imageSmoothingEnabled=a,c.mozImageSmoothingEnabled=a)},isAntiAliasEnabled:function(){return this._antiAliasEnabled},enableAutoFullScreen:function(a){a&&a!==this._autoFullScreen&&cc.sys.isMobile?(this._autoFullScreen=!0,cc.screen.autoFullScreen(cc.game.frame)):
(this._autoFullScreen=!1,cc.screen.disableAutoFullScreen(cc.game.frame))},isAutoFullScreenEnabled:function(){return this._autoFullScreen},setCanvasSize:function(a,b){var c=cc.game.canvas,d=cc.game.container;c.width=a*this._devicePixelRatio;c.height=b*this._devicePixelRatio;c.style.width=a+"px";c.style.height=b+"px";d.style.width=a+"px";d.style.height=b+"px";this._resizeEvent()},getCanvasSize:function(){return cc.size(cc.game.canvas.width,cc.game.canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,
this._frameSize.height)},setFrameSize:function(a,b){this._frameSize.width=a;this._frameSize.height=b;cc.game.frame.style.width=a+"px";cc.game.frame.style.height=b+"px";this._resizeEvent(!0)},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.v2(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.v2(this._visibleRect.x*
this._scaleX,this._visibleRect.y*this._scaleY)},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(a){if(a instanceof cc.ResolutionPolicy)this._resolutionPolicy=a;else{var c=cc.ResolutionPolicy;a===c.EXACT_FIT&&(this._resolutionPolicy=this._rpExactFit);a===c.SHOW_ALL&&(this._resolutionPolicy=this._rpShowAll);a===c.NO_BORDER&&(this._resolutionPolicy=this._rpNoBorder);a===c.FIXED_HEIGHT&&(this._resolutionPolicy=this._rpFixedHeight);a===c.FIXED_WIDTH&&(this._resolutionPolicy=
this._rpFixedWidth)}},setDesignResolutionSize:function(a,b,d){if(0<a||0<b)if(this.setResolutionPolicy(d),d=this._resolutionPolicy,d&&d.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._orientationChanging=!0,this._resizing||this._initFrameSize(),d){this._originalDesignResolutionSize.width=this._designResolutionSize.width=a;this._originalDesignResolutionSize.height=this._designResolutionSize.height=b;var c=d.apply(this,this._designResolutionSize);if(c.scale&&2===c.scale.length&&(this._scaleX=
c.scale[0],this._scaleY=c.scale[1]),c.viewport)a=this._viewportRect,b=this._visibleRect,c=c.viewport,a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height,b.x=0,b.y=0,b.width=c.width/this._scaleX,b.height=c.height/this._scaleY;d.postApply(this);cc.winSize.width=this._visibleRect.width;cc.winSize.height=this._visibleRect.height;cc.visibleRect&&cc.visibleRect.init(this._visibleRect);e.updateCameraViewport();_cc.inputManager._updateCanvasBoundingRect();this.emit("design-resolution-changed")}else cc.logID(2201);
else cc.logID(2200)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(a,b,d){this._setViewportMeta({width:a},!0);document.documentElement.style.width=a+"px";document.body.style.width=a+"px";document.body.style.left="0px";document.body.style.top="0px";this.setDesignResolutionSize(a,b,d)},setViewportInPoints:function(a,b,d,e){var c=this._scaleX,g=this._scaleY;cc.game._renderContext.viewport(a*c+this._viewportRect.x,
b*g+this._viewportRect.y,d*c,e*g)},setScissorInPoints:function(a,d,k,e){var c=this._scaleX,g=this._scaleY;a=Math.ceil(a*c+this._viewportRect.x);d=Math.ceil(d*g+this._viewportRect.y);k=Math.ceil(k*c);e=Math.ceil(e*g);g=cc.game._renderContext;b||(c=g.getParameter(g.SCISSOR_BOX),b=cc.rect(c[0],c[1],c[2],c[3]));b.x===a&&b.y===d&&b.width===k&&b.height===e||(b.x=a,b.y=d,b.width=k,b.height=e,g.scissor(a,d,k,e))},isScissorEnabled:function(){return cc.game._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){if(!b){var a=
gl.getParameter(gl.SCISSOR_BOX);b=cc.rect(a[0],a[1],a[2],a[3])}a=1/this._scaleX;var d=1/this._scaleY;return cc.rect((b.x-this._viewportRect.x)*a,(b.y-this._viewportRect.y)*d,b.width*a,b.height*d)},getViewportRect:function(){return this._viewportRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(a,b,d,e){e=e||cc.v2();a=this._devicePixelRatio*(a-(d.adjustedLeft?d.adjustedLeft:
d.left));b=this._devicePixelRatio*((d.adjustedTop?d.adjustedTop:d.top)+d.height-b);return this._isRotated?(e.x=cc.game.canvas.width-b,e.y=a):(e.x=a,e.y=b),e},_convertMouseToLocationInView:function(a,b){var c=this._viewportRect;a.x=(this._devicePixelRatio*(a.x-b.left)-c.x)/this._scaleX;a.y=(this._devicePixelRatio*(b.top+b.height-a.y)-c.y)/this._scaleY},_convertPointWithScale:function(a){var c=this._viewportRect;a.x=(a.x-c.x)/this._scaleX;a.y=(a.y-c.y)/this._scaleY},_convertTouchesWithScale:function(a){for(var c,
b,d=this._viewportRect,e=this._scaleX,f=this._scaleY,t=0;t<a.length;t++)b=(c=a[t])._point,c=c._prevPoint,b.x=(b.x-d.x)/e,b.y=(b.y-d.y)/f,c.x=(c.x-d.x)/e,c.y=(c.y-d.y)/f}});cc.ContainerStrategy=cc.Class({name:"ContainerStrategy",preApply:function(a){},apply:function(a,b){},postApply:function(a){},_setupContainer:function(a,b,d){var c=cc.game.canvas;this._setupStyle(a,b,d);var g=a._devicePixelRatio=1;a.isRetinaEnabled()&&(g=a._devicePixelRatio=Math.min(a._maxPixelRatio,window.devicePixelRatio||1));
c.width=b*g;c.height=d*g},_setupStyle:function(a,b,d){var c=cc.game.canvas,g=cc.game.container;cc.sys.os===cc.sys.OS_ANDROID&&(document.body.style.width=(a._isRotated?d:b)+"px",document.body.style.height=(a._isRotated?b:d)+"px");g.style.width=c.style.width=b+"px";g.style.height=c.style.height=d+"px"},_fixContainer:function(){document.body.insertBefore(cc.game.container,document.body.firstChild);var a=document.body.style;a.width=window.innerWidth+"px";a.height=window.innerHeight+"px";a.overflow="hidden";
a=cc.game.container.style;a.position="fixed";a.left=a.top="0px";document.body.scrollTop=0}});cc.ContentStrategy=cc.Class({name:"ContentStrategy",ctor:function(){this._result={scale:[1,1],viewport:null}},_buildResult:function(a,b,d,e,f,r){2>Math.abs(a-d)&&(d=a);2>Math.abs(b-e)&&(e=b);a=cc.rect((a-d)/2,(b-e)/2,d,e);return cc.game.renderType,cc.game.RENDER_TYPE_CANVAS,this._result.scale=[f,r],this._result.viewport=a,this._result},preApply:function(a){},apply:function(a,b){return{scale:[1,1]}},postApply:function(a){}});
(function(){var c=cc.Class({name:"EqualToFrame",extends:cc.ContainerStrategy,apply:function(a){var c=a._frameSize.height,b=cc.game.container.style;this._setupContainer(a,a._frameSize.width,a._frameSize.height);a._isRotated?b.margin="0 0 0 "+c+"px":b.margin="0px";b.padding="0px"}}),b=cc.Class({name:"ProportionalToFrame",extends:cc.ContainerStrategy,apply:function(a,c){var b,d,g=a._frameSize.width,k=a._frameSize.height,e=cc.game.container.style,l=c.width;c=c.height;var f=g/l,q=k/c;f<q?(b=g,d=c*f):(b=
l*q,d=k);b=Math.round((g-b)/2);d=Math.round((k-d)/2);this._setupContainer(a,g-2*b,k-2*d);a._isRotated?e.margin="0 0 0 "+k+"px":e.margin="0px";e.paddingLeft=b+"px";e.paddingRight=b+"px";e.paddingTop=d+"px";e.paddingBottom=d+"px"}}),d=(cc.Class({name:"EqualToWindow",extends:c,preApply:function(a){this._super(a);cc.game.frame=document.documentElement},apply:function(a){this._super(a);this._fixContainer()}}),cc.Class({name:"ProportionalToWindow",extends:b,preApply:function(a){this._super(a);cc.game.frame=
document.documentElement},apply:function(a,c){this._super(a,c);this._fixContainer()}}),cc.Class({name:"OriginalContainer",extends:cc.ContainerStrategy,apply:function(a){this._setupContainer(a,cc.game.canvas.width,cc.game.canvas.height)}})),e=("undefined"==typeof window?global:window).__globalAdapter;e&&(e.adaptContainerStrategy&&e.adaptContainerStrategy(cc.ContainerStrategy.prototype),e.adaptView&&e.adaptView(a.prototype));cc.ContainerStrategy.EQUAL_TO_FRAME=new c;cc.ContainerStrategy.PROPORTION_TO_FRAME=
new b;cc.ContainerStrategy.ORIGINAL_CONTAINER=new d;c=cc.Class({name:"ExactFit",extends:cc.ContentStrategy,apply:function(a,c){a=cc.game.canvas.width;var b=cc.game.canvas.height;return this._buildResult(a,b,a,b,a/c.width,b/c.height)}});b=cc.Class({name:"ShowAll",extends:cc.ContentStrategy,apply:function(a,c){var b,d;a=cc.game.canvas.width;var g=cc.game.canvas.height,k=c.width;c=c.height;var e=a/k,l=g/c,f=0;return e<l?(b=a,d=c*(f=e)):(b=k*(f=l),d=g),this._buildResult(a,g,b,d,f,f)}});d=cc.Class({name:"NoBorder",
extends:cc.ContentStrategy,apply:function(a,c){var b,d,g;a=cc.game.canvas.width;var k=cc.game.canvas.height,e=c.width;c=c.height;var l=a/e,f=k/c;return l<f?(d=e*(b=f),g=k):(d=a,g=c*(b=l)),this._buildResult(a,k,d,g,b,b)}});e=cc.Class({name:"FixedHeight",extends:cc.ContentStrategy,apply:function(a,c){a=cc.game.canvas.width;var b=cc.game.canvas.height;c=b/c.height;return this._buildResult(a,b,a,b,c,c)}});var f=cc.Class({name:"FixedWidth",extends:cc.ContentStrategy,apply:function(a,c){a=cc.game.canvas.width;
var b=cc.game.canvas.height;c=a/c.width;return this._buildResult(a,b,a,b,c,c)}});cc.ContentStrategy.EXACT_FIT=new c;cc.ContentStrategy.SHOW_ALL=new b;cc.ContentStrategy.NO_BORDER=new d;cc.ContentStrategy.FIXED_HEIGHT=new e;cc.ContentStrategy.FIXED_WIDTH=new f})();cc.ResolutionPolicy=cc.Class({name:"cc.ResolutionPolicy",ctor:function(a,b){this._contentStrategy=this._containerStrategy=null;this.setContainerStrategy(a);this.setContentStrategy(b)},preApply:function(a){this._containerStrategy.preApply(a);
this._contentStrategy.preApply(a)},apply:function(a,b){return this._containerStrategy.apply(a,b),this._contentStrategy.apply(a,b)},postApply:function(a){this._containerStrategy.postApply(a);this._contentStrategy.postApply(a)},setContainerStrategy:function(a){a instanceof cc.ContainerStrategy&&(this._containerStrategy=a)},setContentStrategy:function(a){a instanceof cc.ContentStrategy&&(this._contentStrategy=a)}});m.get(cc.ResolutionPolicy.prototype,"canvasSize",function(){return cc.v2(cc.game.canvas.width,
cc.game.canvas.height)});cc.ResolutionPolicy.EXACT_FIT=0;cc.ResolutionPolicy.NO_BORDER=1;cc.ResolutionPolicy.SHOW_ALL=2;cc.ResolutionPolicy.FIXED_HEIGHT=3;cc.ResolutionPolicy.FIXED_WIDTH=4;cc.ResolutionPolicy.UNKNOWN=5;cc.view=new a;cc.winSize=cc.size();n.exports=cc.view},{"../event/event-target":99,"../platform/CCClass":130,"../platform/js":150,"../renderer":178}],141:[function(f,n,m){cc.visibleRect={topLeft:cc.v2(0,0),topRight:cc.v2(0,0),top:cc.v2(0,0),bottomLeft:cc.v2(0,0),bottomRight:cc.v2(0,
0),bottom:cc.v2(0,0),center:cc.v2(0,0),left:cc.v2(0,0),right:cc.v2(0,0),width:0,height:0,init:function(f){var e=this.width=f.width,d=this.height=f.height,b=f.x;f=f.y;var a=f+d,c=b+e;this.topLeft.x=b;this.topLeft.y=a;this.topRight.x=c;this.topRight.y=a;this.top.x=b+e/2;this.top.y=a;this.bottomLeft.x=b;this.bottomLeft.y=f;this.bottomRight.x=c;this.bottomRight.y=f;this.bottom.x=b+e/2;this.bottom.y=f;this.center.x=b+e/2;this.center.y=f+d/2;this.left.x=b;this.left.y=f+d/2;this.right.x=c;this.right.y=f+
d/2}}},{}],142:[function(f,n,m){function h(a,d){d=d?Object.create(d):{};return b.value(a,"__attrs__",d),d}function e(a){var c;if(!(c=a.hasOwnProperty("__attrs__")&&a.__attrs__))if("function"!=typeof a)c=h(a,e(a.constructor));else{var b;c=cc.Class.getInheritanceChain(a);for(var d=c.length-1;0<=d;d--){var f=c[d];f.hasOwnProperty("__attrs__")&&f.__attrs__||h(f,(b=c[d+1])&&b.__attrs__)}c=(h(a,(b=c[0])&&b.__attrs__),a.__attrs__)}return c}function d(a,b){this.name=a;this.default=b}var b=f("./js"),a=(f("./utils").isPlainEmptyObj_DEV,
"$_$");d.prototype.toString=function(){return this.name};cc.Integer=new d("Integer",0);cc.Float=new d("Float",0);cc.Boolean=new d("Boolean",!1);cc.String=new d("String","");n.exports={PrimitiveType:d,attr:function(c,b,d){c=e(c);b+=a;d={};for(var g in c)g.startsWith(b)&&(d[g.slice(b.length)]=c[g]);return d},getClassAttrs:e,setClassAttr:function(c,b,d,l){e(c)[b+a+d]=l},DELIMETER:a,getTypeChecker_ET:!1,getObjTypeChecker_ET:!1,ScriptUuid:{}}},{"./CCClass":130,"./js":150,"./utils":154}],143:[function(f,
n,m){function h(){}function e(){this.callback=h;this.target=void 0;this.once=!1}function d(){this.callbackInfos=[];this.containCanceled=this.isInvoking=!1}function b(){this._callbackTable=a.createMap(!0)}var a=f("./js"),c=a.array.fastRemoveAt;e.prototype.set=function(a,c,b){this.callback=a;this.target=c;this.once=!!b};var g=new a.Pool(function(a){return a.callback=h,a.target=void 0,a.once=!1,!0},32);g.get=function(){return this._get()||new e};f=d.prototype;f.removeByCallback=function(a){for(var b=
0;b<this.callbackInfos.length;++b){var d=this.callbackInfos[b];d&&d.callback===a&&(g.put(d),c(this.callbackInfos,b),--b)}};f.removeByTarget=function(a){for(var b=0;b<this.callbackInfos.length;++b){var d=this.callbackInfos[b];d&&d.target===a&&(g.put(d),c(this.callbackInfos,b),--b)}};f.cancel=function(a){var c=this.callbackInfos[a];c&&(g.put(c),this.callbackInfos[a]=null);this.containCanceled=!0};f.cancelAll=function(){for(var a=0;a<this.callbackInfos.length;a++){var c=this.callbackInfos[a];c&&(g.put(c),
this.callbackInfos[a]=null)}this.containCanceled=!0};f.purgeCanceled=function(){for(var a=this.callbackInfos.length-1;0<=a;--a)this.callbackInfos[a]||c(this.callbackInfos,a);this.containCanceled=!1};f.clear=function(){this.cancelAll();this.callbackInfos.length=0;this.containCanceled=this.isInvoking=!1};var k=new a.Pool(function(a){return a.callback=h,a.target=void 0,a.once=!1,!0},16);k.get=function(){return this._get()||new d};(f=b.prototype).on=function(a,c,b,d){var e=this._callbackTable[a];e||(e=
this._callbackTable[a]=k.get());a=g.get();a.set(c,b,d);e.callbackInfos.push(a)};f.hasEventListener=function(a,c,b){var d=this._callbackTable[a];if(!d)return!1;a=d.callbackInfos;if(!c){if(d.isInvoking){for(c=0;c<a.length;++c)if(a[c])return!0;return!1}return 0<a.length}for(d=0;d<a.length;++d){var g=a[d];if(g&&g.callback===c&&g.target===b)return!0}return!1};f.removeAll=function(a){if("string"==typeof a){var c=this._callbackTable[a];c&&(c.isInvoking?c.cancelAll():(c.clear(),k.put(c),delete this._callbackTable[a]))}else if(a)for(c in this._callbackTable){var b=
this._callbackTable[c];if(b.isInvoking)for(var d=b.callbackInfos,g=0;g<d.length;++g){var e=d[g];e&&e.target===a&&b.cancel(g)}else b.removeByTarget(a)}};f.off=function(a,b,d){if(a=this._callbackTable[a])for(var k=a.callbackInfos,e=0;e<k.length;++e){var l=k[e];if(l&&l.callback===b&&l.target===d){a.isInvoking?a.cancel(e):(c(k,e),g.put(l));break}}};f.emit=function(a,c,b,d,g,k){var e=this._callbackTable[a];if(e){var l=!e.isInvoking;e.isInvoking=!0;for(var f=e.callbackInfos,p=0,q=f.length;p<q;++p){var r=
f[p];if(r){var v=r.target,t=r.callback;r.once&&this.off(a,t,v);v?t.call(v,c,b,d,g,k):t(c,b,d,g,k)}}l&&(e.isInvoking=!1,e.containCanceled&&e.purgeCanceled())}};n.exports=b},{"./js":150}],144:[function(f,n,m){function h(e,d){for(var b=0;b<d.length;b++){var a=d[b];Array.isArray(a)?h(e,a):e.push(a)}}n.exports={flattenCodeArray:function(e){var d=[];return h(d,e),d.join("")}}},{}],145:[function(f,n,m){var h=f("./js"),e=f("./attribute"),d=f("./CCClass"),b=f("../utils/misc"),a=function(){this.uuidList=[];
this.uuidObjList=[];this.uuidPropList=[];this._stillUseUrl=h.createMap(!0)};a.prototype.reset=function(){this.uuidList.length=0;this.uuidObjList.length=0;this.uuidPropList.length=0;h.clear(this._stillUseUrl)};a.prototype.push=function(a,c,b,d){d&&(this._stillUseUrl[this.uuidList.length]=!0);this.uuidList.push(b);this.uuidObjList.push(a);this.uuidPropList.push(c)};(a.pool=new h.Pool(function(a){a.reset()},10)).get=function(){return this._get()||new a};var c=function(){function a(a,c,b,d,g){this.result=
a;this.customEnv=d;this.deserializedList=[];this.deserializedData=null;this._classFinder=b;this._idList=[];this._idObjList=[];this._idPropList=[]}function c(a,c,b,d,g,k){c instanceof cc.ValueType?(g||a.push("if(prop){"),c=h.getClassName(c),a.push("s._deserializeTypedObject(o"+b+",prop,"+c+");"),g||a.push("}else o"+b+"=null;")):(a.push("if(prop){"),a.push("s._deserializeObjField(o,prop,"+d+",null,"+!!k+");"),a.push("}else o"+b+"=null;"))}var l=a.prototype;l.deserialize=function(a){if(Array.isArray(a)){var c=
a.length;this.deserializedList.length=c;for(var b=0;b<c;b++)a[b]&&(this.deserializedList[b]=this._deserializeObject(a[b],!1));this.deserializedData=0<c?this.deserializedList[0]:[]}else this.deserializedList.length=1,this.deserializedData=a?this._deserializeObject(a,!1):null,this.deserializedList[0]=this.deserializedData;var d=this.deserializedList,g=this._idPropList,k=this._idList,e=this._idObjList;this._classFinder&&this._classFinder.onDereferenced;for(a=0;a<k.length;a++)c=g[a],b=k[a],e[a][c]=d[b];
return this.deserializedData};l._deserializeObject=function(a,g,k,l,f){var p=a.__type__;if("TypedArray"===p){k=a.array;p=new window[a.ctor](k.length);for(a=0;a<k.length;++a)p[a]=k[a];return p}if(p){if(!(g=this._classFinder(p,a,l,f)))return this._classFinder===h._getClassById&&cc.deserialize.reportMissingClass(p),null;if((p=new g)._deserialize)return p._deserialize(a.content,this),p;if(cc.Class._isCCClass(g)){var q=p;if(g.hasOwnProperty("__deserialize__"))var r=g.__deserialize__;else{l=e.DELIMETER+
"type";f=(e.DELIMETER,e.DELIMETER+"default");for(var v=e.DELIMETER+"saveUrlAsAsset",t=e.DELIMETER+"formerlySerializedAs",B=e.getClassAttrs(g),m=g.__values__,z=["var prop;"],A=b.BUILTIN_CLASSID_RE.test(h._getClassId(g)),D=0;D<m.length;D++){var n,F=m[D];0;d.IDENTIFIER_RE.test(F)?(n='"'+F+'"',r="."+F):r="["+(n=d.escapeForJS(F))+"]";var G=r;B[F+t]&&(G=B[F+t],G=d.IDENTIFIER_RE.test(G)?"."+G:"["+d.escapeForJS(G)+"]");z.push("prop=d"+G+";");z.push('if(typeof prop!=="undefined"){');G=B[F+v];var J=d.getDefault(B[F+
f]);A?(F=B[F+l],void 0===J&&F?F=F instanceof e.PrimitiveType:(F=typeof J,F="string"===F&&!G||"number"===F||"boolean"===F),F?z.push("o"+r+"=prop;"):c(z,J,r,n,!0,G)):(z.push('if(typeof prop!=="object"){o'+r+"=prop;}else{"),c(z,J,r,n,!1,G),z.push("}"));z.push("}")}(cc.js.isChildClassOf(g,cc._BaseNode)||cc.js.isChildClassOf(g,cc.Component))&&z.push("d._id&&(o._id=d._id);");r=("_$erialized"===m[m.length-1]&&(z.push("o._$erialized=JSON.parse(JSON.stringify(d));"),z.push("s._deserializePrimitiveObject(o._$erialized,d);")),
Function("s","o","d","k","t",z.join("")));h.value(g,"__deserialize__",r,!0)}r(this,q,a,g,k)}else this._deserializeTypedObject(p,a,g)}else if(Array.isArray(a))for(p=Array(a.length),k=0;k<a.length;k++)"object"==typeof(q=a[k])&&q?this._deserializeObjField(p,q,""+k,null,g):p[k]=q;else p={},this._deserializePrimitiveObject(p,a);return p};l._deserializeObjField=function(a,c,b,d,g){d=c.__id__;void 0===d?(d=c.__uuid__)?this.result.push(a,b,d,g):a[b]=this._deserializeObject(c,g):(c=this.deserializedList[d])?
a[b]=c:(this._idList.push(d),this._idObjList.push(a),this._idPropList.push(b))};l._deserializePrimitiveObject=function(a,c){for(var b in c)if(c.hasOwnProperty(b)){var d=c[b];"object"!=typeof d?"__type__"!==b&&(a[b]=d):d?this._deserializeObjField(a,d,b):a[b]=null}};l._deserializeTypedObject=function(a,c,b){if(b===cc.Vec2)return a.x=c.x||0,void(a.y=c.y||0);if(b===cc.Vec3)return a.x=c.x||0,a.y=c.y||0,void(a.z=c.z||0);if(b!==cc.Color){if(b===cc.Size)return a.width=c.width||0,void(a.height=c.height||0);
var g=e.DELIMETER+"default",k=e.getClassAttrs(b);b=b.__props__||Object.keys(a);for(var l=0;l<b.length;l++){var f=b[l],q=c[f];void 0!==q&&c.hasOwnProperty(f)||(q=d.getDefault(k[f+g]));"object"!=typeof q?a[f]=q:q?this._deserializeObjField(a,q,f):a[f]=null}}else a.r=c.r||0,a.g=c.g||0,a.b=c.b||0,c=c.a,a.a=void 0===c?255:c};return a.pool=new h.Pool(function(a){a.result=null;a.customEnv=null;a.deserializedList.length=0;a.deserializedData=null;a._classFinder=null;a._idList.length=0;a._idObjList.length=0;
a._idPropList.length=0},1),a.pool.get=function(c,b,d,g,k){var e=this._get();return e?(e.result=c,e.customEnv=g,e._classFinder=d,e):new a(c,b,d,g,k)},a}();cc.deserialize=function(b,d,e){var g=(e=e||{}).classFinder||h._getClassById,k=e.createAssetRefs||cc.sys.platform===cc.sys.EDITOR_CORE,l=e.customEnv,f=e.ignoreEditorOnly;"string"==typeof b&&(b=JSON.parse(b));e=!d;d=d||a.pool.get();g=c.pool.get(d,!1,g,l,f);cc.game._isCloning=!0;b=g.deserialize(b);return cc.game._isCloning=!1,c.pool.put(g),k&&d.assignAssetsBy(Editor.serialize.asAsset),
e&&a.pool.put(d),b};cc.deserialize.Details=a;cc.deserialize.reportMissingClass=function(a){cc.warnID(5302,a)}},{"../utils/misc":220,"./CCClass":130,"./attribute":142,"./js":150}],146:[function(f,n,m){function h(e){this.id=0|998*Math.random();this.prefix=e?e+".":""}h.prototype.getNewId=function(){return this.prefix+ ++this.id};h.global=new h("global");n.exports=h},{}],147:[function(f,n,m){f("./js");f("./CCClass");f("./CCClassDecorator");f("./CCEnum");f("./CCObject");f("./callbacks-invoker");f("./url");
f("./deserialize");f("./instantiate");f("./instantiate-jit");f("./requiring-frame");f("./CCSys");f("./CCMacro");f("./CCAssetLibrary");f("./CCVisibleRect")},{"./CCAssetLibrary":129,"./CCClass":130,"./CCClassDecorator":131,"./CCEnum":132,"./CCMacro":135,"./CCObject":136,"./CCSys":139,"./CCVisibleRect":141,"./callbacks-invoker":143,"./deserialize":145,"./instantiate":149,"./instantiate-jit":148,"./js":150,"./requiring-frame":152,"./url":153}],148:[function(f,n,m){function h(a){if(a===Float32Array)return"Float32Array";
if(a===Float64Array)return"Float64Array";if(a===Int8Array)return"Int8Array";if(a===Int16Array)return"Int16Array";if(a===Int32Array)return"Int32Array";if(a===Uint8Array)return"Uint8Array";if(a===Uint16Array)return"Uint16Array";if(a===Uint32Array)return"Uint32Array";throw Error("Unknown TypedArray could not be instantiated: "+a);}function e(a,c){this.varName=a;this.expression=c}function d(a,c){return c instanceof e?new e(c.varName,a+c.expression):a+c}function b(a,c,b){Array.isArray(b)?(b[0]=d(c,b[0]),
a.push(b)):a.push(d(c,b)+";")}function a(a){this._exps=[];this._targetExp=a}function c(a,c){if("function"==typeof a)try{a=a()}catch(z){return!1}if(a===c)return!0;if(a&&c){if(a instanceof cc.ValueType&&a.equals(c))return!0;if(Array.isArray(a)&&Array.isArray(c)||a.constructor===Object&&c.constructor===Object)try{return Array.isArray(a)&&Array.isArray(c)&&0===a.length&&0===c.length}catch(z){}}return!1}function g(a){return x.test(a)?"."+a:"["+y(a)+"]"}function k(a,c){var b;this.parent=c;this.objsToClear_iN$t=
[];this.codeArray=[];this.objs=[];this.funcs=[];this.funcModuleCache=p.createMap();p.mixin(this.funcModuleCache,u);this.globalVariables=[];this.localVariableId=this.globalVariableId=0;this.codeArray.push("var o,t;","if(R){","o=R;","}else{","o=R=new "+this.getFuncModule(a.constructor,!0)+"();","}");p.value(a,"_iN$t",{globalVar:"R"},!0);this.objsToClear_iN$t.push(a);this.enumerateObject(this.codeArray,a);0<this.globalVariables.length&&(b="var "+this.globalVariables.join(",")+";");a=w.flattenCodeArray(["return (function(R){",
b||[],this.codeArray,"return o;","})"]);this.result=Function("O","F",a)(this.objs,this.funcs);a=0;for(c=this.objsToClear_iN$t.length;a<c;++a)this.objsToClear_iN$t[a]._iN$t=null;this.objsToClear_iN$t.length=0}var l=f("./CCObject"),q=l.Flags.Destroyed,r=l.Flags.PersistentMask,t=f("./attribute"),p=f("./js"),v=f("./CCClass"),w=f("./compiler"),E=t.DELIMETER+"default",x=v.IDENTIFIER_RE,y=v.escapeForJS,u={"cc.Node":"cc.Node","cc.Sprite":"cc.Sprite","cc.Label":"cc.Label","cc.Button":"cc.Button","cc.Widget":"cc.Widget",
"cc.Animation":"cc.Animation","cc.ClickEvent":!1,"cc.PrefabInfo":!1};try{!Float32Array.name&&(Float32Array.name="Float32Array"),!Float64Array.name&&(Float64Array.name="Float64Array"),!Int8Array.name&&(Int8Array.name="Int8Array"),!Int16Array.name&&(Int16Array.name="Int16Array"),!Int32Array.name&&(Int32Array.name="Int32Array"),!Uint8Array.name&&(Uint8Array.name="Uint8Array"),!Uint16Array.name&&(Uint16Array.name="Uint16Array"),!Uint32Array.name&&(Uint32Array.name="Uint32Array")}catch(B){}e.prototype.toString=
function(){return"var "+this.varName+"="+this.expression+";"};a.prototype.append=function(a,c){this._exps.push([a,c])};a.prototype.writeCode=function(a){if(1<this._exps.length){a.push("t="+this._targetExp+";");var c="t"}else{if(1!==this._exps.length)return;c=this._targetExp}for(var d=0;d<this._exps.length;d++){var k=this._exps[d];b(a,c+g(k[0])+"=",k[1])}};a.pool=new p.Pool(function(a){a._exps.length=0;a._targetExp=null},1);a.pool.get=function(c){var b=this._get()||new a;return b._targetExp=c,b};f=
k.prototype;f.getFuncModule=function(a,c){var b=p.getClassName(a);if(b){var d=this.funcModuleCache[b];if(d)return d;if(void 0===d&&-1!==b.indexOf("."))try{if(a===Function("return "+b)())return this.funcModuleCache[b]=b,b}catch(D){}}d=this.funcs.indexOf(a);0>d&&(d=this.funcs.length,this.funcs.push(a));a="F["+d+"]";return c&&(a="("+a+")"),this.funcModuleCache[b]=a,a};f.getObjRef=function(a){var c=this.objs.indexOf(a);return 0>c&&(c=this.objs.length,this.objs.push(a)),"O["+c+"]"};f.setValueType=function(c,
b,d,g){g=a.pool.get(g);var k=b.constructor.__props__;k||(k=Object.keys(b));for(var e=0;e<k.length;e++){var l=k[e],f=d[l];b[l]!==f&&(f=this.enumerateField(d,l,f),g.append(l,f))}g.writeCode(c);a.pool.put(g)};f.enumerateCCClass=function(a,b,d){var k=d.__values__;d=t.getClassAttrs(d);for(var e=0;e<k.length;e++){var l=k[e],f=b[l],p=d[l+E];c(p,f)||("object"==typeof f&&f instanceof cc.ValueType&&(p=v.getDefault(p))&&p.constructor===f.constructor?(l="o"+g(l),this.setValueType(a,p,f,l)):this.setObjProp(a,
b,l,f))}};f.instantiateArray=function(a){if(0===a.length)return"[]";var c="a"+ ++this.localVariableId,d=[new e(c,"new Array("+a.length+")")];p.value(a,"_iN$t",{globalVar:"",source:d},!0);this.objsToClear_iN$t.push(a);for(var g=0;g<a.length;++g)b(d,c+"["+g+"]=",this.enumerateField(a,g,a[g]));return d};f.instantiateTypedArray=function(a){var c=a.constructor.name||h(a.constructor);if(0===a.length)return"new "+c;var d="a"+ ++this.localVariableId;c=[new e(d,"new "+c+"("+a.length+")")];a._iN$t={globalVar:"",
source:c};this.objsToClear_iN$t.push(a);for(var g=0;g<a.length;++g)0!==a[g]&&b(c,d+"["+g+"]=",a[g]);return c};f.enumerateField=function(a,c,b){return"object"==typeof b&&b?(a=b._iN$t)?(b=a.globalVar,b||(b=a.globalVar="v"+ ++this.globalVariableId,this.globalVariables.push(b),a.source[0]=d(b+"=",a.source[0])),b):ArrayBuffer.isView(b)?this.instantiateTypedArray(b):Array.isArray(b)?this.instantiateArray(b):this.instantiateObj(b):"function"==typeof b?this.getFuncModule(b):"string"==typeof b?y(b):("_objFlags"===
c&&a instanceof l&&(b&=r),b)};f.setObjProp=function(a,c,d,k){b(a,"o"+g(d)+"=",this.enumerateField(c,d,k))};f.enumerateObject=function(a,c){var b=c.constructor;if(cc.Class._isCCClass(b))this.enumerateCCClass(a,c,b);else for(var d in c)!c.hasOwnProperty(d)||95===d.charCodeAt(0)&&95===d.charCodeAt(1)&&"__type__"!==d||(b=c[d],"object"==typeof b&&b&&b===c._iN$t||this.setObjProp(a,c,d,b))};f.instantiateObj=function(a){if(a instanceof cc.ValueType)return v.getNewValueTypeCode(a);if(a instanceof cc.Asset)return this.getObjRef(a);
if(a._objFlags&q)return null;var c=a.constructor;if(cc.Class._isCCClass(c)){if(this.parent)if(this.parent instanceof cc.Component){if(a instanceof cc._BaseNode||a instanceof cc.Component)return this.getObjRef(a)}else if(this.parent instanceof cc._BaseNode)if(a instanceof cc._BaseNode){if(!a.isChildOf(this.parent))return this.getObjRef(a)}else if(a instanceof cc.Component&&!a.node.isChildOf(this.parent))return this.getObjRef(a);c=new e("o","new "+this.getFuncModule(c,!0)+"()")}else if(c===Object)c=
new e("o","{}");else{if(c)return this.getObjRef(a);c=new e("o","Object.create(null)")}c=[c];return p.value(a,"_iN$t",{globalVar:"",source:c},!0),this.objsToClear_iN$t.push(a),this.enumerateObject(c,a),["(function(){",c,"return o;})();"]};n.exports={compile:function(a){return(new k(a,a instanceof cc._BaseNode&&a)).result},equalsToDefault:c}},{"./CCClass":130,"./CCObject":136,"./attribute":142,"./compiler":144,"./js":150}],149:[function(f,n,m){function h(c,b){if(!b){if("object"!=typeof c||Array.isArray(c)||
!c||!cc.isValid(c))return null;0}var d;if(c instanceof a){if(c._instantiate)return cc.game._isCloning=!0,d=c._instantiate(),cc.game._isCloning=!1,d;if(c instanceof cc.Asset)return null}return cc.game._isCloning=!0,d=e(c),cc.game._isCloning=!1,d}function e(a,c){if(Array.isArray(a)||l&&l(a))return null;var b=a._iN$t?a._iN$t:a.constructor?new (0,a.constructor):Object.create(null);d(a,b,c);a=0;for(c=r.length;a<c;++a)r[a]._iN$t=null;return r.length=0,b}function d(d,g,e){q.value(d,"_iN$t",g,!0);r.push(d);
var l=d.constructor;if(cc.Class._isCCClass(l)){var f=l.__values__;for(l=0;l<f.length;l++){var p=f[l],v=d[p];if("object"==typeof v&&v){var t=g[p];t instanceof c&&t.constructor===v.constructor?t.set(v):g[p]=v._iN$t||b(v,e)}else g[p]=v}}else for(f in d)!d.hasOwnProperty(f)||95===f.charCodeAt(0)&&95===f.charCodeAt(1)&&"__type__"!==f||(l=d[f],"object"==typeof l&&l?l!==g&&(g[f]=l._iN$t||b(l,e)):g[f]=l);d instanceof a&&(g._objFlags&=k)}function b(a,k){if(a instanceof c)return a.clone();if(a instanceof cc.Asset)return a;
if(ArrayBuffer.isView(a)){k=a.length;var e=new a.constructor(k);a._iN$t=e;r.push(a);for(var l=0;l<k;++l)e[l]=a[l];return e}if(Array.isArray(a)){l=a.length;e=Array(l);q.value(a,"_iN$t",e,!0);r.push(a);for(var f=0;f<l;++f){var p=a[f];e[f]="object"==typeof p&&p?p._iN$t||b(p,k):p}return e}if(a._objFlags&g)return null;e=a.constructor;if(cc.Class._isCCClass(e)){if(k)if(k instanceof cc.Component){if(a instanceof cc._BaseNode||a instanceof cc.Component)return a}else if(k instanceof cc._BaseNode)if(a instanceof
cc._BaseNode){if(!a.isChildOf(k))return a}else if(a instanceof cc.Component&&!a.node.isChildOf(k))return a;e=new e}else if(e===Object)e={};else{if(e)return a;e=Object.create(null)}return d(a,e,k),e}var a=f("./CCObject"),c=f("../value-types/value-type"),g=a.Flags.Destroyed,k=a.Flags.PersistentMask,l=f("./utils").isDomNode,q=f("./js"),r=[];h._clone=e;cc.instantiate=h;n.exports=h},{"../value-types/value-type":240,"./CCObject":136,"./js":150,"./utils":154}],150:[function(f,n,m){function h(a,c){for(;a;){var b=
Object.getOwnPropertyDescriptor(a,c);if(b)return b;a=Object.getPrototypeOf(a)}return null}function e(a,c){a.splice(c,1)}function d(a,c){c=a.indexOf(c);return 0<=c&&(e(a,c),!0)}function b(a,c){void 0===c&&(c=a,a=null);this.get=null;this.count=0;this._pool=Array(c);this._cleanup=a}var a=new (f("./id-generater"))("TmpCId."),c={isNumber:function(a){return"number"==typeof a||a instanceof Number},isString:function(a){return"string"==typeof a||a instanceof String},addon:function(a){a=a||{};for(var c=1,b=
arguments.length;c<b;c++){var d=arguments[c];if(d)if("object"!=typeof d)cc.errorID(5402,d);else for(var g in d)if(!(g in a)){var k=g,e=a,l=h(d,k);Object.defineProperty(e,k,l)}}return a},mixin:function(a){a=a||{};for(var c=1,b=arguments.length;c<b;c++){var d=arguments[c];if(d)if("object"!=typeof d)cc.errorID(5403,d);else for(var g in d){var k=g,e=a,l=h(d,k);Object.defineProperty(e,k,l)}}return a},extend:function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b]);return a.prototype=Object.create(c.prototype,
{constructor:{value:a,writable:!0,configurable:!0}}),a},getSuper:function(a){return(a=(a=a.prototype)&&Object.getPrototypeOf(a))&&a.constructor},isChildClassOf:function(a,b){if(a&&b){if("function"!=typeof a||"function"!=typeof b)return!1;if(a===b)return!0;for(;a=c.getSuper(a);)if(a===b)return!0}return!1},clear:function(a){for(var c=Object.keys(a),b=0;b<c.length;b++)delete a[c[b]]},isEmptyObject:function(a){for(var c in a)return!1;return!0},getPropertyDescriptor:h},g={value:void 0,enumerable:!1,writable:!1,
configurable:!0};c.value=function(a,c,b,d,k){g.value=b;g.writable=d;g.enumerable=k;Object.defineProperty(a,c,g);g.value=void 0};var k={get:null,set:null,enumerable:!1};c.getset=function(a,c,b,d,g,e){"function"!=typeof d&&(g=d,d=void 0);k.get=b;k.set=d;k.enumerable=g;k.configurable=e;Object.defineProperty(a,c,k);k.get=null;k.set=null};var l={get:null,enumerable:!1,configurable:!1};c.get=function(a,c,b,d,g){l.get=b;l.enumerable=d;l.configurable=g;Object.defineProperty(a,c,l);l.get=null};var q={set:null,
enumerable:!1,configurable:!1};c.set=function(a,c,b,d,g){q.set=b;q.enumerable=d;q.configurable=g;Object.defineProperty(a,c,q);q.set=null};c.getClassName=function(a){if("function"==typeof a){var b=a.prototype;if(b&&b.hasOwnProperty("__classname__")&&b.__classname__)return b.__classname__;b="";if(a.name&&(b=a.name),a.toString){var d;a=a.toString();(d="["===a.charAt(0)?a.match(/\[\w+\s*(\w+)\]/):a.match(/function\s*(\w+)/))&&2===d.length&&(b=d[1])}return"Object"!==b?b:""}return a&&a.constructor?c.getClassName(a.constructor):
""};(function(){function b(a,b,d){return c.getset(c,b,function(){return Object.assign({},d)},function(a){c.clear(d);Object.assign(d,a)}),function(b,g){if(g.prototype.hasOwnProperty(a)&&delete d[g.prototype[a]],c.value(g.prototype,a,b),b){var k=d[b];k&&k!==g?(b="A Class already exists with the same "+a+' : "'+b+'".',0,cc.error(b)):d[b]=g}}}var d={},g={};c._setClassId=b("__cid__","_registeredClassIds",d);var k=b("__classname__","_registeredClassNames",g);c.setClassName=function(b,d){(k(b,d),d.prototype.hasOwnProperty("__cid__"))||
(b=b||a.getNewId())&&c._setClassId(b,d)};c.unregisterClass=function(){for(var a=0;a<arguments.length;a++){var c=arguments[a].prototype,b=c.__cid__;b&&delete d[b];(c=c.__classname__)&&delete g[c]}};c._getClassById=function(a){return d[a]};c.getClassByName=function(a){return g[a]};c._getClassId=function(a,c){return"function"==typeof a&&a.prototype.hasOwnProperty("__cid__")?a.prototype.__cid__:a&&a.constructor&&(c=a.constructor.prototype)&&c.hasOwnProperty("__cid__")?a.__cid__:""}})();c.obsolete=function(a,
b,d,g){function k(){return this[l]}var e=/([^.]+)$/;b=e.exec(b)[0];var l=e.exec(d)[0];g?c.getset(a,b,k,function(a){this[l]=a}):c.get(a,b,k)};c.obsoletes=function(a,b,d,g){for(var k in d)c.obsolete(a,b+"."+k,d[k],g)};var r=/(%d)|(%s)/,t=/%s/;c.formatStr=function(){var a=arguments.length;if(0===a)return"";var c=arguments[0];if(1===a)return""+c;if("string"==typeof c&&r.test(c))for(var b=1;b<a;++b){var d=arguments[b],g="number"==typeof d?r:t;g.test(c)?c=c.replace(g,d):c+=" "+d}else for(b=1;b<a;++b)c+=
" "+arguments[b];return c};c.shiftArguments=function(){for(var a=arguments.length-1,c=Array(a),b=0;b<a;++b)c[b]=arguments[b+1];return c};c.createMap=function(a){var c=Object.create(null);a&&(c["."]=!0,c["/"]=!0,delete c["."],delete c["/"]);return c};c.array={remove:d,fastRemove:function(a,c){c=a.indexOf(c);0<=c&&(a[c]=a[a.length-1],--a.length)},removeAt:e,fastRemoveAt:function(a,c){var b=a.length;0>c||c>=b||(a[c]=a[b-1],a.length=b-1)},contains:function(a,c){return 0<=a.indexOf(c)},verifyType:function(a,
c){if(a&&0<a.length)for(var b=0;b<a.length;b++)if(!(a[b]instanceof c))return cc.logID(1300),!1;return!0},removeArray:function(a,c){for(var b=0,g=c.length;b<g;b++)d(a,c[b])},appendObjectsAt:function(a,c,b){return a.splice.apply(a,[b,0].concat(c)),a},copy:function(a){var c,b=a.length,d=Array(b);for(c=0;c<b;c+=1)d[c]=a[c];return d},indexOf:Array.prototype.indexOf,MutableForwardIterator:f("../utils/mutable-forward-iterator")};b.prototype._get=function(){if(0<this.count){--this.count;var a=this._pool[this.count];
return this._pool[this.count]=null,a}return null};b.prototype.put=function(a){var c=this._pool;this.count<c.length&&(!this._cleanup||!1!==this._cleanup(a))&&(c[this.count]=a,++this.count)};b.prototype.resize=function(a){0<=a&&(this._pool.length=a,this.count>a&&(this.count=a))};c.Pool=b;cc.js=c;n.exports=c},{"../utils/mutable-forward-iterator":221,"./id-generater":146}],151:[function(f,n,m){function h(a,c,d,k){if(!a.get&&!a.set)if(a.hasOwnProperty("default")){var g="_N$"+c;a.get=function(){return this[g]};
a.set=function(a){var c=this[g];this[g]=a;d.call(this,c)};c={};for(var e in k[g]=c,b)k=b[e],a.hasOwnProperty(e)&&(c[e]=a[e],k.canUsedInGet||delete a[e])}else 0}var e=f("./js"),d=f("./attribute"),b={url:{canUsedInGet:!0},default:{},serializable:{},editorOnly:{},formerlySerializedAs:{}};m.getFullFormOfProperty=function(a,c,b){return a&&a.constructor===Object?null:Array.isArray(a)&&0<a.length?(a[0],{default:[],type:a,_short:!0}):"function"==typeof a?cc.RawAsset.isRawAssetType(a)||cc.RawAsset.wasRawAssetType(a)?
{default:"",url:a,_short:!0}:{default:e.isChildClassOf(a,cc.ValueType)?new a:null,type:a,_short:!0}:a instanceof d.PrimitiveType?{default:a.default,_short:!0}:{default:a,_short:!0}};m.preprocessAttrs=function(a,c,b,d){for(var g in a)if(b=a[g],d=m.getFullFormOfProperty(b,g,c),d&&(b=a[g]=d),b){(d=b.notify)&&h(b,g,d,a);if("type"in b)a:{d=b;var k=b.type,e=c,f=g;if(Array.isArray(k)){if(!(0<k.length)){cc.errorID(5508,e,f);break a}if(cc.RawAsset.isRawAssetType(k[0])){d.url=k[0];delete d.type;break a}d.type=
k=k[0]}"function"==typeof k&&(k===String?d.type=cc.String:k===Boolean?d.type=cc.Boolean:k===Number&&(d.type=cc.Float))}"url"in b&&(d=b,k=b.url,Array.isArray(k)&&0<k.length&&(k=k[0]),d.type=k);"type"in b&&b.type}};m.validateMethodWithProps=function(a,c,b,d,e){return"function"==typeof a||null===a}},{"./CCClass":130,"./attribute":142,"./js":150}],152:[function(f,n,m){var h=[];cc._RF={push:function(e,d,b){void 0===b&&(b=d,d="");h.push({uuid:d,script:b,module:e,exports:e.exports,beh:null})},pop:function(){var e=
h.pop(),d=e.module,b=d.exports;if(b===e.exports){for(var a in b)return;d.exports=e.cls}},peek:function(){return h[h.length-1]}}},{}],153:[function(f,n,m){cc.url={_rawAssets:"",normalize:function(f){return f&&(46===f.charCodeAt(0)&&47===f.charCodeAt(1)?f=f.slice(2):47===f.charCodeAt(0)&&(f=f.slice(1))),f},raw:function(f){if((f=this.normalize(f)).startsWith("resources/")){var e=cc.loader._getResUuid(f.slice(10),cc.Asset,null,!0);if(e)return cc.AssetLibrary.getLibUrlNoExt(e,!0)+cc.path.extname(f)}else cc.errorID(7002,
f);return this._rawAssets+f},_init:function(f){this._rawAssets=cc.path.stripSep(f)+"/"}};n.exports=cc.url},{}],154:[function(f,n,m){f("./js");n.exports={contains:function(f,e){if("function"==typeof f.contains)return f.contains(e);if("function"==typeof f.compareDocumentPosition)return!!(16&f.compareDocumentPosition(e));if(e=e.parentNode){do{if(e===f)return!0;e=e.parentNode}while(null!==e)}return!1},isDomNode:"object"==typeof window&&("function"==typeof Node?function(f){return f instanceof Node}:function(f){return f&&
"object"==typeof f&&"number"==typeof f.nodeType&&"string"==typeof f.nodeName}),callInNextTick:function(f,e,d){f&&setTimeout(function(){f(e,d)},0)}}},{"./js":150}],155:[function(f,n,m){f("./platform/js");f("./value-types");f("./utils");f("./platform/CCInputManager");f("./platform/CCInputExtension");f("./event");f("./platform/CCSys");f("./platform/CCMacro");f("./load-pipeline");f("./CCDirector");f("./renderer");f("./platform/CCView");f("./platform/CCScreen");f("./CCScheduler");f("./event-manager")},
{"./CCDirector":28,"./CCScheduler":33,"./event":101,"./event-manager":97,"./load-pipeline":116,"./platform/CCInputExtension":133,"./platform/CCInputManager":134,"./platform/CCMacro":135,"./platform/CCScreen":138,"./platform/CCSys":139,"./platform/CCView":140,"./platform/js":150,"./renderer":178,"./utils":219,"./value-types":235}],156:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var d=function(){function a(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(c,b,d){return b&&a(c.prototype,b),d&&a(c,d),c}}(),b=h(f("./assembler")),a=h(f("./utils/dynamic-atlas/manager")),
c=h(f("./webgl/render-data"));f=function(b){function g(){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var a=b.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!=typeof a&&"function"!=typeof a?this:a;return a._renderData=new c.default,a._renderData.init(a),a.initData(),a.initLocal(),a}return e(g,b),g.prototype.initData=function(){this._renderData.createQuadData(0,this.verticesFloats,this.indicesCount)},
g.prototype.initLocal=function(){this._local=[];this._local.length=4},g.prototype.updateColor=function(a,c){var b=this._renderData.uintVDatas[0];if(b){c=c||a.node.color._val;a=this.floatsPerVert;for(var d=this.colorOffset,g=b.length;d<g;d+=a)b[d]=c}},g.prototype.getBuffer=function(){return cc.renderer._handle._meshBuffer},g.prototype.updateWorldVerts=function(a){var c=this._local,b=this._renderData.vDatas[0],d=a.node._worldMatrix.m,g=d[0],k=d[1],e=d[4],l=d[5];a=d[12];d=d[13];var f=c[0],h=c[2],u=c[1],
m=c[3];1===g&&0===k&&0===e&&1===l?(b[0]=f+a,b[1]=u+d,b[5]=h+a,b[6]=u+d,b[10]=f+a,b[11]=m+d,b[15]=h+a,b[16]=m+d):(c=g*f,g*=h,f*=k,k*=h,h=e*u,e*=m,u*=l,l*=m,b[0]=c+h+a,b[1]=f+u+d,b[5]=g+h+a,b[6]=k+u+d,b[10]=c+e+a,b[11]=f+l+d,b[15]=g+e+a,b[16]=k+l+d)},g.prototype.fillBuffers=function(a,c){c.worldMatDirty&&this.updateWorldVerts(a);a=this._renderData;var b=a.vDatas[0];a=a.iDatas[0];var d=this.getBuffer(c);c=d.request(this.verticesCount,this.indicesCount);var g=c.byteOffset>>2,k=d._vData;b.length+g>k.length?
k.set(b.subarray(0,k.length-g),g):k.set(b,g);b=d._iData;d=c.indiceOffset;c=c.vertexOffset;g=0;for(k=a.length;g<k;g++)b[d++]=c+a[g]},g.prototype.packToDynamicAtlas=function(c,b){if(b){if(!b._original&&a.default&&b._texture.packable){var d=a.default.insertSpriteFrame(b);d&&b._setDynamicAtlasFrame(d)}(d=c.sharedMaterials[0])&&d.getProperty("texture")!==b._texture&&(c._vertsDirty=!0,c._activateMaterial(!0))}},d(g,[{key:"verticesFloats",get:function(){return this.verticesCount*this.floatsPerVert}}]),g}(b.default);
m.default=f;cc.js.addon(f.prototype,{floatsPerVert:5,verticesCount:4,indicesCount:6,uvOffset:2,colorOffset:4});cc.Assembler2D=f;n.exports=m.default},{"./assembler":158,"./utils/dynamic-atlas/manager":181,"./webgl/render-data":207}],157:[function(f,n,m){function h(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function d(a){return Object.getOwnPropertyDescriptor(a,"__assemblerId__")||(a.__assemblerId__=++b),a.__assemblerId__}m.__esModule=!0;f=function(a){return a&&a.__esModule?a:{default:a}}(f("../utils/pool"));var b=0,a=new (function(a){function c(){var b,d;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
for(var g=arguments.length,e=Array(g),f=0;f<g;f++)e[f]=arguments[f];return b=d=h(this,a.call.apply(a,[this].concat(e))),d._pool={},h(d,b)}return e(c,a),c.prototype.put=function(a){if(a&&this.enabled){var c=d(a.constructor),b=this._pool;b[c]||(b[c]=[]);this.count>this.maxSize||(this._clean(a),b[c].push(a),this.count++)}},c.prototype.get=function(a){var c=void 0;if(this.enabled){c=this._pool;var b=d(a);c=c[b]&&c[b].pop()}return c?this.count--:c=new a,c},c.prototype.clear=function(){this._pool={};this.count=
0},c.prototype._clean=function(a){a._renderComp=null},c}(f.default));f.default.register("assembler",a);m.default=a;n.exports=m.default},{"../utils/pool":222}],158:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=f("./webgl/vertex-format"),e=function(d){return d&&d.__esModule?d:{default:d}}(f("./assembler-pool"));f=function(){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._extendNative&&this._extendNative()}return d.prototype.init=function(b){this._renderComp=
b},d.prototype.updateRenderData=function(b){},d.prototype.fillBuffers=function(b,a){},d.prototype.getVfmt=function(){return h.vfmtPosUvColor},d}();m.default=f;f.register=function(d,b){d.__assembler__=b};f.init=function(d){for(var b=d.constructor,a=b.__assembler__;!a;){if(!(b=b.$super))return void cc.warn("Can not find assembler for render component : ["+cc.js.getClassName(d)+"]");a=b.__assembler__}(a.getConstructor&&(a=a.getConstructor(d)),d._assembler&&d._assembler.constructor===a)||(b=e.default.get(a),
b.init(d),d._assembler=b)};cc.Assembler=f;n.exports=m.default},{"./assembler-pool":157,"./webgl/vertex-format":209}],159:[function(f,n,m){f=function(f){try{var e=f.getContext("2d")}catch(d){return void console.error(d)}this._canvas=f;this._ctx=e;this._caps={};this._stats={drawcalls:0};this._sx=this._sy=this._sw=this._sh=this._vx=this._vy=this._vw=this._vh=0};f.prototype._restoreTexture=function(f){};f.prototype.setViewport=function(f,e,d,b){this._vx===f&&this._vy===e&&this._vw===d&&this._vh===b||
(this._vx=f,this._vy=e,this._vw=d,this._vh=b)};f.prototype.setScissor=function(f,e,d,b){this._sx===f&&this._sy===e&&this._sw===d&&this._sh===b||(this._sx=f,this._sy=e,this._sw=d,this._sh=b)};f.prototype.clear=function(f){var e=this._ctx;e.clearRect(this._vx,this._vy,this._vw,this._vh);!f||0===f[0]&&0===f[1]&&0===f[2]||(e.fillStyle="rgb("+f[0]+","+f[1]+","+f[2]+")",e.globalAlpha=f[3],e.fillRect(this._vx,this._vy,this._vw,this._vh))};f.prototype.resetDrawCalls=function(){this._stats.drawcalls=0};f.prototype.getDrawCalls=
function(){return this._stats.drawcalls};n.exports=f},{}],160:[function(f,n,m){f=function(f,e){this._device=f;this._height=this._width=4;this._image=null;e&&(void 0!==e.width&&(this._width=e.width),void 0!==e.height&&(this._height=e.height),this.updateImage(e))};f.prototype.update=function(f){this.updateImage(f)};f.prototype.updateImage=function(f){f.images&&f.images[0]&&(f=f.images[0])&&f!==this._image&&(this._image=f)};f.prototype.destroy=function(){this._image=null};n.exports=f},{}],161:[function(f,
n,m){f=function(){};f.prototype={constructor:f,clear:function(){},render:function(){}};n.exports=f},{}],162:[function(f,n,m){function h(d){return d&&d.__esModule?d:{default:d}}m.__esModule=!0;f("./render-flow");f("./renderers");var e=h(f("./forward-renderer"));f=h(f("./render-component-handle"));m.default={ForwardRenderer:e.default,RenderComponentHandle:f.default};n.exports=m.default},{"./forward-renderer":161,"./render-component-handle":163,"./render-flow":164,"./renderers":167}],163:[function(f,
n,m){var h=f("./renderers/utils");f=function(e,d){this._device=e;this._camera=d;this.parentOpacity=1;this.worldMatDirty=this.parentOpacityDirty=0;this.walking=!1};f.prototype={constructor:f,reset:function(){var e=this._device._ctx,d=this._device._canvas,b=cc.Camera.main?cc.Camera.main.backgroundColor:cc.color();e.fillStyle="rgba("+b.r+", "+b.g+", "+b.b+", "+b.a/255+")";e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,d.width,d.height);e.fillRect(0,0,d.width,d.height);this._device._stats.drawcalls=0;h.context.reset()},
terminate:function(){}};n.exports=f},{"./renderers/utils":177}],164:[function(f,n,m){var h=function(e){return e&&e.__esModule?e:{default:e}}(f("../render-flow"));h.default.prototype._draw=function(e,d){var b=h.default.getBachther(),a=b._device._ctx;b=b._camera;a.setTransform(b.a,b.b,b.c,b.d,b.tx,b.ty);a.scale(1,-1);b=e._renderComponent;b._assembler[d](a,b);this._next._func(e)};h.default.prototype._render=function(e){this._draw(e,"draw")};h.default.prototype._postRender=function(e){this._draw(e,"postDraw")}},
{"../render-flow":179}],165:[function(f,n,m){function h(){this.cmds=[];this.style={strokeStyle:"black",fillStyle:"white",lineCap:"butt",lineJoin:"miter",miterLimit:10}}var e=f("../../../../graphics/helper");m=f("../../../../graphics/types");f=f("../../../../platform/js");var d=m.LineJoin,b=m.LineCap;m=h.prototype;f.mixin(m,{moveTo:function(a,c){this.cmds.push(["moveTo",[a,c]])},lineTo:function(a,c){this.cmds.push(["lineTo",[a,c]])},bezierCurveTo:function(a,c,b,d,e,f){this.cmds.push(["bezierCurveTo",
[a,c,b,d,e,f]])},quadraticCurveTo:function(a,c,b,d){this.cmds.push(["quadraticCurveTo",[a,c,b,d]])},arc:function(a,c,b,d,l,f){e.arc(this,a,c,b,d,l,f)},ellipse:function(a,c,b,d){e.ellipse(this,a,c,b,d)},circle:function(a,c,b){e.ellipse(this,a,c,b,b)},rect:function(a,c,b,d){this.moveTo(a,c);this.lineTo(a,c+d);this.lineTo(a+b,c+d);this.lineTo(a+b,c);this.close()},roundRect:function(a,c,b,d,l){e.roundRect(this,a,c,b,d,l)},clear:function(a,c){this.cmds.length=0},close:function(){this.cmds.push(["closePath",
[]])},stroke:function(){this.cmds.push(["stroke",[]])},fill:function(){this.cmds.push(["fill",[]])}});f.set(m,"strokeColor",function(a){a="rgba("+(0|a.r)+","+(0|a.g)+","+(0|a.b)+","+a.a/255+")";this.cmds.push(["strokeStyle",a]);this.style.strokeStyle=a});f.set(m,"fillColor",function(a){a="rgba("+(0|a.r)+","+(0|a.g)+","+(0|a.b)+","+a.a/255+")";this.cmds.push(["fillStyle",a]);this.style.fillStyle=a});f.set(m,"lineWidth",function(a){this.cmds.push(["lineWidth",a]);this.style.lineWidth=a});f.set(m,"lineCap",
function(a){var c="butt";a===b.BUTT?c="butt":a===b.ROUND?c="round":a===b.SQUARE&&(c="square");this.cmds.push(["lineCap",c]);this.style.lineCap=c});f.set(m,"lineJoin",function(a){var c="bevel";a===d.BEVEL?c="bevel":a===d.ROUND?c="round":a===d.MITER&&(c="miter");this.cmds.push(["lineJoin",c]);this.style.lineJoin=c});f.set(m,"miterLimit",function(a){this.cmds.push(["miterLimit",a]);this.style.miterLimit=a});cc.Graphics._Impl=h;n.exports=h},{"../../../../graphics/helper":104,"../../../../graphics/types":106,
"../../../../platform/js":150}],166:[function(f,n,m){function h(b){return b&&b.__esModule?b:{default:b}}m.__esModule=!0;m.default=void 0;var e=h(f("../../../assembler"));f=(h(f("./impl")),h(f("../../../../graphics/graphics")));var d=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");}return b.prototype.init=function(){},b.prototype.draw=function(a,c){var b=c.node,d=b._worldMatrix.m;a.transform(d[0],d[1],d[4],d[5],d[12],d[13]);a.save();a.globalAlpha=
b.opacity/255;b=c._impl.style;a.strokeStyle=b.strokeStyle;a.fillStyle=b.fillStyle;a.lineWidth=b.lineWidth;a.lineJoin=b.lineJoin;a.miterLimit=b.miterLimit;b=!0;c=c._impl.cmds;d=0;for(var e=c.length;d<e;d++){var f=c[d],r=f[0];f=f[1];"moveTo"===r&&b?(a.beginPath(),b=!1):"fill"!==r&&"stroke"!==r&&"fillRect"!==r||(b=!0);"function"==typeof a[r]?a[r].apply(a,f):a[r]=f}return a.restore(),1},b.prototype.stroke=function(a){a._impl.stroke()},b.prototype.fill=function(a){a._impl.fill()},b.prototype.clear=function(){},
b}();m.default=d;e.default.register(f.default,d);n.exports=m.default},{"../../../../graphics/graphics":103,"../../../assembler":158,"./impl":165}],167:[function(f,n,m){f("../../../components/CCSprite");f("../../../components/CCLabel");f("../../../components/CCMask");f("../../../graphics/graphics");f("./sprite");f("./label");f("./graphics");f("./mask")},{"../../../components/CCLabel":66,"../../../components/CCMask":70,"../../../components/CCSprite":79,"../../../graphics/graphics":103,"./graphics":166,
"./label":169,"./mask":171,"./sprite":173}],168:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}m.__esModule=!0;m.default=void 0;var d=h(f("../../../utils/label/bmfont")),
b=h(f("../render-data")),a=h(f("../utils"));f=function(c){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var a=c.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return e(d,c),d.prototype.init=function(){this._renderData=new b.default},d.prototype.updateColor=function(){},d.prototype.appendQuad=function(a,c,b,d,g,e,f){c=this._renderData;
a=c.dataLength;c.dataLength+=2;c=c.vertices;var k=b.width,l=b.height,p=void 0,q=void 0,r=void 0,v=void 0;d?(p=b.x,q=b.y,v=b.y+k,c[a].u=p,c[a].v=v,c[a+1].u=p,c[a+1].v=q):(p=b.x,r=b.x+k,q=b.y,v=b.y+l,c[a].u=p,c[a].v=q,c[a+1].u=r,c[a+1].v=v);c[a].x=g;c[a].y=e-l*f;c[a+1].x=g+k*f;c[a+1].y=e},d.prototype.draw=function(c,b){var d=b.node,g=d._worldMatrix.m;c.transform(g[0],g[1],g[4],g[5],g[12],g[13]);c.scale(1,-1);a.default.context.setGlobalAlpha(c,d.opacity/255);g=this._renderData.vertices;b=a.default.getColorizedImage(b._frame._texture,
d._color);d=0;for(var k=g.length;d<k;d+=2){var e=g[d].x,l=g[d].y,f=g[d+1].x-e,h=g[d+1].y-l;l=-l-h;var x=g[d].u,m=g[d].v;c.drawImage(b,x,m,g[d+1].u-x,g[d+1].v-m,e,l,f,h)}return 1},d}(d.default);m.default=f;n.exports=m.default},{"../../../utils/label/bmfont":182,"../render-data":172,"../utils":177}],169:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}n=h(f("../../../assembler"));var e=h(f("../../../../components/CCLabel")),d=h(f("./ttf")),b=h(f("./bmfont"));e.default._canvasPool=
{pool:[],get:function(){var a=this.pool.pop();a||(a=document.createElement("canvas"),a={canvas:a,context:a.getContext("2d")});return a},put:function(a){32<=this.pool.length||this.pool.push(a)}};n.default.register(e.default,{getConstructor:function(a){var c=d.default;return a.font instanceof cc.BitmapFont?c=b.default:a.cacheMode===e.default.CacheMode.CHAR&&cc.warn("sorry, canvas mode does not support CHAR mode currently!"),c},TTF:d.default,Bmfont:b.default})},{"../../../../components/CCLabel":66,"../../../assembler":158,
"./bmfont":168,"./ttf":170}],170:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}m.__esModule=!0;m.default=void 0;var d=h(f("../../../utils/label/ttf")),b=h(f("../render-data")),
a=h(f("../utils"));f=function(c){function g(){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var a=c.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return e(g,c),g.prototype.init=function(){this._renderData=new b.default;this._renderData.dataLength=2},g.prototype.updateColor=function(){},g.prototype.updateVerts=function(a){var c=a.node;a=
c.width;var b=c.height,d=c.anchorX*a;c=c.anchorY*b;var g=this._renderData.vertices;g[0].x=-d;g[0].y=-c;g[1].x=a-d;g[1].y=b-c},g.prototype._updateTexture=function(c){d.default.prototype._updateTexture.call(this,c);a.default.dropColorizedImage(c._frame._texture,c.node.color)},g.prototype.draw=function(c,b){var d=b.node,g=d._worldMatrix.m;c.transform(g[0],g[1],g[4],g[5],g[12],g[13]);c.scale(1,-1);a.default.context.setGlobalAlpha(c,d.opacity/255);d=this._renderData.vertices;b=b._frame._texture.getHtmlElementObj();
g=d[0].x;var k=d[0].y,e=d[1].x-g;d=d[1].y-k;return k=-k-d,c.drawImage(b,g,k,e,d),1},g}(d.default);m.default=f;n.exports=m.default},{"../../../utils/label/ttf":185,"../render-data":172,"../utils":177}],171:[function(f,n,m){function h(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,
a):b.__proto__=a)}m.__esModule=!0;m.default=void 0;var e=function(b){return b&&b.__esModule?b:{default:b}}(f("../../assembler")),d=f("../../../components/CCMask");f=(f("./graphics"),function(b){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");var c=b.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!c||"object"!=typeof c&&"function"!=typeof c?this:c}return h(a,b),a.prototype.draw=
function(a,b){a.save();b._graphics._assembler.draw(a,b._graphics);a.clip()},a.prototype.postDraw=function(a,b){a.restore()},a}(e.default));m.default=f;e.default.register(d,f);n.exports=m.default},{"../../../components/CCMask":70,"../../assembler":158,"./graphics":166}],172:[function(f,n,m){m.__esModule=!0;var h=function(){function e(d,b){for(var a=0;a<b.length;a++){var c=b[a];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}return function(d,
b,a){return b&&e(d.prototype,b),a&&e(d,a),d}}();f=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.vertices=[]}return h(e,[{key:"dataLength",get:function(){return this.vertices.length},set:function(d){var b=this.vertices.length;for(this.vertices.length=d;b<d;b++)this.vertices[b]={x:0,y:0,u:0,v:0}}}]),e}();m.default=f;n.exports=m.default},{}],173:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}n=h(f("../../../assembler"));
var e=f("../../../../components/CCSprite"),d=h(f("./simple")),b=h(f("./sliced")),a=h(f("./tiled"));n.default.register(cc.Sprite,{getConstructor:function(c){var g=d.default;switch(c.type){case e.Type.SLICED:g=b.default;break;case e.Type.TILED:g=a.default}return g},Simple:d.default,Sliced:b.default,Tiled:a.default})},{"../../../../components/CCSprite":79,"../../../assembler":158,"./simple":174,"./sliced":175,"./tiled":176}],174:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,
b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}m.__esModule=!0;m.default=void 0;var d=h(f("../../../assembler")),b=h(f("../render-data")),a=f("../utils");f=function(c){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var a=c.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return e(d,c),d.prototype.init=function(){this._renderData=new b.default;this._renderData.dataLength=2},d.prototype.updateRenderData=function(a){a._vertsDirty&&(this.updateUVs(a),this.updateVerts(a),a._vertsDirty=!1)},d.prototype.updateUVs=function(a){var c=a.spriteFrame;a=this._renderData.vertices;var b=c._rect;if(c._rotated){c=
b.width;var d=b.y,g=b.height;a[0].u=b.x;a[0].v=d;a[1].u=g;a[1].v=c}else c=b.width,d=b.y,g=b.height,a[0].u=b.x,a[0].v=d,a[1].u=c,a[1].v=g},d.prototype.updateVerts=function(a){var c=this._renderData,b=a.node,d=c.vertices,g=a.spriteFrame,e=b.width,k=b.height,f=b.anchorX*e;b=b.anchorY*k;if(a.trim)f=-f,b=-b;else{var h=g._originalSize.width;a=g._originalSize.height;var x=g._rect.height,m=g._offset;f=e/h*(m.x+(h-g._rect.width)/2)-f;b=k/a*(m.y+(a-x)/2)-b}g._rotated?(d[0].y=f,d[0].x=b,d[1].y=e,d[1].x=k):(d[0].x=
f,d[0].y=b,d[1].x=e,d[1].y=k);c.vertDirty=!1},d.prototype.draw=function(c,b){var d=b.node,g=b._spriteFrame;b=d._worldMatrix.m;c.transform(b[0],b[1],b[4],b[5],b[12],b[13]);c.scale(1,-1);g._rotated&&c.rotate(-Math.PI/2);a.context.setGlobalAlpha(c,d.opacity/255);b=this._renderData.vertices;d=a.getColorizedImage(g._texture,d._color);g=b[1].y;return c.drawImage(d,b[0].u,b[0].v,b[1].u,b[1].v,b[0].x,-b[0].y-g,b[1].x,g),1},d}(d.default);m.default=f;n.exports=m.default},{"../../../assembler":158,"../render-data":172,
"../utils":177}],175:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}m.__esModule=!0;m.default=void 0;h(f("../../../assembler"));var d=h(f("../render-data")),b=h(f("./simple")),
a=f("../utils");f=function(c){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var a=c.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return e(b,c),b.prototype.init=function(){this._renderData=new d.default;this._renderData.dataLength=4},b.prototype.updateUVs=function(a){a=a.spriteFrame;var c=a._rect,b=a.insetLeft,d=c.width-b-
a.insetRight,g=a.insetTop,e=a.insetBottom,k=c.height-g-e,f=this._renderData.vertices;a._rotated?(f[0].u=c.x,f[1].u=e+c.x,f[2].u=e+k+c.x,f[3].u=c.x+c.height,f[3].v=c.y,f[2].v=b+c.y,f[1].v=b+d+c.y,f[0].v=c.y+c.width):(f[0].u=c.x,f[1].u=b+c.x,f[2].u=b+d+c.x,f[3].u=c.x+c.width,f[3].v=c.y,f[2].v=g+c.y,f[1].v=g+k+c.y,f[0].v=c.y+c.height)},b.prototype.updateVerts=function(a){var c=this._renderData.vertices,b=a.node,d=b.width,g=b.height,e=b.anchorX*d;b=b.anchorY*g;var k=a.spriteFrame,f=k.insetLeft,h=k.insetRight,
x=k.insetTop,m=k.insetBottom,u=d-f-h,B=g-x-m,C=d/(f+h);x=g/(x+m);C=isNaN(C)||1<C?1:C;x=isNaN(x)||1<x?1:x;u=0>u?0:u;B=0>B?0:B;k._rotated?(c[0].y=-e,c[0].x=-b,c[1].y=h*C-e,c[1].x=m*x-b,c[2].y=c[1].y+u,c[2].x=c[1].x+B,c[3].y=d-e,c[3].x=g-b):(c[0].x=-e,c[0].y=-b,c[1].x=f*C-e,c[1].y=m*x-b,c[2].x=c[1].x+u,c[2].y=c[1].y+B,c[3].x=d-e,c[3].y=g-b);a._vertsDirty=!1},b.prototype.draw=function(c,b){var d=b.node,g=b._spriteFrame;b=d._worldMatrix.m;c.transform(b[0],b[1],b[4],b[5],b[12],b[13]);c.scale(1,-1);g._rotated&&
c.rotate(-Math.PI/2);a.context.setGlobalAlpha(c,d.opacity/255);b=this._renderData.vertices;d=a.getColorizedImage(g._texture,d._color);g=0;for(var e,k,l,f,h,x,m,u,B,C,z=0;3>z;++z){f=b[z];l=b[z+1];for(var A=0;3>A;++A)e=b[A],k=b[A+1],h=e.x,x=f.y,m=k.x-h,x=-x-(u=l.y-x),e=e.u,B=l.v,k=k.u-e,C=f.v-B,0<k&&0<C&&0<m&&0<u&&(c.drawImage(d,e,B,k,C,h,x,m,u),g++)}return g},b}(b.default);m.default=f;n.exports=m.default},{"../../../assembler":158,"../render-data":172,"../utils":177,"./simple":174}],176:[function(f,
n,m){function h(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}m.__esModule=!0;m.default=void 0;var e=function(b){return b&&b.__esModule?b:{default:b}}(f("../../../assembler")),d=f("../utils");f=function(b){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
var c=b.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!c||"object"!=typeof c&&"function"!=typeof c?this:c}return h(a,b),a.prototype.draw=function(a,b){var c=b.node,g=c._worldMatrix.m;a.transform(g[0],g[1],g[4],g[5],g[12],g[13]);a.scale(1,-1);d.context.setGlobalAlpha(a,c.opacity/255);b=b.spriteFrame;g=b._rect;b=d.getFrameCache(b._texture,c._color,g.x,g.y,b._rotated?g.height:g.width,b._rotated?g.width:g.height);g=c.width;var e=
c.height,f=-c.anchorX*g;c=-c.anchorY*e;return c=-c-e,a.translate(f,c),a.fillStyle=a.createPattern(b,"repeat"),a.fillRect(0,0,g,e),1},a}(e.default);m.default=f;n.exports=m.default},{"../../../assembler":158,"../utils":177}],177:[function(f,n,m){function h(b,a,c,d,e,l,f){a=a._image;var g=b.getContext("2d");return b.width=l,b.height=f,g.globalCompositeOperation="source-over",g.fillStyle="rgb("+c.r+","+c.g+","+c.b+")",g.fillRect(0,0,l,f),g.globalCompositeOperation="multiply",g.drawImage(a,d,e,l,f,0,0,
l,f),g.globalCompositeOperation="destination-atop",g.drawImage(a,d,e,l,f,0,0,l,f),b}var e={canvasMap:{},canvasUsed:{},canvasPool:[],checking:!1,check:function(){var b=!1,a;for(a in this.canvasUsed)if(b=!0,this.canvasUsed[a])this.canvasUsed[a]=!1;else{var c=this.canvasMap[a];c.width=0;c.height=0;32>this.canvasPool.length&&this.canvasPool.push(c);delete this.canvasMap[a];delete this.canvasUsed[a]}b||(cc.director.off(cc.Director.EVENT_AFTER_DRAW,this.check,this),this.checking=!1)},startCheck:function(){cc.director.on(cc.Director.EVENT_AFTER_DRAW,
this.check,this);this.checking=!0},getCanvas:function(b){return this.canvasUsed[b]=!0,this.canvasMap[b]},cacheCanvas:function(b,a){this.canvasMap[a]=b;this.canvasUsed[a]=!0;this.checking||this.startCheck()},dropImage:function(b){this.canvasMap[b]&&delete this.canvasMap[b]}};n.exports={getColorizedImage:function(b,a){if(!b)return null;if(0===b.width||0===b.height)return b._image;var c=16777215&a._val;if(16777215===c)return b._image;c=b.url+c;var d=e.getCanvas(c);return d||(h(d=e.canvasPool.pop()||
document.createElement("canvas"),b,a,0,0,b.width,b.height),e.cacheCanvas(d,c)),d},getFrameCache:function(b,a,c,d,k,l){if(!b||!b.url||0>c||0>d||0>=k||0>=l)return null;var g=b.url,f=!1,t=16777215&a._val;if(16777215!==t&&(g+=t,f=!0),(0!==c||0!==d&&k!==b.width&&l!==b.height)&&(g+="_"+c+"_"+d+"_"+k+"_"+l,f=!0),!f)return b._image;f=e.getCanvas(g);return f||(h(f=e.canvasPool.pop()||document.createElement("canvas"),b,a,c,d,k,l),e.cacheCanvas(f,g)),f},dropColorizedImage:function(b,a){e.dropImage(b.url+(16777215&
a._val))}};var d=-1;n.exports.context={setGlobalAlpha:function(b,a){d!==a&&(d=a,b.globalAlpha=d)},reset:function(){d=-1}}},{}],178:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}var e=h(f("../../renderer/config")),d=h(f("../../renderer/gfx"));m=h(f("../../renderer/core/input-assembler"));var b=h(f("../../renderer/core/pass"));cc.renderer=n.exports={Texture2D:null,InputAssembler:m.default,Pass:b.default,renderEngine:null,canvas:null,device:null,scene:null,drawCalls:0,_handle:null,
_cameraNode:null,_camera:null,_forward:null,_flow:null,initWebGL:function(a,c){f("./webgl/assemblers");var b=f("./webgl/model-batcher");this.Texture2D=d.default.Texture2D;this.canvas=a;this._flow=cc.RenderFlow;var k=f("../../renderer/scene/scene"),l=f("../../renderer/renderers/forward-renderer");this.device=new d.default.Device(a,c);this.scene=new k;a={defaultTexture:new d.default.Texture2D(this.device,{images:[],width:128,height:128,wrapS:d.default.WRAP_REPEAT,wrapT:d.default.WRAP_REPEAT,format:d.default.TEXTURE_FMT_RGB8,
mipmap:!1}),programTemplates:[],programChunks:{}};this._forward=new l(this.device,a);this._handle=new b(this.device,this.scene);this._flow.init(this._handle,this._forward);e.default.addStage("shadowcast");e.default.addStage("opaque");e.default.addStage("transparent")},initCanvas:function(a){var c=f("./canvas"),b=f("./canvas/Texture2D"),d=f("./canvas/Device");this.Device=d;this.Texture2D=b;this.canvas=a;this.device=new d(a);this._camera={a:1,b:0,c:0,d:1,tx:0,ty:0};this._handle=new c.RenderComponentHandle(this.device,
this._camera);this._forward=new c.ForwardRenderer;this._flow=cc.RenderFlow;this._flow.init(this._handle,this._forward)},updateCameraViewport:function(){if(cc.director){var a=cc.director.getScene();a&&a.setScale(1,1,1)}cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&(a=cc.view.getViewportRect(),this.device.setViewport(a.x,a.y,a.width,a.height),this._camera.a=cc.view.getScaleX(),this._camera.d=cc.view.getScaleY(),this._camera.tx=a.x,this._camera.ty=a.y+a.height)},render:function(a,c){this.device.resetDrawCalls();
a&&(this._flow.render(a,c),this.drawCalls=this.device.getDrawCalls())},clear:function(){this._handle.reset();this._forward.clear()}}},{"../../renderer/config":267,"../../renderer/core/input-assembler":270,"../../renderer/core/pass":271,"../../renderer/gfx":280,"../../renderer/renderers/forward-renderer":299,"../../renderer/scene/scene":302,"./canvas":162,"./canvas/Device":159,"./canvas/Texture2D":160,"./webgl/assemblers":190,"./webgl/model-batcher":205}],179:[function(f,n,m){function h(){this._func=
b;this._next=null}function e(b,d){var e=new h;switch(e._next=d||B,b){case a:case c:e._func=e._doNothing;break;case g:e._func=e._localTransform;break;case k:e._func=e._worldTransform;break;case q:e._func=e._opacity;break;case r:e._func=e._color;break;case l:e._func=e._updateRenderData;break;case p:e._func=e._render;break;case v:e._func=e._children;break;case w:e._func=e._postRender}return e}function d(a){for(var c=null,b=E;0<b;)b&a&&(c=e(b,c)),b>>=1;return c}function b(a){var c=a._renderFlag;(C[c]=
d(c))._func(a)}m=0;var a=1<<m++,c=1<<m++,g=1<<m++,k=1<<m++;f=g|k;var l=1<<m++,q=1<<m++,r=1<<m++,t=q|r,p=1<<m++,v=1<<m++,w=1<<m++,E=1<<m++,x=void 0,y=void 0,u=0;m=h.prototype;m._doNothing=function(){};m._localTransform=function(a){a._updateLocalMatrix();a._renderFlag&=~g;this._next._func(a)};m._worldTransform=function(a){x.worldMatDirty++;var c=a._matrix,b=a._trs,d=c.m;d[12]=b[0];d[13]=b[1];d[14]=b[2];a._mulMat(a._worldMatrix,a._parent._worldMatrix,c);a._renderFlag&=~k;this._next._func(a);x.worldMatDirty--};
m._opacity=function(a){x.parentOpacityDirty++;a._renderFlag&=~q;this._next._func(a);x.parentOpacityDirty--};m._color=function(a){var c=a._renderComponent;c&&c._updateColor();a._renderFlag&=~r;this._next._func(a)};m._updateRenderData=function(a){var c=a._renderComponent;c._assembler.updateRenderData(c);a._renderFlag&=~l;this._next._func(a)};m._render=function(a){var c=a._renderComponent;c._checkBacth(x,a._cullingMask);c._assembler.fillBuffers(c,x);this._next._func(a)};m._children=function(a){for(var c=
u,b=x,d=b.parentOpacity,g=b.parentOpacity*=a._opacity/255,e=(b.worldMatDirty?k:0)|(b.parentOpacityDirty?t:0),l=a._children,f=0,p=l.length;f<p;f++){var q=l[f];if(0!=q.isRenderVisible&&(q._renderFlag|=e,q._activeInHierarchy&&0!==q._opacity)){u=q._cullingMask=0===q.groupIndex?c:1<<q.groupIndex;var r=q._color._val;q._color._fastSetA(q._opacity*g);C[q._renderFlag]._func(q);q._color._val=r}}b.parentOpacity=d;this._next._func(a)};m._postRender=function(a){var c=a._renderComponent;c._checkBacth(x,a._cullingMask);
c._assembler.postFillBuffers(c,x);this._next._func(a)};var B=new h;B._func=B._doNothing;B._next=B;var C={};h.flows=C;h.createFlow=e;h.visitRootNode=function(a){u=1<<a.groupIndex;a._renderFlag&k?(x.worldMatDirty++,a._calculWorldMatrix(),a._renderFlag&=~k,C[a._renderFlag]._func(a),x.worldMatDirty--):C[a._renderFlag]._func(a)};h.render=function(a,c){x.reset();x.walking=!0;h.visitRootNode(a);x.terminate();x.walking=!1;y.render(x._renderScene,c)};h.init=function(a,c){x=a;y=c;C[0]=B;for(a=1;a<E;a++)C[a]=
new h};h.getBachther=function(){return x};h.FLAG_DONOTHING=a;h.FLAG_BREAK_FLOW=c;h.FLAG_LOCAL_TRANSFORM=g;h.FLAG_WORLD_TRANSFORM=k;h.FLAG_TRANSFORM=f;h.FLAG_OPACITY=q;h.FLAG_COLOR=r;h.FLAG_OPACITY_COLOR=t;h.FLAG_UPDATE_RENDER_DATA=l;h.FLAG_RENDER=p;h.FLAG_CHILDREN=v;h.FLAG_POST_RENDER=w;h.FLAG_FINAL=E;n.exports=cc.RenderFlow=h},{}],180:[function(f,n,m){function h(d,b){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,c=new e;c.initWithSize(d,b);c.update();this._texture=c;this._nexty=
this._y=this._x=this.space=a;this._width=d;this._height=b;this._innerTextureInfos={};this._innerSpriteFrames=[]}var e=f("../../../assets/CCRenderTexture");h.DEFAULT_HASH=(new e)._getHash();cc.js.mixin(h.prototype,{insertSpriteFrame:function(d){var b=d._rect,a=d._texture,c=this._innerTextureInfos[a._id],g=b.x;b=b.y;if(c)g+=c.x,b+=c.y;else{c=a.width;var e=a.height;if(this._x+c+this.space>this._width&&(this._x=this.space,this._y=this._nexty),this._y+e+this.space>this._nexty&&(this._nexty=this._y+e+this.space),
this._nexty>this._height)return null;cc.dynamicAtlasManager.textureBleeding&&(this._texture.drawTextureAt(a,this._x-1,this._y),this._texture.drawTextureAt(a,this._x+1,this._y),this._texture.drawTextureAt(a,this._x,this._y-1),this._texture.drawTextureAt(a,this._x,this._y+1));this._texture.drawTextureAt(a,this._x,this._y);this._innerTextureInfos[a._id]={x:this._x,y:this._y,texture:a};g+=this._x;b+=this._y;this._x+=c+this.space;this._dirty=!0}a={x:g,y:b,texture:this._texture};return this._innerSpriteFrames.push(d),
a},update:function(){this._dirty&&(this._texture.update(),this._dirty=!1)},deleteInnerTexture:function(d){d&&delete this._innerTextureInfos[d._id]},reset:function(){this._nexty=this._y=this._x=this.space;for(var d=this._innerSpriteFrames,b=0,a=d.length;b<a;b++){var c=d[b];c.isValid&&c._resetDynamicAtlasFrame()}this._innerSpriteFrames.length=0;this._innerTextureInfos={}},destroy:function(){this.reset();this._texture.destroy()}});n.exports=h},{"../../../assets/CCRenderTexture":44}],181:[function(f,
n,m){var h=f("./atlas");n.exports=cc.dynamicAtlasManager={Atlas:h,_atlases:[],_atlasIndex:-1,_maxAtlasCount:5,_textureSize:2048,_minFrameSize:8,_maxFrameSize:512,_textureBleeding:!0,_debugNode:null,_enabled:!1,get enabled(){return this._enabled},set enabled(e){this._enabled!==e&&(e?(this.reset(),cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,this.beforeSceneLoad,this)):cc.director.off(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,this.beforeSceneLoad,this),this._enabled=e)},beforeSceneLoad:function(){this.reset()},
get maxAtlasCount(){return this._maxAtlasCount},set maxAtlasCount(e){this._maxAtlasCount=e},get textureBleeding(){return this._textureBleeding},set textureBleeding(e){this._textureBleeding=e},get textureSize(){return this._textureSize},set textureSize(e){this._textureSize=e},get maxFrameSize(){return this._maxFrameSize},set maxFrameSize(e){this._maxFrameSize=e},get minFrameSize(){return this._minFrameSize},set minFrameSize(e){this._minFrameSize=e},newAtlas:function(){var e=this._atlases[++this._atlasIndex];
return e||(e=new h(this._textureSize,this._textureSize),this._atlases.push(e)),e},insertSpriteFrame:function(e){if(!this._enabled||this._atlasIndex===this._maxAtlasCount||!e||e._original||!e._texture.packable)return null;var d=this._atlases[this._atlasIndex];d||(d=this.newAtlas());return(d=d.insertSpriteFrame(e))||this._atlasIndex===this._maxAtlasCount?d:this.newAtlas().insertSpriteFrame(e)},reset:function(){for(var e=0,d=this._atlases.length;e<d;e++)this._atlases[e].destroy();this._atlases.length=
0;this._atlasIndex=-1},deleteAtlasTexture:function(e){if(e._original&&(e=e._original._texture))for(var d=0,b=this._atlases.length;d<b;d++)this._atlases[d].deleteInnerTexture(e)},showDebug:!1,update:function(){if(this.enabled)for(var e=0;e<=this._atlasIndex;e++)this._atlases[e].update()}}},{"./atlas":180}],182:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var e=function(a){return a&&a.__esModule?a:{default:a}}(f("../../assembler-2d"));f("../../../platform/CCSys");var d=f("../../../utils/text-utils"),b=f("../../../platform/CCMacro"),a=f("../../../components/CCLabel").Overflow,c=f("../utils").shareLabelInfo,g=function(){this.char="";this.valid=!0;this.line=this.y=this.x=0;this.hash=""},
k=cc.rect(),l=null,q=[],r=[],t=[],p=[],v=null,w=0,E=0,x=0,y=0,u=0,B=1,C=null,z=cc.size(),A="",D=0,I=0,F=0,G=0,J=0,N=0,K=0,P=!1,L=0,M=0,U=0;f=function(e){function f(){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");var a=e.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return h(f,e),f.prototype.updateRenderData=function(a){a._vertsDirty&&l!==
a&&(l=a,this._reserveQuads(a,a.string.toString().length),this._updateFontFamily(a),this._updateProperties(a),this._updateLabelInfo(a),this._updateContent(),this.updateWorldVerts(a),l._actualFontSize=D/a._fontSizeScale,z.width/=a._fontSizeScale,z.height/=a._fontSizeScale,l.node.setContentSize(z),l._vertsDirty=!1,l=null,this._resetProperties())},f.prototype._updateFontScale=function(){B=D/I},f.prototype._updateFontFamily=function(a){a=a.font;C=a.spriteFrame;v=a._fntConfig;c.fontAtlas=a._fontDefDictionary},
f.prototype._updateLabelInfo=function(){c.hash="";c.margin=0},f.prototype._updateProperties=function(b){A=b.string.toString();I=v?v.fontSize:b.fontSize;I*=b._fontSizeScale;D=b.fontSize*b._fontSizeScale;F=b.horizontalAlign;G=b.verticalAlign;J=b.spacingX;K=b.overflow;N=b._lineHeight*b._fontSizeScale;z.width=b.node.width*b._fontSizeScale;z.height=b.node.height*b._fontSizeScale;K===a.NONE?(P=!1,z.width+=2*c.margin,z.height+=2*c.margin):K===a.RESIZE_HEIGHT?(P=!0,z.height+=2*c.margin):P=b.enableWrapText;
c.lineHeight=N;c.fontSize=D;this._setupBMFontOverflowMetrics()},f.prototype._resetProperties=function(){C=v=null;c.hash="";c.margin=0},f.prototype._updateContent=function(){this._updateFontScale();this._computeHorizontalKerningForText();this._alignText()},f.prototype._computeHorizontalKerningForText=function(){for(var a=A,c=a.length,b=v.kerningDict,d=-1,g=0;g<c;++g){var e=a.charCodeAt(g);d=b[d<<16|65535&e]||0;q[g]=g<c-1?d:0;d=e}},f.prototype._multilineTextWrap=function(a){for(var b=A.length,g=0,e=
0,k=0,l=0,f=0,p=0,r=0,v,h=cc.v2(0,0),x=0;x<b;){var m=A.charAt(x);if("\n"!==m){for(var C=a(A,x,b),n=p,D=r,F=f,I=e,G=!1,oa=0;oa<C;++oa){var da=x+oa;if("\r"!==(m=A.charAt(da)))if(v=c.fontAtlas.getLetterDefinitionForChar(m,c)){var R=void 0!=v.fontSize?c.fontSize/v.fontSize:1,H=I-c.margin;if(P&&0<U&&0<e&&H+v.w*B*R>U&&!d.isUnicodeSpace(m)){t.push(f);f=0;g++;e=0;k-=N*B;G=!0;break}h.x=H;h.y=k-v.offsetY*B*R+c.margin;this._recordLetterInfo(h,m,da,g);da+1<q.length&&da<b-1&&(I+=q[da+1]);I+=v.xAdvance*B*R+J-2*
c.margin;F=h.x+v.w*B*R-c.margin;n<h.y&&(n=h.y);D>h.y-v.h*B*R&&(D=h.y-v.h*B*R)}else this._recordPlaceholderInfo(da,m),console.log("Can't find letter definition in texture atlas  for letter:"+m);else this._recordPlaceholderInfo(da,m)}G||(e=I,f=F,p<n&&(p=n),r>D&&(r=D),l<f&&(l=f),x+=C)}else t.push(f),f=0,g++,e=0,k-=N*B,this._recordPlaceholderInfo(x,m),x++}return t.push(f),E=(w=g+1)*N*B,1<w&&(E+=0*(w-1)),z.width=L,z.height=M,0>=L&&(z.width=parseFloat(l.toFixed(2))+2*c.margin),0>=M&&(z.height=parseFloat(E.toFixed(2))+
2*c.margin),y=z.height,u=0,0<p&&(y=z.height+p),r<-E&&(u=E+r),!0},f.prototype._getFirstCharLen=function(){return 1},f.prototype._getFirstWordLen=function(a,b,g){var e=a.charAt(b);if(d.isUnicodeCJK(e)||"\n"===e||d.isUnicodeSpace(e))return 1;var k=1,l=c.fontAtlas.getLetterDefinitionForChar(e,c);if(!l)return k;var f=void 0!=l.fontSize?c.fontSize/l.fontSize:1;for(b=(l.xAdvance,b+1);b<g&&(e=a.charAt(b),l=c.fontAtlas.getLetterDefinitionForChar(e,c))&&!(f=void 0!=l.fontSize?c.fontSize/l.fontSize:1,NaN+l.w*
B*f>U&&!d.isUnicodeSpace(e)&&0<U)&&(l.xAdvance*B*f+J,"\n"!==e&&!d.isUnicodeSpace(e)&&!d.isUnicodeCJK(e));++b)k++;return k},f.prototype._multilineTextWrapByWord=function(){return this._multilineTextWrap(this._getFirstWordLen)},f.prototype._multilineTextWrapByChar=function(){return this._multilineTextWrap(this._getFirstCharLen)},f.prototype._recordPlaceholderInfo=function(a,b){var d=null;a>=r.length?(d=new g,r.push(d)):d=r[a];d.char=b;d.hash=c.fontAtlas.getFinialLetterHash?c.fontAtlas.getFinialLetterHash(b,
c):""+b.charCodeAt(0)+c.hash;d.valid=!1},f.prototype._recordLetterInfo=function(a,b,d,e){var k=null;d>=r.length?(k=new g,r.push(k)):k=r[d];d=c.fontAtlas.getFinialLetterHash?c.fontAtlas.getFinialLetterHash(b,c):""+b.charCodeAt(0)+c.hash;var l=c.fontAtlas.getLetterForKey?c.fontAtlas.getLetterForKey(d):c.fontAtlas.getLetter(d);k.line=e;k.char=b;k.hash=d;k.valid=l.valid;k.x=a.x;k.y=a.y},f.prototype._alignText=function(){E=0;t.length=0;this._multilineTextWrapByWord();this._computeAlignmentOffset();K===
a.SHRINK&&0<D&&this._isVerticalClamp()&&this._shrinkLabelToContentSize(this._isVerticalClamp);this._updateQuads()||K===a.SHRINK&&this._shrinkLabelToContentSize(this._isHorizontalClamp)},f.prototype._scaleFontSizeDown=function(a){var c=!0;a||(a=.1,c=!1);D=a;c&&this._updateContent()},f.prototype._shrinkLabelToContentSize=function(a){for(var c=D,b=0,d=!0;a();){var g=c-++b;if(d=!1,0>=g)break;B=g/I;this._multilineTextWrapByWord();this._computeAlignmentOffset()}d||0<=c-b&&this._scaleFontSizeDown(c-b)},
f.prototype._isVerticalClamp=function(){return E>z.height},f.prototype._isHorizontalClamp=function(){for(var a=!1,b=0,d=A.length;b<d;++b){var g=r[b];if(g.valid){var e=c.fontAtlas.getLetterForKey?c.fontAtlas.getLetterForKey(g.hash):c.fontAtlas.getLetter(g.hash);e=g.x+e.w*B*(void 0!=e.fontSize?c.fontSize/e.fontSize:1);g=g.line;if(0<L)if(P){if(t[g]>z.width&&(e>z.width||0>e)){a=!0;break}}else if(e>z.width){a=!0;break}}}return a},f.prototype._isHorizontalClamped=function(a,c){c=t[c];a=a>z.width||0>a;return P?
c>z.width&&a:a},f.prototype._updateQuads=function(){var b=c.fontAtlas.getTexture(),d=l.node;this.verticesCount=this.indicesCount=0;var g=B/l._fontSizeScale;this._renderData&&(this._renderData.dataLength=0);var e=d._anchorPoint.x*z.width;d=d._anchorPoint.y*z.height;for(var f=!0,q=0,v=A.length;q<v;++q){var t=r[q];if(t.valid){var h=c.fontAtlas.getLetterForKey?c.fontAtlas.getLetterForKey(t.hash):c.fontAtlas.getLetter(t.hash);if(h){var w=void 0!=h.fontSize?c.fontSize/h.fontSize:1;k.height=h.h;k.width=
h.w;k.x=h.u;k.y=h.v;var E=t.y+x;if(0<M){if(E>y){var m=E-y;k.y+=m;k.height-=m;E-=m}K===a.CLAMP&&E-h.h*w*B<u&&(k.height=E<u?0:(E-u)/w)}m=t.line;var C=t.x+h.w*w/2*B+p[m];if(0<L&&this._isHorizontalClamped(C,m))if(K===a.CLAMP)k.width=0;else if(K===a.SHRINK){if(z.width>h.w*w){f=!1;break}k.width=0}0<k.height&&0<k.width&&(h=this._determineRect(k),this.appendQuad(l,b,k,h,(t.x+p[t.line]-e)/l._fontSizeScale,(E-d)/l._fontSizeScale,g*w))}else console.warn("[Letter] not find letter,char:"+t.char+",hash:"+t.hash)}}return this._quadsUpdated(l),
f},f.prototype._determineRect=function(a){var c=C.isRotated(),b=C._originalSize,d=C._rect,g=C._offset,e=g.x+(b.width-d.width)/2;b=g.y-(b.height-d.height)/2;c?(g=a.x,a.x=d.x+d.height-a.y-a.height-b,a.y=g+d.y-e,0>a.y&&(a.height+=b)):(a.x+=d.x-e,a.y+=d.y+b);return c},f.prototype._computeAlignmentOffset=function(){switch(p.length=0,F){case b.TextAlignment.LEFT:for(var a=0;a<w;++a)p.push(0);break;case b.TextAlignment.CENTER:a=0;for(var c=t.length;a<c;a++)p.push((z.width-t[a])/2);break;case b.TextAlignment.RIGHT:for(a=
0,c=t.length;a<c;a++)p.push(z.width-t[a])}if(x=z.height,G!==b.VerticalTextAlignment.TOP)a=z.height-E+(N-I)*B,G===b.VerticalTextAlignment.BOTTOM?x-=a:x-=a/2},f.prototype._setupBMFontOverflowMetrics=function(){var c=z.width,b=z.height;K===a.RESIZE_HEIGHT&&(b=0);K===a.NONE&&(c=0,b=0);L=c;M=b;U=c},f.prototype.updateWorldVerts=function(){},f.prototype.appendQuad=function(a,c,b,d,g,e,k){},f.prototype._quadsUpdated=function(a){},f.prototype._reserveQuads=function(){},f}(e.default);m.default=f;n.exports=
m.default},{"../../../components/CCLabel":66,"../../../platform/CCMacro":135,"../../../platform/CCSys":139,"../../../utils/text-utils":227,"../../assembler-2d":156,"../utils":186}],183:[function(f,n,m){function h(){this._rect=null;this.uv=[];this._original=this._texture=null}h.prototype={constructor:h,getRect:function(){return cc.rect(this._rect)},setRect:function(e){this._rect=e;this._texture&&this._calculateUV()},_setDynamicAtlasFrame:function(e){e&&(this._original={_texture:this._texture,_x:this._rect.x,
_y:this._rect.y},this._texture=e.texture,this._rect.x=e.x,this._rect.y=e.y,this._calculateUV())},_resetDynamicAtlasFrame:function(){this._original&&(this._rect.x=this._original._x,this._rect.y=this._original._y,this._texture=this._original._texture,this._original=null,this._calculateUV())},_refreshTexture:function(e){this._texture=e;this._rect=cc.rect(0,0,e.width,e.height);this._calculateUV()},_calculateUV:function(){var e=this._rect,d=this._texture,b=this.uv,a=d.width,c=d.height;d=0===a?0:e.x/a;
a=0===a?0:(e.x+e.width)/a;var g=0===c?0:(e.y+e.height)/c;e=0===c?0:e.y/c;b[0]=d;b[1]=g;b[2]=a;b[3]=g;b[4]=d;b[5]=e;b[6]=a;b[7]=e}};n.exports=h},{}],184:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}function e(a){a=20*
Math.ceil(a/20);if(30>a)a=30;else if(100<a)return 100;return a}function d(a,b){this._texture=null;this._labelInfo=b;this._char=a;this._context=this._canvas=this._data=this._hash=null;this._offsetY=this._height=this._width=0;this._texture=new cc.Texture2D;this._data=c._canvasPool.get();this._canvas=this._data.canvas;this._context=this._data.context;this._texture.initWithElement(this._canvas)}function b(a,c){var b=new q;b.initWithSize(a,c);b.update();this._fontDefDictionary=new w(b);this._width=a;this._height=
c;this.totalCount=0;this.maxRow=this.maxCol=4;this.gridWidth=a/this.maxCol;this.gridHeight=c/this.maxRow;this.lineList=[];a=0;for(c=this.maxCol*this.maxRow;a<c;a++)this.lineList.push({lines:[]});a=[20,40,60,80,100];for(c=0;c<a.length;c++)this.lineList[c].staticFontSize=a[c];this.currDrawPos={x:0,y:0};this.useCharCreateTime=0}m.__esModule=!0;m.default=void 0;var a=function(a){return a&&a.__esModule?a:{default:a}}(f("../../webgl/assemblers/label/2d/bmfont")),c=f("../../../components/CCLabel"),g=f("../../../components/CCLabelOutline"),
k=f("../../../utils/text-utils"),l=f("../../../components/CCComponent"),q=f("../../../assets/CCRenderTexture"),r=cc.js.isChildClassOf(g,l),t=f("../utils").getFontFamily,p=f("../utils").shareLabelInfo,v=cc.BitmapFont.FontLetterDefinition,w=cc.BitmapFont.FontAtlas,E=cc.Color.WHITE,x=(1/255).toFixed(3);d.prototype={constructor:d,updateRenderData:function(){this._updateProperties();this._updateTexture()},_updateProperties:function(){this.drawFontSize=e(this._labelInfo.fontSize);this._labelInfo.fontSize==
this.drawFontSize?this.drawFontDesc=this._labelInfo.fontDesc:this.drawFontDesc=this._labelInfo.fontDesc.replace(this._labelInfo.fontSize+"px ",this.drawFontSize+"px ");this._context.font=this.drawFontDesc;this._width=Math.ceil(k.safeMeasureText(this._context,this._char))+4;this._height=(1+k.BASELINE_RATIO)*this.drawFontSize+2*this._labelInfo.margin+2;this._offsetY=-this.drawFontSize*k.BASELINE_RATIO/2;this._canvas.width!==this._width&&(this._canvas.width=this._width);this._canvas.height!==this._height&&
(this._canvas.height=this._height)},_updateTexture:function(){var a=this._context,c=this._labelInfo,b=this._canvas.width,d=this._canvas.height,g=b/2,e=d/2+this.drawFontSize*k.MIDDLE_RATIO,l=c.color;if(a.textAlign="center",a.textBaseline="alphabetic",a.clearRect(0,0,b,d),a.fillStyle="rgba("+l.r+", "+l.g+", "+l.b+", "+x+")",a.fillRect(0,0,b,d),a.font=this.drawFontDesc,a.lineJoin="round",a.fillStyle="rgba("+l.r+", "+l.g+", "+l.b+", 1)",c.isOutlined)b=c.out||E,a.strokeStyle="rgba("+b.r+", "+b.g+", "+
b.b+", "+b.a/255+")",a.lineWidth=2*c.margin,a.strokeText(this._char,g,e);a.fillText(this._char,g,e);this._texture.handleLoadedTexture()},destroy:function(){this._texture.destroy();this._texture=null;c._canvasPool.put(this._data)}};var y=null;cc.js.mixin(b.prototype,{discardChar:function(a){this.totalCount--;this._fontDefDictionary._letterDefinitions[a];delete this._fontDefDictionary._letterDefinitions[a]},updateUseChar:function(){var a=cc.sys.now();if(!(200>a-this.useCharCreateTime)){for(var b=cc.director.getScene().children,
d=[],k=0;k<b.length;++k){var l=b[k].getComponentsInChildren(cc.Label);Array.prototype.push.apply(d,l)}for(b=0;b<d.length;++b)if(k=d[b],k.node.activeInHierarchy&&k.cacheMode==c.CacheMode.CHAR){l=t(k);var f=k.node.color.toHEX("#rrggbb");l="_"+e(k.fontSize*k._fontSizeScale)+l+f;if(f=r&&k.node.getComponent(g)){var p=f.color.clone();p.a=f.color.a*k.node.color.a/255;l+=f.width+p.toHEX("#rrggbb")}f=0;for(p=k.string.length;f<p;f++){var q=k.string.charCodeAt(f)+l;(q=this._fontDefDictionary._letterDefinitions[q])&&
(0,q.lastVisitTime=a)}}this.useCharCreateTime=a}},freeLine:function(a){var c=cc.sys.now();this.updateUseChar();for(var b=this.lineList.length-1;0<=b;b--)for(var d=this.lineList[b].lines,g=d.length-1;0<=g;g--){var e=d[g];if(!(0<=a&&a!=e.fontSize)){for(var k=!0,l=0;l<e.charList.length;l++){var f=this._fontDefDictionary._letterDefinitions[e.charList[l]];if(f&&6E3>=c-f.lastVisitTime){k=!1;break}}if(k&&0<e.charList.length){console.warn("[Letter] find empty line:"+e.fontSize);e.lx=2;for(a=0;a<e.charList.length;a++)this.discardChar(e.charList[a]);
return e.charList=[],!0}}}return!1},freeGrid:function(a){var c=cc.sys.now();this.updateUseChar();for(var b=this.lineList.length-1;0<=b;b--){var d=0,g=this.lineList[b],e=g.lines;if(void 0==g.staticFontSize||g.staticFontSize==a){for(g=e.length-1;0<=g;g--){for(var k=e[g],l=!0,f=0;f<k.charList.length;f++)if(6E3>=c-this._fontDefDictionary._letterDefinitions[k.charList[f]].lastVisitTime){l=!1;break}if(l&&(d++,0<k.charList.length)){console.warn("[Letter] find empty line:"+k.fontSize);k.lx=2;for(l=0;l<k.charList.length;l++)this.discardChar(k.charList[l]);
k.charList=[]}}if(d==e.length)return console.warn("[Letter] find empty grid:"+b),0<e.length&&e.splice(0,e.length),!0}}return!1},findDrawPos:function(a,c,b,d){for(var g=4<arguments.length&&void 0!==arguments[4]&&arguments[4],e=5<arguments.length&&void 0!==arguments[5]&&arguments[5],k=-1,l=-1,f=this.lineList.length-1;0<=f;f--)for(var p=this.lineList[f].lines,q=p.length-1;0<=q;q--){var r=p[q];if(r.fontSize==b.drawFontSize&&r.lx+a<this.gridWidth-2&&!(c>r.height)&&(r=c+r.gy,!(r>this.gridHeight||q+1<p.length&&
r>p[q+1].gy))){l=q;k=f;break}}if(0<=l)(g=this.lineList[k].lines[l]).charList.push(b._hash),d.x=k%this.maxCol*this.gridWidth+g.lx,d.y=Math.floor(k/this.maxCol)*this.gridHeight+g.gy,g.lx+=a;else{l=2;k=-1;for(f=this.lineList.length-1;0<=f;f--)if(p=this.lineList[f],void 0==p.staticFontSize||p.staticFontSize==b.drawFontSize){l=2;p=p.lines;if(0==p.length){k=f;break}p=p[p.length-1];if(!((l+=p.gy+p.height)+c>this.gridHeight)){k=f;break}}if(0<=k)g={gy:l,lx:4,height:c,fontSize:b.drawFontSize,charList:[b._hash]},
this.lineList[k].lines.push(g),d.x=k%this.maxCol*this.gridWidth+g.lx,d.y=Math.floor(k/this.maxCol)*this.gridHeight+g.gy,g.lx+=a;else{if(g&&this.freeLine(b.drawFontSize))return this.findDrawPos(a,c,b,d,!1,e);if(e&&this.freeGrid(b.drawFontSize))return this.findDrawPos(a,c,b,d,!1,!1);k=cc.sys.now();var v=!1;for(g=this.lineList.length-1;0<=g;g--){e=this.lineList[g].lines;l=0;for(f=e.length;l<f;l++)if(p=e[l],p.fontSize==b.drawFontSize){q=-1;for(var t=r=0,h=0;h<p.charList.length;h++)if(6E3<k-this._fontDefDictionary._letterDefinitions[p.charList[h]].lastVisitTime){if(-1==
q)if(q=h,0<h){var w=this._fontDefDictionary._letterDefinitions[p.charList[h-1]];r=w.u;r+=w.w+4;r-=g%this.maxCol*this.gridWidth}else r=4;if(h<p.charList.length-1?(t=this._fontDefDictionary._letterDefinitions[p.charList[h+1]].u,t-=g%this.maxCol*this.gridWidth):t=this.gridWidth,(t-=4)-r>=a){for(v=h;v>=q;v--)h=p.charList[v],console.warn("[Letter] cover unuse char,oldChar:"+h,"newChar:"+b._char,"endX="+t,"beginX:"+r+",width:"+a),this.discardChar(h),p.charList.splice(v,1);d.x=g%this.maxCol*this.gridWidth+
r;d.y=Math.floor(g/this.maxCol)*this.gridHeight+p.gy;p.charList.splice(q,0,b._hash);v=!0;break}}else q=-1;if(v)break}if(v)break}if(!v)return console.warn("Letter insert letter fail,rect not enough! curr count:"+this.totalCount),!1}}return!0},insertLetterTexture:function(a){var c=a._texture,b=c.width,d=c.height;if(b-=4,!this.findDrawPos(b,d,a,this.currDrawPos,!0,!0))return null;this._fontDefDictionary._texture.drawTextureAt(c,this.currDrawPos.x-2,this.currDrawPos.y);this._dirty=!0;c=new v;return c.u=
this.currDrawPos.x,c.v=this.currDrawPos.y,c.texture=this._fontDefDictionary._texture,c.valid=!0,c.w=b,c.h=a._height,c.xAdvance=b,c.offsetY=a._offsetY,c.fontSize=a.drawFontSize,c.lastVisitTime=cc.sys.now(),this.totalCount++,this._fontDefDictionary.addLetterDefinitions(a._hash,c),c},update:function(){this._dirty&&(this._fontDefDictionary._texture.update(),this._dirty=!1)},reset:function(){},destroy:function(){this.reset();this._fontDefDictionary._texture.destroy();this._fontDefDictionary._texture=null},
clearAllCache:function(){this.destroy();var a=new q;a.initWithSize(this._width,this._height);a.update();this._fontDefDictionary._texture=a},getLetter:function(a,c){a=this.getFinialLetterHash(a,c);return this.getLetterForKey(a)},getLetterForKey:function(a){a=this._fontDefDictionary._letterDefinitions[a];return a&&(a.lastVisitTime=cc.sys.now()),a},getTexture:function(){return this._fontDefDictionary.getTexture()},fixedFontSize:function(a){return 10*Math.ceil(.1*a)},getFinialLetterHash:function(a,c){var b=
""+a.charCodeAt(0);a=e(c.fontSize);b+="_";return a==c.fontSize?b+=c.hash:b+=c.hash.replace(c.fontSize.toString(),a),b},insertStaticLetterTexture:function(a,c,b){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"Arial";y._labelInfo.fontSize=c;y._labelInfo.fontDesc=c+"px "+d;y._labelInfo.color.fromHEX(b);y._labelInfo.hash=""+c+d+b;y._char=a;d=this.getFinialLetterHash(a,y._labelInfo);var g=this._fontDefDictionary._letterDefinitions[d];g?g.lastVisitTime=cc.sys.now():(y._hash=d,y.updateRenderData(),
this.insertLetterTexture(y))},getLetterDefinitionForChar:function(a,c){var b=this.getFinialLetterHash(a,c),d=this._fontDefDictionary._letterDefinitions[b];if(d)d.lastVisitTime=cc.sys.now();else{if(y._labelInfo!==c)for(var g in c)y._labelInfo[g]=c[g];y.drawFontSize=e(y._labelInfo.fontSize);y._char=a;y._hash=b;y.updateRenderData();d=this.insertLetterTexture(y)}return d}});var u=null;f=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var b=a.apply(this,
arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(c,a),c.prototype._getAssemblerData=function(){return u||(y=new d("",p),u=new b(2048,2048),cc.Label._shareAtlas=u),u.getTexture()},c.prototype._updateFontFamily=function(a){p.fontAtlas=u;p.fontFamily=t(a);var c=r&&a.getComponent(g);c&&c.enabled?(p.isOutlined=!0,p.margin=c.width,p.out=c.color.clone(),p.out.a=c.color.a*a.node.color.a/
255):(p.isOutlined=!1,p.margin=0)},c.prototype._updateLabelInfo=function(a){p.fontDesc=this._getFontDesc();p.color=a.node.color;var c=p.color.toHEX("#rrggbb");a="";c=(p.isOutlined&&(a=a+p.margin+p.out.toHEX("#rrggbb")),""+p.fontSize+p.fontFamily+c+a);p.hash=c},c.prototype._getFontDesc=function(){return p.fontSize.toString()+"px "+p.fontFamily},c.prototype._computeHorizontalKerningForText=function(){},c.prototype._determineRect=function(a){return!1},c}(a.default);m.default=f;cc.LetterFontAssembler=
f;cc.LetterTexture=n.exports=d;n.exports=f;n.exports=m.default},{"../../../assets/CCRenderTexture":44,"../../../components/CCComponent":64,"../../../components/CCLabel":66,"../../../components/CCLabelOutline":67,"../../../utils/text-utils":227,"../../webgl/assemblers/label/2d/bmfont":191,"../utils":186}],185:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var e=function(a){return a&&a.__esModule?a:{default:a}}(f("../../assembler-2d"));f("../../../platform/CCSys");var d=f("../../../utils/text-utils"),b=f("../../../platform/CCMacro"),a=f("../../../components/CCLabel"),c=f("../../../components/CCLabelOutline"),g=f("../../../components/CCLabelShadow"),k=a.Overflow,l=f("../utils").deleteFromDynamicAtlas,
q=f("../utils").getFontFamily,r=(1/255).toFixed(3),t=null,p=null,v=null,w="",E="",x=0,y=0,u=[],B=cc.Size.ZERO,C=0,z=0,A=0,D=null,I="",F=k.NONE,G=!1,J=null,N=cc.Color.WHITE,K=null,P=cc.Color.BLACK,L=cc.rect(),M=cc.Size.ZERO,U=cc.Size.ZERO,R=!1,O=!1,H=!1,S=0,W=cc.Vec2.ZERO,T=0,Q=void 0;f=function(e){function f(){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");var a=e.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return h(f,e),f.prototype._getAssemblerData=function(){return(Q=a._canvasPool.get()).canvas.width=Q.canvas.height=1,Q},f.prototype._resetAssemblerData=function(c){c&&a._canvasPool.put(c)},f.prototype.updateRenderData=function(a){if(e.prototype.updateRenderData.call(this,a),a._vertsDirty){var c=a.node.getContentSize();this._updateFontFamily(a);this._updateProperties(a);this._calculateLabelFont();this._calculateSplitedStrings();this._updateLabelDimensions();
this._calculateTextBaseline();this._updateTexture(a);this._calDynamicAtlas(a);a._actualFontSize=x/a._fontSizeScale;0==F?(c.width=B.width/a._fontSizeScale,c.height=B.height/a._fontSizeScale):3==F&&(c.height=B.height/a._fontSizeScale);a.node.setContentSize(c);this.updateVerts(a);a._vertsDirty=!1;v=p=t=null}},f.prototype.updateVerts=function(){},f.prototype._updatePaddingRect=function(){var a=0,c=0,b=0,d=0,g=0;if(M.width=M.height=0,J&&(a=c=b=d=g=J.width,M.width=M.height=2*g),K)g=K.blur+g,b=Math.max(b,
-K._offset.x+g),d=Math.max(d,K._offset.x+g),a=Math.max(a,K._offset.y+g),c=Math.max(c,-K._offset.y+g);O&&(g=y*Math.tan(.20943951),d+=g,M.width+=g);L.x=b;L.y=a;L.width=b+d;L.height=a+c},f.prototype._updateFontFamily=function(a){I=q(a)},f.prototype._updateProperties=function(a){var b=a._assemblerData;t=b.context;p=b.canvas;v=a._frame._original?a._frame._original._texture:a._frame._texture;E=a.string.toString();x=a._fontSize*a._fontSizeScale;S=(y=x)/8;F=a.overflow;B.width=a.node.width*a._fontSizeScale;
B.height=a.node.height*a._fontSizeScale;(U=a.node.getContentSize()).width*=a._fontSizeScale;U.height*=a._fontSizeScale;C=a._lineHeight*a._fontSizeScale;z=a.horizontalAlign;A=a.verticalAlign;D=a.node.color;R=a._isBold;O=a._isItalic;H=a._isUnderline;G=F!==k.NONE&&(F===k.RESIZE_HEIGHT||a.enableWrapText);(J=(J=c&&a.getComponent(c))&&J.enabled&&0<J.width?J:null)&&N.set(J.color);(K=(K=g&&a.getComponent(g))&&K.enabled?K:null)&&(P.set(K.color),P.a=P.a*a.node.color.a/255);this._updatePaddingRect()},f.prototype._calculateFillTextStartPosition=
function(){var a=0;z===b.TextAlignment.RIGHT?a=B.width-L.width:z===b.TextAlignment.CENTER&&(a=(B.width-L.width)/2);var c=this._getLineHeight()*(u.length-1),g=x*(1-d.BASELINE_RATIO/2);A!==b.VerticalTextAlignment.TOP&&(c=c+L.height+x-B.height,A===b.VerticalTextAlignment.BOTTOM?g-=c:g-=c/2);return cc.v2(a+L.x,g+L.y)},f.prototype._setupOutline=function(){t.strokeStyle="rgba("+N.r+", "+N.g+", "+N.b+", "+N.a/255+")";t.lineWidth=2*J.width},f.prototype._setupShadow=function(){t.shadowColor="rgba("+P.r+", "+
P.g+", "+P.b+", "+P.a/255+")";t.shadowBlur=K.blur;t.shadowOffsetX=K.offset.x;t.shadowOffsetY=-K.offset.y},f.prototype._drawUnderline=function(a){J&&(this._setupOutline(),t.strokeRect(W.x,W.y,a,S));t.lineWidth=S;t.fillStyle="rgba("+D.r+", "+D.g+", "+D.b+", "+D.a/255+")";t.fillRect(W.x,W.y,a,S)},f.prototype._updateTexture=function(){t.clearRect(0,0,p.width,p.height);var a=J?N:D;t.fillStyle="rgba("+a.r+", "+a.g+", "+a.b+", "+r+")";t.fillRect(0,0,p.width,p.height);t.font=w;a=this._calculateFillTextStartPosition();
var c=this._getLineHeight();t.lineJoin="round";t.fillStyle="rgba("+D.r+", "+D.g+", "+D.b+", 1)";var d=1<u.length,g=this._measureText(t);K&&this._setupShadow();J&&this._setupOutline();for(var e=0;e<u.length;++e){var k=a.x;var l=a.y+e*c;K&&d&&(J&&t.strokeText(u[e],k,l),t.fillText(u[e],k,l));H&&(T=g(u[e]),z===b.TextAlignment.RIGHT?W.x=a.x-T:z===b.TextAlignment.CENTER?W.x=a.x-T/2:W.x=a.x,W.y=l,this._drawUnderline(T))}K&&d&&(t.shadowColor="transparent");for(d=0;d<u.length;++d)k=a.x,l=a.y+d*c,J&&t.strokeText(u[d],
k,l),t.fillText(u[d],k,l);K&&(t.shadowColor="transparent");v.handleLoadedTexture()},f.prototype._calDynamicAtlas=function(c){if(c.cacheMode===a.CacheMode.BITMAP){var b=c._frame;l(c,b);b._original||b.setRect(cc.rect(0,0,p.width,p.height));this.packToDynamicAtlas(c,b)}},f.prototype._updateLabelDimensions=function(){var a=E.split("\n");if(F===k.RESIZE_HEIGHT){var c=(u.length+d.BASELINE_RATIO)*this._getLineHeight();B.height=c+L.height;U.height=c+M.height}else if(F===k.NONE){u=a;for(var b=c=0;b<a.length;++b){var g=
d.safeMeasureText(t,a[b]);c=c>g?c:g}a=(u.length+d.BASELINE_RATIO)*this._getLineHeight();c=parseFloat(c.toFixed(2));a=parseFloat(a.toFixed(2));B.width=c+L.width;B.height=a+L.height;U.width=c+M.width;U.height=a+M.height}B.width=Math.min(B.width,2048);B.height=Math.min(B.height,2048);p.width!==B.width&&(p.width=B.width);p.height!==B.height&&(p.height=B.height)},f.prototype._calculateTextBaseline=function(){t.textAlign=z===b.TextAlignment.RIGHT?"right":z===b.TextAlignment.CENTER?"center":"left";t.textBaseline=
"alphabetic"},f.prototype._calculateSplitedStrings=function(){var a=E.split("\n");if(G){u=[];for(var c=U.width,b=0;b<a.length;++b){var g=d.safeMeasureText(t,a[b]);g=d.fragmentText(a[b],g,c,this._measureText(t));u=u.concat(g)}}else u=a},f.prototype._getFontDesc=function(){var a=x.toString()+"px ";return a+=I,R&&(a="bold "+a),O&&(a="italic "+a),a},f.prototype._getLineHeight=function(){var a=C;return 0|(0===a?x:a*x/y)},f.prototype._calculateParagraphLength=function(a,c){for(var b=[],g=0;g<a.length;++g){var e=
d.safeMeasureText(c,a[g]);b.push(e)}return b},f.prototype._measureText=function(a){return function(c){return d.safeMeasureText(a,c)}},f.prototype._calculateLabelFont=function(){if(w=this._getFontDesc(),t.font=w,F===k.SHRINK){var a=E.split("\n"),c=this._calculateParagraphLength(a,t),b,g=0;if(G){c=U.width;var e=U.height;if(0>c||0>e)return w=this._getFontDesc(),void(t.font=w);var l=e+1;g=c+1;for(var f=x+1,p,q=!0,r=0|f;l>e||g>c;){if(q?f=r/2|0:r=f=r-1,0>=f){cc.logID(4003);break}x=f;w=this._getFontDesc();
t.font=w;for(b=l=0;b<a.length;++b){var v=0;p=d.safeMeasureText(t,a[b]);for(p=d.fragmentText(a[b],p,c,this._measureText(t));v<p.length;)g=d.safeMeasureText(t,p[v]),l+=this._getLineHeight(),++v}q&&(l>e?r=0|f:(q=!1,l=e+1))}}else{l=a.length*this._getLineHeight();for(b=0;b<a.length;++b)g<c[b]&&(g=c[b]);x=y*Math.min(1,(B.width-L.width)/g,B.height/l)|0;w=this._getFontDesc();t.font=w}}},f}(e.default);m.default=f;n.exports=m.default},{"../../../components/CCLabel":66,"../../../components/CCLabelOutline":67,
"../../../components/CCLabelShadow":68,"../../../platform/CCMacro":135,"../../../platform/CCSys":139,"../../../utils/text-utils":227,"../../assembler-2d":156,"../utils":186}],186:[function(f,n,m){var h=f("./dynamic-atlas/manager");f=cc.Color.WHITE;n.exports={deleteFromDynamicAtlas:function(e,d){d&&d._original&&h&&(h.deleteAtlasTexture(d),d._resetDynamicAtlasFrame())},getFontFamily:function(e){return e.useSystemFont?e.fontFamily||"Arial":e.font?e.font._nativeAsset?e.font._nativeAsset:(cc.loader.load(e.font.nativeUrl,
function(d,b){e.font._nativeAsset=b;e._lazyUpdateRenderData()}),"Arial"):"Arial"},shareLabelInfo:{fontAtlas:null,fontSize:0,lineHeight:0,hAlign:0,vAlign:0,hash:"",fontFamily:"",fontDesc:"Arial",color:f,isOutlined:!1,out:f,margin:0}}},{"./dynamic-atlas/manager":181}],187:[function(f,n,m){function h(g,l,f){f=f||2;var p,q,r=(q=l&&l.length)?l[0]*f:g.length,t=e(g,0,r,f,!0),h=[];if(!t)return h;if(q){var w=f,x,u;var E=[];q=0;for(x=l.length;q<x;q++)(u=e(g,l[q]*w,q<x-1?l[q+1]*w:g.length,w,!1))===u.next&&(u.steiner=
!0),E.push(k(u));E.sort(a);for(q=0;q<E.length;q++){l=E[q];u=t;if(u=c(l,u))l=v(u,l),d(l,l.next);t=d(t,t.next)}}if(g.length>80*f){var m=p=g[0];var y=q=g[1];for(u=f;u<r;u+=f)E=g[u],l=g[u+1],E<m&&(m=E),l<y&&(y=l),E>p&&(p=E),l>q&&(q=l);p=Math.max(p-m,q-y)}return b(t,h,f,m,y,p),h}function e(a,c,b,d,g){if(g===0<y(a,c,b,d))for(g=c;g<b;g+=d)var e=w(g,a[g],a[g+1],e);else for(g=b-d;g>=c;g-=d)e=w(g,a[g],a[g+1],e);return e&&r(e,e.next)&&(E(e),e=e.next),e}function d(a,c){if(!a)return a;c||(c=a);var b=a;do if(a=
!1,b.steiner||!r(b,b.next)&&0!==q(b.prev,b,b.next))b=b.next;else{if(E(b),(b=c=b.prev)===b.next)return null;a=!0}while(a||b!==c);return c}function b(a,c,e,k,f,h,w){if(a){if(!w&&h){var x=a,u=x;do null===u.z&&(u.z=g(u.x,u.y,k,f,h)),u.prevZ=u.prev,u=u.nextZ=u.next;while(u!==x);u.prevZ.nextZ=null;u.prevZ=null;x=u;var m,A,y,B,n=1;do{u=x;var C=x=null;for(y=0;u;){y++;var z=u;for(m=B=0;m<n&&(B++,z=z.nextZ);m++);for(m=n;0<B||0<m&&z;)0===B?(A=z,z=z.nextZ,m--):0!==m&&z?u.z<=z.z?(A=u,u=u.nextZ,B--):(A=z,z=z.nextZ,
m--):(A=u,u=u.nextZ,B--),C?C.nextZ=A:x=A,A.prevZ=C,C=A;u=z}C.nextZ=null;n*=2}while(1<y)}for(u=a;a.prev!==a.next;){A=a.prev;x=a.next;if(h)a:{z=a;m=k;var D=f,I=h;C=z.prev;y=z;B=z.next;if(0<=q(C,y,B))z=!1;else{var H=C.x>y.x?C.x>B.x?C.x:B.x:y.x>B.x?y.x:B.x,S=C.y>y.y?C.y>B.y?C.y:B.y:y.y>B.y?y.y:B.y;n=g(C.x<y.x?C.x<B.x?C.x:B.x:y.x<B.x?y.x:B.x,C.y<y.y?C.y<B.y?C.y:B.y:y.y<B.y?y.y:B.y,m,D,I);m=g(H,S,m,D,I);for(D=z.nextZ;D&&D.z<=m;){if(D!==z.prev&&D!==z.next&&l(C.x,C.y,y.x,y.y,B.x,B.y,D.x,D.y)&&0<=q(D.prev,
D,D.next)){z=!1;break a}D=D.nextZ}for(D=z.prevZ;D&&D.z>=n;){if(D!==z.prev&&D!==z.next&&l(C.x,C.y,y.x,y.y,B.x,B.y,D.x,D.y)&&0<=q(D.prev,D,D.next)){z=!1;break a}D=D.prevZ}z=!0}}else a:if(z=a,C=z.prev,y=z,B=z.next,0<=q(C,y,B))z=!1;else{for(n=z.next.next;n!==z.prev;){if(l(C.x,C.y,y.x,y.y,B.x,B.y,n.x,n.y)&&0<=q(n.prev,n,n.next)){z=!1;break a}n=n.next}z=!0}if(z)c.push(A.i/e),c.push(a.i/e),c.push(x.i/e),E(a),u=a=x.next;else if((a=x)===u){if(w)if(1===w){w=c;A=e;x=a;do u=x.prev,z=x.next.next,!r(u,z)&&t(u,
x,x.next,z)&&p(u,z)&&p(z,u)&&(w.push(u.i/A),w.push(x.i/A),w.push(z.i/A),E(x),E(x.next),x=a=z),x=x.next;while(x!==a);b(x,c,e,k,f,h,2)}else{if(2===w)a:{w=a;do{for(A=w.next.next;A!==w.prev;){if(x=w.i!==A.i){x=w;u=A;if(z=x.next.i!==u.i&&x.prev.i!==u.i){b:{z=x;do{if(z.i!==x.i&&z.next.i!==x.i&&z.i!==u.i&&z.next.i!==u.i&&t(z,z.next,x,u)){z=!0;break b}z=z.next}while(z!==x);z=!1}z=!z}if(z=z&&p(x,u)&&p(u,x)){z=x;C=!1;y=(x.x+u.x)/2;u=(x.y+u.y)/2;do z.y>u!=z.next.y>u&&y<(z.next.x-z.x)*(u-z.y)/(z.next.y-z.y)+
z.x&&(C=!C),z=z.next;while(z!==x);z=C}x=z}if(x){a=v(w,A);w=d(w,w.next);a=d(a,a.next);b(w,c,e,k,f,h);b(a,c,e,k,f,h);break a}A=A.next}w=w.next}while(w!==a)}}else b(d(a),c,e,k,f,h,1);break}}}}function a(a,c){return a.x-c.x}function c(a,c){var b=c,d=a.x,g=a.y,e=-1/0;do{if(g<=b.y&&g>=b.next.y){var k=b.x+(g-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(k<=d&&k>e){if(e=k,k===d){if(g===b.y)return b;if(g===b.next.y)return b.next}var f=b.x<b.next.x?b:b.next}}b=b.next}while(b!==c);if(!f)return null;if(d===e)return f.prev;
var q;c=f;k=f.x;var r=f.y,v=1/0;for(b=f.next;b!==c;)d>=b.x&&b.x>=k&&l(g<r?d:e,g,k,r,g<r?e:d,g,b.x,b.y)&&((q=Math.abs(g-b.y)/(d-b.x))<v||q===v&&b.x>f.x)&&p(b,a)&&(f=b,v=q),b=b.next;return f}function g(a,c,b,d,g){return 1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-b)/g)|a<<8))|a<<4))|a<<2))|a<<1)|(1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-d)/g)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function k(a){var c=a,b=a;do c.x<b.x&&(b=c),c=c.next;while(c!==a);return b}function l(a,
c,b,d,g,e,k,l){return 0<=(g-k)*(c-l)-(a-k)*(e-l)&&0<=(a-k)*(d-l)-(b-k)*(c-l)&&0<=(b-k)*(e-l)-(g-k)*(d-l)}function q(a,c,b){return(c.y-a.y)*(b.x-c.x)-(c.x-a.x)*(b.y-c.y)}function r(a,c){return a.x===c.x&&a.y===c.y}function t(a,c,b,d){return!!(r(a,c)&&r(b,d)||r(a,d)&&r(b,c))||0<q(a,c,b)!=0<q(a,c,d)&&0<q(b,d,a)!=0<q(b,d,c)}function p(a,c){return 0>q(a.prev,a,a.next)?0<=q(a,c,a.next)&&0<=q(a,a.prev,c):0>q(a,c,a.prev)||0>q(a,a.next,c)}function v(a,c){var b=new x(a.i,a.x,a.y),d=new x(c.i,c.x,c.y),g=a.next,
e=c.prev;return a.next=c,c.prev=a,b.next=g,g.prev=b,d.next=b,b.prev=d,e.next=d,d.prev=e,d}function w(a,c,b,d){a=new x(a,c,b);return d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a),a}function E(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function x(a,c,b){this.i=a;this.x=c;this.y=b;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function y(a,c,b,d){for(var g=0,e=b-d;c<b;c+=d)g+=(a[e]-a[c])*(a[c+
1]+a[e+1]),e=c;return g}cc.Graphics.earcut=n.exports=h;h.deviation=function(a,c,b,d){var g=c&&c.length,e=Math.abs(y(a,0,g?c[0]*b:a.length,b));if(g){g=0;for(var k=c.length;g<k;g++)e-=Math.abs(y(a,c[g]*b,g<k-1?c[g+1]*b:a.length,b))}for(g=c=0;g<d.length;g+=3){k=d[g]*b;var l=d[g+1]*b,f=d[g+2]*b;c+=Math.abs((a[k]-a[f])*(a[l+1]-a[k+1])-(a[k]-a[l])*(a[f+1]-a[k+1]))}return 0===e&&0===c?0:Math.abs((c-e)/e)};h.flatten=function(a){for(var c=a[0][0].length,b={vertices:[],holes:[],dimensions:c},d=0,g=0;g<a.length;g++){for(var e=
0;e<a[g].length;e++)for(var k=0;k<c;k++)b.vertices.push(a[g][e][k]);0<g&&(d+=a[g-1].length,b.holes.push(d))}return b}},{}],188:[function(f,n,m){function h(){this.reset()}function e(a){this._tessTol=.25;this._distTol=.01;this._updatePathOffset=!1;this._commandy=this._commandx=this._pointsOffset=this._pathOffset=this._pathLength=0;this._paths=[];this._points=[]}var d=f("../../../../graphics/helper"),b=f("../../../../graphics/types").PointFlags,a=cc.Graphics.Point=cc.Class({name:"cc.GraphicsPoint",extends:cc.Vec2,
ctor:function(a,b){this.reset()},reset:function(){this.len=this.flags=this.dmy=this.dmx=this.dy=this.dx=0}});cc.js.mixin(h.prototype,{reset:function(){this.closed=!1;this.nbevel=0;this.complex=!0;this.points?this.points.length=0:this.points=[]}});cc.js.mixin(e.prototype,{moveTo:function(a,d){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1);this._addPath();this._addPoint(a,d,b.PT_CORNER);this._commandx=a;this._commandy=d},lineTo:function(a,d){this._addPoint(a,d,
b.PT_CORNER);this._commandx=a;this._commandy=d},bezierCurveTo:function(a,g,e,l,f,r){var c=this._curPath;c=c.points[c.points.length-1];c.x!==a||c.y!==g||e!==f||l!==r?(d.tesselateBezier(this,c.x,c.y,a,g,e,l,f,r,0,b.PT_CORNER),this._commandx=f,this._commandy=r):this.lineTo(f,r)},quadraticCurveTo:function(a,b,d,e){var c=this._commandx,g=this._commandy;this.bezierCurveTo(c+2/3*(a-c),g+2/3*(b-g),d+2/3*(a-d),e+2/3*(b-e),d,e)},arc:function(a,b,e,l,f,r){d.arc(this,a,b,e,l,f,r)},ellipse:function(a,b,e,l){d.ellipse(this,
a,b,e,l);this._curPath.complex=!1},circle:function(a,b,e){d.ellipse(this,a,b,e,e);this._curPath.complex=!1},rect:function(a,b,d,e){this.moveTo(a,b);this.lineTo(a,b+e);this.lineTo(a+d,b+e);this.lineTo(a+d,b);this.close();this._curPath.complex=!1},roundRect:function(a,b,e,l,f){d.roundRect(this,a,b,e,l,f);this._curPath.complex=!1},clear:function(a){this._pointsOffset=this._pathOffset=this._pathLength=0;this._curPath=null;a&&(this._paths.length=0,this._points.length=0)},close:function(){this._curPath.closed=
!0},_addPath:function(){var a=this._paths[this._pathLength];return a?a.reset():(a=new h,this._paths.push(a)),this._pathLength++,this._curPath=a,a},_addPoint:function(c,b,d){var g=this._curPath;if(g){var e,k=this._points;g=g.points;(e=k[this._pointsOffset++])?(e.x=c,e.y=b):(e=new a(c,b),k.push(e));e.flags=d;g.push(e)}}});cc.Graphics._Impl=e;n.exports=e},{"../../../../graphics/helper":104,"../../../../graphics/types":106}],189:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,
c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var d=h(f("../../../assembler")),b=h(f("../../../../../renderer/core/input-assembler")),a=f("../../mesh-buffer"),c=f("../../vertex-format").vfmtPosColor,g=f("../../../index"),
k=f("../../../../graphics/graphics"),l=f("../../../../graphics/types").PointFlags,q=k.LineJoin,r=k.LineCap,t=f("./earcut"),p=(f("./impl"),Math.PI),v=Math.min,w=Math.max,E=Math.ceil,x=Math.acos,y=Math.cos,u=Math.sin,B=Math.atan2;f=function(d){function k(a){if(!(this instanceof k))throw new TypeError("Cannot call a class as a function");a=d.call(this,a);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!=typeof a&&"function"!=typeof a?this:
a;return a._buffer=null,a._buffers=[],a._bufferOffset=0,a}return e(k,d),k.prototype.getVfmt=function(){return c},k.prototype.requestBuffer=function(){var d={indiceStart:0,vertexStart:0},e=new a(g._handle,c);d.meshbuffer=e;e=new b.default(e._vb,e._ib);return d.ia=e,this._buffers.push(d),d},k.prototype.getBuffers=function(){return 0===this._buffers.length&&this.requestBuffer(),this._buffers},k.prototype.clear=function(a){this._bufferOffset=0;var c=this._buffers;if(a){a=0;for(var b=c.length;a<b;a++){var d=
c[a];d.meshbuffer.destroy();d.meshbuffer=null}c.length=0}else for(a=0,b=c.length;a<b;a++)d=c[a],d.indiceStart=0,d.vertexStart=0,d.meshbuffer.reset()},k.prototype.fillBuffers=function(a,c){c._flush();c.node=a.node;c.material=a.sharedMaterials[0];a=this.getBuffers();for(var b=0,d=a.length;b<d;b++){var g=a[b],e=g.meshbuffer;g.ia._count=g.indiceStart;c._flushIA(g.ia);e.uploadData()}},k.prototype.genBuffer=function(a,c){var b=this.getBuffers(),d=b[this._bufferOffset],g=d.meshbuffer,e=d.vertexStart+c;return(65535<
e||131070<3*e)&&(++this._bufferOffset,e=c,this._bufferOffset<b.length?d=b[this._bufferOffset]:(d=this.requestBuffer(a),b[this._bufferOffset]=d),g=d.meshbuffer),e>g.vertexOffset&&g.requestStatic(c,3*c),this._buffer=d,d},k.prototype.stroke=function(a){this._curColor=a._strokeColor._val;this._flattenPaths(a._impl);this._expandStroke(a);a._impl._updatePathOffset=!0},k.prototype.fill=function(a){this._curColor=a._fillColor._val;this._expandFill(a);a._impl._updatePathOffset=!0},k.prototype._expandStroke=
function(a){var c=.5*a.lineWidth,b=a.lineCap,d=a.lineJoin,g=a.miterLimit,e=a._impl;var k=2*x(c/(c+e._tessTol));k=w(2,E(p/k));this._calculateJoins(e,c,d,g);g=e._paths;for(var f=0,v=e._pathOffset,t=e._pathLength;v<t;v++){var h=g[v],u=h.points.length;d===q.ROUND?f+=2*(u+h.nbevel*(k+2)+1):f+=2*(u+5*h.nbevel+1);h.closed||(b===r.ROUND?f+=2*(2*k+2):f+=12)}a=this.genBuffer(a,f);v=a.meshbuffer;f=v._vData;v=v._iData;t=e._pathOffset;for(e=e._pathLength;t<e;t++){var m,A=g[t],y=A.points,B=y.length;h=a.vertexStart;
var n=void 0,z=u=void 0,C=void 0;((m=A.closed)?(n=y[B-1],u=y[0],z=0,C=B):(n=y[0],u=y[1],z=1,C=B-1),m)||(B=u.sub(n),B.normalizeSelf(),A=B.x,B=B.y,b===r.BUTT?this._buttCapStart(n,A,B,c,0):b===r.SQUARE?this._buttCapStart(n,A,B,c,c):b===r.ROUND&&this._roundCapStart(n,A,B,c,k));for(;z<C;++z)d===q.ROUND?this._roundJoin(n,u,c,c,k):0!=(u.flags&(l.PT_BEVEL|l.PT_INNERBEVEL))?this._bevelJoin(n,u,c,c):(this._vset(u.x+u.dmx*c,u.y+u.dmy*c),this._vset(u.x-u.dmx*c,u.y-u.dmy*c)),n=u,u=y[z+1];m?(u=3*h,this._vset(f[u],
f[u+1]),this._vset(f[u+3],f[u+4])):(n=u.sub(n),n.normalizeSelf(),y=n.x,n=n.y,b===r.BUTT?this._buttCapEnd(u,y,n,c,0):b===r.SQUARE?this._buttCapEnd(u,y,n,c,c):b===r.ROUND&&this._roundCapEnd(u,y,n,c,k));u=a.indiceStart;h+=2;for(y=a.vertexStart;h<y;h++)v[u++]=h-2,v[u++]=h-1,v[u++]=h;a.indiceStart=u}},k.prototype._expandFill=function(a){for(var c=a._impl,b=c._paths,d=0,g=c._pathOffset,e=c._pathLength;g<e;g++)d+=b[g].points.length;a=this.genBuffer(a,d);g=a.meshbuffer;d=g._vData;g=g._iData;e=c._pathOffset;
for(c=c._pathLength;e<c;e++){var k=b[e],l=k.points,f=l.length;if(0!==f){for(var p=a.vertexStart,q=0;q<f;++q)this._vset(l[q].x,l[q].y);l=a.indiceStart;if(k.complex){k=[];f=p;for(q=a.vertexStart;f<q;f++){var r=3*f;k.push(d[r]);k.push(d[r+1])}k=t(k,null,2);if(!k||0===k.length)continue;f=0;for(q=k.length;f<q;f++)g[l++]=k[f]+p}else for(k=p,p+=2,f=a.vertexStart;p<f;p++)g[l++]=k,g[l++]=p-1,g[l++]=p;a.indiceStart=l}}},k.prototype._calculateJoins=function(a,c,b,d){var g=0;0<c&&(g=1/c);c=a._paths;var e=a._pathOffset;
for(a=a._pathLength;e<a;e++)for(var k=c[e],f=k.points,p=f.length,r=f[p-1],t=f[0],h=k.nbevel=0;h<p;h++){var x;var E=-r.dx;var u=-t.dx;if(t.dmx=.5*(r.dy+t.dy),t.dmy=.5*(E+u),1E-6<(E=t.dmx*t.dmx+t.dmy*t.dmy))u=1/E,600<u&&(u=600),t.dmx*=u,t.dmy*=u;0<t.dx*r.dy-r.dx*t.dy&&(0,t.flags|=l.PT_LEFT);1>E*(x=w(11,v(r.len,t.len)*g))*x&&(t.flags|=l.PT_INNERBEVEL);t.flags&l.PT_CORNER&&(1>E*d*d||b===q.BEVEL||b===q.ROUND)&&(t.flags|=l.PT_BEVEL);0!=(t.flags&(l.PT_BEVEL|l.PT_INNERBEVEL))&&k.nbevel++;r=t;t=f[h+1]}},k.prototype._flattenPaths=
function(a){var c=a._paths,b=a._pathOffset;for(a=a._pathLength;b<a;b++){var d=c[b],g=d.points,e=g[g.length-1],k=g[0];e.equals(k)&&(d.closed=!0,g.pop(),e=g[g.length-1]);d=0;for(var l=g.length;d<l;d++){var f=k.sub(e);e.len=f.mag();(f.x||f.y)&&f.normalizeSelf();e.dx=f.x;e.dy=f.y;e=k;k=g[d+1]}}},k.prototype._chooseBevel=function(a,c,b,d){var g=b.x,e=b.y,k=void 0,l=void 0,f=void 0,p=void 0;return 0!==a?(k=g+c.dy*d,l=e-c.dx*d,f=g+b.dy*d,p=e-b.dx*d):(k=f=g+b.dmx*d,l=p=e+b.dmy*d),[k,l,f,p]},k.prototype._buttCapStart=
function(a,c,b,d,g){var e=a.x-c*g;a=a.y-b*g;c=-c;this._vset(e+b*d,a+c*d);this._vset(e-b*d,a-c*d)},k.prototype._buttCapEnd=function(a,c,b,d,g){var e=a.x+c*g;a=a.y+b*g;c=-c;this._vset(e+b*d,a+c*d);this._vset(e-b*d,a-c*d)},k.prototype._roundCapStart=function(a,c,b,d,g){var e=a.x;a=a.y;for(var k=-c,l=0;l<g;l++){var f=l/(g-1)*p,q=y(f)*d;f=u(f)*d;this._vset(e-b*q-c*f,a-k*q-b*f);this._vset(e,a)}this._vset(e+b*d,a+k*d);this._vset(e-b*d,a-k*d)},k.prototype._roundCapEnd=function(a,c,b,d,g){var e=a.x;a=a.y;
var k=-c;this._vset(e+b*d,a+k*d);this._vset(e-b*d,a-k*d);for(var l=0;l<g;l++){var f=l/(g-1)*p,q=y(f)*d;f=u(f)*d;this._vset(e,a);this._vset(e-b*q+c*f,a-k*q+b*f)}},k.prototype._roundJoin=function(a,c,b,d,g){var e=a.dy,k=-a.dx,f=c.dy,q=-c.dx,r=c.x,v=c.y;if(0!=(c.flags&l.PT_LEFT)){a=this._chooseBevel(c.flags&l.PT_INNERBEVEL,a,c,b);var t=a[0],h=a[1];b=a[2];a=a[3];var w=B(-k,-e),x=B(-q,-f);x>w&&(x-=2*p);this._vset(t,h);this._vset(r-e*d,c.y-k*d);e=E((w-x)/p)*g;g=2>e?2:e>g?g:e;for(e=0;e<g;e++)c=w+e/(g-1)*
(x-w),k=r+y(c)*d,c=v+u(c)*d,this._vset(r,v),this._vset(k,c);this._vset(b,a);this._vset(r-f*d,v-q*d)}else{w=this._chooseBevel(c.flags&l.PT_INNERBEVEL,a,c,-d);t=w[0];h=w[1];a=w[2];w=w[3];x=B(k,e);c=B(q,f);c<x&&(c+=2*p);this._vset(r+e*d,v+k*d);this._vset(t,h);e=E((c-x)/p)*g;g=2>e?2:e>g?g:e;for(e=0;e<g;e++)t=x+e/(g-1)*(c-x),k=r+y(t)*b,t=v+u(t)*b,this._vset(k,t),this._vset(r,v);this._vset(r+f*d,v+q*d);this._vset(a,w)}},k.prototype._bevelJoin=function(a,c,b,d){var g=a.dy,e=-a.dx,k=c.dy,f=-c.dx;if(c.flags&
l.PT_LEFT){var p=this._chooseBevel(c.flags&l.PT_INNERBEVEL,a,c,b);b=p[0];a=p[1];var q=p[2];p=p[3];this._vset(b,a);this._vset(c.x-g*d,c.y-e*d);this._vset(q,p);this._vset(c.x-k*d,c.y-f*d)}else p=this._chooseBevel(c.flags&l.PT_INNERBEVEL,a,c,-d),d=p[0],a=p[1],q=p[2],p=p[3],this._vset(c.x+g*b,c.y+e*b),this._vset(d,a),this._vset(c.x+k*b,c.y+f*b),this._vset(q,p)},k.prototype._vset=function(a,c){var b=this._buffer,d=b.meshbuffer,g=3*b.vertexStart,e=d._vData,k=d._uintVData;e[g]=a;e[g+1]=c;k[g+2]=this._curColor;
b.vertexStart++;d._dirty=!0},k}(d.default);m.default=f;d.default.register(cc.Graphics,f);n.exports=m.default},{"../../../../../renderer/core/input-assembler":270,"../../../../graphics/graphics":103,"../../../../graphics/types":106,"../../../assembler":158,"../../../index":178,"../../mesh-buffer":204,"../../vertex-format":209,"./earcut":187,"./impl":188}],190:[function(f,n,m){cc.assemblers={};f("./sprite");f("./mask-assembler");f("./graphics");f("./label");f("./motion-streak")},{"./graphics":189,"./label":194,
"./mask-assembler":195,"./motion-streak":void 0,"./sprite":202}],191:[function(f,n,m){function h(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);d.prototype=Object.create(b&&b.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(d,b):d.__proto__=b)}m.__esModule=!0;m.default=void 0;var e=0;f=function(d){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");
var a=d.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return h(b,d),b.prototype.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt())},b.prototype._reserveQuads=function(a,c){a=4*c;c*=6;var b=this._renderData._flexBuffer;b.reserve(a,c);b.used(a,c);a=this._renderData.iDatas[0];for(var d=b=0;b<c;b+=6,d+=4)a[b]=d,a[b+1]=d+1,a[b+2]=d+2,a[b+3]=d+1,a[b+4]=
d+3,a[b+5]=d+2;e=0},b.prototype._quadsUpdated=function(a){e=0;this._renderData._flexBuffer.used(this.verticesCount,this.indicesCount)},b.prototype._getColor=function(a){return a.node._color._val},b.prototype.appendQuad=function(a,c,b,d,l,f,r){var g=this._renderData,k=g.vDatas[0];g=g.uintVDatas[0];this.verticesCount+=4;this.indicesCount=this.verticesCount/2*3;var q=c.width,h=c.height,E=b.width,x=b.height;c=this._getColor(a);var m=void 0,u=void 0,B=void 0,n=void 0,z=this.floatsPerVert,A=e+this.uvOffset;
d?(m=b.x/q,B=(b.x+x)/q,u=(b.y+E)/h,n=b.y/h,k[A]=m,k[A+1]=n,k[A+=z]=m,k[A+1]=u,k[A+=z]=B,k[A+1]=n,k[A+=z]=B,k[A+1]=u):(m=b.x/q,B=(b.x+E)/q,u=(b.y+x)/h,n=b.y/h,k[A]=m,k[A+1]=u,k[A+=z]=B,k[A+1]=u,k[A+=z]=m,k[A+1]=n,k[A+=z]=B,k[A+1]=n);this.appendVerts(a,e,l,l+E*r,f-x*r,f);a=e+this.colorOffset;for(b=0;4>b;b++)g[a]=c,a+=z;e+=4*this.floatsPerVert},b.prototype.appendVerts=function(a,c,b,d,e,f){a=this._local;var g=this.floatsPerVert;a[c]=b;a[c+1]=e;a[c+=g]=d;a[c+1]=e;a[c+=g]=b;a[c+1]=f;a[c+=g]=d;a[c+1]=f},
b.prototype.updateWorldVerts=function(a){var c=a.node._worldMatrix.m;a=c[0];var b=c[1],d=c[4],e=c[5],f=c[12];c=c[13];for(var r=this._local,t=this._renderData.vDatas[0],p=this.floatsPerVert,v=0;v<r.length;v+=p){var h=r[v],E=r[v+1];t[v]=h*a+E*d+f;t[v+1]=h*b+E*e+c}},b}(function(d){return d&&d.__esModule?d:{default:d}}(f("../../../../utils/label/bmfont")).default);m.default=f;n.exports=m.default},{"../../../../utils/label/bmfont":182}],192:[function(f,n,m){function h(d,b){if("function"!=typeof b&&null!==
b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);d.prototype=Object.create(b&&b.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(d,b):d.__proto__=b)}m.__esModule=!0;f("../../../../../platform/js");f("./bmfont");f=f("../../../../utils/label/letter-font");var e=cc.color(255,255,255,255);f=function(d){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");
var a=d.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return h(b,d),b.prototype.createData=function(a){return a.requestRenderData()},b.prototype._getColor=function(a){return e._fastSetA(a.node._color.a),e._val},b.prototype.updateColor=function(a){var c=this._getColor(a);d.prototype.updateColor.call(this,a,c)},b}(f);m.default=f;n.exports=m.default},{"../../../../../platform/js":150,
"../../../../utils/label/letter-font":184,"./bmfont":191}],193:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var e=function(a){return a&&a.__esModule?a:{default:a}}(f("../../../../utils/label/ttf")),
d=f("../../../../../components/CCLabelShadow"),b=cc.color(255,255,255,255);f=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var b=a.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(c,a),c.prototype.updateUVs=function(a){var c=this._renderData.vDatas[0];a=a._frame.uv;for(var b=this.uvOffset,d=this.floatsPerVert,
g=0;4>g;g++){var e=2*g,f=d*g+b;c[f]=a[e];c[f+1]=a[e+1]}},c.prototype.updateColor=function(c){b._fastSetA(c.node._color.a);a.prototype.updateColor.call(this,c,b._val)},c.prototype.updateVerts=function(a){var c=a._fontSizeScale||1,b=a.node,g=a._ttfTexture.width,e=a._ttfTexture.height;g/=c;e/=c;var f=b.anchorX*(1<c?Math.max(b.width,g):b.width);c=b.anchorY*(1<c?Math.max(b.height,e):b.height);var p=d&&a.getComponent(d);if(p&&p._enabled){var v=(g-b.width)/2,h=(e-b.height)/2;p=p.offset;-p.x>v?f+=g-b.width:
v>p.x&&(f+=v-p.x);-p.y>h?c+=e-b.height:h>p.y&&(c+=h-p.y)}b=this._local;b[0]=-f;b[1]=-c;b[2]=g-f;b[3]=e-c;this.updateUVs(a);this.updateWorldVerts(a)},c}(e.default);m.default=f;n.exports=m.default},{"../../../../../components/CCLabelShadow":68,"../../../../utils/label/ttf":185}],194:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}n=h(f("../../../assembler"));var e=h(f("../../../../components/CCLabel")),d=h(f("./2d/ttf")),b=h(f("./2d/bmfont")),a=h(f("./2d/letter")),c=h(f("./3d/ttf")),
g=h(f("./3d/bmfont")),k=h(f("./3d/letter"));e.default._canvasPool={pool:[],get:function(){var a=this.pool.pop();a||(a=document.createElement("canvas"),a={canvas:a,context:a.getContext("2d")});return a},put:function(a){32<=this.pool.length||this.pool.push(a)}};n.default.register(cc.Label,{getConstructor:function(l){var f=l.node.is3DNode,r=f?c.default:d.default;return l.font instanceof cc.BitmapFont?r=f?g.default:b.default:l.cacheMode===e.default.CacheMode.CHAR&&(cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT_GAME_SUB?
cc.warn("sorry, subdomain does not support CHAR mode currently!"):r=f?k.default:a.default),r},TTF:d.default,Bmfont:b.default,Letter:a.default,TTF3D:c.default,Bmfont3D:g.default,Letter3D:k.default})},{"../../../../components/CCLabel":66,"../../../assembler":158,"./2d/bmfont":191,"./2d/letter":192,"./2d/ttf":193,"./3d/bmfont":void 0,"./3d/letter":void 0,"./3d/ttf":void 0}],195:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}function e(a){for(var c=g.DS_FUNC_EQUAL,b=g.STENCIL_OP_KEEP,d,e=d=0;e<l.length;++e)d+=1<<e;e=l[l.length-1];e._enableMaterial.effect.setStencil(g.STENCIL_ENABLE,c,d,d,b,g.STENCIL_OP_KEEP,g.STENCIL_OP_KEEP,1<<l.length-1);a._flushMaterial(e._enableMaterial)}m.__esModule=!0;m.MaskAssembler=void 0;n=function(a){return a&&
a.__esModule?a:{default:a}}(f("../../assembler"));var d=f("../../../components/CCMask"),b=f("../../render-flow"),a=f("./sprite/2d/simple"),c=f("./graphics"),g=f("../../../../renderer/gfx"),k=f("../vertex-format").vfmtPos,l=[];f=m.MaskAssembler=function(f){function q(){if(!(this instanceof q))throw new TypeError("Cannot call a class as a function");var a=f.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&
"function"!=typeof a?this:a}return h(q,f),q.prototype.updateRenderData=function(b){b._type===d.Type.IMAGE_STENCIL?b.spriteFrame?a.prototype.updateRenderData.call(this,b):b.setMaterial(0,null):(b._graphics.setMaterial(0,b.sharedMaterials[0]),c.prototype.updateRenderData.call(b._graphics._assembler,b._graphics,b._graphics))},q.prototype.fillBuffers=function(f,p){if(f._type!==d.Type.IMAGE_STENCIL||f.spriteFrame){8<l.length+1&&cc.errorID(9E3,8);l.push(f);var q=1<<l.length-1;f._clearMaterial.effect.setStencil(g.STENCIL_ENABLE,
g.DS_FUNC_NEVER,q,q,f.inverted?g.STENCIL_OP_REPLACE:g.STENCIL_OP_ZERO,g.STENCIL_OP_KEEP,g.STENCIL_OP_KEEP,q);var r=p.getBuffer("mesh",k),h=r.request(4,6);q=h.indiceOffset;var t=h.byteOffset>>2;h=h.vertexOffset;var m=r._vData;r=r._iData;m[t++]=-1;m[t++]=-1;m[t++]=-1;m[t++]=1;m[t++]=1;m[t++]=1;m[t++]=1;m[t++]=-1;r[q++]=h;r[q++]=h+3;r[q++]=h+1;r[q++]=h+1;r[q++]=h+3;r[q++]=h+2;p.node=p._dummyNode;p.material=f._clearMaterial;p._flush();q=1<<l.length-1;f.sharedMaterials[0].effect.setStencil(g.STENCIL_ENABLE,
g.DS_FUNC_NEVER,q,q,f.inverted?g.STENCIL_OP_ZERO:g.STENCIL_OP_REPLACE,g.STENCIL_OP_KEEP,g.STENCIL_OP_KEEP,q);p.material=f.sharedMaterials[0];f._type===d.Type.IMAGE_STENCIL?(p.node=p._dummyNode,a.prototype.fillBuffers.call(f._assembler,f,p),p._flush()):(p.node=f.node,c.prototype.fillBuffers.call(f._graphics._assembler,f._graphics,p));e(p)}f.node._renderFlag|=b.FLAG_UPDATE_RENDER_DATA},q.prototype.postFillBuffers=function(a,c){if(a._type!==d.Type.IMAGE_STENCIL||a.spriteFrame)0===l.length&&cc.errorID(9001),
l.pop(),0===l.length?c._flushMaterial(a._exitMaterial):e(c);a.node._renderFlag|=b.FLAG_UPDATE_RENDER_DATA},q}(a);n.default.register(d,f)},{"../../../../renderer/gfx":280,"../../../components/CCMask":70,"../../assembler":158,"../../render-flow":179,"../vertex-format":209,"./graphics":189,"./sprite/2d/simple":199}],196:[function(f,n,m){function h(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&
a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}m.__esModule=!0;m.default=void 0;var e=function(b){return b&&b.__esModule?b:{default:b}}(f("../../../../assembler-2d")),d=f("../../../../../components/CCSprite").FillType;f=function(b){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");var c=b.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!c||"object"!=typeof c&&"function"!=typeof c?this:c}return h(a,b),a.prototype.updateRenderData=function(a){var c=a._spriteFrame;if(c&&(this.packToDynamicAtlas(a,c),a._vertsDirty)){c=a._fillStart;var b=a._fillRange;0>b&&(c+=b,b=-b);b=c+b;c=0>(c=1<c?1:c)?0:c;b=0>(b=1<b?1:b)?0:b;var d=c+(0>(b-=c)?0:b);d=1<d?1:d;this.updateUVs(a,c,d);this.updateVerts(a,c,d);a._vertsDirty=!1}},a.prototype.updateUVs=function(a,b,e){var c=a._spriteFrame,g=c._texture.width,k=c._texture.height,f=c._rect,p=void 0,v=void 0,
h=void 0,E=void 0,x=void 0,m=void 0,u=void 0,B=void 0,n=void 0,z=void 0;c._rotated?(p=f.x/g,v=(f.y+f.width)/k,h=x=p,u=n=(f.x+f.height)/g,m=z=v,E=B=f.y/k):(p=f.x/g,v=(f.y+f.height)/k,h=u=p,x=n=(f.x+f.width)/g,E=m=v,B=z=f.y/k);c=this._renderData.vDatas[0];g=this.uvOffset;k=this.floatsPerVert;switch(a._fillType){case d.HORIZONTAL:c[g]=h+(x-h)*b;c[g+1]=E+(m-E)*b;c[g+k]=h+(x-h)*e;c[g+k+1]=E+(m-E)*e;c[g+2*k]=u+(n-u)*b;c[g+2*k+1]=B+(z-B)*b;c[g+3*k]=u+(n-u)*e;c[g+3*k+1]=B+(z-B)*e;break;case d.VERTICAL:c[g]=
h+(u-h)*b;c[g+1]=E+(B-E)*b;c[g+k]=x+(n-x)*b;c[g+k+1]=m+(z-m)*b;c[g+2*k]=h+(u-h)*e;c[g+2*k+1]=E+(B-E)*e;c[g+3*k]=x+(n-x)*e;c[g+3*k+1]=m+(z-m)*e;break;default:cc.errorID(2626)}},a.prototype.updateVerts=function(a,b,e){var c=a.node,g=c.width,k=c.height,f=c.anchorX*g,p=c.anchorY*k;c=-f;var v=-p;g-=f;k-=p;switch(a._fillType){case d.HORIZONTAL:e=c+(g-c)*e;c+=(g-c)*b;g=e;break;case d.VERTICAL:e=v+(k-v)*e;v+=(k-v)*b;k=e;break;default:cc.errorID(2626)}b=this._local;b[0]=c;b[1]=v;b[2]=g;b[3]=k;this.updateWorldVerts(a)},
a}(e.default);m.default=f;n.exports=m.default},{"../../../../../components/CCSprite":79,"../../../../assembler-2d":156}],197:[function(f,n,m){function h(e,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);e.prototype=Object.create(d&&d.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(e,d):e.__proto__=d)}m.__esModule=!0;m.default=void 0;f=function(e){function d(){if(!(this instanceof
d))throw new TypeError("Cannot call a class as a function");var b=e.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(d,e),d.prototype.initData=function(b){this._renderData.createFlexData(0,4,6,this.getVfmt())},d.prototype.updateRenderData=function(b){this.packToDynamicAtlas(b,b._spriteFrame);var a=b.spriteFrame;if(a&&(a=a.vertices)){this.verticesCount=a.x.length;this.indicesCount=
a.triangles.length;var c=this._renderData._flexBuffer;c.reserve(this.verticesCount,this.indicesCount)&&(this.updateColor(b),b._vertsDirty=!0);c.used(this.verticesCount,this.indicesCount);this.updateIndices(a.triangles);b._vertsDirty&&(this.updateUVs(b),this.updateVerts(b),this.updateWorldVerts(b),b._vertsDirty=!1)}},d.prototype.updateIndices=function(b){this._renderData.iDatas[0].set(b)},d.prototype.updateUVs=function(b){var a=b.spriteFrame.vertices;b=a.nu;a=a.nv;for(var c=this.uvOffset,d=this.floatsPerVert,
e=this._renderData.vDatas[0],l=0;l<b.length;l++){var f=d*l+c;e[f]=b[l];e[f+1]=a[l]}},d.prototype.updateVerts=function(b){var a=b.node,c=Math.abs(a.width),d=Math.abs(a.height),e=a.anchorX*c;a=a.anchorY*d;var l=b.spriteFrame,f=l.vertices,r=f.x;f=f.y;var h=l._originalSize.width,p=l._originalSize.height,v=l._rect.width,w=l._rect.height,E=l._offset.x+(h-v)/2;l=l._offset.y+(p-w)/2;c/=b.trim?v:h;d/=b.trim?w:p;w=this._local;if(b.trim)for(b=0,h=r.length;b<h;b++)v=2*b,w[v]=(r[b]-E)*c-e,w[v+1]=(p-f[b]-l)*d-
a;else for(E=0,b=r.length;E<b;E++)l=2*E,w[l]=r[E]*c-e,w[l+1]=(p-f[E])*d-a},d.prototype.updateWorldVerts=function(b){var a=b.node._worldMatrix.m;b=a[0];var c=a[1],d=a[4],e=a[5],l=a[12];a=a[13];for(var f=this._local,r=this._renderData.vDatas[0],h=this.floatsPerVert,p=0,v=this.verticesCount;p<v;p++){var w=f[2*p],E=f[2*p+1];r[h*p]=w*b+E*d+l;r[h*p+1]=w*c+E*e+a}},d}(function(e){return e&&e.__esModule?e:{default:e}}(f("../../../../assembler-2d")).default);m.default=f;n.exports=m.default},{"../../../../assembler-2d":156}],
198:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}function e(a,c,b,d,g,e,k){var l=Math.sin(e),f=Math.cos(e),p;if(0!==Math.cos(e)){if(p=l/f,0<(a-g.x)*f){var q=g.y+p*(a-g.x);k[0].x=a;k[0].y=q}0<(c-g.x)*f&&(a=g.y+p*(c-
g.x),k[2].x=c,k[2].y=a)}if(0!==Math.sin(e)){if(c=f/l,0<(d-g.y)*l)k[3].x=g.x+c*(d-g.y),k[3].y=d;0<(b-g.y)*l&&(k[1].x=g.x+c*(b-g.y),k[1].y=b)}}function d(a,c){var b,d;if(b=c.x-a.x,d=c.y-a.y,0!==b||0!==d){if(0===b)return 0<d?.5*Math.PI:1.5*Math.PI;a=Math.atan(d/b);return 0>b&&(a+=Math.PI),a}}m.__esModule=!0;m.default=void 0;f=function(a){return a&&a.__esModule?a:{default:a}}(f("../../../../assembler-2d"));var b=2*Math.PI,a=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],c=[0,0,0,0],g=[0,0,0,0,0,0,0,0],
k=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],l=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],q=cc.v2(0,0),r=[];f=function(f){function p(){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");var a=f.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?this:a}return h(p,f),p.prototype.initData=function(a){this._renderData.createFlexData(0,4,6,this.getVfmt());
this.updateIndices()},p.prototype.updateRenderData=function(d){f.prototype.updateRenderData.call(this,d);var p=d.spriteFrame;if(p&&(this.packToDynamicAtlas(d,p),d._vertsDirty)){var h=d._fillStart,v=d._fillRange;for(0>v&&(h+=v,v=-v);1<=h;)--h;for(;0>h;)h+=1;h*=b;v*=b;var t=d.node,u=t.width,m=t.height,n=t.anchorX*u,z=t.anchorY*m;t=-n;var A=-z;u-=n;m-=z;c[0]=t;c[1]=A;c[2]=u;c[3]=m;z=d._fillCenter;n=q.x=Math.min(Math.max(0,z.x),1)*(u-t)+t;z=q.y=Math.min(Math.max(0,z.y),1)*(m-A)+A;a[0].x=a[3].x=t;a[1].x=
a[2].x=u;a[0].y=a[1].y=A;a[2].y=a[3].y=m;r.length=0;n!==c[0]&&(r[0]=[3,0]);n!==c[2]&&(r[2]=[1,2]);z!==c[1]&&(r[1]=[0,1]);z!==c[3]&&(r[3]=[2,3]);t=p._texture.width;A=p._texture.height;u=p._rect;var D=z=n=m=void 0;p._rotated?(m=u.x/t,n=(u.x+u.height)/t,z=u.y/A,D=(u.y+u.width)/A,g[0]=g[2]=m,g[4]=g[6]=n,g[3]=g[7]=D,g[1]=g[5]=z):(m=u.x/t,n=(u.x+u.width)/t,z=u.y/A,D=(u.y+u.height)/A,g[0]=g[4]=m,g[2]=g[6]=n,g[1]=g[3]=D,g[5]=g[7]=z);e(c[0],c[2],c[1],c[3],q,h,k);e(c[0],c[2],c[1],c[3],q,h+v,l);this.updateVerts(d,
h,v);d._vertsDirty=!1}},p.prototype.updateVerts=function(c,g,e){for(var f=g+e,p=this._local,h=0,v=3*this.floatsPerVert,t=0;4>t;++t){var w=r[t];if(w)if(e>=b)p.length=h+v,this._generateTriangle(p,h,q,a[w[0]],a[w[1]]),h+=v;else{var E=d(q,a[w[0]]),m=d(q,a[w[1]]);m<E&&(m+=b);E-=b;m-=b;for(var n=0;3>n;++n)E>=f||(E>=g?(p.length=h+v,m>=f?this._generateTriangle(p,h,q,a[w[0]],l[t]):this._generateTriangle(p,h,q,a[w[0]],a[w[1]]),h+=v):m<=g||(m<=f?(p.length=h+v,this._generateTriangle(p,h,q,k[t],a[w[1]]),h+=v):
(p.length=h+v,this._generateTriangle(p,h,q,k[t],l[t]),h+=v))),E+=b,m+=b}}this.allocWorldVerts(c);this.updateWorldVerts(c)},p.prototype.allocWorldVerts=function(a){a=a.node._color._val;var c=this._renderData,b=this.floatsPerVert,d=this._local,g=d.length/b;this.verticesCount=this.indicesCount=g;var e=c._flexBuffer;e.reserve(g,g)&&this.updateIndices();e.used(this.verticesCount,this.indicesCount);g=c.vDatas[0];c=c.uintVDatas[0];e=this.uvOffset;for(var k=0;k<d.length;k+=b){var l=k+e;g[l]=d[l];g[l+1]=d[l+
1];c[l+2]=a}},p.prototype.updateIndices=function(){for(var a=this._renderData.iDatas[0],c=0;c<a.length;c++)a[c]=c},p.prototype.updateWorldVerts=function(a){var c=a.node._worldMatrix.m;a=c[0];var b=c[1],d=c[4],g=c[5],e=c[12];c=c[13];for(var k=this._local,l=this._renderData.vDatas[0],f=this.floatsPerVert,p=0;p<k.length;p+=f){var q=k[p],r=k[p+1];l[p]=q*a+r*d+e;l[p+1]=q*b+r*g+c}},p.prototype._generateTriangle=function(a,b,d,g,e){var k=c[0],l=c[1],f=c[2],p=c[3],q=this.floatsPerVert;a[b]=d.x;a[b+1]=d.y;
a[b+q]=g.x;a[b+q+1]=g.y;a[b+2*q]=e.x;a[b+2*q+1]=e.y;var r=this.uvOffset;var h=(d.x-k)/(f-k);d=(d.y-l)/(p-l);this._generateUV(h,d,a,b+r);h=(g.x-k)/(f-k);d=(g.y-l)/(p-l);this._generateUV(h,d,a,b+q+r);h=(e.x-k)/(f-k);d=(e.y-l)/(p-l);this._generateUV(h,d,a,b+2*q+r)},p.prototype._generateUV=function(a,c,b,d){var e=g[0]+(g[2]-g[0])*a,k=g[1]+(g[3]-g[1])*a,l=g[5]+(g[7]-g[5])*a;b[d]=e+(g[4]+(g[6]-g[4])*a-e)*c;b[d+1]=k+(l-k)*c},p}(f.default);m.default=f;n.exports=m.default},{"../../../../assembler-2d":156}],
199:[function(f,n,m){function h(e,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);e.prototype=Object.create(d&&d.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(e,d):e.__proto__=d)}m.__esModule=!0;m.default=void 0;f=function(e){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b=e.apply(this,arguments);
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(d,e),d.prototype.updateRenderData=function(b){var a=b._spriteFrame;a&&(this.packToDynamicAtlas(b,a),b._vertsDirty&&(this.updateUVs(b),this.updateVerts(b),b._vertsDirty=!1))},d.prototype.updateUVs=function(b){b=b._spriteFrame.uv;for(var a=this.uvOffset,c=this.floatsPerVert,d=this._renderData.vDatas[0],e=0;4>e;e++){var l=2*e,f=c*e+a;d[f]=b[l];
d[f+1]=b[l+1]}},d.prototype.updateVerts=function(b){var a=b.node,c=a.width,d=a.height,e=a.anchorX*c;a=a.anchorY*d;if(b.trim){var l=-e;var f=-a;c-=e;d-=a}else{var r=b.spriteFrame;l=r._originalSize.width;var h=r._originalSize.height;f=r._rect.width;var p=r._rect.height;r=r._offset;var v=c/l,w=d/h,E=r.x-(l-f)/2;l=(r.x+(l-f)/2)*v-e;f=(r.y+(h-p)/2)*w-a;c=c+E*v-e;d=d+(r.y-(h-p)/2)*w-a}e=this._local;e[0]=l;e[1]=f;e[2]=c;e[3]=d;this.updateWorldVerts(b)},d}(function(e){return e&&e.__esModule?e:{default:e}}(f("../../../../assembler-2d")).default);
m.default=f;n.exports=m.default},{"../../../../assembler-2d":156}],200:[function(f,n,m){function h(e,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);e.prototype=Object.create(d&&d.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(e,d):e.__proto__=d)}m.__esModule=!0;m.default=void 0;f=function(e){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var b=e.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(d,e),d.prototype.initData=function(b){if(!(0<this._renderData.meshCount)){this._renderData.createData(0,this.verticesFloats,this.indicesCount);b=this._renderData.iDatas[0];for(var a=0,c=0;3>c;++c)for(var d=0;3>d;++d){var e=4*c+d;b[a++]=e;b[a++]=e+1;b[a++]=e+4;b[a++]=e+1;b[a++]=e+5;b[a++]=e+4}}},d.prototype.initLocal=
function(){this._local=[];this._local.length=8},d.prototype.updateRenderData=function(b){var a=b._spriteFrame;a&&(this.packToDynamicAtlas(b,a),b._vertsDirty&&(this.updateUVs(b),this.updateVerts(b),b._vertsDirty=!1))},d.prototype.updateVerts=function(b){var a=b.node,c=a.width,d=a.height,e=a.anchorX*c;a=a.anchorY*d;var l=b.spriteFrame,f=l.insetLeft,r=l.insetRight,h=l.insetTop;l=l.insetBottom;var p=c-f-r,v=d-h-l;r=c/(f+r);h=d/(h+l);r=isNaN(r)||1<r?1:r;h=isNaN(h)||1<h?1:h;var w=this._local;w[0]=-e;w[1]=
-a;w[2]=f*r-e;w[3]=l*h-a;w[4]=w[2]+(0>p?0:p);w[5]=w[3]+(0>v?0:v);w[6]=c-e;w[7]=d-a;this.updateWorldVerts(b)},d.prototype.updateUVs=function(b){var a=this._renderData.vDatas[0];b=b.spriteFrame.uvSliced;for(var c=this.uvOffset,d=this.floatsPerVert,e=0;4>e;++e)for(var l=0;4>l;++l){var f=4*e+l,r=b[f];f*=d;a[f+c]=r.u;a[f+c+1]=r.v}},d.prototype.updateWorldVerts=function(b){var a=b.node._worldMatrix.m;b=a[0];var c=a[1],d=a[4],e=a[5],f=a[12];a=a[13];for(var q=this._local,r=this._renderData.vDatas[0],h=this.floatsPerVert,
p=0;4>p;++p)for(var v=q[2*p+1],w=0;4>w;++w){var E=q[2*w],x=(4*p+w)*h;r[x]=E*b+v*d+f;r[x+1]=E*c+v*e+a}},d}(function(e){return e&&e.__esModule?e:{default:e}}(f("../../../../assembler-2d")).default);m.default=f;Object.assign(f.prototype,{verticesCount:16,indicesCount:54});n.exports=m.default},{"../../../../assembler-2d":156}],201:[function(f,n,m){function h(e,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+typeof d);e.prototype=Object.create(d&&
d.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});d&&(Object.setPrototypeOf?Object.setPrototypeOf(e,d):e.__proto__=d)}m.__esModule=!0;m.default=void 0;f=function(e){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b=e.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(d,e),d.prototype.initData=
function(b){this.col=this.row=this.vRepeat=this.hRepeat=this.rectHeight=this.rectWidth=this.contentHeight=this.contentWidth=this.verticesCount=0;this._renderData.createFlexData(0,4,6,this.getVfmt());this._updateIndices()},d.prototype.initLocal=function(){this._local={x:[],y:[]}},d.prototype._updateIndices=function(){for(var b=this._renderData.iDatas[0],a=0,c=0,d=b.length;a<d;a+=6,c+=4)b[a]=c,b[a+1]=c+1,b[a+2]=c+2,b[a+3]=c+1,b[a+4]=c+3,b[a+5]=c+2},d.prototype.updateRenderData=function(b){var a=b._spriteFrame;
if(a){this.packToDynamicAtlas(b,a);var c=b.node,d=this.contentWidth=Math.abs(c.width);c=this.contentHeight=Math.abs(c.height);var e=a._rect;a=this.rectWidth=e.width;e=this.rectHeight=e.height;d=this.hRepeat=d/a;c=this.vRepeat=c/e;d=(this.row=Math.ceil(c))*(this.col=Math.ceil(d));this.verticesCount=4*d;this.indicesCount=6*d;d=this._renderData._flexBuffer;d.reserve(this.verticesCount,this.indicesCount)&&(this._updateIndices(),this.updateColor(b));d.used(this.verticesCount,this.indicesCount);b._vertsDirty&&
(this.updateUVs(b),this.updateVerts(b),b._vertsDirty=!1)}},d.prototype.updateVerts=function(b){var a=b.node,c=a.anchorX*a.width;a=a.anchorY*a.height;var d=this.row,e=this.col,f=this.rectWidth,q=this.rectHeight,r=this.contentWidth,h=this.contentHeight,p=this._local,v=p.x;p=p.y;for(var w=v.length=p.length=0;w<=e;++w)v[w]=Math.min(f*w,r)-c;for(c=0;c<=d;++c)p[c]=Math.min(q*c,h)-a;this.updateWorldVerts(b)},d.prototype.updateWorldVerts=function(b){var a=this._local,c=a.x;a=a.y;var d=this._renderData.vDatas[0],
e=this.col,f=b.node._worldMatrix.m;b=f[0];var q=f[1],r=f[4],h=f[5],p=f[12];f=f[13];for(var v,w,E,x,m=this.floatsPerVert,u=0,B=0,n=this.row;B<n;++B){E=a[B];x=a[B+1];for(var z=0,A=e;z<A;++z)v=c[z],w=c[z+1],d[u]=v*b+E*r+p,d[u+1]=v*q+E*h+f,d[u+=m]=w*b+E*r+p,d[u+1]=w*q+E*h+f,d[u+=m]=v*b+x*r+p,d[u+1]=v*q+x*h+f,d[u+=m]=w*b+x*r+p,d[u+1]=w*q+x*h+f,u+=m}},d.prototype.updateUVs=function(b){var a=this._renderData.vDatas[0];if(a){var c=this.col,d=this.hRepeat,e=this.vRepeat,f=b.spriteFrame.uv;b=b.spriteFrame._rotated;
for(var q=this.floatsPerVert,r=this.uvOffset,h=0,p=this.row;h<p;++h)for(var v=Math.min(1,e-h),w=0,E=c;w<E;++w){var x=Math.min(1,d-w);b?(a[r]=f[0],a[r+1]=f[1],a[r+=q]=f[0],a[r+1]=f[1]+(f[7]-f[1])*x,a[r+=q]=f[0]+(f[6]-f[0])*v,a[r+1]=f[1],a[r+=q]=a[r-q],a[r+1]=a[r+1-2*q],r+=q):(a[r]=f[0],a[r+1]=f[1],a[r+=q]=f[0]+(f[6]-f[0])*x,a[r+1]=f[1],a[r+=q]=f[0],a[r+1]=f[1]+(f[7]-f[1])*v,a[r+=q]=a[r-2*q],a[r+1]=a[r+1-q],r+=q)}}},d}(function(e){return e&&e.__esModule?e:{default:e}}(f("../../../../assembler-2d")).default);
m.default=f;n.exports=m.default},{"../../../../assembler-2d":156}],202:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}n=h(f("../../../assembler"));var e=f("../../../../components/CCSprite"),d=h(f("./2d/simple")),b=h(f("./2d/sliced")),a=h(f("./2d/tiled")),c=h(f("./2d/radial-filled")),g=h(f("./2d/bar-filled")),k=h(f("./2d/mesh")),l=h(f("./3d/simple")),q=h(f("./3d/sliced")),r=h(f("./3d/tiled")),t=h(f("./3d/radial-filled")),p=h(f("./3d/bar-filled")),v=h(f("./3d/mesh"));n.default.register(cc.Sprite,
{getConstructor:function(f){var h=f.node.is3DNode,w=h?l.default:d.default;switch(f.type){case e.Type.SLICED:w=h?q.default:b.default;break;case e.Type.TILED:w=h?r.default:a.default;break;case e.Type.FILLED:w=f._fillType===e.FillType.RADIAL?h?t.default:c.default:h?p.default:g.default;break;case e.Type.MESH:w=h?v.default:k.default}return w},Simple:d.default,Sliced:b.default,Tiled:a.default,RadialFilled:c.default,BarFilled:g.default,Mesh:k.default,Simple3D:l.default,Sliced3D:q.default,Tiled3D:r.default,
RadialFilled3D:t.default,BarFilled3D:p.default,Mesh3D:v.default})},{"../../../../components/CCSprite":79,"../../../assembler":158,"./2d/bar-filled":196,"./2d/mesh":197,"./2d/radial-filled":198,"./2d/simple":199,"./2d/sliced":200,"./2d/tiled":201,"./3d/bar-filled":void 0,"./3d/mesh":void 0,"./3d/radial-filled":void 0,"./3d/simple":void 0,"./3d/sliced":void 0,"./3d/tiled":void 0}],203:[function(f,n,m){m.__esModule=!0;f=function(){function f(e,d,b,a,c){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");
this._handler=e;this._index=d;this._vfmt=c;this._verticesBytes=c._bytes;this._initVerticesCount=b;this._initIndicesCount=a;this.reset()}return f.prototype._reallocVData=function(e,d){this.vData=new Float32Array(e);this.uintVData=new Uint32Array(this.vData.buffer);d&&this.vData.set(d);this._handler.updateMesh(this._index,this.vData,this.iData)},f.prototype._reallocIData=function(e,d){this.iData=new Uint16Array(e);d&&this.iData.set(d);this._handler.updateMesh(this._index,this.vData,this.iData)},f.prototype.reserve=
function(e,d){var b=e*this._verticesBytes>>2,a=this.vData.length;e=!1;if(b>a){for(;a<b;)a*=2;this._reallocVData(a,this.vData);e=!0}b=this.iData.length;if(d>b){for(;b<d;)b*=2;this._reallocIData(d,this.iData);e=!0}return e},f.prototype.used=function(e,d){this.usedVertices=e;this.usedIndices=d;this.usedVerticesFloats=e*this._verticesBytes>>2;this._handler.updateMeshRange(e,d)},f.prototype.reset=function(){this._reallocVData(this._initVerticesCount*this._verticesBytes>>2);this._reallocIData(this._initIndicesCount);
this.usedIndices=this.usedVerticesFloats=this.usedVertices=0},f}();m.default=f;cc.FlexBuffer=f;n.exports=m.default},{}],204:[function(f,n,m){var h=function(e){return e&&e.__esModule?e:{default:e}}(f("../../../renderer/gfx"));f=cc.Class({name:"cc.MeshBuffer",ctor:function(e,d){this.init(e,d)},init:function(e,d){this.indiceStart=this.vertexOffset=this.indiceOffset=this.byteOffset=0;this._dirty=!1;this._vertexFormat=d;this._vertexBytes=this._vertexFormat._bytes;this._arrOffset=0;this._vbArr=[];this._vb=
new h.default.VertexBuffer(e._device,d,h.default.USAGE_DYNAMIC,new ArrayBuffer,0);this._vbArr[0]=this._vb;this._ibArr=[];this._ib=new h.default.IndexBuffer(e._device,h.default.INDEX_FMT_UINT16,h.default.USAGE_STATIC,new ArrayBuffer,0);this._ibArr[0]=this._ib;this._iData=this._uintVData=this._vData=null;this._batcher=e;this._initVDataCount=256*d._bytes;this._initIDataCount=1536;this._offsetInfo={byteOffset:0,vertexOffset:0,indiceOffset:0};this._reallocBuffer()},uploadData:function(){if(0!==this.byteOffset&&
this._dirty){var e=new Float32Array(this._vData.buffer,0,this.byteOffset>>2),d=new Uint16Array(this._iData.buffer,0,this.indiceOffset);this._vb.update(0,e);this._ib.update(0,d);this._dirty=!1}},switchBuffer:function(){var e=++this._arrOffset;this.indiceStart=this.indiceOffset=this.vertexOffset=this.byteOffset=0;e<this._vbArr.length?(this._vb=this._vbArr[e],this._ib=this._ibArr[e]):(this._vb=new h.default.VertexBuffer(this._batcher._device,this._vertexFormat,h.default.USAGE_DYNAMIC,new ArrayBuffer,
0),this._vbArr[e]=this._vb,this._ib=new h.default.IndexBuffer(this._batcher._device,h.default.INDEX_FMT_UINT16,h.default.USAGE_STATIC,new ArrayBuffer,0),this._ibArr[e]=this._ib)},checkAndSwitchBuffer:function(e){65535<this.vertexOffset+e&&(this.uploadData(),this._batcher._flush(),this.switchBuffer())},requestStatic:function(e,d){this.checkAndSwitchBuffer(e);var b=this.byteOffset+e*this._vertexBytes,a=this.indiceOffset+d,c=this._vData.byteLength,g=this._iData.length;if(b>c||a>g){for(;c<b||g<a;)this._initVDataCount*=
2,this._initIDataCount*=2,c=4*this._initVDataCount,g=this._initIDataCount;this._reallocBuffer()}this._updateOffset(e,d,b)},_updateOffset:function(e,d,b){var a=this._offsetInfo;a.vertexOffset=this.vertexOffset;this.vertexOffset+=e;a.indiceOffset=this.indiceOffset;this.indiceOffset+=d;a.byteOffset=this.byteOffset;this.byteOffset=b;this._dirty=!0},request:function(e,d){return this._batcher._buffer!==this&&(this._batcher._flush(),this._batcher._buffer=this),this.requestStatic(e,d),this._offsetInfo},_reallocBuffer:function(){this._reallocVData(!0);
this._reallocIData(!0)},_reallocVData:function(e){var d=void 0;this._vData&&(d=new Uint8Array(this._vData.buffer));this._vData=new Float32Array(this._initVDataCount);this._uintVData=new Uint32Array(this._vData.buffer);var b=new Uint8Array(this._uintVData.buffer);if(d&&e){e=0;for(var a=d.length;e<a;e++)b[e]=d[e]}},_reallocIData:function(e){var d=this._iData;if(this._iData=new Uint16Array(this._initIDataCount),d&&e){e=this._iData;for(var b=0,a=d.length;b<a;b++)e[b]=d[b]}},reset:function(){this._arrOffset=
0;this._vb=this._vbArr[0];this._ib=this._ibArr[0];this.indiceStart=this.vertexOffset=this.indiceOffset=this.byteOffset=0;this._dirty=!1},destroy:function(){this.reset();for(var e=0;e<this._vbArr.length;e++)this._vbArr[e].destroy();this._vbArr=null;for(e=0;e<this._ibArr.length;e++)this._ibArr[e].destroy();this._vb=this._ib=this._ibArr=null},forwardIndiceStartToOffset:function(){this.indiceStart=this.indiceOffset}});cc.MeshBuffer=n.exports=f},{"../../../renderer/gfx":280}],205:[function(f,n,m){function h(a){return a&&
a.__esModule?a:{default:a}}var e=h(f("../../../renderer/core/input-assembler")),d=h(f("../../../renderer/memop/recycle-pool")),b=h(f("../../../renderer/scene/model"));m=f("./vertex-format");var a=m.vfmtPosUvColor,c=m.vfmt3D,g=f("./quad-buffer"),k=f("./mesh-buffer"),l=f("./spine-buffer");m=f("../../assets/material/CCMaterial");var q=(new (f("../../platform/id-generater"))("VertextFormat"),{}),r=new m,t=new e.default;t._count=0;f=function(g,k){this._renderScene=k;this._device=g;this.walking=!1;this.material=
r;this.cullingMask=1;this._iaPool=new d.default(function(){return new e.default},16);this._modelPool=new d.default(function(){return new b.default},16);this._quadBuffer=this.getBuffer("quad",a);this._meshBuffer=this.getBuffer("mesh",a);this._quadBuffer3D=this.getBuffer("quad",c);this._meshBuffer3D=this.getBuffer("mesh",c);this._buffer=this._meshBuffer;this._batchedModels=[];this._dummyNode=new cc.Node;this._sortKey=0;this.node=this._dummyNode;this.parentOpacity=1;this.worldMatDirty=this.parentOpacityDirty=
0;this.customProperties=null};f.prototype={constructor:f,reset:function(){this._iaPool.reset();for(var a=this._renderScene,c=this._batchedModels,b=0;b<c.length;++b)c[b].setInputAssembler(null),c[b].setEffect(null),a.removeModel(c[b]);for(var d in this._modelPool.reset(),c.length=0,this._sortKey=0,q)q[d].reset();this._buffer=this._meshBuffer;this.node=this._dummyNode;this.material=r;this.parentOpacity=this.cullingMask=1;this.worldMatDirty=this.parentOpacityDirty=0;this.customProperties=null},_flushMaterial:function(a){if(a&&
(this.material=a,a=a.effect)){var c=this._modelPool.add();this._batchedModels.push(c);c.sortKey=this._sortKey++;c._cullingMask=this.cullingMask;c.setNode(this.node);c.setEffect(a,null);c.setInputAssembler(t);this._renderScene.addModel(c)}},_flush:function(){var a=this.material,c=this._buffer,b=c.indiceOffset-c.indiceStart;if(this.walking&&a&&!(0>=b)&&(a=a.effect)){var d=this._iaPool.add();d._vertexBuffer=c._vb;d._indexBuffer=c._ib;d._start=c.indiceStart;d._count=b;b=this._modelPool.add();this._batchedModels.push(b);
b.sortKey=this._sortKey++;b._cullingMask=this.cullingMask;b.setNode(this.node);b.setEffect(a,this.customProperties);b.setInputAssembler(d);this._renderScene.addModel(b);c.forwardIndiceStartToOffset()}},_flushIA:function(a){if(a){var c=this.material.effect;if(c){var b=this._modelPool.add();this._batchedModels.push(b);b.sortKey=this._sortKey++;b._cullingMask=this.cullingMask;b.setNode(this.node);b.setEffect(c,this.customProperties);b.setInputAssembler(a);this._renderScene.addModel(b)}}},terminate:function(){for(var a in cc.dynamicAtlasManager&&
cc.dynamicAtlasManager.enabled&&cc.dynamicAtlasManager.update(),this._flush(),q)q[a].uploadData();this.walking=!1},getBuffer:function(a,c){var b=a+c.getHash(),d=q[b];if(!d){if("mesh"===a)d=new k(this,c);else if("quad"===a)d=new g(this,c);else{if("spine"!==a)return cc.error("Not support buffer type ["+a+"]"),null;d=new l(this,c)}q[b]=d}return d}};n.exports=f},{"../../../renderer/core/input-assembler":270,"../../../renderer/memop/recycle-pool":295,"../../../renderer/scene/model":301,"../../assets/material/CCMaterial":53,
"../../platform/id-generater":146,"./mesh-buffer":204,"./quad-buffer":206,"./spine-buffer":208,"./vertex-format":209}],206:[function(f,n,m){f=f("./mesh-buffer");f=cc.Class({name:"cc.QuadBuffer",extends:f,_fillQuadBuffer:function(){for(var f=this._initIDataCount/6,e=this._iData,d=0,b=0;d<f;d++){var a=4*d;e[b++]=a;e[b++]=a+1;e[b++]=a+2;e[b++]=a+1;e[b++]=a+3;e[b++]=a+2}f=new Uint16Array(this._iData.buffer,0,6*f);this._ib.update(0,f)},uploadData:function(){if(0!==this.byteOffset&&this._dirty){var f=new Float32Array(this._vData.buffer,
0,this.byteOffset>>2);this._vb.update(0,f);this._dirty=!1}},switchBuffer:function(){this._super();var f=new Uint16Array(this._iData.buffer,0,this._initIDataCount);this._ib.update(0,f)},_reallocBuffer:function(){this._reallocVData(!0);this._reallocIData();this._fillQuadBuffer()}});cc.QuadBuffer=n.exports=f},{"./mesh-buffer":204}],207:[function(f,n,m){function h(){this.vDatas=[];this.uintVDatas=[];this.iDatas=[];this.meshCount=0;this._flexBuffer=this._infos=null}m.__esModule=!0;m.default=h;var e=function(b){return b&&
b.__esModule?b:{default:b}}(f("./flex-buffer")),d=f("./vertex-format");cc.js.mixin(h.prototype,{init:function(b){},clear:function(){this.vDatas.length=0;this.iDatas.length=0;this.meshCount=this.uintVDatas.length=0;this._infos=null;this._flexBuffer&&this._flexBuffer.reset()},updateMesh:function(b,a,c){this.vDatas[b]=a;this.uintVDatas[b]=new Uint32Array(a.buffer,0,a.length);this.iDatas[b]=c;this.meshCount=this.vDatas.length},updateMeshRange:function(b,a){},createData:function(b,a,c){a=new Float32Array(a);
c=new Uint16Array(c);this.updateMesh(b,a,c)},createQuadData:function(b,a,c){this.createData(b,a,c);this.initQuadIndices(this.iDatas[b])},createFlexData:function(b,a,c,g){g=g||d.vfmtPosUvColor;this._flexBuffer=new e.default(this,b,a,c,g)},initQuadIndices:function(b){for(var a=b.length/6,c=0,d=0;c<a;c++){var e=4*c;b[d++]=e;b[d++]=e+1;b[d++]=e+2;b[d++]=e+1;b[d++]=e+3;b[d++]=e+2}}});cc.RenderData=h;n.exports=m.default},{"./flex-buffer":203,"./vertex-format":209}],208:[function(f,n,m){f=cc.Class({name:"cc.SpineBuffer",
extends:f("./mesh-buffer"),requestStatic:function(f,e){this.checkAndSwitchBuffer(f);f=this.byteOffset+f*this._vertexBytes;e=this.indiceOffset+e;var d=this._vData.byteLength,b=this._iData.length;if(f>d||e>b){for(;d<f||b<e;)this._initVDataCount*=2,this._initIDataCount*=2,d=4*this._initVDataCount,b=this._initIDataCount;this._reallocBuffer()}f=this._offsetInfo;f.vertexOffset=this.vertexOffset;f.indiceOffset=this.indiceOffset;f.byteOffset=this.byteOffset},adjust:function(f,e){this.vertexOffset+=f;this.indiceOffset+=
e;this.byteOffset+=f*this._vertexBytes;this._dirty=!0}});cc.SpineBuffer=n.exports=f},{"./mesh-buffer":204}],209:[function(f,n,m){f=(f=f("../../../renderer/gfx"))&&f.__esModule?f:{default:f};m=new f.default.VertexFormat([{name:f.default.ATTR_POSITION,type:f.default.ATTR_TYPE_FLOAT32,num:3},{name:f.default.ATTR_UV0,type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_COLOR,type:f.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);m.name="vfmt3D";f.default.VertexFormat.XYZ_UV_Color=m;var h=new f.default.VertexFormat([{name:f.default.ATTR_POSITION,
type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_UV0,type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_COLOR,type:f.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);h.name="vfmtPosUvColor";f.default.VertexFormat.XY_UV_Color=h;var e=new f.default.VertexFormat([{name:f.default.ATTR_POSITION,type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_UV0,type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_COLOR,type:f.default.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:f.default.ATTR_COLOR0,
type:f.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);e.name="vfmtPosUvTwoColor";f.default.VertexFormat.XY_UV_Two_Color=e;var d=new f.default.VertexFormat([{name:f.default.ATTR_POSITION,type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_UV0,type:f.default.ATTR_TYPE_FLOAT32,num:2}]);d.name="vfmtPosUv";f.default.VertexFormat.XY_UV=d;var b=new f.default.VertexFormat([{name:f.default.ATTR_POSITION,type:f.default.ATTR_TYPE_FLOAT32,num:2},{name:f.default.ATTR_COLOR,type:f.default.ATTR_TYPE_UINT8,
num:4,normalize:!0}]);b.name="vfmtPosColor";f.default.VertexFormat.XY_Color=b;var a=new f.default.VertexFormat([{name:f.default.ATTR_POSITION,type:f.default.ATTR_TYPE_FLOAT32,num:2}]);a.name="vfmtPos";f.default.VertexFormat.XY=a;n.exports={vfmt3D:m,vfmtPosUvColor:h,vfmtPosUvTwoColor:e,vfmtPosUv:d,vfmtPosColor:b,vfmtPos:a}},{"../../../renderer/gfx":280}],210:[function(f,n,m){f("../platform/CCSys");var h=/(\.[^\.\/\?\\]*)(\?.*)?$/,e=/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,d=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var b=
arguments.length,a="",c=0;c<b;c++)a=(a+(""===a?"":"/")+arguments[c]).replace(/(\/|\\\\)$/,"");return a},extname:function(b){return(b=h.exec(b))?b[1]:""},mainFileName:function(b){if(b){var a=b.lastIndexOf(".");if(-1!==a)return b.substring(0,a)}return b},basename:function(b,a){var c=b.indexOf("?");0<c&&(b=b.substring(0,c));c=/(\/|\\)([^\/\\]+)$/g.exec(b.replace(/(\/|\\)$/,""));if(!c)return null;c=c[2];return a&&b.substring(b.length-a.length).toLowerCase()===a.toLowerCase()?c.substring(0,c.length-a.length):
c},dirname:function(b){return(b=e.exec(b))?b[2]:""},changeExtname:function(b,a){a=a||"";var c=b.indexOf("?"),d="";return 0<c&&(d=b.substring(c),b=b.substring(0,c)),0>(c=b.lastIndexOf("."))?b+a+d:b.substring(0,c)+a+d},changeBasename:function(b,a,c){if(0===a.indexOf("."))return this.changeExtname(b,a);var d=b.indexOf("?"),e="";c=c?this.extname(b):"";return 0<d&&(e=b.substring(d),b=b.substring(0,d)),d=0>=(d=b.lastIndexOf("/"))?0:d+1,b.substring(0,d)+a+c+e},_normalize:function(b){b=String(b);do{var a=
b;b=b.replace(d,"")}while(a.length!==b.length);return b},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",stripSep:function(b){return b.replace(/[\/\\]$/,"")}};n.exports=cc.path},{"../platform/CCSys":139}],211:[function(f,n,m){f=function(f,e,d,b,a,c){this.a=f;this.b=e;this.c=d;this.d=b;this.tx=a;this.ty=c};f.create=function(f,e,d,b,a,c){return{a:f,b:e,c:d,d:b,tx:a,ty:c}};f.identity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}};f.clone=function(f){return{a:f.a,b:f.b,c:f.c,d:f.d,tx:f.tx,ty:f.ty}};f.concat=
function(f,e,d){var b=e.a,a=e.b,c=e.c,g=e.d,k=e.tx;e=e.ty;return f.a=b*d.a+a*d.c,f.b=b*d.b+a*d.d,f.c=c*d.a+g*d.c,f.d=c*d.b+g*d.d,f.tx=k*d.a+e*d.c+d.tx,f.ty=k*d.b+e*d.d+d.ty,f};f.invert=function(f,e){var d=e.a,b=e.b,a=e.c,c=e.d,g=1/(d*c-b*a),k=e.tx;e=e.ty;return f.a=g*c,f.b=-g*b,f.c=-g*a,f.d=g*d,f.tx=g*(a*e-c*k),f.ty=g*(b*k-d*e),f};f.fromMat4=function(f,e){e=e.m;return f.a=e[0],f.b=e[1],f.c=e[4],f.d=e[5],f.tx=e[12],f.ty=e[13],f};f.transformVec2=function(f,e,d,b){var a,c;return void 0===b?(b=d,a=e.x,
c=e.y):(a=e,c=d),f.x=b.a*a+b.c*c+b.tx,f.y=b.b*a+b.d*c+b.ty,f};f.transformSize=function(f,e,d){return f.width=d.a*e.width+d.c*e.height,f.height=d.b*e.width+d.d*e.height,f};f.transformRect=function(f,e,d){var b=e.x,a=e.y,c=b+e.width,g=a+e.height,k=d.a*b+d.c*a+d.tx;e=d.b*b+d.d*a+d.ty;var l=d.a*c+d.c*a+d.tx;a=d.b*c+d.d*a+d.ty;var q=d.a*b+d.c*g+d.tx;b=d.b*b+d.d*g+d.ty;var r=d.a*c+d.c*g+d.tx;c=d.b*c+d.d*g+d.ty;d=Math.min(k,l,q,r);k=Math.max(k,l,q,r);l=Math.min(e,a,b,c);e=Math.max(e,a,b,c);return f.x=d,
f.y=l,f.width=k-d,f.height=e-l,f};f.transformObb=function(f,e,d,b,a,c){var g=a.x,k=a.y,l=a.width,q=a.height;a=c.a*g+c.c*k+c.tx;g=c.b*g+c.d*k+c.ty;k=c.a*l;l*=c.b;var r=c.c*q;c=c.d*q;e.x=a;e.y=g;d.x=k+a;d.y=l+g;f.x=r+a;f.y=c+g;b.x=k+r+a;b.y=l+c+g};cc.AffineTransform=n.exports=f},{}],212:[function(f,n,m){function h(a){return a?"string"==typeof a?g.getClassByName(a):a:(cc.errorID(3804),null)}function e(a,c){if(c._sealed)for(var b=0;b<a._components.length;++b){var d=a._components[b];if(d.constructor===
c)return d}else for(b=0;b<a._components.length;++b)if(d=a._components[b],d instanceof c)return d;return null}function d(a,c,b){if(c._sealed)for(var d=0;d<a._components.length;++d){var g=a._components[d];g.constructor===c&&b.push(g)}else for(d=0;d<a._components.length;++d)g=a._components[d],g instanceof c&&b.push(g)}function b(a,c){for(var d=0;d<a.length;++d){var g=a[d],k=e(g,c);if(k||0<g._children.length&&(k=b(g._children,c)))return k}return null}function a(c,b,g){for(var e=0;e<c.length;++e){var k=
c[e];d(k,b,g);0<k._children.length&&a(k._children,b,g)}}var c=f("../platform/CCObject").Flags;m=f("./misc");var g=f("../platform/js"),k=f("../platform/id-generater"),l=f("../event-manager"),q=f("../renderer/render-flow"),r=c.Destroying,t=c.DontDestroy,p=c.Deactivating,v=new k("Node");f=cc.Class({name:"cc._BaseNode",extends:cc.Object,properties:{_parent:null,_children:[],_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return 0<(this._objFlags&t)},set:function(a){a?this._objFlags|=
t:this._objFlags&=~t}},name:{get:function(){return this._name},set:function(a){this._name=a}},uuid:{get:function(){return this._id}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},active:{get:function(){return this._active},set:function(a){if(a=!!a,this._active!==a){this._active=a;var c=this._parent;c&&c._activeInHierarchy&&cc.director._nodeActivator.activateNode(this,a)}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}}},
ctor:function(a){this._name=void 0!==a?a:"New Node";this._activeInHierarchy=!1;this._id=v.getNewId();cc.director._scheduler&&cc.director._scheduler.enableForTarget(this);this.__eventTargets=[]},getParent:function(){return this._parent},setParent:function(a){if(this._parent!==a){0;var c=this._parent;(this._parent=a||null,this._onSetParent(a),a&&(l._setDirtyForNode(this),a._children.push(this),a.emit&&a.emit("child-added",this),a._renderFlag|=q.FLAG_CHILDREN),c)?c._objFlags&r||(a=c._children.indexOf(this),
0,c._children.splice(a,1),c.emit&&c.emit("child-removed",this),this._onHierarchyChanged(c),0===c._children.length&&(c._renderFlag&=~q.FLAG_CHILDREN)):a&&this._onHierarchyChanged(null)}},attr:function(a){g.mixin(this,a)},getChildByUuid:function(a){if(!a)return cc.log("Invalid uuid"),null;for(var c=this._children,b=0,d=c.length;b<d;b++)if(c[b]._id===a)return c[b];return null},getChildByName:function(a){if(!a)return cc.log("Invalid name"),null;for(var c=this._children,b=0,d=c.length;b<d;b++)if(c[b]._name===
a)return c[b];return null},addChild:function(a){cc.assertID(a,1606);cc.assertID(null===a._parent,1605);a.setParent(this)},insertChild:function(a,c){a.parent=this;a.setSiblingIndex(c)},getSiblingIndex:function(){return this._parent?this._parent._children.indexOf(this):0},setSiblingIndex:function(a){if(this._parent)if(this._parent._objFlags&p)cc.errorID(3821);else{var c=this._parent._children;a=-1!==a?a:c.length-1;var b=c.indexOf(this);a!==b&&(c.splice(b,1),a<c.length?c.splice(a,0,this):c.push(this),
this._onSiblingIndexChanged&&this._onSiblingIndexChanged(a))}},walk:function(a,c){var b,d,g,e,k=cc._BaseNode,f=1,l=k._stacks[k._stackId];l||(l=[],k._stacks.push(l));k._stackId++;l.length=0;l[0]=this;var p=null;for(e=!1;f;)if(d=l[--f])if(!e&&a?a(d):e&&c&&c(d),l[f]=null,e){if(e=!1,b)if(b[++g])l[f]=b[g],f++;else if(p&&(l[f]=p,f++,e=!0,p._parent?(g=(b=p._parent._children).indexOf(p),p=p._parent):(p=null,b=null),0>g))break}else 0<d._children.length?(p=d,b=d._children,g=0,l[f]=b[g],f++):(l[f]=d,f++,e=!0);
l.length=0;k._stackId--},cleanup:function(){},removeFromParent:function(a){this._parent&&(void 0===a&&(a=!0),this._parent.removeChild(this,a))},removeChild:function(a,c){-1<this._children.indexOf(a)&&((c||void 0===c)&&a.cleanup(),a.parent=null)},removeAllChildren:function(a){var c=this._children;void 0===a&&(a=!0);for(var b=c.length-1;0<=b;b--){var d=c[b];d&&(a&&d.cleanup(),d.parent=null)}this._children.length=0},isChildOf:function(a){var c=this;do{if(c===a)return!0;c=c._parent}while(c);return!1},
getComponent:function(a){return(a=h(a))?e(this,a):null},getComponents:function(a){a=h(a);var c=[];return a&&d(this,a,c),c},getComponentInChildren:function(a){return(a=h(a))?b(this._children,a):null},getComponentsInChildren:function(c){c=h(c);var b=[];return c&&(d(this,c,b),a(this._children,c,b)),b},_checkMultipleComp:!1,addComponent:function(a){var c;if("string"==typeof a){if(!(c=g.getClassByName(a)))return cc.errorID(3807,a),cc._RF.peek()&&cc.errorID(3808,a),null}else{if(!a)return cc.errorID(3804),
null;c=a}if("function"!=typeof c)return cc.errorID(3809),null;if(!g.isChildClassOf(c,cc.Component))return cc.errorID(3810),null;if((a=c._requireComponent)&&!this.getComponent(a)&&!this.addComponent(a))return null;c=new c;return c.node=this,this._components.push(c),this._activeInHierarchy&&cc.director._nodeActivator.activateComp(c),c},_addComponentAt:!1,removeComponent:function(a){a?(a instanceof cc.Component||(a=this.getComponent(a)),a&&a.destroy()):cc.errorID(3813)},_getDependComponent:!1,_removeComponent:function(a){if(a){if(!(this._objFlags&
r)){var c=this._components.indexOf(a);-1!==c?this._components.splice(c,1):a.node!==this&&cc.errorID(3815)}}else cc.errorID(3814)},destroy:function(){cc.Object.prototype.destroy.call(this)&&(this.active=!1)},destroyAllChildren:function(){for(var a=this._children,c=0;c<a.length;++c)a[c].destroy()},_onSetParent:function(a){},_onPostActivated:function(){},_onBatchRestored:function(){},_onBatchCreated:function(){},_onHierarchyChanged:function(a){a=this._parent;!this._persistNode||a instanceof cc.Scene||
cc.game.removePersistRootNode(this);a=this._active&&!(!a||!a._activeInHierarchy);this._activeInHierarchy!==a&&cc.director._nodeActivator.activateNode(this,a)},_instantiate:function(a){a||(a=cc.instantiate._clone(this,this));var c=this._prefab;c&&this===c.root&&c.sync;return a._parent=null,a._onBatchRestored(),a},_registerIfAttached:!1,_onPreDestroy:function(){var a;this._objFlags|=r;var c=this._parent,b=c&&c._objFlags&r,d=this._children;var g=0;for(a=d.length;g<a;++g)d[g]._destroyImmediate();g=0;
for(a=this._components.length;g<a;++g)this._components[g]._destroyImmediate();d=this.__eventTargets;g=0;for(a=d.length;g<a;++g){var e=d[g];e&&e.targetOff(this)}if(d.length=0,this._persistNode&&cc.game.removePersistRootNode(this),!b&&c)g=c._children.indexOf(this),c._children.splice(g,1),c.emit&&c.emit("child-removed",this);return b},onRestore:!1});f.idGenerater=v;f._stacks=[[]];f._stackId=0;f.prototype._onPreDestroyBase=f.prototype._onPreDestroy;f.prototype._onHierarchyChangedBase=f.prototype._onHierarchyChanged;
m.propertyDefine(f,["parent","name","children","childrenCount"],{});cc._BaseNode=n.exports=f},{"../event-manager":97,"../platform/CCObject":136,"../platform/id-generater":146,"../platform/js":150,"../renderer/render-flow":179,"./misc":220}],213:[function(f,n,m){n.exports={binarySearchEpsilon:function(f,e){for(var d=0,b=f.length-1,a=b>>>1;d<=b;a=d+b>>>1){var c=f[a];if(c>e+1E-6)b=a-1;else{if(!(c<e-1E-6))return a;d=a+1}}return~d}}},{}],214:[function(f,n,m){var h=f("../components/CCRenderComponent");
m=f("../platform/CCMacro").BlendFactor;var e=f("../../renderer/gfx");f=cc.Class({properties:{_srcBlendFactor:m.SRC_ALPHA,_dstBlendFactor:m.ONE_MINUS_SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(d){this._srcBlendFactor!==d&&(this._srcBlendFactor=d,this._updateBlendFunc())},animatable:!1,type:m,tooltip:!1,visible:!0},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(d){this._dstBlendFactor!==d&&(this._dstBlendFactor=d,this._updateBlendFunc())},
animatable:!1,type:m,tooltip:!1,visible:!0}},setMaterial:function(d,b){this._materials[d]!==b&&(h.prototype.setMaterial.call(this,d,b),b&&this._updateMaterialBlendFunc(b))},_updateBlendFunc:function(){for(var d=this._materials,b=0;b<d.length;b++)this._updateMaterialBlendFunc(d[b])},_updateMaterialBlendFunc:function(d){d.effect.setBlend(!0,e.BLEND_FUNC_ADD,this._srcBlendFactor,this._dstBlendFactor,e.BLEND_FUNC_ADD,this._srcBlendFactor,this._dstBlendFactor);d.setDirty(!0)}});n.exports=cc.BlendFunc=
f},{"../../renderer/gfx":280,"../components/CCRenderComponent":74,"../platform/CCMacro":135}],215:[function(f,n,m){var h=f("./misc").BASE64_VALUES,e="0123456789abcdef".split("");f=["","","",""];var d=f.concat(f,"-",f,"-",f,"-",f,"-",f,f,f),b=d.map(function(a,c){return"-"===a?NaN:c}).filter(isFinite);n.exports=function(a){if(22!==a.length)return a;d[0]=a[0];d[1]=a[1];for(var c=2,g=2;22>c;c+=2){var k=h[a.charCodeAt(c)],f=h[a.charCodeAt(c+1)];d[b[g++]]=e[k>>2];d[b[g++]]=e[(3&k)<<2|f>>4];d[b[g++]]=e[15&
f]}return d.join("")}},{"./misc":220}],216:[function(f,n,m){cc.find=n.exports=function(f,e){if(null==f)return cc.errorID(5600),null;if(e)0;else if(e=cc.director.getScene(),!e)return null;var d="/"!==f[0]?0:1;for(f=f.split("/");d<f.length;d++){var b=f[d],a=e._children;e=null;for(var c=0,g=a.length;c<g;++c){var k=a[c];if(k.name===b){e=k;break}}if(!e)return null}return e}},{}],217:[function(f,n,m){var h=f("../assets/material/CCMaterial");f=cc.Class({properties:{_normalMaterial:null,normalMaterial:{get:function(){return this._normalMaterial},
set:function(e){this._normalMaterial=e;this._updateDisabledState&&this._updateDisabledState()},type:h,tooltip:!1,animatable:!1},_grayMaterial:null,grayMaterial:{get:function(){return this._grayMaterial},set:function(e){this._grayMaterial=e;this._updateDisabledState&&this._updateDisabledState()},type:h,tooltip:!1,animatable:!1}},_switchGrayMaterial:function(e,d){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){var b=void 0;e?((b=this._grayMaterial)||(b=h.getBuiltinMaterial("2d-gray-sprite")),b=
this._grayMaterial=h.getInstantiatedMaterial(b,d)):((b=this._normalMaterial)||(b=h.getBuiltinMaterial("2d-sprite",d)),b=this._normalMaterial=h.getInstantiatedMaterial(b,d));d.setMaterial(0,b)}}});n.exports=f},{"../assets/material/CCMaterial":53}],218:[function(f,n,m){var h=/^(click)(\s)*=|(param)(\s)*=/,e=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;f=function(){this._parsedObject={};this._specialSymbolArray=[];this._specialSymbolArray.push([/&lt;/g,"<"]);
this._specialSymbolArray.push([/&gt;/g,">"]);this._specialSymbolArray.push([/&amp;/g,"&"]);this._specialSymbolArray.push([/&quot;/g,'"']);this._specialSymbolArray.push([/&apos;/g,"'"])};f.prototype={constructor:f,parse:function(d){this._resultObjectArray=[];this._stack=[];for(var b=0,a=d.length;b<a;){var c=d.indexOf("<",b);0>c?(this._stack.pop(),this._processResult(d.substring(b)),b=a):(this._processResult(d.substring(b,c)),b=d.indexOf(">",b),-1===b?b=c:"/"===d.charAt(c+1)?this._stack.pop():this._addToStack(d.substring(c+
1,b)),b+=1)}return this._resultObjectArray},_attributeToObject:function(d){var b,a,c,g,k={},f=(d=d.trim()).match(/^(color|size)(\s)*=/);if(f){if(b=f[0],""===(d=d.substring(b.length).trim()))return k;switch(a=d.indexOf(" "),b[0]){case "c":k.color=-1<a?d.substring(0,a).trim():d;break;case "s":k.size=parseInt(d)}return-1<a&&(g=d.substring(a+1).trim(),c=this._processEventHandler(g),k.event=c),k}if((f=d.match(/^(br(\s)*\/)/))&&0<f[0].length&&(b=f[0].trim()).startsWith("br")&&"/"===b[b.length-1])return k.isNewLine=
!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),k;if((f=d.match(/^(img(\s)*src(\s)*=[^>]+\/)/))&&0<f[0].length&&(b=f[0].trim()).startsWith("img")&&"/"===b[b.length-1]){var q;f=d.match(e);for(c=!1;f;)b=(d=d.substring(d.indexOf(f[0]))).substr(0,f[0].length),f=-1<(a=(q=d.substring(b.length).trim()).indexOf(" "))?q.substr(0,a):q,b=(b=b.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),d=q.substring(a).trim(),"src"===b?(k.isImage=!0,f.endsWith("/")&&(f=f.substring(0,f.length-1)),0===f.indexOf("'")?
(c=!0,f=f.substring(1,f.length-1)):0===f.indexOf('"')&&(c=!0,f=f.substring(1,f.length-1)),k.src=f):"height"===b?k.imageHeight=parseInt(f):"width"===b?k.imageWidth=parseInt(f):"click"===b&&(k.event=this._processEventHandler(b+"="+f)),k.event&&"param"===b&&(k.event.param=f.replace(/^"|"$/g,"")),f=d.match(e);return c&&k.isImage&&this._resultObjectArray.push({text:"",style:k}),{}}if(f=d.match(/^(outline(\s)*[^>]*)/)){c={color:"#ffffff",width:1};if(d=f[0].substring(7).trim())for(g=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/,
f=d.match(g);f;)b=(d=d.substring(d.indexOf(f[0]))).substr(0,f[0].length),f=-1<(a=(q=d.substring(b.length).trim()).indexOf(" "))?q.substr(0,a):q,b=(b=b.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),d=q.substring(a).trim(),"click"===b?k.event=this._processEventHandler(b+"="+f):"color"===b?c.color=f:"width"===b&&(c.width=parseInt(f)),k.event&&"param"===b&&(k.event.param=f.replace(/^"|"$/g,"")),f=d.match(g);k.outline=c}if((f=d.match(/^(on|u|b|i)(\s)*/))&&0<f[0].length){switch(b=f[0],d=d.substring(b.length).trim(),
b[0]){case "u":k.underline=!0;break;case "i":k.italic=!0;break;case "b":k.bold=!0}if(""===d)return k;c=this._processEventHandler(d);k.event=c}return k},_processEventHandler:function(d){for(var b=0,a={},c=d.match(h);c;){var g=c[0],e="";(c=!1,'"'===(d=d.substring(g.length).trim()).charAt(0))?(-1<(b=d.indexOf('"',1))&&(e=d.substring(1,b).trim(),c=!0),b++):"'"===d.charAt(0)?(-1<(b=d.indexOf("'",1))&&(e=d.substring(1,b).trim(),c=!0),b++):(b=d.match(/(\S)+/),b=(e=b?b[0]:"").length);c&&(a[g=g.substring(0,
g.length-1).trim()]=e);c=(d=d.substring(b).trim()).match(h)}return a},_addToStack:function(d){d=this._attributeToObject(d);if(0!==this._stack.length){if(d.isNewLine||d.isImage)return;var b=this._stack[this._stack.length-1],a;for(a in b)d[a]||(d[a]=b[a])}this._stack.push(d)},_processResult:function(d){""!==d&&(d=this._escapeSpecialSymbol(d),0<this._stack.length?this._resultObjectArray.push({text:d,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:d}))},_escapeSpecialSymbol:function(d){for(var b=
0;b<this._specialSymbolArray.length;++b)d=d.replace(this._specialSymbolArray[b][0],this._specialSymbolArray[b][1]);return d}};n.exports=f},{}],219:[function(f,n,m){f("./CCPath");f("./profiler/CCProfiler");f("./find");f("./mutable-forward-iterator")},{"./CCPath":210,"./find":216,"./mutable-forward-iterator":221,"./profiler/CCProfiler":224}],220:[function(f,n,m){var h=f("../platform/js");f={propertyDefine:function(d,b,a){function c(a,c,b,d){var g=Object.getOwnPropertyDescriptor(a,c);g?(g.get&&(a[b]=
g.get),g.set&&d&&(a[d]=g.set)):h.getset(a,c,a[b],a[d])}var g;d=d.prototype;for(var e=0;e<b.length;e++){var f=(g=b[e])[0].toUpperCase()+g.slice(1);c(d,g,"get"+f,"set"+f)}for(g in a)b=a[g],c(d,g,b[0],b[1])},NextPOT:function(d){return--d,d|=d>>1,d|=d>>2,d|=d>>4,d|=d>>8,(d|d>>16)+1},BUILTIN_CLASSID_RE:/^(?:cc|dragonBones|sp|ccsg)\..+/};m=Array(123);for(var e=0;123>e;++e)m[e]=64;for(e=0;64>e;++e)m["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(e)]=e;f.BASE64_VALUES=m;f.pushToMap=
function(d,b,a,c){var g=d[b];g?Array.isArray(g)?c?(g.push(g[0]),g[0]=a):g.push(a):d[b]=c?[a,g]:[g,a]:d[b]=a};f.clampf=function(d,b,a){if(b>a){var c=b;b=a;a=c}return d<b?b:d<a?d:a};f.clamp01=function(d){return 0>d?0:1>d?d:1};f.lerp=function(d,b,a){return d+(b-d)*a};f.degreesToRadians=function(d){return d*cc.macro.RAD};f.radiansToDegrees=function(d){return d*cc.macro.DEG};cc.misc=n.exports=f},{"../platform/js":150}],221:[function(f,n,m){function h(e){this.i=0;this.array=e}f=h.prototype;f.remove=function(e){e=
this.array.indexOf(e);0<=e&&this.removeAt(e)};f.removeAt=function(e){this.array.splice(e,1);e<=this.i&&--this.i};f.fastRemove=function(e){e=this.array.indexOf(e);0<=e&&this.fastRemoveAt(e)};f.fastRemoveAt=function(e){var d=this.array;d[e]=d[d.length-1];--d.length;e<=this.i&&--this.i};f.push=function(e){this.array.push(e)};n.exports=h},{}],222:[function(f,n,m){m.__esModule=!0;f=function(){function f(){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this.enabled=!0;
this.count=0;this.maxSize=1024}return f.prototype.get=function(){},f.prototype.put=function(){},f.prototype.clear=function(){},f}();m.default=f;cc.pool={};f.register=function(f,e){cc.pool[f]=e};n.exports=m.default},{}],223:[function(f,n,m){f("../vmath");cc._PrefabInfo=cc.Class({name:"cc.PrefabInfo",properties:{root:null,asset:null,fileId:"",sync:!1,_synced:{default:!1,serializable:!1}}});n.exports={syncWithPrefab:function(f){var e=f._prefab;if(e._synced=!0,!e.asset)return cc.errorID(3701,f.name),
void(f._prefab=null);var d=f._objFlags,b=f._parent,a=f._id,c=f._name,g=f._active,k=f._eulerAngles.x,l=f._eulerAngles.y,q=f._eulerAngles.z,r=f._localZOrder,h=f._globalZOrder,p=f._trs,v=p[0],w=p[1],m=p[2];cc.game._isCloning=!0;e.asset._doInstantiate(f);cc.game._isCloning=!1;f._objFlags=d;f._parent=b;f._id=a;f._prefab=e;f._name=c;f._active=g;f._localZOrder=r;f._globalZOrder=h;(p=f._trs)[0]=v;p[1]=w;p[2]=m;f._eulerAngles.x=k;f._eulerAngles.y=l;f._eulerAngles.z=q}}},{"../vmath":246}],224:[function(f,n,
m){function h(){if(!k||!k.isValid){(k=new cc.Node("PROFILER-NODE")).x=k.y=10;k.color=cc.color(0,0,0);k.groupIndex=cc.Node.BuiltinGroupIndex.DEBUG;cc.Camera._setupDebugCamera();k.zIndex=b.MAX_ZINDEX;cc.game.addPersistRootNode(k);var a=new cc.Node("LEFT-PANEL");a.anchorX=a.anchorY=0;var c=a.addComponent(cc.Label);c.fontSize=15;c.lineHeight=15;a.parent=k;a=new cc.Node("RIGHT-PANEL");a.anchorX=1;a.anchorY=0;a.x=200;var d=a.addComponent(cc.Label);d.horizontalAlign=cc.Label.HorizontalAlign.RIGHT;d.fontSize=
15;d.lineHeight=15;a.parent=k;cc.sys.browserType!==cc.sys.BROWSER_TYPE_BAIDU_GAME_SUB&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_WECHAT_GAME_SUB&&(c.cacheMode=cc.Label.CacheMode.CHAR,d.cacheMode=cc.Label.CacheMode.CHAR);l={left:c,right:d}}c=cc.director._lastUpdate;g.frame._counter.start(c);g.logic._counter.start(c)}function e(){var a=performance.now();cc.director.isPaused()?g.frame._counter.start(a):g.logic._counter.end(a);g.render._counter.start(a)}function d(){var a=performance.now();g.render._counter.end(a);
g.draws._counter.value=cc.renderer.drawCalls;g.frame._counter.end(a);g.fps._counter.frame(a);var c="",b="",d;for(d in g){var e=g[d];e._counter.sample(a);c+=e.desc+"\n";b+=e._counter.human()+"\n"}l&&(l.left.string=c,l.right.string=b)}var b=f("../../platform/CCMacro"),a=f("./perf-counter"),c=!1,g=null,k=null,l=null;cc.profiler=n.exports={isShowingStats:function(){return c},hideStats:function(){c&&(k&&(k.active=!1),cc.director.off(cc.Director.EVENT_BEFORE_UPDATE,h),cc.director.off(cc.Director.EVENT_AFTER_UPDATE,
e),cc.director.off(cc.Director.EVENT_AFTER_DRAW,d),c=!1)},showStats:function(){if(!c){if(!g){g={frame:{desc:"Frame time (ms)",min:0,max:50,average:500},fps:{desc:"Framerate (FPS)",below:30,average:500},draws:{desc:"Draw call"},logic:{desc:"Game Logic (ms)",min:0,max:50,average:500,color:"#080"},render:{desc:"Renderer (ms)",min:0,max:50,average:500,color:"#f90"},mode:{desc:cc.game.renderType===cc.game.RENDER_TYPE_WEBGL?"WebGL":"Canvas",min:1}};var b=performance.now(),f;for(f in g)g[f]._counter=new a(f,
g[f],b)}k&&(k.active=!0);cc.director.on(cc.Director.EVENT_BEFORE_UPDATE,h);cc.director.on(cc.Director.EVENT_AFTER_UPDATE,e);cc.director.on(cc.Director.EVENT_AFTER_DRAW,d);c=!0}}}},{"../../platform/CCMacro":135,"./perf-counter":226}],225:[function(f,n,m){f=cc.Class({name:"cc.Counter",ctor:function(f,e,d){this._id=f;this._opts=e||{};this._accumSamples=this._accumValue=this._averageValue=this._total=this._value=0;this._accumStart=d},properties:{value:{get:function(){return this._value},set:function(f){this._value=
f}}},_average:function(f,e){this._opts.average&&(this._accumValue+=f,++this._accumSamples,e-this._accumStart>=this._opts.average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=e,this._accumSamples=0))},sample:function(f){this._average(this._value,f)},human:function(){return Math.round(100*(this._opts.average?this._averageValue:this._value))/100},alarm:function(){return this._opts.below&&this._value<this._opts.below||this._opts.over&&this._value>this._opts.over}});
n.exports=f},{}],226:[function(f,n,m){f=f("./counter");f=cc.Class({name:"cc.PerfCounter",extends:f,ctor:function(f,e,d){this._time=d},start:function(f){this._time=f},end:function(f){this._value=f-this._time;this._average(this._value)},tick:function(){this.end();this.start()},frame:function(f){var e=f-this._time;this._total++;e>(this._opts.average||1E3)&&(this._value=1E3*this._total/e,this._total=0,this._time=f,this._average(this._value))}});n.exports=f},{"./counter":225}],227:[function(f,n,m){cc.textUtils=
n.exports={BASELINE_RATIO:.26,MIDDLE_RATIO:.37,label_wordRex:/([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430-\u044f\u0410-\u042f\u0401\u0451]+|\S)/,label_symbolRex:/^[!,.:;'}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/,label_lastWordRex:/([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+|\S)$/,
label_lastEnglish:/[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+$/,
label_firstEnglish:/^[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]/,
label_firstEmoji:/^[\uD83C\uDF00-\uDFFF\uDC00-\uDE4F]/,label_lastEmoji:/([\uDF00-\uDFFF\uDC00-\uDE4F]+|\S)$/,label_wrapinspection:!0,__CHINESE_REG:/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,__JAPANESE_REG:/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,__KOREAN_REG:/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/,isUnicodeCJK:function(f){return this.__CHINESE_REG.test(f)||this.__JAPANESE_REG.test(f)||
this.__KOREAN_REG.test(f)},isUnicodeSpace:function(f){return 9<=(f=f.charCodeAt(0))&&13>=f||32===f||133===f||160===f||5760===f||8192<=f&&8202>=f||8232===f||8233===f||8239===f||8287===f||12288===f},safeMeasureText:function(f,e){return(f=f.measureText(e))&&f.width||0},fragmentText:function(f,e,d,b){var a=[];if(0===f.length||0>d)return a.push(""),a;for(;e>d&&1<f.length;){for(var c=d/e*f.length|0,g=f.substring(c),k=e-b(g),l=g,q=0,r=0;k>d&&10>r++;)c*=d/k,c|=0,k=e-b(g=f.substring(c));for(r=0;k<=d&&10>r++;)g&&
(q=(l=this.label_wordRex.exec(g))?l[0].length:1,l=g),c+=q,k=e-b(g=f.substring(c));0===(c-=q)&&(c=1,l=l.substring(1));var t;e=f.substring(0,0+c);this.label_wrapinspection&&this.label_symbolRex.test(l||g)&&(0===(c-=(t=this.label_lastWordRex.exec(e))?t[0].length:0)&&(c=1),l=f.substring(c),e=f.substring(0,0+c));this.label_firstEmoji.test(l)&&(t=this.label_lastEmoji.exec(e))&&e!==t[0]&&(c-=t[0].length,l=f.substring(c),e=f.substring(0,0+c));this.label_firstEnglish.test(l)&&(t=this.label_lastEnglish.exec(e))&&
e!==t[0]&&(c-=t[0].length,l=f.substring(c),e=f.substring(0,0+c));0===a.length?a.push(e):0<(e=e.trimLeft()).length&&a.push(e);e=b(f=l||g)}return 0===a.length?a.push(f):0<(f=f.trimLeft()).length&&a.push(f),a}}},{}],228:[function(f,n,m){var h=f("../assets/CCTexture2D");cc.textureUtil=n.exports={loadImage:function(e,d,b){cc.assertID(e,3103);var a=cc.loader.getRes(e);return a?a.loaded?(d&&d.call(b,null,a),a):(a.once("load",function(){d&&d.call(b,null,a)},b),a):((a=new h).url=e,cc.loader.load({url:e,texture:a},
function(a,g){if(a)return d&&d.call(b,a||Error("Unknown error"));g.handleLoadedTexture();d&&d.call(b,null,g)}),a)},cacheImage:function(e,d){if(e&&d){var b=new h;b.initWithElement(d);return cc.loader.flowOut({id:e,url:e,error:null,content:b,complete:!1}),b}},postLoadTexture:function(e,d){e.loaded?d&&d():e.url?cc.loader.load({url:e.url,skips:["Loader"]},function(b,a){a&&(e.loaded||(e._nativeAsset=a));d&&d(b)}):d&&d()}}},{"../assets/CCTexture2D":51}],229:[function(f,n,m){m=f("./node-unit");f=f("./node-mem-pool");
n.exports={NodeMemPool:new f(m)}},{"./node-mem-pool":231,"./node-unit":232}],230:[function(f,n,m){f=function(f){this._unitClass=f;this._pool=[];this._findOrder=[]};m=f.prototype;m._initNative=function(){this._nativeMemPool=new renderer.MemPool};m._buildUnit=function(f){return new this._unitClass(f,this)};m._destroyUnit=function(f){this._pool[f]=null;for(var e=0,d=this._findOrder.length;e<d;e++){var b=this._findOrder[e];if(b&&b.unitID==f){this._findOrder.splice(e,1);break}}};m._findUnitID=function(){for(var f=
0,e=this._pool;e[f];)f++;return f};m.pop=function(){for(var f=null,e=0,d=this._findOrder,b=this._pool,a=d.length;e<a;e++){var c=d[e];if(c&&c.hasSpace()){f=c;break}}f||(e=this._findUnitID(),f=this._buildUnit(e),b[e]=f,d.push(f),e=d.length-1);b=d[0];return b!==f&&(d[0]=f,d[e]=b),f.pop()};m.push=function(f){var e=this._pool[f.unitID];return e.push(f.index),1<this._findOrder.length&&e.isAllFree()&&this._destroyUnit(f.unitID),e};n.exports=f},{}],231:[function(f,n,m){var h=f("./mem-pool"),e=function(d){h.call(this,
d)};(function(){var d=function(){};d.prototype=h.prototype;e.prototype=new d})();f=e.prototype;f._initNative=function(){this._nativeMemPool=new renderer.NodeMemPool};f._destroyUnit=function(d){h.prototype._destroyUnit.call(this,d)};n.exports=e},{"./mem-pool":230}],232:[function(f,n,m){var h=f("../../vmath/utils"),e=(Uint32Array,10*h.FLOAT_BYTES),d=16*h.FLOAT_BYTES,b=16*h.FLOAT_BYTES,a=(Uint32Array,Uint32Array,Int32Array,Uint8Array,Uint8Array,Uint32Array,h.FLOAT_BYTES,h.FLOAT_BYTES,h.FLOAT_BYTES,f("./unit-base")),
c=function(c,k){a.call(this,c,k);c=this._contentNum;this.trsList=new h.FLOAT_ARRAY_TYPE(10*c);this.localMatList=new h.FLOAT_ARRAY_TYPE(16*c);this.worldMatList=new h.FLOAT_ARRAY_TYPE(16*c);for(k=0;k<c;k++){var g=this._spacesData[k];g.trs=new h.FLOAT_ARRAY_TYPE(this.trsList.buffer,k*e,10);g.localMat=new h.FLOAT_ARRAY_TYPE(this.localMatList.buffer,k*d,16);g.worldMat=new h.FLOAT_ARRAY_TYPE(this.worldMatList.buffer,k*b,16)}};(function(){var b=function(){};b.prototype=a.prototype;c.prototype=new b})();
n.exports=c},{"../../vmath/utils":253,"./unit-base":233}],233:[function(f,n,m){f=function(f,e,d){d=d||128;this.unitID=f;this._memPool=e;this._data=new Uint16Array(2);this._data[0]=0;this._data[1]=0;this._contentNum=d;this._signData=new Uint16Array(2*this._contentNum);this._spacesData=[];for(e=0;e<d;e++){var b=2*e;this._signData[b+0]=e+1;this._signData[b+1]=0;this._spacesData[e]={index:e,unitID:f}}this._signData[2*(d-1)]=65535};m=f.prototype;m.hasSpace=function(){return 65535!==this._data[0]};m.isAllFree=
function(){return 0==this._data[1]};m.pop=function(){var f=this._data[0];if(65535===f)return null;var e=2*f;f=this._spacesData[f];return this._signData[e+1]=1,this._data[0]=this._signData[e+0],this._data[1]++,f};m.push=function(f){var e=2*f;this._signData[e+1]=0;this._signData[e+0]=this._data[0];this._data[0]=f;this._data[1]--};m.dump=function(){for(var f=0,e=this._data[0],d="";65535!=e;)f++,d+=e+"->",e=this._signData[2*e];e=0;for(var b="",a=this._contentNum,c=0;c<a;c++)1==this._signData[2*c+1]&&
(e++,b+=c+"->");a=f+e;console.log("unitID:",this.unitID,"spaceNum:",f,"calc using num:",e,"store using num:",this._data[1],"calc total num:",a,"actually total num:",this._contentNum);console.log("free info:",d);console.log("using info:",b);e!=this._data[1]&&cc.error("using num error","calc using num:",e,"store using num:",this._data[1]);f+e!=this._contentNum&&cc.error("total num error","calc total num:",a,"actually total num:",this._contentNum)};n.exports=f},{}],234:[function(f,n,m){var h=f("../vmath"),
e=f("./value-type"),d=f("../platform/js");m=function(){function b(a,c,b,d){"object"==typeof a&&(c=a.g,b=a.b,d=a.a,a=a.r);this._val=(("number"==typeof d?d:255)<<24>>>0)+((b||0)<<16)+((c||0)<<8)+(a||0)}d.extend(b,e);f("../platform/CCClass").fastDefine("cc.Color",b,{r:0,g:0,b:0,a:255});var a={WHITE:[255,255,255,255],BLACK:[0,0,0,255],TRANSPARENT:[0,0,0,0],GRAY:[127.5,127.5,127.5],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,235,4],ORANGE:[255,127,0],CYAN:[0,255,255],MAGENTA:[255,0,255]},
c;for(c in a)d.get(b,c,function(a){return function(){return new b(a[0],a[1],a[2],a[3])}}(a[c]));a=b.prototype;return a.clone=function(){var a=new b;return a._val=this._val,a},a.equals=function(a){return a&&this._val===a._val},a.lerp=function(a,c,d){d=d||new b;var g=this.r,e=this.g,k=this.b,f=this.a;return d.r=g+(a.r-g)*c,d.g=e+(a.g-e)*c,d.b=k+(a.b-k)*c,d.a=f+(a.a-f)*c,d},a.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},a.getR=
function(){return 255&this._val},a.setR=function(a){return a=~~cc.misc.clampf(a,0,255),this._val=(4294967040&this._val|a)>>>0,this},a.getG=function(){return(65280&this._val)>>8},a.setG=function(a){return a=~~cc.misc.clampf(a,0,255),this._val=(4294902015&this._val|a<<8)>>>0,this},a.getB=function(){return(16711680&this._val)>>16},a.setB=function(a){return a=~~cc.misc.clampf(a,0,255),this._val=(4278255615&this._val|a<<16)>>>0,this},a.getA=function(){return(4278190080&this._val)>>>24},a.setA=function(a){return a=
~~cc.misc.clampf(a,0,255),this._val=(16777215&this._val|a<<24)>>>0,this},a._fastSetA=function(a){this._val=(16777215&this._val|a<<24)>>>0},d.getset(a,"r",a.getR,a.setR,!0),d.getset(a,"g",a.getG,a.setG,!0),d.getset(a,"b",a.getB,a.setB,!0),d.getset(a,"a",a.getA,a.setA,!0),a.toCSS=function(a){return"rgba"===a?"rgba("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+","+(this.a/255).toFixed(2)+")":"rgb"===a?"rgb("+(0|this.r)+","+(0|this.g)+","+(0|this.b)+")":"#"+this.toHEX(a)},a.fromHEX=function(a){a=0===a.indexOf("#")?
a.substring(1):a;var c=parseInt(a.substr(0,2),16)||0,b=parseInt(a.substr(2,2),16)||0,d=parseInt(a.substr(4,2),16)||0;return this._val=((parseInt(a.substr(6,2),16)||255)<<24>>>0)+(d<<16)+(b<<8)+c,this},a.toHEX=function(a){var c=[(16>this.r?"0":"")+(0|this.r).toString(16),(16>this.g?"0":"")+(0|this.g).toString(16),(16>this.b?"0":"")+(0|this.b).toString(16)];if("#rgb"===a)for(a=0;a<c.length;++a)1<c[a].length&&(c[a]=c[a][0]);else if("#rrggbb"===a)for(a=0;a<c.length;++a)1===c[a].length&&(c[a]="0"+c[a]);
else"#rrggbbaa"===a&&c.push((16>this.a?"0":"")+(0|this.a).toString(16));return c.join("")},a.toRGBValue=function(){return 16777215&this._val},a.fromHSV=function(a,c,b){var d,g;if(0===c)var e=d=g=b;else if(0===b)e=d=g=0;else{1===a&&(a=0);a*=6;var k=Math.floor(a),f=a-k;a=b*(1-c);var l=b*(1-c*f);c=b*(1-c*(1-f));switch(k){case 0:e=b;d=c;g=a;break;case 1:e=l;d=b;g=a;break;case 2:e=a;d=b;g=c;break;case 3:e=a;d=l;g=b;break;case 4:e=c;d=a;g=b;break;case 5:e=b,d=a,g=l}}return e*=255,d*=255,g*=255,this._val=
(this.a<<24>>>0)+(g<<16)+(d<<8)+e,this},a.toHSV=function(){var a=this.r/255,c=this.g/255,b=this.b/255,d={h:0,s:0,v:0},e=Math.max(a,c,b),f=Math.min(a,c,b),p=0;return d.v=e,d.s=e?(e-f)/e:0,d.s?(p=e-f,d.h=a===e?(c-b)/p:c===e?2+(b-a)/p:4+(a-c)/p,d.h/=6,0>d.h&&(d.h+=1)):d.h=0,d},a.set=function(a){a._val?this._val=a._val:(this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a)},a.array=function(a){h.color4.array(a,this)},b}();cc.Color=m;cc.color=function(b,a,c,d){return"string"==typeof b?(new cc.Color).fromHEX(b):
"object"==typeof b?new cc.Color(b.r,b.g,b.b,b.a):new cc.Color(b,a,c,d)};n.exports=cc.Color},{"../platform/CCClass":130,"../platform/js":150,"../vmath":246,"./value-type":240}],235:[function(f,n,m){f("./value-type");cc.vmath=f("../vmath").default;n.exports={Vec2:f("./vec2"),Vec3:f("./vec3"),Vec4:f("./vec4"),Quat:f("./quat"),Mat4:f("./mat4"),Size:f("./size"),Rect:f("./rect"),Color:f("./color")}},{"../vmath":246,"./color":234,"./mat4":236,"./quat":237,"./rect":238,"./size":239,"./value-type":240,"./vec2":241,
"./vec3":242,"./vec4":243}],236:[function(f,n,m){function h(a,c,b,e,f,q,r,t,p,v,h,m,x,y,u,n){var g=this.m=new d.FLOAT_ARRAY_TYPE(16);g[0]=a;g[1]=c;g[2]=b;g[3]=e;g[4]=f;g[5]=q;g[6]=r;g[7]=t;g[8]=p;g[9]=v;g[10]=h;g[11]=m;g[12]=x;g[13]=y;g[14]=u;g[15]=n}var e=f("../vmath"),d=f("../vmath/utils"),b=f("./value-type");m=f("../platform/js");f=f("../platform/CCClass");m.extend(h,b);f.fastDefine("cc.Mat4",h,{m00:1,m01:0,m02:0,m03:0,m04:0,m05:1,m06:0,m07:0,m08:0,m09:0,m10:1,m11:0,m12:0,m13:0,m14:0,m15:1});f=
function(a){Object.defineProperty(h.prototype,"m"+a,{get:function(){return this.m[a]},set:function(c){this.m[a]=c}})};for(b=0;16>b;b++)f(b);m.mixin(h.prototype,{clone:function(){var a=this.m;return new h(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])},set:function(a){var c=this.m;a=a.m;return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],
this},equals:function(a){return e.mat4.exactEquals(this,a)},fuzzyEquals:function(a){return e.mat4.equals(this,a)},toString:function(){var a=this.m;return a?"[\n"+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+",\n"+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+",\n"+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+",\n"+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"\n]":"[\n1, 0, 0, 0\n0, 1, 0, 0\n0, 0, 1, 0\n0, 0, 0, 1\n]"},identity:function(){return e.mat4.identity(this)},transpose:function(a){return a=a||new cc.Mat4,e.mat4.transpose(a,
this)},invert:function(a){return a=a||new cc.Mat4,e.mat4.invert(a,this)},adjoint:function(a){return a=a||new cc.Mat4,e.mat4.adjoint(a,this)},determinant:function(){return e.mat4.determinant(this)},add:function(a,c){return c=c||new cc.Mat4,e.mat4.add(c,this,a)},sub:function(a,c){return c=c||new cc.Mat4,e.mat4.subtract(c,this,a)},mul:function(a,c){return c=c||new cc.Mat4,e.mat4.multiply(c,this,a)},mulScalar:function(a,c){return c=c||new cc.Mat4,e.mat4.mulScalar(c,this,a)},translate:function(a,c){return c=
c||new cc.Mat4,e.mat4.translate(c,this,a)},scale:function(a,c){return c=c||new cc.Mat4,e.mat4.scale(c,this,a)},rotate:function(a,c,b){return b=b||new cc.Mat4,e.mat4.rotate(b,this,a,c)},getTranslation:function(a){return a=a||new cc.Vec3,e.mat4.getTranslation(a,this)},getScale:function(a){return a=a||new cc.Vec3,e.mat4.getScaling(a,this)},getRotation:function(a){return a=a||new cc.Quat,e.mat4.getRotation(a,this)},fromRTS:function(a,c,b){return e.mat4.fromRTS(this,a,c,b)},fromQuat:function(a){return e.mat4.fromQuat(this,
a)},array:function(a){return e.mat4.array(a,this)}});cc.mat4=function(a,c,b,d,f,q,r,t,p,v,w,m,x,y,u,n){c=new h(a,c,b,d,f,q,r,t,p,v,w,m,x,y,u,n);return void 0===a&&e.mat4.identity(c),c};n.exports=cc.Mat4=h},{"../platform/CCClass":130,"../platform/js":150,"../vmath":246,"../vmath/utils":253,"./value-type":240}],237:[function(f,n,m){function h(a,c,b,d){a&&"object"==typeof a&&(b=a.z,c=a.y,d=a.w,a=a.x);this.x=a||0;this.y=c||0;this.z=b||0;this.w=d||1}m=f("./value-type");var e=f("../platform/js"),d=f("../platform/CCClass"),
b=f("../vmath/quat");e.extend(h,m);d.fastDefine("cc.Quat",h,{x:0,y:0,z:0,w:1});f=h.prototype;f.clone=function(){return new h(this.x,this.y,this.z,this.w)};f.set=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this};f.equals=function(a){return a&&this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w};f.toEuler=function(a){return b.toEuler(a,this),a};f.fromEuler=function(a){return b.fromEuler(this,a.x,a.y,a.z),this};f.lerp=function(a,c,d){return d=d||new cc.Quat,b.slerp(d,this,a,c),
d};f.mul=function(a,c){return c=c||new cc.Quat,b.mul(c,this,a),c};f.array=function(a){b.array(a,this)};f.rotateAround=function(a,c,d,e){return e=e||new cc.Quat,b.rotateAround(e,a,c,d)};cc.quat=function(a,c,b,d){return new h(a,c,b,d)};n.exports=cc.Quat=h},{"../platform/CCClass":130,"../platform/js":150,"../vmath/quat":251,"./value-type":240}],238:[function(f,n,m){function h(d,b,a,c){d&&"object"==typeof d&&(b=d.y,a=d.width,c=d.height,d=d.x);this.x=d||0;this.y=b||0;this.width=a||0;this.height=c||0}var e=
f("./value-type");m=f("../platform/js");m.extend(h,e);f("../platform/CCClass").fastDefine("cc.Rect",h,{x:0,y:0,width:0,height:0});h.fromMinMax=function(d,b){var a=Math.min(d.x,b.x),c=Math.min(d.y,b.y);return new h(a,c,Math.max(d.x,b.x)-a,Math.max(d.y,b.y)-c)};f=h.prototype;f.clone=function(){return new h(this.x,this.y,this.width,this.height)};f.equals=function(d){return d&&this.x===d.x&&this.y===d.y&&this.width===d.width&&this.height===d.height};f.lerp=function(d,b,a){a=a||new h;var c=this.x,g=this.y,
e=this.width,f=this.height;return a.x=c+(d.x-c)*b,a.y=g+(d.y-g)*b,a.width=e+(d.width-e)*b,a.height=f+(d.height-f)*b,a};f.set=function(d){this.x=d.x;this.y=d.y;this.width=d.width;this.height=d.height};f.intersects=function(d){var b=this.y+this.height,a=d.x+d.width,c=d.y+d.height;return!(this.x+this.width<d.x||a<this.x||b<d.y||c<this.y)};f.intersection=function(d,b){var a=this.y,c=this.x+this.width,g=this.y+this.height,e=b.y,f=b.x+b.width,q=b.y+b.height;return d.x=Math.max(this.x,b.x),d.y=Math.max(a,
e),d.width=Math.min(c,f)-d.x,d.height=Math.min(g,q)-d.y,d};f.contains=function(d){return this.x<=d.x&&this.x+this.width>=d.x&&this.y<=d.y&&this.y+this.height>=d.y};f.containsRect=function(d){return this.x<=d.x&&this.x+this.width>=d.x+d.width&&this.y<=d.y&&this.y+this.height>=d.y+d.height};f.union=function(d,b){var a=this.x,c=this.y,g=this.width,e=this.height,f=b.x,q=b.y,r=b.width;b=b.height;return d.x=Math.min(a,f),d.y=Math.min(c,q),d.width=Math.max(a+g,f+r)-d.x,d.height=Math.max(c+e,q+b)-d.y,d};
f.transformMat4=function(d,b){var a=this.x,c=this.y,g=a+this.width,e=c+this.height,f=b.m,q=f[0]*a+f[4]*c+f[12];b=f[1]*a+f[5]*c+f[13];var r=f[0]*g+f[4]*c+f[12];c=f[1]*g+f[5]*c+f[13];var t=f[0]*a+f[4]*e+f[12];a=f[1]*a+f[5]*e+f[13];var p=f[0]*g+f[4]*e+f[12];e=f[1]*g+f[5]*e+f[13];g=Math.min(q,r,t,p);q=Math.max(q,r,t,p);r=Math.min(b,c,a,e);b=Math.max(b,c,a,e);return d.x=g,d.y=r,d.width=q-g,d.height=b-r,d};f.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+
", "+this.height.toFixed(2)+")"};m.getset(f,"xMin",function(){return this.x},function(d){this.width+=this.x-d;this.x=d});m.getset(f,"yMin",function(){return this.y},function(d){this.height+=this.y-d;this.y=d});m.getset(f,"xMax",function(){return this.x+this.width},function(d){this.width=d-this.x});m.getset(f,"yMax",function(){return this.y+this.height},function(d){this.height=d-this.y});m.getset(f,"center",function(){return new cc.Vec2(this.x+.5*this.width,this.y+.5*this.height)},function(d){this.x=
d.x-.5*this.width;this.y=d.y-.5*this.height});m.getset(f,"origin",function(){return new cc.Vec2(this.x,this.y)},function(d){this.x=d.x;this.y=d.y});m.getset(f,"size",function(){return new cc.Size(this.width,this.height)},function(d){this.width=d.width;this.height=d.height});cc.Rect=h;cc.rect=function(d,b,a,c){return new h(d,b,a,c)};n.exports=cc.Rect},{"../platform/CCClass":130,"../platform/js":150,"./value-type":240}],239:[function(f,n,m){function h(d,b){d&&"object"==typeof d&&(b=d.height,d=d.width);
this.width=d||0;this.height=b||0}m=f("./value-type");var e=f("../platform/js");e.extend(h,m);f("../platform/CCClass").fastDefine("cc.Size",h,{width:0,height:0});e.get(h,"ZERO",function(){return new h(0,0)});f=h.prototype;f.clone=function(){return new h(this.width,this.height)};f.equals=function(d){return d&&this.width===d.width&&this.height===d.height};f.lerp=function(d,b,a){a=a||new h;var c=this.width,g=this.height;return a.width=c+(d.width-c)*b,a.height=g+(d.height-g)*b,a};f.set=function(d){this.width=
d.width;this.height=d.height};f.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"};cc.size=function(d,b){return new h(d,b)};cc.Size=n.exports=h},{"../platform/CCClass":130,"../platform/js":150,"./value-type":240}],240:[function(f,n,m){function h(){}f("../platform/js").setClassName("cc.ValueType",h);h.prototype.toString=function(){return"[object Object]"};cc.ValueType=n.exports=h},{"../platform/js":150}],241:[function(f,n,m){function h(a,b){a&&"object"==typeof a&&
(b=a.y,a=a.x);this.x=a||0;this.y=b||0}var e=f("../vmath"),d=f("./value-type");m=f("../platform/js");var b=f("../platform/CCClass"),a=f("../utils/misc");m.extend(h,d);b.fastDefine("cc.Vec2",h,{x:0,y:0});f=h.prototype;m.value(f,"z",0,!0);f.clone=function(){return new h(this.x,this.y)};f.set=function(a){return this.x=a.x,this.y=a.y,this};f.equals=function(a){return a&&this.x===a.x&&this.y===a.y};f.fuzzyEquals=function(a,b){return this.x-b<=a.x&&a.x<=this.x+b&&this.y-b<=a.y&&a.y<=this.y+b};f.toString=
function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"};f.lerp=function(a,b,d){d=d||new h;var c=this.x,g=this.y;return d.x=c+(a.x-c)*b,d.y=g+(a.y-g)*b,d};f.clampf=function(c,b){return this.x=a.clampf(this.x,c.x,b.x),this.y=a.clampf(this.y,c.y,b.y),this};f.addSelf=function(a){return this.x+=a.x,this.y+=a.y,this};f.add=function(a,b){return(b=b||new h).x=this.x+a.x,b.y=this.y+a.y,b};f.subSelf=function(a){return this.x-=a.x,this.y-=a.y,this};f.sub=function(a,b){return(b=b||new h).x=this.x-
a.x,b.y=this.y-a.y,b};f.mulSelf=function(a){return this.x*=a,this.y*=a,this};f.mul=function(a,b){return(b=b||new h).x=this.x*a,b.y=this.y*a,b};f.scaleSelf=function(a){return this.x*=a.x,this.y*=a.y,this};f.scale=function(a,b){return(b=b||new h).x=this.x*a.x,b.y=this.y*a.y,b};f.divSelf=function(a){return this.x/=a,this.y/=a,this};f.div=function(a,b){return(b=b||new h).x=this.x/a,b.y=this.y/a,b};f.negSelf=function(){return this.x=-this.x,this.y=-this.y,this};f.neg=function(a){return(a=a||new h).x=-this.x,
a.y=-this.y,a};f.dot=function(a){return this.x*a.x+this.y*a.y};f.cross=function(a){return this.x*a.y-this.y*a.x};f.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};f.magSqr=function(){return this.x*this.x+this.y*this.y};f.normalizeSelf=function(){var a=this.x*this.x+this.y*this.y;if(1===a||0===a)return this;a=1/Math.sqrt(a);return this.x*=a,this.y*=a,this};f.normalize=function(a){return(a=a||new h).x=this.x,a.y=this.y,a.normalizeSelf(),a};f.angle=function(c){var b=this.magSqr(),d=c.magSqr();
if(0===b||0===d)return console.warn("Can't get angle between zero vector"),0;c=this.dot(c)/Math.sqrt(b*d);return c=a.clampf(c,-1,1),Math.acos(c)};f.signAngle=function(a){var c=this.angle(a);return 0>this.cross(a)?-c:c};f.rotate=function(a,b){return(b=b||new h).x=this.x,b.y=this.y,b.rotateSelf(a)};f.rotateSelf=function(a){var c=Math.sin(a);a=Math.cos(a);var b=this.x;return this.x=a*b-c*this.y,this.y=c*b+a*this.y,this};f.project=function(a){return a.mul(this.dot(a)/a.dot(a))};f.transformMat4=function(a,
b){b=b||new h;e.vec2.transformMat4(b,this,a)};f.fromTranslation=function(a){return this.x=a[0],this.y=a[1],this};f.toTranslation=function(a){a[0]=this.x;a[1]=this.y};f.fromScale=function(a){return this.x=a[7],this.y=a[8],this};f.toScale=function(a){a[7]=this.x;a[8]=this.y};f.array=function(a){e.vec2.array(a,this)};m.get(h,"ONE",function(){return new h(1,1)});m.get(h,"ZERO",function(){return new h(0,0)});m.get(h,"UP",function(){return new h(0,1)});m.get(h,"RIGHT",function(){return new h(1,0)});cc.Vec2=
h;cc.v2=function(a,b){return new h(a,b)};cc.p=cc.v2;n.exports=cc.Vec2},{"../platform/CCClass":130,"../platform/js":150,"../utils/misc":220,"../vmath":246,"./value-type":240}],242:[function(f,n,m){function h(a,c,b){a&&"object"==typeof a&&(b=a.z,c=a.y,a=a.x);this.x=a||0;this.y=c||0;this.z=b||0}var e=f("../vmath"),d=f("./value-type");m=f("../platform/js");var b=f("../platform/CCClass"),a=f("../utils/misc"),c=f("./vec2").prototype;m.extend(h,d);b.fastDefine("cc.Vec3",h,{x:0,y:0,z:0});f=h.prototype;f.clone=
function(){return new h(this.x,this.y,this.z)};f.set=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this};f.equals=function(a){return a&&this.x===a.x&&this.y===a.y&&this.z===a.z};f.fuzzyEquals=function(a,c){return this.x-c<=a.x&&a.x<=this.x+c&&this.y-c<=a.y&&a.y<=this.y+c&&this.z-c<=a.z&&a.z<=this.z+c};f.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+")"};f.lerp=function(a,c,b){return b=b||new h,e.vec3.lerp(b,this,a,c),b};f.clampf=function(c,b){return this.x=
a.clampf(this.x,c.x,b.x),this.y=a.clampf(this.y,c.y,b.y),this.z=a.clampf(this.z,c.z,b.z),this};f.addSelf=function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this};f.add=function(a,c){return(c=c||new h).x=this.x+a.x,c.y=this.y+a.y,c.z=this.z+a.z,c};f.subSelf=function(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this};f.sub=function(a,c){return(c=c||new h).x=this.x-a.x,c.y=this.y-a.y,c.z=this.z-a.z,c};f.mulSelf=function(a){return this.x*=a,this.y*=a,this.z*=a,this};f.mul=function(a,c){return(c=
c||new h).x=this.x*a,c.y=this.y*a,c.z=this.z*a,c};f.scaleSelf=function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this};f.scale=function(a,c){return(c=c||new h).x=this.x*a.x,c.y=this.y*a.y,c.z=this.z*a.z,c};f.divSelf=function(a){return this.x/=a,this.y/=a,this.z/=a,this};f.div=function(a,c){return(c=c||new h).x=this.x/a,c.y=this.y/a,c.z=this.z/a,c};f.negSelf=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this};f.neg=function(a){return(a=a||new h).x=-this.x,a.y=-this.y,a.z=-this.z,
a};f.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};f.cross=function(a,c){return c=c||new h,e.vec3.cross(c,this,a),c};f.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};f.magSqr=function(){return this.x*this.x+this.y*this.y+this.z*this.z};f.normalizeSelf=function(){return e.vec3.normalize(this,this),this};f.normalize=function(a){return a=a||new h,e.vec3.normalize(a,this),a};f.transformMat4=function(a,c){c=c||new h;e.vec3.transformMat4(c,this,a)};f.angle=c.angle;
f.project=c.project;f.signAngle=function(a){cc.warnID(1408,"vec3.signAngle","v2.1","cc.v2(selfVector).signAngle(vector)");var c=new cc.Vec2(this.x,this.y);a=new cc.Vec2(a.x,a.y);return c.signAngle(a)};f.rotate=function(a,b){return cc.warnID(1408,"vec3.rotate","v2.1","cc.v2(selfVector).rotate(radians, out)"),c.rotate.call(this,a,b)};f.rotateSelf=function(a){return cc.warnID(1408,"vec3.rotateSelf","v2.1","cc.v2(selfVector).rotateSelf(radians)"),c.rotateSelf.call(this,a)};f.array=function(a){e.vec3.array(a,
this)};m.get(h,"ONE",function(){return new h(1,1,1)});m.get(h,"ZERO",function(){return new h(0,0,0)});m.get(h,"UP",function(){return new h(0,1,0)});m.get(h,"RIGHT",function(){return new h(1,0,0)});m.get(h,"FRONT",function(){return new h(0,0,1)});cc.v3=function(a,c,b){return new h(a,c,b)};n.exports=cc.Vec3=h},{"../platform/CCClass":130,"../platform/js":150,"../utils/misc":220,"../vmath":246,"./value-type":240,"./vec2":241}],243:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,
c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m=h(f("./value-type"));var d=h(f("../platform/CCClass")),b=f("../vmath"),a=f("../utils/misc"),c=function(c){function d(a,b,g,e){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
var f=c.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!=typeof f&&"function"!=typeof f?this:f;return a&&"object"==typeof a&&(e=a.w,g=a.z,b=a.y,a=a.x),f.x=a||0,f.y=b||0,f.z=g||0,f.w=e||0,f}return e(d,c),d.prototype.clone=function(){return new d(this.x,this.y,this.z,this.w)},d.prototype.set=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this},d.prototype.equals=function(a){return a&&this.x===a.x&&this.y===a.y&&
this.z===a.z&&this.w===a.w},d.prototype.fuzzyEquals=function(a,c){return this.x-c<=a.x&&a.x<=this.x+c&&this.y-c<=a.y&&a.y<=this.y+c&&this.z-c<=a.z&&a.z<=this.z+c&&this.w-c<=a.w&&a.w<=this.w+c},d.prototype.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+", "+this.w.toFixed(2)+")"},d.prototype.lerp=function(a,c,g){return g=g||new d,b.vec4.lerp(g,this,a,c),g},d.prototype.clampf=function(c,b){return this.x=(0,a.clampf)(this.x,c.x,b.x),this.y=(0,a.clampf)(this.y,
c.y,b.y),this.z=(0,a.clampf)(this.z,c.z,b.z),this.w=(0,a.clampf)(this.w,c.w,b.w),this},d.prototype.addSelf=function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this},d.prototype.add=function(a,c){return(c=c||new d).x=this.x+a.x,c.y=this.y+a.y,c.z=this.z+a.z,c.w=this.w+a.w,c},d.prototype.subSelf=function(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this},d.prototype.sub=function(a,c){return(c=c||new d).x=this.x-a.x,c.y=this.y-a.y,c.z=this.z-a.z,c.w=this.w-a.w,c},d.prototype.mulSelf=
function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},d.prototype.mul=function(a,c){return(c=c||new d).x=this.x*a,c.y=this.y*a,c.z=this.z*a,c.w=this.w*a,c},d.prototype.scaleSelf=function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this},d.prototype.scale=function(a,c){return(c=c||new d).x=this.x*a.x,c.y=this.y*a.y,c.z=this.z*a.z,c.w=this.w*a.w,c},d.prototype.divSelf=function(a){return this.x/=a,this.y/=a,this.z/=a,this.w/=a,this},d.prototype.div=function(a,c){return(c=c||
new d).x=this.x/a,c.y=this.y/a,c.z=this.z/a,c.w=this.w/a,c},d.prototype.negSelf=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},d.prototype.neg=function(a){return(a=a||new d).x=-this.x,a.y=-this.y,a.z=-this.z,a.w=-this.w,a},d.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},d.prototype.cross=function(a,c){return c=c||new d,b.vec4.cross(c,this,a),c},d.prototype.mag=function(){var a=this.x,c=this.y,b=this.z,d=this.w;return Math.sqrt(a*
a+c*c+b*b+d*d)},d.prototype.magSqr=function(){var a=this.x,c=this.y,b=this.z,d=this.w;return a*a+c*c+b*b+d*d},d.prototype.normalizeSelf=function(){return b.vec4.normalize(this,this),this},d.prototype.normalize=function(a){return a=a||new d,b.vec4.normalize(a,this),a},d.prototype.transformMat4=function(a,c){return c=c||new d,b.vec4.transformMat4(c,this,a),c},d.prototype.array=function(a){b.vec4.array(a,this)},d}(m.default);d.default.fastDefine("cc.Vec4",c,{x:0,y:0,z:0,w:0});cc.v4=function(a,b,d,e){return new c(a,
b,d,e)};n.exports=cc.Vec4=c},{"../platform/CCClass":130,"../utils/misc":220,"../vmath":246,"./value-type":240}],244:[function(f,n,m){m.__esModule=!0;var h=f("./utils");f=function(){function e(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.r=d;this.g=b;this.b=a}return e.create=function(){return new e(0<
arguments.length&&void 0!==arguments[0]?arguments[0]:1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,2<arguments.length&&void 0!==arguments[2]?arguments[2]:1)},e.clone=function(d){return new e(d.r,d.g,d.b)},e.copy=function(d,b){return d.r=b.r,d.g=b.g,d.b=b.b,d},e.set=function(d,b,a,c){return d.r=b,d.g=a,d.b=c,d},e.fromHex=function(d,b){return d.r=(b>>16)/255,d.g=(b>>8&255)/255,d.b=(255&b)/255,d},e.add=function(d,b,a){return d.r=b.r+a.r,d.g=b.g+a.g,d.b=b.b+a.b,d},e.subtract=function(d,b,
a){return d.r=b.r-a.r,d.g=b.g-a.g,d.b=b.b-a.b,d},e.sub=function(d,b,a){return e.subtract(d,b,a)},e.multiply=function(d,b,a){return d.r=b.r*a.r,d.g=b.g*a.g,d.b=b.b*a.b,d},e.mul=function(d,b,a){return e.multiply(d,b,a)},e.divide=function(d,b,a){return d.r=b.r/a.r,d.g=b.g/a.g,d.b=b.b/a.b,d},e.div=function(d,b,a){return e.divide(d,b,a)},e.scale=function(d,b,a){return d.r=b.r*a,d.g=b.g*a,d.b=b.b*a,d},e.lerp=function(d,b,a,c){var g=b.r,e=b.g;b=b.b;return d.r=g+c*(a.r-g),d.g=e+c*(a.g-e),d.b=b+c*(a.b-b),
d},e.str=function(d){return"color3("+d.r+", "+d.g+", "+d.b+")"},e.array=function(d,b){var a=b instanceof cc.Color?1/255:1;return d[0]=b.r*a,d[1]=b.g*a,d[2]=b.b*a,d},e.exactEquals=function(d,b){return d.r===b.r&&d.g===b.g&&d.b===b.b},e.equals=function(d,b){var a=d.r,c=d.g;d=d.b;var g=b.r,e=b.g;b=b.b;return Math.abs(a-g)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(c-e)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&Math.abs(d-b)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},e.hex=function(d){return 255*
d.r<<16|255*d.g<<8|255*d.b},e}();m.default=f;n.exports=m.default},{"./utils":253}],245:[function(f,n,m){m.__esModule=!0;var h=f("./utils");f=function(){function e(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.r=d;this.g=
b;this.b=a;this.a=c}return e.create=function(){return new e(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1)},e.clone=function(d){return new e(d.r,d.g,d.b,d.a)},e.copy=function(d,b){return d.r=b.r,d.g=b.g,d.b=b.b,d.a=b.a,d},e.set=function(d,b,a,c,g){return d.r=b,d.g=a,d.b=c,d.a=g,d},e.fromHex=function(d,b){return d.r=(b>>
24)/255,d.g=(b>>16&255)/255,d.b=(b>>8&255)/255,d.a=(255&b)/255,d},e.add=function(d,b,a){return d.r=b.r+a.r,d.g=b.g+a.g,d.b=b.b+a.b,d.a=b.a+a.a,d},e.subtract=function(d,b,a){return d.r=b.r-a.r,d.g=b.g-a.g,d.b=b.b-a.b,d.a=b.a-a.a,d},e.sub=function(d,b,a){return e.subtract(d,b,a)},e.multiply=function(d,b,a){return d.r=b.r*a.r,d.g=b.g*a.g,d.b=b.b*a.b,d.a=b.a*a.a,d},e.mul=function(d,b,a){return e.multiply(d,b,a)},e.divide=function(d,b,a){return d.r=b.r/a.r,d.g=b.g/a.g,d.b=b.b/a.b,d.a=b.a/a.a,d},e.div=
function(d,b,a){return e.divide(d,b,a)},e.scale=function(d,b,a){return d.r=b.r*a,d.g=b.g*a,d.b=b.b*a,d.a=b.a*a,d},e.lerp=function(d,b,a,c){var g=b.r,e=b.g,f=b.b;b=b.a;return d.r=g+c*(a.r-g),d.g=e+c*(a.g-e),d.b=f+c*(a.b-f),d.a=b+c*(a.a-b),d},e.str=function(d){return"color4("+d.r+", "+d.g+", "+d.b+", "+d.a+")"},e.array=function(d,b){var a=b instanceof cc.Color||1<b.a?1/255:1;return d[0]=b.r*a,d[1]=b.g*a,d[2]=b.b*a,d[3]=b.a*a,d},e.exactEquals=function(d,b){return d.r===b.r&&d.g===b.g&&d.b===b.b&&d.a===
b.a},e.equals=function(d,b){var a=d.r,c=d.g,g=d.b;d=d.a;var e=b.r,f=b.g,q=b.b;b=b.a;return Math.abs(a-e)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(e))&&Math.abs(c-f)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(g-q)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(q))&&Math.abs(d-b)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},e.hex=function(d){return(255*d.r<<24|255*d.g<<16|255*d.b<<8|255*d.a)>>>0},e}();m.default=f;n.exports=m.default},{"./utils":253}],246:[function(f,n,m){function h(a){return a&&
a.__esModule?a:{default:a}}m.__esModule=!0;m.color4=m.color3=m.mat4=m.mat3=m.mat23=m.mat2=m.trs=m.quat=m.vec4=m.vec3=m.vec2=void 0;var e=f("./utils");Object.keys(e).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(m,a,{enumerable:!0,get:function(){return e[a]}})});n=h(f("./vec2"));var d=h(f("./vec3")),b=h(f("./vec4")),a=h(f("./quat")),c=h(f("./trs")),g=h(f("./mat2")),k=h(f("./mat23")),l=h(f("./mat3")),q=h(f("./mat4")),r=h(f("./color3"));f=h(f("./color4"));m.vec2=n.default;
m.vec3=d.default;m.vec4=b.default;m.quat=a.default;m.trs=c.default;m.mat2=g.default;m.mat23=k.default;m.mat3=l.default;m.mat4=q.default;m.color3=r.default;m.color4=f.default;m.default={vec2:n.default,vec3:d.default,vec4:b.default,quat:a.default,trs:c.default,mat2:g.default,mat23:k.default,mat3:l.default,mat4:q.default,color3:r.default,color4:f.default}},{"./color3":244,"./color4":245,"./mat2":247,"./mat23":248,"./mat3":249,"./mat4":250,"./quat":251,"./trs":252,"./utils":253,"./vec2":254,"./vec3":255,
"./vec4":256}],247:[function(f,n,m){m.__esModule=!0;var h=f("./utils");f=function(){function e(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");if("object"==typeof d)b?(this.m=new d.constructor(4),this.m.set(d)):this.m=d;else{var g=
this.m=new h.FLOAT_ARRAY_TYPE(4);g[0]=d;g[1]=b;g[2]=a;g[3]=c}}return e.create=function(){return new e(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1)},e.clone=function(d){d=d.m;return new e(d[0],d[1],d[2],d[3])},e.copy=function(d,b){return d.m.set(b.m),d},e.identity=function(d){var b=d.m;return b[0]=1,b[1]=0,b[2]=0,b[3]=
1,d},e.set=function(d,b,a,c,g){var e=d.m;return e[0]=b,e[1]=a,e[2]=c,e[3]=g,d},e.transpose=function(d,b){var a=d.m,c=b.m;d===b?(b=c[1],a[1]=c[2],a[2]=b):(a[0]=c[0],a[1]=c[2],a[2]=c[1],a[3]=c[3]);return d},e.invert=function(d,b){var a=b.m;b=d.m;var c=a[0],g=a[1],e=a[2];a=a[3];var f=c*a-e*g;return f?(f=1/f,b[0]=a*f,b[1]=-g*f,b[2]=-e*f,b[3]=c*f,d):null},e.adjoint=function(d,b){var a=d.m;b=b.m;var c=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=c,d},e.determinant=function(d){d=d.m;return d[0]*d[3]-
d[2]*d[1]},e.multiply=function(d,b,a){var c=b.m;b=d.m;var g=a.m;a=c[0];var e=c[1],f=c[2];c=c[3];var q=g[0],r=g[1],t=g[2];g=g[3];return b[0]=a*q+f*r,b[1]=e*q+c*r,b[2]=a*t+f*g,b[3]=e*t+c*g,d},e.mul=function(d,b,a){return e.multiply(d,b,a)},e.rotate=function(d,b,a){var c=b.m;b=d.m;var g=c[0],e=c[1],f=c[2];c=c[3];var q=Math.sin(a);a=Math.cos(a);return b[0]=g*a+f*q,b[1]=e*a+c*q,b[2]=g*-q+f*a,b[3]=e*-q+c*a,d},e.scale=function(d,b,a){b=b.m;var c=d.m,g=b[1],e=b[2],f=b[3],q=a.x;a=a.y;return c[0]=b[0]*q,c[1]=
g*q,c[2]=e*a,c[3]=f*a,d},e.fromRotation=function(d,b){var a=d.m,c=Math.sin(b);b=Math.cos(b);return a[0]=b,a[1]=c,a[2]=-c,a[3]=b,d},e.fromScaling=function(d,b){var a=d.m;return a[0]=b.x,a[1]=0,a[2]=0,a[3]=b.y,d},e.str=function(d){d=d.m;return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},e.array=function(d,b){b=b.m;return d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],d},e.frob=function(d){d=d.m;return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2))},e.LDU=function(d,b,a,c){d=
d.m;a=a.m;c=c.m;d[2]=c[2]/c[0];a[0]=c[0];a[1]=c[1];a[3]=c[3]-d[2]*a[1]},e.add=function(d,b,a){b=b.m;a=a.m;var c=d.m;return c[0]=b[0]+a[0],c[1]=b[1]+a[1],c[2]=b[2]+a[2],c[3]=b[3]+a[3],d},e.subtract=function(d,b,a){b=b.m;a=a.m;var c=d.m;return c[0]=b[0]-a[0],c[1]=b[1]-a[1],c[2]=b[2]-a[2],c[3]=b[3]-a[3],d},e.sub=function(d,b,a){return e.subtract(d,b,a)},e.exactEquals=function(d,b){d=d.m;b=b.m;return d[0]===b[0]&&d[1]===b[1]&&d[2]===b[2]&&d[3]===b[3]},e.equals=function(d,b){var a=d.m,c=b.m;b=a[0];d=a[1];
var g=a[2];a=a[3];var e=c[0],f=c[1],q=c[2];c=c[3];return Math.abs(b-e)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(e))&&Math.abs(d-f)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(g-q)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(q))&&Math.abs(a-c)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},e.multiplyScalar=function(d,b,a){b=b.m;var c=d.m;return c[0]=b[0]*a,c[1]=b[1]*a,c[2]=b[2]*a,c[3]=b[3]*a,d},e.multiplyScalarAndAdd=function(d,b,a,c){b=b.m;a=a.m;var g=d.m;return g[0]=b[0]+a[0]*c,g[1]=
b[1]+a[1]*c,g[2]=b[2]+a[2]*c,g[3]=b[3]+a[3]*c,d},e}();m.default=f;n.exports=m.default},{"./utils":253}],248:[function(f,n,m){m.__esModule=!0;var h=f("./utils");f=function(){function e(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,g=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,f=5<arguments.length&&
void 0!==arguments[5]?arguments[5]:0;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");if("object"==typeof d)b?(this.m=new d.constructor(6),this.m.set(d)):this.m=d;else{var l=this.m=new h.FLOAT_ARRAY_TYPE(6);l[0]=d;l[1]=b;l[2]=a;l[3]=c;l[4]=g;l[5]=f}}return e.create=function(){return new e(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&
void 0!==arguments[3]?arguments[3]:1,4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0)},e.clone=function(d){d=d.m;return new e(d[0],d[1],d[2],d[3],d[4],d[5])},e.copy=function(d,b){return d.m.set(b.m),d},e.identity=function(d){var b=d.m;return b[0]=1,b[1]=0,b[2]=0,b[3]=1,b[4]=0,b[5]=0,d},e.set=function(d,b,a,c,g,e,f){var k=d.m;return k[0]=b,k[1]=a,k[2]=c,k[3]=g,k[4]=e,k[5]=f,d},e.invert=function(d,b){var a=b.m;b=d.m;var c=a[0],g=a[1],
e=a[2],f=a[3],q=a[4];a=a[5];var r=c*f-g*e;return r?(r=1/r,b[0]=f*r,b[1]=-g*r,b[2]=-e*r,b[3]=c*r,b[4]=(e*a-f*q)*r,b[5]=(g*q-c*a)*r,d):null},e.determinant=function(d){d=d.m;return d[0]*d[3]-d[1]*d[2]},e.multiply=function(d,b,a){var c=b.m,g=a.m;a=d.m;b=c[0];var e=c[1],f=c[2],q=c[3],r=c[4];c=c[5];var t=g[0],p=g[1],v=g[2],h=g[3],m=g[4];g=g[5];return a[0]=b*t+f*p,a[1]=e*t+q*p,a[2]=b*v+f*h,a[3]=e*v+q*h,a[4]=b*m+f*g+r,a[5]=e*m+q*g+c,d},e.mul=function(d,b,a){return e.multiply(d,b,a)},e.rotate=function(d,b,
a){var c=b.m;b=d.m;var g=c[0],e=c[1],f=c[2],q=c[3],r=c[4];c=c[5];var t=Math.sin(a);a=Math.cos(a);return b[0]=g*a+f*t,b[1]=e*a+q*t,b[2]=g*-t+f*a,b[3]=e*-t+q*a,b[4]=r,b[5]=c,d},e.scale=function(d,b,a){b=b.m;var c=d.m,g=b[1],e=b[2],f=b[3],q=b[4],r=b[5],t=a.x;a=a.y;return c[0]=b[0]*t,c[1]=g*t,c[2]=e*a,c[3]=f*a,c[4]=q,c[5]=r,d},e.translate=function(d,b,a){var c=b.m;b=d.m;var g=c[0],e=c[1],f=c[2],q=c[3],r=c[4];c=c[5];var t=a.x;a=a.y;return b[0]=g,b[1]=e,b[2]=f,b[3]=q,b[4]=g*t+f*a+r,b[5]=e*t+q*a+c,d},e.fromRotation=
function(d,b){var a=d.m,c=Math.sin(b);b=Math.cos(b);return a[0]=b,a[1]=c,a[2]=-c,a[3]=b,a[4]=0,a[5]=0,d},e.fromScaling=function(d,b){b=b.m;var a=d.m;return a[0]=b[0],a[1]=0,a[2]=0,a[3]=b[1],a[4]=0,a[5]=0,d},e.fromTranslation=function(d,b){var a=d.m;return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=b.x,a[5]=b.y,d},e.fromRTS=function(d,b,a,c){var g=d.m,e=Math.sin(b);b=Math.cos(b);return g[0]=b*c.x,g[1]=e*c.x,g[2]=-e*c.y,g[3]=b*c.y,g[4]=a.x,g[5]=a.y,d},e.str=function(d){d=d.m;return"mat23("+d[0]+", "+d[1]+", "+
d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},e.array=function(d,b){b=b.m;return d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],d[4]=b[4],d[5]=b[5],d},e.array4x4=function(d,b){b=b.m;return d[0]=b[0],d[1]=b[1],d[2]=0,d[3]=0,d[4]=b[2],d[5]=b[3],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=b[4],d[13]=b[5],d[14]=0,d[15]=1,d},e.frob=function(d){d=d.m;return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+1)},e.add=function(d,b,a){b=b.m;a=a.m;var c=
d.m;return c[0]=b[0]+a[0],c[1]=b[1]+a[1],c[2]=b[2]+a[2],c[3]=b[3]+a[3],c[4]=b[4]+a[4],c[5]=b[5]+a[5],d},e.subtract=function(d,b,a){b=b.m;a=a.m;var c=d.m;return c[0]=b[0]-a[0],c[1]=b[1]-a[1],c[2]=b[2]-a[2],c[3]=b[3]-a[3],c[4]=b[4]-a[4],c[5]=b[5]-a[5],d},e.sub=function(d,b,a){return e.subtract(d,b,a)},e.multiplyScalar=function(d,b,a){b=b.m;var c=d.m;return c[0]=b[0]*a,c[1]=b[1]*a,c[2]=b[2]*a,c[3]=b[3]*a,c[4]=b[4]*a,c[5]=b[5]*a,d},e.multiplyScalarAndAdd=function(d,b,a,c){b=b.m;a=a.m;var g=d.m;return g[0]=
b[0]+a[0]*c,g[1]=b[1]+a[1]*c,g[2]=b[2]+a[2]*c,g[3]=b[3]+a[3]*c,g[4]=b[4]+a[4]*c,g[5]=b[5]+a[5]*c,d},e.exactEquals=function(d,b){d=d.m;b=b.m;return d[0]===b[0]&&d[1]===b[1]&&d[2]===b[2]&&d[3]===b[3]&&d[4]===b[4]&&d[5]===b[5]},e.equals=function(d,b){var a=d.m,c=b.m;b=a[0];d=a[1];var g=a[2],e=a[3],f=a[4];a=a[5];var q=c[0],r=c[1],t=c[2],p=c[3],v=c[4];c=c[5];return Math.abs(b-q)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(q))&&Math.abs(d-r)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(r))&&Math.abs(g-t)<=
h.EPSILON*Math.max(1,Math.abs(g),Math.abs(t))&&Math.abs(e-p)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(p))&&Math.abs(f-v)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(a-c)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},e}();m.default=f;n.exports=m.default},{"./utils":253}],249:[function(f,n,m){m.__esModule=!0;var h=f("./utils"),e=function(d){return d&&d.__esModule?d:{default:d}}(f("./vec3"));f=function(){function d(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,a=1<
arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,q=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,r=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,t=8<arguments.length&&void 0!==arguments[8]?arguments[8]:1;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
if("object"==typeof b)a?(this.m=new b.constructor(9),this.m.set(b)):this.m=b;else{var p=this.m=new h.FLOAT_ARRAY_TYPE(9);p[0]=b;p[1]=a;p[2]=c;p[3]=g;p[4]=e;p[5]=f;p[6]=q;p[7]=r;p[8]=t}}return d.create=function(){return new d(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,4<arguments.length&&void 0!==arguments[4]?arguments[4]:
1,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,8<arguments.length&&void 0!==arguments[8]?arguments[8]:1)},d.clone=function(b){b=b.m;return new d(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])},d.copy=function(b,a){return b.m.set(a.m),b},d.set=function(b,a,c,d,e,f,q,r,t,p){var g=b.m;return g[0]=a,g[1]=c,g[2]=d,g[3]=e,g[4]=f,g[5]=q,g[6]=r,g[7]=t,g[8]=p,b},d.identity=function(b){var a=
b.m;return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,b},d.transpose=function(b,a){var c=a.m,d=b.m;if(b===a){a=c[1];var e=c[2],f=c[5];d[1]=c[3];d[2]=c[6];d[3]=a;d[5]=c[7];d[6]=e;d[7]=f}else d[0]=c[0],d[1]=c[3],d[2]=c[6],d[3]=c[1],d[4]=c[4],d[5]=c[7],d[6]=c[2],d[7]=c[5],d[8]=c[8];return b},d.invert=function(b,a){var c=a.m;a=b.m;var d=c[0],e=c[1],f=c[2],q=c[3],r=c[4],t=c[5],p=c[6],v=c[7];c=c[8];var h=c*r-t*v,m=-c*q+t*p,x=v*q-r*p,y=d*h+e*m+f*x;return y?(y=1/y,a[0]=h*y,a[1]=(-c*e+
f*v)*y,a[2]=(t*e-f*r)*y,a[3]=m*y,a[4]=(c*d-f*p)*y,a[5]=(-t*d+f*q)*y,a[6]=x*y,a[7]=(-v*d+e*p)*y,a[8]=(r*d-e*q)*y,b):null},d.adjoint=function(b,a){var c=a.m;a=b.m;var d=c[0],e=c[1],f=c[2],q=c[3],r=c[4],t=c[5],p=c[6],v=c[7];c=c[8];return a[0]=r*c-t*v,a[1]=f*v-e*c,a[2]=e*t-f*r,a[3]=t*p-q*c,a[4]=d*c-f*p,a[5]=f*q-d*t,a[6]=q*v-r*p,a[7]=e*p-d*v,a[8]=d*r-e*q,b},d.determinant=function(b){b=b.m;var a=b[3],c=b[4],d=b[5],e=b[6],f=b[7],q=b[8];return b[0]*(q*c-d*f)+b[1]*(-q*a+d*e)+b[2]*(f*a-c*e)},d.multiply=function(b,
a,c){var d=a.m,e=c.m;c=b.m;a=d[0];var f=d[1],q=d[2],r=d[3],t=d[4],p=d[5],v=d[6],h=d[7];d=d[8];var m=e[0],x=e[1],y=e[2],u=e[3],n=e[4],C=e[5],z=e[6],A=e[7];e=e[8];return c[0]=m*a+x*r+y*v,c[1]=m*f+x*t+y*h,c[2]=m*q+x*p+y*d,c[3]=u*a+n*r+C*v,c[4]=u*f+n*t+C*h,c[5]=u*q+n*p+C*d,c[6]=z*a+A*r+e*v,c[7]=z*f+A*t+e*h,c[8]=z*q+A*p+e*d,b},d.mul=function(b,a,c){return d.multiply(b,a,c)},d.translate=function(b,a,c){var d=a.m;a=b.m;var e=d[0],f=d[1],q=d[2],r=d[3],t=d[4],p=d[5],v=d[6],h=d[7];d=d[8];var m=c.x;c=c.y;return a[0]=
e,a[1]=f,a[2]=q,a[3]=r,a[4]=t,a[5]=p,a[6]=m*e+c*r+v,a[7]=m*f+c*t+h,a[8]=m*q+c*p+d,b},d.rotate=function(b,a,c){var d=a.m;a=b.m;var e=d[0],f=d[1],q=d[2],r=d[3],t=d[4],p=d[5],v=d[6],h=d[7];d=d[8];var m=Math.sin(c);c=Math.cos(c);return a[0]=c*e+m*r,a[1]=c*f+m*t,a[2]=c*q+m*p,a[3]=c*r-m*e,a[4]=c*t-m*f,a[5]=c*p-m*q,a[6]=v,a[7]=h,a[8]=d,b},d.scale=function(b,a,c){var d=c.x;c=c.y;a=a.m;var e=b.m;return e[0]=d*a[0],e[1]=d*a[1],e[2]=d*a[2],e[3]=c*a[3],e[4]=c*a[4],e[5]=c*a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],b},
d.fromMat4=function(b,a){a=a.m;var c=b.m;return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],b},d.fromTranslation=function(b,a){var c=b.m;return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=a.x,c[7]=a.y,c[8]=1,b},d.fromRotation=function(b,a){var c=Math.sin(a);a=Math.cos(a);var d=b.m;return d[0]=a,d[1]=c,d[2]=0,d[3]=-c,d[4]=a,d[5]=0,d[6]=0,d[7]=0,d[8]=1,b},d.fromScaling=function(b,a){var c=b.m;return c[0]=a.x,c[1]=0,c[2]=0,c[3]=0,c[4]=a.y,c[5]=0,c[6]=
0,c[7]=0,c[8]=1,b},d.fromMat2d=function(b,a){a=a.m;var c=b.m;return c[0]=a[0],c[1]=a[1],c[2]=0,c[3]=a[2],c[4]=a[3],c[5]=0,c[6]=a[4],c[7]=a[5],c[8]=1,b},d.fromQuat=function(b,a){var c=b.m,d=a.x,e=a.y,f=a.z;a=a.w;var q=d+d,r=e+e,h=f+f;d*=q;var p=e*q;e*=r;var v=f*q,w=f*r;f*=h;q*=a;r*=a;a*=h;return c[0]=1-e-f,c[3]=p-a,c[6]=v+r,c[1]=p+a,c[4]=1-d-f,c[7]=w-q,c[2]=v-r,c[5]=w+q,c[8]=1-d-e,b},d.fromViewUp=function(b,a,c){return function(){var a=e.default.create(0,1,0),c=e.default.create(0,0,0),b=e.default.create(0,
0,0);return function(g,f,k){return e.default.sqrMag(f)<h.EPSILON*h.EPSILON?(d.identity(g),g):(k=k||a,e.default.normalize(c,e.default.cross(c,k,f)),e.default.sqrMag(c)<h.EPSILON*h.EPSILON?(d.identity(g),g):(e.default.cross(b,f,c),d.set(g,c.x,c.y,c.z,b.x,b.y,b.z,f.x,f.y,f.z),g))}}()(b,a,c)},d.normalFromMat4=function(b,a){var c=a.m;a=b.m;var d=c[0],e=c[1],f=c[2],q=c[3],r=c[4],h=c[5],p=c[6],v=c[7],w=c[8],m=c[9],x=c[10],y=c[11],u=c[12],n=c[13],C=c[14];c=c[15];var z=d*h-e*r,A=d*p-f*r,D=d*v-q*r,I=e*p-f*
h,F=e*v-q*h,G=f*v-q*p,J=w*n-m*u,N=w*C-x*u;w=w*c-y*u;var K=m*C-x*n;m=m*c-y*n;x=x*c-y*C;return(y=z*x-A*m+D*K+I*w-F*N+G*J)?(y=1/y,a[0]=(h*x-p*m+v*K)*y,a[1]=(p*w-r*x-v*N)*y,a[2]=(r*m-h*w+v*J)*y,a[3]=(f*m-e*x-q*K)*y,a[4]=(d*x-f*w+q*N)*y,a[5]=(e*w-d*m-q*J)*y,a[6]=(n*G-C*F+c*I)*y,a[7]=(C*D-u*G-c*A)*y,a[8]=(u*F-n*D+c*z)*y,b):null},d.str=function(b){b=b.m;return"mat3("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+")"},d.array=function(b,a){a=a.m;return b[0]=a[0],b[1]=
a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},d.frob=function(b){b=b.m;return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+Math.pow(b[6],2)+Math.pow(b[7],2)+Math.pow(b[8],2))},d.add=function(b,a,c){a=a.m;c=c.m;var d=b.m;return d[0]=a[0]+c[0],d[1]=a[1]+c[1],d[2]=a[2]+c[2],d[3]=a[3]+c[3],d[4]=a[4]+c[4],d[5]=a[5]+c[5],d[6]=a[6]+c[6],d[7]=a[7]+c[7],d[8]=a[8]+c[8],b},d.subtract=function(b,a,c){a=a.m;c=c.m;
var d=b.m;return d[0]=a[0]-c[0],d[1]=a[1]-c[1],d[2]=a[2]-c[2],d[3]=a[3]-c[3],d[4]=a[4]-c[4],d[5]=a[5]-c[5],d[6]=a[6]-c[6],d[7]=a[7]-c[7],d[8]=a[8]-c[8],b},d.sub=function(b,a,c){return d.subtract(b,a,c)},d.multiplyScalar=function(b,a,c){a=a.m;var d=b.m;return d[0]=a[0]*c,d[1]=a[1]*c,d[2]=a[2]*c,d[3]=a[3]*c,d[4]=a[4]*c,d[5]=a[5]*c,d[6]=a[6]*c,d[7]=a[7]*c,d[8]=a[8]*c,b},d.multiplyScalarAndAdd=function(b,a,c,d){a=a.m;c=c.m;var e=b.m;return e[0]=a[0]+c[0]*d,e[1]=a[1]+c[1]*d,e[2]=a[2]+c[2]*d,e[3]=a[3]+
c[3]*d,e[4]=a[4]+c[4]*d,e[5]=a[5]+c[5]*d,e[6]=a[6]+c[6]*d,e[7]=a[7]+c[7]*d,e[8]=a[8]+c[8]*d,b},d.exactEquals=function(b,a){b=b.m;a=a.m;return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===a[8]},d.equals=function(b,a){var c=b.m,d=a.m;a=c[0];b=c[1];var e=c[2],f=c[3],q=c[4],r=c[5],t=c[6],p=c[7];c=c[8];var v=d[0],w=d[1],m=d[2],x=d[3],y=d[4],u=d[5],n=d[6],C=d[7];d=d[8];return Math.abs(a-v)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&
Math.abs(b-w)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(w))&&Math.abs(e-m)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(m))&&Math.abs(f-x)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(x))&&Math.abs(q-y)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(y))&&Math.abs(r-u)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(t-n)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))&&Math.abs(p-C)<=h.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(c-d)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))},d}();
m.default=f;n.exports=m.default},{"./utils":253,"./vec3":255}],250:[function(f,n,m){m.__esModule=!0;var h=f("./utils");f=function(){function e(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,g=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:
1,l=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,q=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,r=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,t=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0,p=10<arguments.length&&void 0!==arguments[10]?arguments[10]:1,v=11<arguments.length&&void 0!==arguments[11]?arguments[11]:0,w=12<arguments.length&&void 0!==arguments[12]?arguments[12]:0,m=13<arguments.length&&void 0!==arguments[13]?arguments[13]:0,x=14<arguments.length&&
void 0!==arguments[14]?arguments[14]:0,y=15<arguments.length&&void 0!==arguments[15]?arguments[15]:1;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");if("object"==typeof d)b?(this.m=new d.constructor(16),this.m.set(d)):this.m=d;else{var u=this.m=new h.FLOAT_ARRAY_TYPE(16);u[0]=d;u[1]=b;u[2]=a;u[3]=c;u[4]=g;u[5]=f;u[6]=l;u[7]=q;u[8]=r;u[9]=t;u[10]=p;u[11]=v;u[12]=w;u[13]=m;u[14]=x;u[15]=y}}return e.create=function(){return new e(0<arguments.length&&void 0!==arguments[0]?
arguments[0]:1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,9<arguments.length&&void 0!==arguments[9]?
arguments[9]:0,10<arguments.length&&void 0!==arguments[10]?arguments[10]:1,11<arguments.length&&void 0!==arguments[11]?arguments[11]:0,12<arguments.length&&void 0!==arguments[12]?arguments[12]:0,13<arguments.length&&void 0!==arguments[13]?arguments[13]:0,14<arguments.length&&void 0!==arguments[14]?arguments[14]:0,15<arguments.length&&void 0!==arguments[15]?arguments[15]:1)},e.clone=function(d){d=d.m;return new e(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15])},
e.copy=function(d,b){return d.m.set(b.m),d},e.set=function(d,b,a,c,e,f,l,q,r,h,p,v,w,m,x,y,u){var g=d.m;return g[0]=b,g[1]=a,g[2]=c,g[3]=e,g[4]=f,g[5]=l,g[6]=q,g[7]=r,g[8]=h,g[9]=p,g[10]=v,g[11]=w,g[12]=m,g[13]=x,g[14]=y,g[15]=u,d},e.identity=function(d){var b=d.m;return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,d},e.transpose=function(d,b){var a=b.m,c=d.m;if(d===b){b=a[1];var e=a[2],f=a[3],l=a[6],q=a[7],r=a[11];c[1]=a[4];
c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=e;c[9]=l;c[11]=a[14];c[12]=f;c[13]=q;c[14]=r}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return d},e.invert=function(d,b){var a=b.m;b=d.m;var c=a[0],e=a[1],f=a[2],l=a[3],q=a[4],r=a[5],h=a[6],p=a[7],v=a[8],w=a[9],m=a[10],x=a[11],y=a[12],u=a[13],n=a[14];a=a[15];var C=c*r-e*q,z=c*h-f*q,A=c*p-l*q,D=e*h-f*r,I=e*p-l*r,
F=f*p-l*h,G=v*u-w*y,J=v*n-m*y,N=v*a-x*y,K=w*n-m*u,P=w*a-x*u,L=m*a-x*n,M=C*L-z*P+A*K+D*N-I*J+F*G;return M?(M=1/M,b[0]=(r*L-h*P+p*K)*M,b[1]=(f*P-e*L-l*K)*M,b[2]=(u*F-n*I+a*D)*M,b[3]=(m*I-w*F-x*D)*M,b[4]=(h*N-q*L-p*J)*M,b[5]=(c*L-f*N+l*J)*M,b[6]=(n*A-y*F-a*z)*M,b[7]=(v*F-m*A+x*z)*M,b[8]=(q*P-r*N+p*G)*M,b[9]=(e*N-c*P-l*G)*M,b[10]=(y*I-u*A+a*C)*M,b[11]=(w*A-v*I-x*C)*M,b[12]=(r*J-q*K-h*G)*M,b[13]=(c*K-e*J+f*G)*M,b[14]=(u*z-y*D-n*C)*M,b[15]=(v*D-w*z+m*C)*M,d):null},e.adjoint=function(d,b){var a=b.m;b=d.m;
var c=a[0],e=a[1],f=a[2],l=a[3],q=a[4],r=a[5],h=a[6],p=a[7],v=a[8],w=a[9],m=a[10],x=a[11],y=a[12],u=a[13],n=a[14];a=a[15];return b[0]=r*(m*a-x*n)-w*(h*a-p*n)+u*(h*x-p*m),b[1]=-(e*(m*a-x*n)-w*(f*a-l*n)+u*(f*x-l*m)),b[2]=e*(h*a-p*n)-r*(f*a-l*n)+u*(f*p-l*h),b[3]=-(e*(h*x-p*m)-r*(f*x-l*m)+w*(f*p-l*h)),b[4]=-(q*(m*a-x*n)-v*(h*a-p*n)+y*(h*x-p*m)),b[5]=c*(m*a-x*n)-v*(f*a-l*n)+y*(f*x-l*m),b[6]=-(c*(h*a-p*n)-q*(f*a-l*n)+y*(f*p-l*h)),b[7]=c*(h*x-p*m)-q*(f*x-l*m)+v*(f*p-l*h),b[8]=q*(w*a-x*u)-v*(r*a-p*u)+y*(r*
x-p*w),b[9]=-(c*(w*a-x*u)-v*(e*a-l*u)+y*(e*x-l*w)),b[10]=c*(r*a-p*u)-q*(e*a-l*u)+y*(e*p-l*r),b[11]=-(c*(r*x-p*w)-q*(e*x-l*w)+v*(e*p-l*r)),b[12]=-(q*(w*n-m*u)-v*(r*n-h*u)+y*(r*m-h*w)),b[13]=c*(w*n-m*u)-v*(e*n-f*u)+y*(e*m-f*w),b[14]=-(c*(r*n-h*u)-q*(e*n-f*u)+y*(e*h-f*r)),b[15]=c*(r*m-h*w)-q*(e*m-f*w)+v*(e*h-f*r),d},e.determinant=function(d){var b=d.m;d=b[0];var a=b[1],c=b[2],e=b[3],f=b[4],l=b[5],q=b[6],r=b[7],h=b[8],p=b[9],v=b[10],w=b[11],m=b[12],x=b[13],y=b[14];b=b[15];return(d*l-a*f)*(v*b-w*y)-(d*
q-c*f)*(p*b-w*x)+(d*r-e*f)*(p*y-v*x)+(a*q-c*l)*(h*b-w*m)-(a*r-e*l)*(h*y-v*m)+(c*r-e*q)*(h*x-p*m)},e.multiply=function(d,b,a){var c=b.m;a=a.m;b=d.m;var e=c[0],f=c[1],l=c[2],q=c[3],r=c[4],h=c[5],p=c[6],v=c[7],w=c[8],m=c[9],x=c[10],y=c[11],u=c[12],n=c[13],C=c[14];c=c[15];var z=a[0],A=a[1],D=a[2],I=a[3];return b[0]=z*e+A*r+D*w+I*u,b[1]=z*f+A*h+D*m+I*n,b[2]=z*l+A*p+D*x+I*C,b[3]=z*q+A*v+D*y+I*c,z=a[4],A=a[5],D=a[6],I=a[7],b[4]=z*e+A*r+D*w+I*u,b[5]=z*f+A*h+D*m+I*n,b[6]=z*l+A*p+D*x+I*C,b[7]=z*q+A*v+D*y+I*
c,z=a[8],A=a[9],D=a[10],I=a[11],b[8]=z*e+A*r+D*w+I*u,b[9]=z*f+A*h+D*m+I*n,b[10]=z*l+A*p+D*x+I*C,b[11]=z*q+A*v+D*y+I*c,z=a[12],A=a[13],D=a[14],I=a[15],b[12]=z*e+A*r+D*w+I*u,b[13]=z*f+A*h+D*m+I*n,b[14]=z*l+A*p+D*x+I*C,b[15]=z*q+A*v+D*y+I*c,d},e.mul=function(d,b,a){return e.multiply(d,b,a)},e.translate=function(d,b,a){var c=b.m,e=d.m,f=a.x,l=a.y;a=a.z;var q=void 0,r=void 0,h=void 0,p=void 0,v=void 0,w=void 0,m=void 0,x=void 0,y=void 0,u=void 0,n=void 0,C=void 0;return b===d?(e[12]=c[0]*f+c[4]*l+c[8]*
a+c[12],e[13]=c[1]*f+c[5]*l+c[9]*a+c[13],e[14]=c[2]*f+c[6]*l+c[10]*a+c[14],e[15]=c[3]*f+c[7]*l+c[11]*a+c[15]):(q=c[0],r=c[1],h=c[2],p=c[3],v=c[4],w=c[5],m=c[6],x=c[7],y=c[8],u=c[9],n=c[10],C=c[11],e[0]=q,e[1]=r,e[2]=h,e[3]=p,e[4]=v,e[5]=w,e[6]=m,e[7]=x,e[8]=y,e[9]=u,e[10]=n,e[11]=C,e[12]=q*f+v*l+y*a+c[12],e[13]=r*f+w*l+u*a+c[13],e[14]=h*f+m*l+n*a+c[14],e[15]=p*f+x*l+C*a+c[15]),d},e.scale=function(d,b,a){var c=a.x,e=a.y;a=a.z;b=b.m;var f=d.m;return f[0]=b[0]*c,f[1]=b[1]*c,f[2]=b[2]*c,f[3]=b[3]*c,f[4]=
b[4]*e,f[5]=b[5]*e,f[6]=b[6]*e,f[7]=b[7]*e,f[8]=b[8]*a,f[9]=b[9]*a,f[10]=b[10]*a,f[11]=b[11]*a,f[12]=b[12],f[13]=b[13],f[14]=b[14],f[15]=b[15],d},e.rotate=function(d,b,a,c){var e,f,l,q,r,t,p,v,w,m,x,y,u,n,C,z,A,D,I,F,G,J,N,K,P=b.m,L=d.m,M=c.x,U=c.y;c=c.z;var R=Math.sqrt(M*M+U*U+c*c);return Math.abs(R)<h.EPSILON?null:(M*=R=1/R,U*=R,c*=R,e=Math.sin(a),l=1-(f=Math.cos(a)),q=P[0],r=P[1],t=P[2],p=P[3],v=P[4],w=P[5],m=P[6],x=P[7],y=P[8],u=P[9],n=P[10],C=P[11],z=M*M*l+f,A=U*M*l+c*e,D=c*M*l-U*e,I=M*U*l-c*
e,F=U*U*l+f,G=c*U*l+M*e,J=M*c*l+U*e,N=U*c*l-M*e,K=c*c*l+f,L[0]=q*z+v*A+y*D,L[1]=r*z+w*A+u*D,L[2]=t*z+m*A+n*D,L[3]=p*z+x*A+C*D,L[4]=q*I+v*F+y*G,L[5]=r*I+w*F+u*G,L[6]=t*I+m*F+n*G,L[7]=p*I+x*F+C*G,L[8]=q*J+v*N+y*K,L[9]=r*J+w*N+u*K,L[10]=t*J+m*N+n*K,L[11]=p*J+x*N+C*K,b!==d&&(L[12]=P[12],L[13]=P[13],L[14]=P[14],L[15]=P[15]),d)},e.rotateX=function(d,b,a){var c=b.m,e=d.m,f=Math.sin(a);a=Math.cos(a);var l=c[4],q=c[5],r=c[6],h=c[7],p=c[8],v=c[9],w=c[10],m=c[11];return b!==d&&(e[0]=c[0],e[1]=c[1],e[2]=c[2],
e[3]=c[3],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e[4]=l*a+p*f,e[5]=q*a+v*f,e[6]=r*a+w*f,e[7]=h*a+m*f,e[8]=p*a-l*f,e[9]=v*a-q*f,e[10]=w*a-r*f,e[11]=m*a-h*f,d},e.rotateY=function(d,b,a){var c=b.m,e=d.m,f=Math.sin(a);a=Math.cos(a);var l=c[0],q=c[1],r=c[2],h=c[3],p=c[8],v=c[9],w=c[10],m=c[11];return b!==d&&(e[4]=c[4],e[5]=c[5],e[6]=c[6],e[7]=c[7],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e[0]=l*a-p*f,e[1]=q*a-v*f,e[2]=r*a-w*f,e[3]=h*a-m*f,e[8]=l*f+p*a,e[9]=q*f+v*a,e[10]=r*f+w*a,e[11]=
h*f+m*a,d},e.rotateZ=function(d,b,a){var c=b.m,e=d.m,f=Math.sin(a);a=Math.cos(a);var l=c[0],q=c[1],r=c[2],h=c[3],p=c[4],v=c[5],w=c[6],m=c[7];return b!==d&&(e[8]=c[8],e[9]=c[9],e[10]=c[10],e[11]=c[11],e[12]=c[12],e[13]=c[13],e[14]=c[14],e[15]=c[15]),e[0]=l*a+p*f,e[1]=q*a+v*f,e[2]=r*a+w*f,e[3]=h*a+m*f,e[4]=p*a-l*f,e[5]=v*a-q*f,e[6]=w*a-r*f,e[7]=m*a-h*f,d},e.fromTranslation=function(d,b){var a=d.m;return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=b.x,
a[13]=b.y,a[14]=b.z,a[15]=1,d},e.fromScaling=function(d,b){var a=d.m;return a[0]=b.x,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b.y,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=b.z,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,d},e.fromRotation=function(d,b,a){var c,e,f,l=d.m,q=a.x,r=a.y;a=a.z;var t=Math.sqrt(q*q+r*r+a*a);return Math.abs(t)<h.EPSILON?null:(q*=t=1/t,r*=t,a*=t,c=Math.sin(b),f=1-(e=Math.cos(b)),l[0]=q*q*f+e,l[1]=r*q*f+a*c,l[2]=a*q*f-r*c,l[3]=0,l[4]=q*r*f-a*c,l[5]=r*r*f+e,l[6]=a*r*f+q*c,l[7]=0,l[8]=q*a*f+r*c,l[9]=
r*a*f-q*c,l[10]=a*a*f+e,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,d)},e.fromXRotation=function(d,b){var a=d.m,c=Math.sin(b);b=Math.cos(b);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=c,a[7]=0,a[8]=0,a[9]=-c,a[10]=b,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,d},e.fromYRotation=function(d,b){var a=d.m,c=Math.sin(b);b=Math.cos(b);return a[0]=b,a[1]=0,a[2]=-c,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=c,a[9]=0,a[10]=b,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,d},e.fromZRotation=function(d,b){var a=d.m,
c=Math.sin(b);b=Math.cos(b);return a[0]=b,a[1]=c,a[2]=0,a[3]=0,a[4]=-c,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,d},e.fromRT=function(d,b,a){var c=d.m,e=b.x,f=b.y,l=b.z,q=b.w,r=e+e,h=f+f,p=l+l;b=e*r;var v=e*h;e*=p;var w=f*h;f*=p;l*=p;r*=q;h*=q;q*=p;return c[0]=1-(w+l),c[1]=v+q,c[2]=e-h,c[3]=0,c[4]=v-q,c[5]=1-(b+l),c[6]=f+r,c[7]=0,c[8]=e+h,c[9]=f-r,c[10]=1-(b+w),c[11]=0,c[12]=a.x,c[13]=a.y,c[14]=a.z,c[15]=1,d},e.fromTRSArray=function(d,b){var a=d.m,c=b[3],e=
b[4],f=b[5],l=b[6],q=c+c,r=e+e,h=f+f,p=c*q,v=c*r;c*=h;var w=e*r;e*=h;f*=h;q*=l;r*=l;l*=h;h=b[7];var m=b[8],x=b[9];return a[0]=(1-(w+f))*h,a[1]=(v+l)*h,a[2]=(c-r)*h,a[3]=0,a[4]=(v-l)*m,a[5]=(1-(p+f))*m,a[6]=(e+q)*m,a[7]=0,a[8]=(c+r)*x,a[9]=(e-q)*x,a[10]=(1-(p+w))*x,a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,d},e.getTranslation=function(d,b){b=b.m;return d.x=b[12],d.y=b[13],d.z=b[14],d},e.getScaling=function(d,b){var a=b.m;b=a[0];var c=a[1],e=a[2],f=a[4],l=a[5],q=a[6],r=a[8],h=a[9];a=a[10];return d.x=
Math.sqrt(b*b+c*c+e*e),d.y=Math.sqrt(f*f+l*l+q*q),d.z=Math.sqrt(r*r+h*h+a*a),d},e.getRotation=function(d,b){b=b.m;var a=b[0]+b[5]+b[10],c=0;return 0<a?(c=2*Math.sqrt(a+1),d.w=.25*c,d.x=(b[6]-b[9])/c,d.y=(b[8]-b[2])/c,d.z=(b[1]-b[4])/c):b[0]>b[5]&b[0]>b[10]?(c=2*Math.sqrt(1+b[0]-b[5]-b[10]),d.w=(b[6]-b[9])/c,d.x=.25*c,d.y=(b[1]+b[4])/c,d.z=(b[8]+b[2])/c):b[5]>b[10]?(c=2*Math.sqrt(1+b[5]-b[0]-b[10]),d.w=(b[8]-b[2])/c,d.x=(b[1]+b[4])/c,d.y=.25*c,d.z=(b[6]+b[9])/c):(c=2*Math.sqrt(1+b[10]-b[0]-b[5]),d.w=
(b[1]-b[4])/c,d.x=(b[8]+b[2])/c,d.y=(b[6]+b[9])/c,d.z=.25*c),d},e.fromRTS=function(d,b,a,c){var e=d.m,f=b.x,l=b.y,q=b.z,r=b.w,h=f+f,p=l+l,v=q+q;b=f*h;var w=f*p;f*=v;var m=l*p;l*=v;q*=v;h*=r;p*=r;r*=v;v=c.x;var x=c.y;c=c.z;return e[0]=(1-(m+q))*v,e[1]=(w+r)*v,e[2]=(f-p)*v,e[3]=0,e[4]=(w-r)*x,e[5]=(1-(b+q))*x,e[6]=(l+h)*x,e[7]=0,e[8]=(f+p)*c,e[9]=(l-h)*c,e[10]=(1-(b+m))*c,e[11]=0,e[12]=a.x,e[13]=a.y,e[14]=a.z,e[15]=1,d},e.fromRTSOrigin=function(d,b,a,c,e){var g=d.m,f=b.x,q=b.y,r=b.z,h=b.w,p=f+f,v=q+
q,w=r+r;b=f*p;var m=f*v;f*=w;var x=q*v;q*=w;r*=w;p*=h;v*=h;h*=w;w=c.x;var y=c.y;c=c.z;var u=e.x,n=e.y;e=e.z;return g[0]=(1-(x+r))*w,g[1]=(m+h)*w,g[2]=(f-v)*w,g[3]=0,g[4]=(m-h)*y,g[5]=(1-(b+r))*y,g[6]=(q+p)*y,g[7]=0,g[8]=(f+v)*c,g[9]=(q-p)*c,g[10]=(1-(b+x))*c,g[11]=0,g[12]=a.x+u-(g[0]*u+g[4]*n+g[8]*e),g[13]=a.y+n-(g[1]*u+g[5]*n+g[9]*e),g[14]=a.z+e-(g[2]*u+g[6]*n+g[10]*e),g[15]=1,d},e.fromQuat=function(d,b){var a=d.m,c=b.x,e=b.y,f=b.z;b=b.w;var l=c+c,q=e+e,r=f+f;c*=l;var h=e*l;e*=q;var p=f*l,v=f*q;
f*=r;l*=b;q*=b;b*=r;return a[0]=1-e-f,a[1]=h+b,a[2]=p-q,a[3]=0,a[4]=h-b,a[5]=1-c-f,a[6]=v+l,a[7]=0,a[8]=p+q,a[9]=v-l,a[10]=1-c-e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,d},e.frustum=function(d,b,a,c,e,f,l){var g=d.m,k=1/(a-b),h=1/(e-c),p=1/(f-l);return g[0]=2*f*k,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*f*h,g[6]=0,g[7]=0,g[8]=(a+b)*k,g[9]=(e+c)*h,g[10]=(l+f)*p,g[11]=-1,g[12]=0,g[13]=0,g[14]=l*f*2*p,g[15]=0,d},e.perspective=function(d,b,a,c,e){var g=d.m;b=1/Math.tan(b/2);var f=1/(c-e);return g[0]=b/a,g[1]=
0,g[2]=0,g[3]=0,g[4]=0,g[5]=b,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=(e+c)*f,g[11]=-1,g[12]=0,g[13]=0,g[14]=2*e*c*f,g[15]=0,d},e.perspectiveFromFieldOfView=function(d,b,a,c){var e=d.m,f=Math.tan(b.upDegrees*Math.PI/180),l=Math.tan(b.downDegrees*Math.PI/180),q=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var r=2/(q+b),h=2/(f+l);return e[0]=r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-(q-b)*r*.5,e[9]=(f-l)*h*.5,e[10]=c/(a-c),e[11]=-1,e[12]=0,e[13]=0,e[14]=c*a/(a-
c),e[15]=0,d},e.ortho=function(d,b,a,c,e,f,l){var g=d.m,k=1/(b-a),h=1/(c-e),p=1/(f-l);return g[0]=-2*k,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*h,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*p,g[11]=0,g[12]=(b+a)*k,g[13]=(e+c)*h,g[14]=(l+f)*p,g[15]=1,d},e.lookAt=function(d,b,a,c){var e,f,l,q=d.m,r=void 0,h=void 0,p=void 0,v=void 0,w=void 0,m=void 0,x=void 0,y=b.x,u=b.y;b=b.z;var n=c.x,C=c.y;c=c.z;return v=y-a.x,w=u-a.y,m=b-a.z,r=C*(m*=x=1/Math.sqrt(v*v+w*w+m*m))-c*(w*=x),h=c*(v*=x)-n*m,p=n*w-C*v,e=w*(p*=x=1/Math.sqrt(r*
r+h*h+p*p))-m*(h*=x),f=m*(r*=x)-v*p,l=v*h-w*r,q[0]=r,q[1]=e,q[2]=v,q[3]=0,q[4]=h,q[5]=f,q[6]=w,q[7]=0,q[8]=p,q[9]=l,q[10]=m,q[11]=0,q[12]=-(r*y+h*u+p*b),q[13]=-(e*y+f*u+l*b),q[14]=-(v*y+w*u+m*b),q[15]=1,d},e.str=function(d){d=d.m;return"mat4("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+", "+d[9]+", "+d[10]+", "+d[11]+", "+d[12]+", "+d[13]+", "+d[14]+", "+d[15]+")"},e.array=function(d,b){b=b.m;return d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],d[4]=b[4],d[5]=b[5],
d[6]=b[6],d[7]=b[7],d[8]=b[8],d[9]=b[9],d[10]=b[10],d[11]=b[11],d[12]=b[12],d[13]=b[13],d[14]=b[14],d[15]=b[15],d},e.frob=function(d){d=d.m;return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+Math.pow(d[6],2)+Math.pow(d[7],2)+Math.pow(d[8],2)+Math.pow(d[9],2)+Math.pow(d[10],2)+Math.pow(d[11],2)+Math.pow(d[12],2)+Math.pow(d[13],2)+Math.pow(d[14],2)+Math.pow(d[15],2))},e.add=function(d,b,a){b=b.m;a=a.m;var c=d.m;return c[0]=b[0]+a[0],
c[1]=b[1]+a[1],c[2]=b[2]+a[2],c[3]=b[3]+a[3],c[4]=b[4]+a[4],c[5]=b[5]+a[5],c[6]=b[6]+a[6],c[7]=b[7]+a[7],c[8]=b[8]+a[8],c[9]=b[9]+a[9],c[10]=b[10]+a[10],c[11]=b[11]+a[11],c[12]=b[12]+a[12],c[13]=b[13]+a[13],c[14]=b[14]+a[14],c[15]=b[15]+a[15],d},e.subtract=function(d,b,a){b=b.m;a=a.m;var c=d.m;return c[0]=b[0]-a[0],c[1]=b[1]-a[1],c[2]=b[2]-a[2],c[3]=b[3]-a[3],c[4]=b[4]-a[4],c[5]=b[5]-a[5],c[6]=b[6]-a[6],c[7]=b[7]-a[7],c[8]=b[8]-a[8],c[9]=b[9]-a[9],c[10]=b[10]-a[10],c[11]=b[11]-a[11],c[12]=b[12]-a[12],
c[13]=b[13]-a[13],c[14]=b[14]-a[14],c[15]=b[15]-a[15],d},e.sub=function(d,b,a){return e.subtract(d,b,a)},e.multiplyScalar=function(d,b,a){b=b.m;var c=d.m;return c[0]=b[0]*a,c[1]=b[1]*a,c[2]=b[2]*a,c[3]=b[3]*a,c[4]=b[4]*a,c[5]=b[5]*a,c[6]=b[6]*a,c[7]=b[7]*a,c[8]=b[8]*a,c[9]=b[9]*a,c[10]=b[10]*a,c[11]=b[11]*a,c[12]=b[12]*a,c[13]=b[13]*a,c[14]=b[14]*a,c[15]=b[15]*a,d},e.multiplyScalarAndAdd=function(d,b,a,c){b=b.m;a=a.m;var e=d.m;return e[0]=b[0]+a[0]*c,e[1]=b[1]+a[1]*c,e[2]=b[2]+a[2]*c,e[3]=b[3]+a[3]*
c,e[4]=b[4]+a[4]*c,e[5]=b[5]+a[5]*c,e[6]=b[6]+a[6]*c,e[7]=b[7]+a[7]*c,e[8]=b[8]+a[8]*c,e[9]=b[9]+a[9]*c,e[10]=b[10]+a[10]*c,e[11]=b[11]+a[11]*c,e[12]=b[12]+a[12]*c,e[13]=b[13]+a[13]*c,e[14]=b[14]+a[14]*c,e[15]=b[15]+a[15]*c,d},e.exactEquals=function(d,b){d=d.m;b=b.m;return d[0]===b[0]&&d[1]===b[1]&&d[2]===b[2]&&d[3]===b[3]&&d[4]===b[4]&&d[5]===b[5]&&d[6]===b[6]&&d[7]===b[7]&&d[8]===b[8]&&d[9]===b[9]&&d[10]===b[10]&&d[11]===b[11]&&d[12]===b[12]&&d[13]===b[13]&&d[14]===b[14]&&d[15]===b[15]},e.equals=
function(d,b){var a=d.m,c=b.m;b=a[0];d=a[1];var e=a[2],f=a[3],l=a[4],q=a[5],r=a[6],t=a[7],p=a[8],v=a[9],w=a[10],m=a[11],x=a[12],y=a[13],u=a[14];a=a[15];var n=c[0],C=c[1],z=c[2],A=c[3],D=c[4],I=c[5],F=c[6],G=c[7],J=c[8],N=c[9],K=c[10],P=c[11],L=c[12],M=c[13],U=c[14];c=c[15];return Math.abs(b-n)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(n))&&Math.abs(d-C)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(e-z)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(z))&&Math.abs(f-A)<=h.EPSILON*Math.max(1,
Math.abs(f),Math.abs(A))&&Math.abs(l-D)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(q-I)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(I))&&Math.abs(r-F)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(F))&&Math.abs(t-G)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(G))&&Math.abs(p-J)<=h.EPSILON*Math.max(1,Math.abs(p),Math.abs(J))&&Math.abs(v-N)<=h.EPSILON*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(w-K)<=h.EPSILON*Math.max(1,Math.abs(w),Math.abs(K))&&Math.abs(m-P)<=h.EPSILON*Math.max(1,Math.abs(m),
Math.abs(P))&&Math.abs(x-L)<=h.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(y-M)<=h.EPSILON*Math.max(1,Math.abs(y),Math.abs(M))&&Math.abs(u-U)<=h.EPSILON*Math.max(1,Math.abs(u),Math.abs(U))&&Math.abs(a-c)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},e}();m.default=f;n.exports=m.default},{"./utils":253}],251:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}m.__esModule=!0;var e=h(f("./vec3")),d=h(f("./vec4")),b=h(f("./mat3")),a=f("./utils"),c=.5*Math.PI/180;f=function(){function g(){var a=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");this.x=a;this.y=c;this.z=b;this.w=d}return g.create=function(){return new g(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:
0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1)},g.clone=function(a){return new g(a.x,a.y,a.z,a.w)},g.copy=function(a,c){return d.default.copy(a,c)},g.set=function(a,c,b,d,e){return a.x=c,a.y=b,a.z=d,a.w=e,a},g.identity=function(a){return a.x=0,a.y=0,a.z=0,a.w=1,a},g.rotationTo=function(a,c,b){return function(){var a=e.default.create(0,0,0),c=e.default.create(1,0,0),b=e.default.create(0,1,0);return function(d,f,k){var l=e.default.dot(f,
k);return-.999999>l?(e.default.cross(a,c,f),1E-6>e.default.magnitude(a)&&e.default.cross(a,b,f),e.default.normalize(a,a),g.fromAxisAngle(d,a,Math.PI),d):.999999<l?(d.x=0,d.y=0,d.z=0,d.w=1,d):(e.default.cross(a,f,k),d.x=a.x,d.y=a.y,d.z=a.z,d.w=1+l,g.normalize(d,d))}}()(a,c,b)},g.getAxisAngle=function(a,c){var b=2*Math.acos(c.w),d=Math.sin(b/2);return 0!=d?(a.x=c.x/d,a.y=c.y/d,a.z=c.z/d):(a.x=1,a.y=0,a.z=0),b},g.multiply=function(a,c,b){var d=c.x,e=c.y,g=c.z;c=c.w;var f=b.x,k=b.y,l=b.z;b=b.w;return a.x=
d*b+c*f+e*l-g*k,a.y=e*b+c*k+g*f-d*l,a.z=g*b+c*l+d*k-e*f,a.w=c*b-d*f-e*k-g*l,a},g.mul=function(a,c,b){return g.multiply(a,c,b)},g.scale=function(a,c,b){return a.x=c.x*b,a.y=c.y*b,a.z=c.z*b,a.w=c.w*b,a},g.rotateX=function(a,c,b){b*=.5;var d=c.x,e=c.y,g=c.z;c=c.w;var f=Math.sin(b);b=Math.cos(b);return a.x=d*b+c*f,a.y=e*b+g*f,a.z=g*b-e*f,a.w=c*b-d*f,a},g.rotateY=function(a,c,b){b*=.5;var d=c.x,e=c.y,g=c.z;c=c.w;var f=Math.sin(b);b=Math.cos(b);return a.x=d*b-g*f,a.y=e*b+c*f,a.z=g*b+d*f,a.w=c*b-e*f,a},
g.rotateZ=function(a,c,b){b*=.5;var d=c.x,e=c.y,g=c.z;c=c.w;var f=Math.sin(b);b=Math.cos(b);return a.x=d*b+e*f,a.y=e*b-d*f,a.z=g*b+c*f,a.w=c*b-g*f,a},g.rotateAround=function(a,c,b,d){return function(){var a=e.default.create(0,0,0),c=g.create();return function(b,d,f,k){return g.invert(c,d),e.default.transformQuat(a,f,c),g.fromAxisAngle(c,a,k),g.mul(b,d,c),b}}()(a,c,b,d)},g.rotateAroundLocal=function(a,c,b,d){return function(){var a=g.create();return function(c,b,d,e){return g.fromAxisAngle(a,d,e),
g.mul(c,b,a),c}}()(a,c,b,d)},g.calculateW=function(a,c){var b=c.x,d=c.y;c=c.z;return a.x=b,a.y=d,a.z=c,a.w=Math.sqrt(Math.abs(1-b*b-d*d-c*c)),a},g.dot=function(a,c){return a.x*c.x+a.y*c.y+a.z*c.z+a.w*c.w},g.lerp=function(a,c,b,d){var e=c.x,g=c.y,f=c.z;c=c.w;return a.x=e+d*(b.x-e),a.y=g+d*(b.y-g),a.z=f+d*(b.z-f),a.w=c+d*(b.w-c),a},g.slerp=function(a,c,b,d){var e=c.x,g=c.y,f=c.z;c=c.w;var k=b.x,l=b.y,h=b.z;b=b.w;var r=void 0,q=void 0,m=void 0,n=void 0,z=void 0;return 0>(q=e*k+g*l+f*h+c*b)&&(q=-q,k=
-k,l=-l,h=-h,b=-b),1E-6<1-q?(r=Math.acos(q),m=Math.sin(r),n=Math.sin((1-d)*r)/m,z=Math.sin(d*r)/m):(n=1-d,z=d),a.x=n*e+z*k,a.y=n*g+z*l,a.z=n*f+z*h,a.w=n*c+z*b,a},g.sqlerp=function(a,c,b,d,e,f){return function(){var a=g.create(),c=g.create();return function(b,d,e,f,k,l){return g.slerp(a,d,k,l),g.slerp(c,e,f,l),g.slerp(b,a,c,2*l*(1-l)),b}}()(a,c,b,d,e,f)},g.invert=function(a,c){var b=c.x,d=c.y,e=c.z;c=c.w;var g=b*b+d*d+e*e+c*c;g=g?1/g:0;return a.x=-b*g,a.y=-d*g,a.z=-e*g,a.w=c*g,a},g.conjugate=function(a,
c){return a.x=-c.x,a.y=-c.y,a.z=-c.z,a.w=c.w,a},g.magnitude=function(a){var c=a.x,b=a.y,d=a.z;a=a.w;return Math.sqrt(c*c+b*b+d*d+a*a)},g.mag=function(a){return g.magnitude(a)},g.squaredMagnitude=function(a){var c=a.x,b=a.y,d=a.z;a=a.w;return c*c+b*b+d*d+a*a},g.sqrMag=function(a){return g.squaredMagnitude(a)},g.normalize=function(a,c){var b=c.x,d=c.y,e=c.z;c=c.w;var g=b*b+d*d+e*e+c*c;return 0<g&&(g=1/Math.sqrt(g),a.x=b*g,a.y=d*g,a.z=e*g,a.w=c*g),a},g.fromAxes=function(a,c,d,e){return function(){var a=
b.default.create();return function(c,d,e,f){return b.default.set(a,d.x,d.y,d.z,e.x,e.y,e.z,f.x,f.y,f.z),g.normalize(c,g.fromMat3(c,a))}}()(a,c,d,e)},g.fromViewUp=function(a,c,d){return function(){var a=b.default.create();return function(c,d,e){return b.default.fromViewUp(a,d,e),a?g.normalize(c,g.fromMat3(c,a)):null}}()(a,c,d)},g.fromAxisAngle=function(a,c,b){b*=.5;var d=Math.sin(b);return a.x=d*c.x,a.y=d*c.y,a.z=d*c.z,a.w=Math.cos(b),a},g.fromMat3=function(a,c){var b=c.m,d=b[0];c=b[3];var e=b[6],
g=b[1],f=b[4],k=b[7],l=b[2],h=b[5];b=b[8];var m=d+f+b;0<m?(d=.5/Math.sqrt(m+1),a.w=.25/d,a.x=(h-k)*d,a.y=(e-l)*d,a.z=(g-c)*d):d>f&&d>b?(d=2*Math.sqrt(1+d-f-b),a.w=(h-k)/d,a.x=.25*d,a.y=(c+g)/d,a.z=(e+l)/d):f>b?(d=2*Math.sqrt(1+f-d-b),a.w=(e-l)/d,a.x=(c+g)/d,a.y=.25*d,a.z=(k+h)/d):(d=2*Math.sqrt(1+b-d-f),a.w=(g-c)/d,a.x=(e+l)/d,a.y=(k+h)/d,a.z=.25*d);return a},g.fromEuler=function(a,b,d,e){b*=c;d*=c;e*=c;var g=Math.sin(b);b=Math.cos(b);var f=Math.sin(d);d=Math.cos(d);var k=Math.sin(e);e=Math.cos(e);
return a.x=g*d*e+b*f*k,a.y=b*f*e+g*d*k,a.z=b*d*k-g*f*e,a.w=b*d*e-g*f*k,a},g.fromAngleZ=function(a,b){b*=c;a.x=a.y=0;a.z=Math.sin(b);a.w=Math.cos(b)},g.toEuler=function(c,b){var d=b.x,e=b.y,g=b.z;b=b.w;var f=void 0,k=void 0,l=void 0,h=d*e+g*b;if(.499<h&&(f=2*Math.atan2(d,b),k=Math.PI/2,l=0),-.499>h&&(f=-2*Math.atan2(d,b),k=-Math.PI/2,l=0),isNaN(f))l=g*g,f=Math.atan2(2*e*b-2*d*g,1-2*e*e-2*l),k=Math.asin(2*h),l=Math.atan2(2*d*b-2*e*g,1-2*d*d-2*l);return c.y=(0,a.toDegree)(f),c.z=(0,a.toDegree)(k),c.x=
(0,a.toDegree)(l),c},g.str=function(a){return"quat("+a.x+", "+a.y+", "+a.z+", "+a.w+")"},g.array=function(a,c){return a[0]=c.x,a[1]=c.y,a[2]=c.z,a[3]=c.w,a},g.exactEquals=function(a,c){return d.default.exactEquals(a,c)},g.equals=function(a,c){return d.default.equals(a,c)},g}();m.default=f;n.exports=m.default},{"./mat3":249,"./utils":253,"./vec3":255,"./vec4":256}],252:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=function(d){return d&&d.__esModule?d:{default:d}}(f("./quat")),e=h.default.create();
f=function(){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");}return d.toRotation=function(b,a){return b.x=a[3],b.y=a[4],b.z=a[5],b.w=a[6],b},d.fromRotation=function(b,a){return b[3]=a.x,b[4]=a.y,b[5]=a.z,b[6]=a.w,b},d.toEuler=function(b,a){return d.toRotation(e,a),h.default.toEuler(b,e),b},d.fromEuler=function(b,a){return h.default.fromEuler(e,a.x,a.y,a.z),d.fromRotation(b,e),b},d.fromEulerNumber=function(b,a,c,g){return h.default.fromEuler(e,a,c,g),
d.fromRotation(b,e),b},d.toScale=function(b,a){return b.x=a[7],b.y=a[8],b.z=a[9],b},d.fromScale=function(b,a){return b[7]=a.x,b[8]=a.y,b[9]=a.z,b},d.toPosition=function(b,a){return b.x=a[0],b.y=a[1],b.z=a[2],b},d.fromPosition=function(b,a){return b[0]=a.x,b[1]=a.y,b[2]=a.z,b},d.fromAngleZ=function(b,a){return h.default.fromAngleZ(e,a),d.fromRotation(b,e),b},d}();m.default=f;n.exports=m.default},{"./quat":251}],253:[function(f,n,m){function h(a,c){return Math.random()*(c-a)+a}function e(a){return(9301*
a+49297)%233280/233280}function d(a,c,b){return e(a)*(b-c)+c}function b(a,c){return a-Math.floor(a/c)*c}m.__esModule=!0;m.equals=function(a,c){return Math.abs(a-c)<=g*Math.max(1,Math.abs(a),Math.abs(c))};m.approx=function(a,c,b){return b=b||g,Math.abs(a-c)<=b};m.clamp=function(a,c,b){return a<c?c:a>b?b:a};m.clamp01=function(a){return 0>a?0:1<a?1:a};m.lerp=function(a,c,b){return a+(c-a)*b};m.toRadian=function(c){return c*a};m.toDegree=function(a){return a*c};m.randomRange=h;m.randomRangeInt=function(a,
c){return Math.floor(h(a,c))};m.pseudoRandom=e;m.pseudoRandomRange=d;m.pseudoRandomRangeInt=function(a,c,b){return Math.floor(d(a,c,b))};m.nextPow2=function(a){return--a,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,++a};m.repeat=b;m.pingPong=function(a,c){return a=b(a,2*c),c-Math.abs(a-c)};m.inverseLerp=function(a,c,b){return(b-a)/(c-a)};var a=Math.PI/180,c=180/Math.PI,g=m.EPSILON=1E-6;m.FLOAT_ARRAY_TYPE=Float64Array;m.FLOAT_BYTES=8;m.random=Math.random},{}],254:[function(f,n,m){m.__esModule=!0;var h=
f("./utils"),e=function(){function d(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=a}return d.create=function(){return new d(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)},d.zero=function(b){return b.x=0,b.y=0,b},d.clone=function(b){return new d(b.x,b.y)},d.copy=
function(b,a){return b.x=a.x,b.y=a.y,b},d.set=function(b,a,c){return b.x=a,b.y=c,b},d.add=function(b,a,c){return b.x=a.x+c.x,b.y=a.y+c.y,b},d.subtract=function(b,a,c){return b.x=a.x-c.x,b.y=a.y-c.y,b},d.sub=function(b,a,c){return d.subtract(b,a,c)},d.multiply=function(b,a,c){return b.x=a.x*c.x,b.y=a.y*c.y,b},d.mul=function(b,a,c){return d.multiply(b,a,c)},d.divide=function(b,a,c){return b.x=a.x/c.x,b.y=a.y/c.y,b},d.div=function(b,a,c){return d.divide(b,a,c)},d.ceil=function(b,a){return b.x=Math.ceil(a.x),
b.y=Math.ceil(a.y),b},d.floor=function(b,a){return b.x=Math.floor(a.x),b.y=Math.floor(a.y),b},d.min=function(b,a,c){return b.x=Math.min(a.x,c.x),b.y=Math.min(a.y,c.y),b},d.max=function(b,a,c){return b.x=Math.max(a.x,c.x),b.y=Math.max(a.y,c.y),b},d.round=function(b,a){return b.x=Math.round(a.x),b.y=Math.round(a.y),b},d.scale=function(b,a,c){return b.x=a.x*c,b.y=a.y*c,b},d.scaleAndAdd=function(b,a,c,d){return b.x=a.x+c.x*d,b.y=a.y+c.y*d,b},d.distance=function(b,a){var c=a.x-b.x;b=a.y-b.y;return Math.sqrt(c*
c+b*b)},d.dist=function(b,a){return d.distance(b,a)},d.squaredDistance=function(b,a){var c=a.x-b.x;b=a.y-b.y;return c*c+b*b},d.sqrDist=function(b,a){return d.squaredDistance(b,a)},d.magnitude=function(b){var a=b.x;b=b.y;return Math.sqrt(a*a+b*b)},d.mag=function(b){return d.magnitude(b)},d.squaredMagnitude=function(b){var a=b.x;b=b.y;return a*a+b*b},d.sqrMag=function(b){return d.squaredMagnitude(b)},d.negate=function(b,a){return b.x=-a.x,b.y=-a.y,b},d.inverse=function(b,a){return b.x=1/a.x,b.y=1/a.y,
b},d.inverseSafe=function(b,a){var c=a.x,d=a.y;return Math.abs(c)<h.EPSILON?b.x=0:b.x=1/c,Math.abs(d)<h.EPSILON?b.y=0:b.y=1/a.y,b},d.normalize=function(b,a){var c=a.x,d=a.y;c=c*c+d*d;return 0<c&&(c=1/Math.sqrt(c),b.x=a.x*c,b.y=a.y*c),b},d.dot=function(b,a){return b.x*a.x+b.y*a.y},d.cross=function(b,a,c){a=a.x*c.y-a.y*c.x;return b.x=b.y=0,b.z=a,b},d.lerp=function(b,a,c,d){var e=a.x;a=a.y;return b.x=e+d*(c.x-e),b.y=a+d*(c.y-a),b},d.random=function(b,a){a=a||1;var c=2*(0,h.random)()*Math.PI;return b.x=
Math.cos(c)*a,b.y=Math.sin(c)*a,b},d.transformMat2=function(b,a,c){c=c.m;var d=a.x;a=a.y;return b.x=c[0]*d+c[2]*a,b.y=c[1]*d+c[3]*a,b},d.transformMat23=function(b,a,c){c=c.m;var d=a.x;a=a.y;return b.x=c[0]*d+c[2]*a+c[4],b.y=c[1]*d+c[3]*a+c[5],b},d.transformMat3=function(b,a,c){c=c.m;var d=a.x;a=a.y;return b.x=c[0]*d+c[3]*a+c[6],b.y=c[1]*d+c[4]*a+c[7],b},d.transformMat4=function(b,a,c){c=c.m;var d=a.x;a=a.y;return b.x=c[0]*d+c[4]*a+c[12],b.y=c[1]*d+c[5]*a+c[13],b},d.forEach=function(b,a,c,e,f,l){return d._forEach(b,
a,c,e,f,l)},d.str=function(b){return"vec2("+b.x+", "+b.y+")"},d.array=function(b,a){return b[0]=a.x,b[1]=a.y,b},d.exactEquals=function(b,a){return b.x===a.x&&b.y===a.y},d.equals=function(b,a){var c=b.x;b=b.y;var d=a.x;a=a.y;return Math.abs(c-d)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(b-a)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))},d.angle=function(b,a){return d._angle(b,a)},d}();e._forEach=function(){var d=e.create(0,0);return function(b,a,c,e,f,l){a||(a=2);c||(c=0);for(e=e?
Math.min(e*a+c,b.length):b.length;c<e;c+=a)d.x=b[c],d.y=b[c+1],f(d,d,l),b[c]=d.x,b[c+1]=d.y;return b}}();e._angle=function(){var d=e.create(0,0),b=e.create(0,0);return function(a,c){e.normalize(d,a);e.normalize(b,c);a=e.dot(d,b);return 1<a?0:-1>a?Math.PI:Math.acos(a)}}();m.default=e;n.exports=m.default},{"./utils":253}],255:[function(f,n,m){m.__esModule=!0;var h=f("./utils"),e=function(){function d(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=a;this.z=c}return d.create=function(){return new d(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)},d.zero=function(b){return b.x=0,b.y=0,b.z=0,b},d.clone=function(b){return new d(b.x,b.y,b.z)},d.copy=function(b,
a){return b.x=a.x,b.y=a.y,b.z=a.z,b},d.set=function(b,a,c,d){return b.x=a,b.y=c,b.z=d,b},d.add=function(b,a,c){return b.x=a.x+c.x,b.y=a.y+c.y,b.z=a.z+c.z,b},d.subtract=function(b,a,c){return b.x=a.x-c.x,b.y=a.y-c.y,b.z=a.z-c.z,b},d.sub=function(b,a,c){return d.subtract(b,a,c)},d.multiply=function(b,a,c){return b.x=a.x*c.x,b.y=a.y*c.y,b.z=a.z*c.z,b},d.mul=function(b,a,c){return d.multiply(b,a,c)},d.divide=function(b,a,c){return b.x=a.x/c.x,b.y=a.y/c.y,b.z=a.z/c.z,b},d.div=function(b,a,c){return d.divide(b,
a,c)},d.ceil=function(b,a){return b.x=Math.ceil(a.x),b.y=Math.ceil(a.y),b.z=Math.ceil(a.z),b},d.floor=function(b,a){return b.x=Math.floor(a.x),b.y=Math.floor(a.y),b.z=Math.floor(a.z),b},d.min=function(b,a,c){return b.x=Math.min(a.x,c.x),b.y=Math.min(a.y,c.y),b.z=Math.min(a.z,c.z),b},d.max=function(b,a,c){return b.x=Math.max(a.x,c.x),b.y=Math.max(a.y,c.y),b.z=Math.max(a.z,c.z),b},d.round=function(b,a){return b.x=Math.round(a.x),b.y=Math.round(a.y),b.z=Math.round(a.z),b},d.scale=function(b,a,c){return b.x=
a.x*c,b.y=a.y*c,b.z=a.z*c,b},d.scaleAndAdd=function(b,a,c,d){return b.x=a.x+c.x*d,b.y=a.y+c.y*d,b.z=a.z+c.z*d,b},d.distance=function(b,a){var c=a.x-b.x,d=a.y-b.y;b=a.z-b.z;return Math.sqrt(c*c+d*d+b*b)},d.dist=function(b,a){return d.distance(b,a)},d.squaredDistance=function(b,a){var c=a.x-b.x,d=a.y-b.y;b=a.z-b.z;return c*c+d*d+b*b},d.sqrDist=function(b,a){return d.squaredDistance(b,a)},d.magnitude=function(b){var a=b.x,c=b.y;b=b.z;return Math.sqrt(a*a+c*c+b*b)},d.mag=function(b){return d.magnitude(b)},
d.squaredMagnitude=function(b){var a=b.x,c=b.y;b=b.z;return a*a+c*c+b*b},d.sqrMag=function(b){return d.squaredMagnitude(b)},d.negate=function(b,a){return b.x=-a.x,b.y=-a.y,b.z=-a.z,b},d.inverse=function(b,a){return b.x=1/a.x,b.y=1/a.y,b.z=1/a.z,b},d.inverseSafe=function(b,a){var c=a.x,d=a.y;a=a.z;return Math.abs(c)<h.EPSILON?b.x=0:b.x=1/c,Math.abs(d)<h.EPSILON?b.y=0:b.y=1/d,Math.abs(a)<h.EPSILON?b.z=0:b.z=1/a,b},d.normalize=function(b,a){var c=a.x,d=a.y;a=a.z;var e=c*c+d*d+a*a;return 0<e&&(e=1/Math.sqrt(e),
b.x=c*e,b.y=d*e,b.z=a*e),b},d.dot=function(b,a){return b.x*a.x+b.y*a.y+b.z*a.z},d.cross=function(b,a,c){var d=a.x,e=a.y;a=a.z;var f=c.x,h=c.y;c=c.z;return b.x=e*c-a*h,b.y=a*f-d*c,b.z=d*h-e*f,b},d.lerp=function(b,a,c,d){var e=a.x,g=a.y;a=a.z;return b.x=e+d*(c.x-e),b.y=g+d*(c.y-g),b.z=a+d*(c.z-a),b},d.hermite=function(b,a,c,d,e,f){var g=f*f,k=g*(2*f-3)+1,l=g*(f-2)+f,p=g*(f-1);f=g*(3-2*f);return b.x=a.x*k+c.x*l+d.x*p+e.x*f,b.y=a.y*k+c.y*l+d.y*p+e.y*f,b.z=a.z*k+c.z*l+d.z*p+e.z*f,b},d.bezier=function(b,
a,c,d,e,f){var g=1-f,k=g*g,l=f*f,p=k*g;k*=3*f;g*=3*l;f*=l;return b.x=a.x*p+c.x*k+d.x*g+e.x*f,b.y=a.y*p+c.y*k+d.y*g+e.y*f,b.z=a.z*p+c.z*k+d.z*g+e.z*f,b},d.random=function(b,a){a=a||1;var c=2*(0,h.random)()*Math.PI,d=Math.acos(2*(0,h.random)()-1);return b.x=Math.sin(d)*Math.cos(c)*a,b.y=Math.sin(d)*Math.sin(c)*a,b.z=Math.cos(d)*a,b},d.transformMat4=function(b,a,c){c=c.m;var d=a.x,e=a.y;a=a.z;var f=c[3]*d+c[7]*e+c[11]*a+c[15];return f=f?1/f:1,b.x=(c[0]*d+c[4]*e+c[8]*a+c[12])*f,b.y=(c[1]*d+c[5]*e+c[9]*
a+c[13])*f,b.z=(c[2]*d+c[6]*e+c[10]*a+c[14])*f,b},d.transformMat4Normal=function(b,a,c){c=c.m;var d=a.x,e=a.y;a=a.z;var f=c[3]*d+c[7]*e+c[11]*a;return f=f?1/f:1,b.x=(c[0]*d+c[4]*e+c[8]*a)*f,b.y=(c[1]*d+c[5]*e+c[9]*a)*f,b.z=(c[2]*d+c[6]*e+c[10]*a)*f,b},d.transformMat3=function(b,a,c){c=c.m;var d=a.x,e=a.y;a=a.z;return b.x=d*c[0]+e*c[3]+a*c[6],b.y=d*c[1]+e*c[4]+a*c[7],b.z=d*c[2]+e*c[5]+a*c[8],b},d.transformQuat=function(b,a,c){var d=a.x,e=a.y,f=a.z;a=c.x;var h=c.y,r=c.z;c=c.w;var t=c*d+h*f-r*e,p=c*
e+r*d-a*f,v=c*f+a*e-h*d;d=-a*d-h*e-r*f;return b.x=t*c+d*-a+p*-r-v*-h,b.y=p*c+d*-h+v*-a-t*-r,b.z=v*c+d*-r+t*-h-p*-a,b},d.rotateX=function(b,a,c,d){var e=a.y-c.y,f=a.z-c.z,g=e*Math.cos(d)-f*Math.sin(d);d=e*Math.sin(d)+f*Math.cos(d);return b.x=a.x-c.x+c.x,b.y=g+c.y,b.z=d+c.z,b},d.rotateY=function(b,a,c,d){var e=a.x-c.x,f=a.y-c.y;a=a.z-c.z;var g=a*Math.cos(d)-e*Math.sin(d);return b.x=a*Math.sin(d)+e*Math.cos(d)+c.x,b.y=f+c.y,b.z=g+c.z,b},d.rotateZ=function(b,a,c,d){var e=a.x-c.x,f=a.y-c.y;a=a.z-c.z;var g=
e*Math.sin(d)+f*Math.cos(d);return b.x=e*Math.cos(d)-f*Math.sin(d)+c.x,b.y=g+c.y,b.z=a+c.z,b},d.str=function(b){return"vec3("+b.x+", "+b.y+", "+b.z+")"},d.array=function(b,a){return b[0]=a.x,b[1]=a.y,b[2]=a.z,b},d.exactEquals=function(b,a){return b.x===a.x&&b.y===a.y&&b.z===a.z},d.equals=function(b,a){var c=b.x,d=b.y;b=b.z;var e=a.x,f=a.y;a=a.z;return Math.abs(c-e)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&Math.abs(d-f)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(b-a)<=h.EPSILON*
Math.max(1,Math.abs(b),Math.abs(a))},d.forEach=function(b,a,c,e,f,l){return d._forEach(b,a,c,e,f,l)},d.angle=function(b,a){return d._angle(b,a)},d.projectOnPlane=function(b,a,c){return d.sub(b,a,d.project(b,a,c))},d.project=function(b,a,c){var e=d.squaredMagnitude(c);return 1E-6>e?d.set(b,0,0,0):d.scale(b,c,d.dot(a,c)/e)},d}();e._forEach=function(){var d=e.create(0,0,0);return function(b,a,c,e,f,l){a||(a=3);c||(c=0);for(e=e?Math.min(e*a+c,b.length):b.length;c<e;c+=a)d.x=b[c],d.y=b[c+1],d.z=b[c+2],
f(d,d,l),b[c]=d.x,b[c+1]=d.y,b[c+2]=d.z;return b}}();e._angle=function(){var d=e.create(0,0,0),b=e.create(0,0,0);return function(a,c){e.copy(d,a);e.copy(b,c);e.normalize(d,d);e.normalize(b,b);a=e.dot(d,b);return 1<a?0:-1>a?Math.PI:Math.acos(a)}}();m.default=e;n.exports=m.default},{"./utils":253}],256:[function(f,n,m){m.__esModule=!0;var h=f("./utils"),e=function(){function d(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,
c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=a;this.z=c;this.w=e}return d.create=function(){return new d(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:
1)},d.zero=function(b){return b.x=0,b.y=0,b.z=0,b.w=0,b},d.clone=function(b){return new d(b.x,b.y,b.z,b.w)},d.copy=function(b,a){return b.x=a.x,b.y=a.y,b.z=a.z,b.w=a.w,b},d.set=function(b,a,c,d,e){return b.x=a,b.y=c,b.z=d,b.w=e,b},d.add=function(b,a,c){return b.x=a.x+c.x,b.y=a.y+c.y,b.z=a.z+c.z,b.w=a.w+c.w,b},d.subtract=function(b,a,c){return b.x=a.x-c.x,b.y=a.y-c.y,b.z=a.z-c.z,b.w=a.w-c.w,b},d.sub=function(b,a,c){return d.subtract(b,a,c)},d.multiply=function(b,a,c){return b.x=a.x*c.x,b.y=a.y*c.y,
b.z=a.z*c.z,b.w=a.w*c.w,b},d.mul=function(b,a,c){return d.multiply(b,a,c)},d.divide=function(b,a,c){return b.x=a.x/c.x,b.y=a.y/c.y,b.z=a.z/c.z,b.w=a.w/c.w,b},d.div=function(b,a,c){return d.divide(b,a,c)},d.ceil=function(b,a){return b.x=Math.ceil(a.x),b.y=Math.ceil(a.y),b.z=Math.ceil(a.z),b.w=Math.ceil(a.w),b},d.floor=function(b,a){return b.x=Math.floor(a.x),b.y=Math.floor(a.y),b.z=Math.floor(a.z),b.w=Math.floor(a.w),b},d.min=function(b,a,c){return b.x=Math.min(a.x,c.x),b.y=Math.min(a.y,c.y),b.z=Math.min(a.z,
c.z),b.w=Math.min(a.w,c.w),b},d.max=function(b,a,c){return b.x=Math.max(a.x,c.x),b.y=Math.max(a.y,c.y),b.z=Math.max(a.z,c.z),b.w=Math.max(a.w,c.w),b},d.round=function(b,a){return b.x=Math.round(a.x),b.y=Math.round(a.y),b.z=Math.round(a.z),b.w=Math.round(a.w),b},d.scale=function(b,a,c){return b.x=a.x*c,b.y=a.y*c,b.z=a.z*c,b.w=a.w*c,b},d.scaleAndAdd=function(b,a,c,d){return b.x=a.x+c.x*d,b.y=a.y+c.y*d,b.z=a.z+c.z*d,b.w=a.w+c.w*d,b},d.distance=function(b,a){var c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;b=a.w-b.w;
return Math.sqrt(c*c+d*d+e*e+b*b)},d.dist=function(b,a){return d.distance(b,a)},d.squaredDistance=function(b,a){var c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;b=a.w-b.w;return c*c+d*d+e*e+b*b},d.sqrDist=function(b,a){return d.squaredDistance(b,a)},d.magnitude=function(b){var a=b.x,c=b.y,d=b.z;b=b.w;return Math.sqrt(a*a+c*c+d*d+b*b)},d.mag=function(b){return d.magnitude(b)},d.squaredMagnitude=function(b){var a=b.x,c=b.y,d=b.z;b=b.w;return a*a+c*c+d*d+b*b},d.sqrMag=function(b){return d.squaredMagnitude(b)},d.negate=
function(b,a){return b.x=-a.x,b.y=-a.y,b.z=-a.z,b.w=-a.w,b},d.inverse=function(b,a){return b.x=1/a.x,b.y=1/a.y,b.z=1/a.z,b.w=1/a.w,b},d.inverseSafe=function(b,a){var c=a.x,d=a.y,e=a.z;a=a.w;return Math.abs(c)<h.EPSILON?b.x=0:b.x=1/c,Math.abs(d)<h.EPSILON?b.y=0:b.y=1/d,Math.abs(e)<h.EPSILON?b.z=0:b.z=1/e,Math.abs(a)<h.EPSILON?b.w=0:b.w=1/a,b},d.normalize=function(b,a){var c=a.x,d=a.y,e=a.z;a=a.w;var f=c*c+d*d+e*e+a*a;return 0<f&&(f=1/Math.sqrt(f),b.x=c*f,b.y=d*f,b.z=e*f,b.w=a*f),b},d.dot=function(b,
a){return b.x*a.x+b.y*a.y+b.z*a.z+b.w*a.w},d.lerp=function(b,a,c,d){var e=a.x,f=a.y,g=a.z;a=a.w;return b.x=e+d*(c.x-e),b.y=f+d*(c.y-f),b.z=g+d*(c.z-g),b.w=a+d*(c.w-a),b},d.random=function(b,a){a=a||1;var c=2*(0,h.random)()*Math.PI,d=Math.acos(2*(0,h.random)()-1);return b.x=Math.sin(d)*Math.cos(c)*a,b.y=Math.sin(d)*Math.sin(c)*a,b.z=Math.cos(d)*a,b.w=0,b},d.transformMat4=function(b,a,c){c=c.m;var d=a.x,e=a.y,f=a.z;a=a.w;return b.x=c[0]*d+c[4]*e+c[8]*f+c[12]*a,b.y=c[1]*d+c[5]*e+c[9]*f+c[13]*a,b.z=c[2]*
d+c[6]*e+c[10]*f+c[14]*a,b.w=c[3]*d+c[7]*e+c[11]*f+c[15]*a,b},d.transformQuat=function(b,a,c){var d=a.x,e=a.y,f=a.z,h=c.x,r=c.y,t=c.z;c=c.w;var p=c*d+r*f-t*e,v=c*e+t*d-h*f,w=c*f+h*e-r*d;d=-h*d-r*e-t*f;return b.x=p*c+d*-h+v*-t-w*-r,b.y=v*c+d*-r+w*-h-p*-t,b.z=w*c+d*-t+p*-r-v*-h,b.w=a.w,b},d.str=function(b){return"vec4("+b.x+", "+b.y+", "+b.z+", "+b.w+")"},d.array=function(b,a){return b[0]=a.x,b[1]=a.y,b[2]=a.z,b[3]=a.w,b},d.exactEquals=function(b,a){return b.x===a.x&&b.y===a.y&&b.z===a.z&&b.w===a.w},
d.equals=function(b,a){var c=b.x,d=b.y,e=b.z;b=b.w;var f=a.x,q=a.y,r=a.z;a=a.w;return Math.abs(c-f)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(d-q)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(q))&&Math.abs(e-r)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(b-a)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))},d.forEach=function(b,a,c,e,f,l){return d._forEach(b,a,c,e,f,l)},d}();e._forEach=function(){var d=e.create(0,0,0,0);return function(b,a,c,e,f,l){a||(a=4);c||(c=0);for(e=
e?Math.min(e*a+c,b.length):b.length;c<e;c+=a)d.x=b[c],d.y=b[c+1],d.z=b[c+2],d.w=b[c+3],f(d,d,l),b[c]=d.x,b[c+1]=d.y,b[c+2]=d.z,b[c+3]=d.w;return b}}();m.default=e;n.exports=m.default},{"./utils":253}],257:[function(f,n,m){cc.js},{}],258:[function(f,n,m){f("./core/CCGame");f("./actions")},{"./actions":7,"./core/CCGame":29}],259:[function(f,n,m){var h=f("../compression/zlib.min"),e=f("../core/CCDebug");f=function(d){var b,a,c;this.data=d;this.pos=8;this.palette=[];this.imgData=[];this.transparency=
{};this.animation=null;this.text={};for(a=null;;){var f=this.readUInt32();d=[];for(c=0;4>c;++c)d.push(String.fromCharCode(this.data[this.pos++]));switch(d=d.join("")){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||
1/0,frames:[]};break;case "PLTE":this.palette=this.read(f);break;case "fcTL":a&&this.animation.frames.push(a);this.pos+=4;a={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};d=this.readUInt16();f=this.readUInt16()||100;a.delay=1E3*d/f;a.disposeOp=this.data[this.pos++];a.blendOp=this.data[this.pos++];a.data=[];break;case "IDAT":case "fdAT":"fdAT"===d&&(this.pos+=4,f-=4);d=(null!=a?a.data:void 0)||this.imgData;for(c=0;0<=f?c<f:c>f;0<=f?++c:--c)d.push(this.data[this.pos++]);
break;case "tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(f),0<(f=255-this.transparency.indexed.length))for(d=0;0<=f?d<f:d>f;0<=f?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(f)[0];break;case 2:this.transparency.rgb=this.read(f)}break;case "tEXt":f=(c=this.read(f)).indexOf(0);d=String.fromCharCode.apply(String,c.slice(0,f));this.text[d]=String.fromCharCode.apply(String,c.slice(f+1));break;case "IEND":a&&
this.animation.frames.push(a);a:{switch(this.colorType){case 0:case 3:case 4:a=1;break a;case 2:case 6:a=3;break a}a=void 0}this.colors=a;this.hasAlphaChannel=4===(b=this.colorType)||6===b;b=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*b;a:{switch(this.colors){case 1:b="DeviceGray";break a;case 3:b="DeviceRGB";break a}b=void 0}return this.colorSpace=b,void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=f}if(this.pos+=4,this.pos>this.data.length)throw Error(e.getError(6017));
}};f.prototype={constructor:f,read:function(d){var b;var a=[];for(b=0;0<=d?b<d:b>d;0<=d?++b:--b)a.push(this.data[this.pos++]);return a},readUInt32:function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},readUInt16:function(){return this.data[this.pos++]<<8|this.data[this.pos++]},decodePixels:function(d){var b,a,c,f,k,l,q,r;if(null==d&&(d=this.imgData),0===d.length)return new Uint8Array(0);d=(new h.Inflate(d,{index:0,verify:!1})).decompress();
var t=(f=this.pixelBitlength/8)*this.width;var p=new Uint8Array(t*this.height);var v=d.length;for(a=k=l=0;k<v;){switch(d[k++]){case 0:for(b=0;b<t;b+=1)p[a++]=d[k++];break;case 1:for(c=r=0;r<t;c=r+=1){b=d[k++];var w=c<f?0:p[a-f];p[a++]=(b+w)%256}break;case 2:for(c=w=0;w<t;c=w+=1){b=d[k++];var m=(c-c%f)/f;var x=l&&p[(l-1)*t+m*f+c%f];p[a++]=(x+b)%256}break;case 3:for(c=r=0;r<t;c=r+=1)b=d[k++],m=(c-c%f)/f,w=c<f?0:p[a-f],x=l&&p[(l-1)*t+m*f+c%f],p[a++]=(b+Math.floor((w+x)/2))%256;break;case 4:for(c=r=0;r<
t;c=r+=1){b=d[k++];m=(c-c%f)/f;w=c<f?0:p[a-f];0===l?x=q=0:(x=p[(l-1)*t+m*f+c%f],q=m&&p[(l-1)*t+(m-1)*f+c%f]);var y=w+x-q;c=Math.abs(y-w);m=Math.abs(y-x);y=Math.abs(y-q);w=c<=m&&c<=y?w:m<=y?x:q;p[a++]=(b+w)%256}break;default:throw Error(e.getError(6018,d[k-1]));}l++}return p},copyToImageData:function(d,b){var a,c,e,f,l,h,r,t;if(c=this.colors,r=null,a=this.hasAlphaChannel,this.palette.length&&(r=null!=(t=this._decodedPalette)?t:this._decodedPalette=this.decodePalette(),c=4,a=!0),h=(d=d.data||d).length,
f=r||b,e=l=0,1===c)for(;e<h;)c=r?4*b[e/4]:l,t=f[c++],d[e++]=t,d[e++]=t,d[e++]=t,d[e++]=a?f[c++]:255,l=c;else for(;e<h;)c=r?4*b[e/4]:l,d[e++]=f[c++],d[e++]=f[c++],d[e++]=f[c++],d[e++]=a?f[c++]:255,l=c},decodePalette:function(){var d,b,a,c,e;var f=this.palette;var l=this.transparency.indexed||[];var h=new Uint8Array((l.length||0)+f.length);var r=a=d=b=0;for(c=f.length;a<c;r=a+=3)h[b++]=f[r],h[b++]=f[r+1],h[b++]=f[r+2],h[b++]=null!=(e=l[d++])?e:255;return h},render:function(d){var b,a;return d.width=
this.width,d.height=this.height,a=(b=d.getContext("2d")).createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),b.putImageData(a,0,0)}};n.exports=f},{"../compression/zlib.min":25,"../core/CCDebug":27}],260:[function(f,n,m){m=f("../core/assets/CCAsset");f=f("../core/assets/CCSpriteFrame");f=cc.Class({name:"cc.ParticleAsset",extends:m,properties:{spriteFrame:{default:null,type:f}}});cc.ParticleAsset=n.exports=f},{"../core/assets/CCAsset":34,"../core/assets/CCSpriteFrame":48}],
261:[function(f,n,m){var h=f("../core/platform/CCMacro");m=f("./CCParticleAsset");var e=f("../core/components/CCRenderComponent"),d=f("../compression/ZipUtils"),b=f("./CCPNGReader"),a=f("./CCTIFFReader"),c=f("../core/utils/texture-util"),g=(f("../core/renderer/render-flow"),f("./particle-simulator")),k=f("../core/assets/material/CCMaterial");f=f("../core/utils/blend-func");var l=cc.Enum({GRAVITY:0,RADIUS:1}),q=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2});f=cc.Class({name:"cc.ParticleSystem",extends:e,mixins:[f],
editor:!1,ctor:function(){this.initProperties()},initProperties:function(){this._previewTimer=null;this._focused=!1;this._simulator=new g(this);this._texture=null;this._startColor=cc.color(255,255,255,255);this._startColorVar=cc.color(0,0,0,0);this._endColor=cc.color(255,255,255,0);this._endColorVar=cc.color(0,0,0,0);this._renderSpriteFrame=null},properties:{preview:{default:!0,editorOnly:!0,notify:!1,animatable:!1,tooltip:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(a){this._custom!==
a&&(this._custom=a,this._applyFile())},animatable:!1,tooltip:!1},_file:{default:null,type:m},file:{get:function(){return this._file},set:function(a,c){this._file!==a&&(this._file=a,a?this._applyFile():this.custom=!0)},animatable:!1,type:m,tooltip:!1},_spriteFrame:{default:null,type:cc.SpriteFrame},spriteFrame:{get:function(){return this._spriteFrame},set:function(a,c){c=this._renderSpriteFrame;c!==a&&(this._renderSpriteFrame=a,a&&!a._uuid||(this._spriteFrame=a),(c&&c.getTexture())!==(a&&a.getTexture())&&
(this._texture=null,this._applySpriteFrame(c)))},type:cc.SpriteFrame,tooltip:!1},_texture:{default:null,type:cc.Texture2D,editorOnly:!0},texture:{get:function(){return this._texture},set:function(a){a&&cc.warnID(6017)},type:cc.Texture2D,tooltip:!1,readonly:!0,visible:!1,animatable:!1},particleCount:{visible:!1,get:function(){return this._simulator.particles.length},readonly:!0},_stopped:!0,stopped:{get:function(){return this._stopped},animatable:!1,visible:!1},playOnLoad:!0,autoRemoveOnFinish:{default:!1,
animatable:!1,tooltip:!1},active:{get:function(){return this._simulator.active},visible:!1},totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,_startColor:null,startColor:{type:cc.Color,get:function(){return this._startColor},set:function(a){this._startColor.r=a.r;this._startColor.g=a.g;this._startColor.b=a.b;this._startColor.a=a.a}},_startColorVar:null,startColorVar:{type:cc.Color,get:function(){return this._startColorVar},set:function(a){this._startColorVar.r=a.r;this._startColorVar.g=
a.g;this._startColorVar.b=a.b;this._startColorVar.a=a.a}},_endColor:null,endColor:{type:cc.Color,get:function(){return this._endColor},set:function(a){this._endColor.r=a.r;this._endColor.g=a.g;this._endColor.b=a.b;this._endColor.a=a.a}},_endColorVar:null,endColorVar:{type:cc.Color,get:function(){return this._endColorVar},set:function(a){this._endColorVar.r=a.r;this._endColorVar.g=a.g;this._endColorVar.b=a.b;this._endColorVar.a=a.a}},angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,
startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.Vec2.ZERO,posVar:cc.Vec2.ZERO,_positionType:{default:q.FREE,formerlySerializedAs:"positionType"},positionType:{type:q,get:function(){return this._positionType},set:function(a){var c=this.getMaterial(0);c&&c.define("CC_USE_MODEL",a!==q.FREE);this._positionType=a}},emitterMode:{default:l.GRAVITY,type:l},gravity:cc.Vec2.ZERO,speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,
startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:l,PositionType:q,_PNGReader:b,_TIFFReader:a},onFocusInEditor:!1,onLostFocusInEditor:!1,_startPreview:!1,_stopPreview:!1,_convertTextureToSpriteFrame:!1,__preload:function(){(this._super(),this._custom&&this.spriteFrame&&!this._renderSpriteFrame)?this._applySpriteFrame(this.spriteFrame):this._file&&(this._custom?!this._texture&&
this._applyFile():this._applyFile());this.playOnLoad&&this.resetSystem()},onEnable:function(){this._super();this._activateMaterial()},onDestroy:function(){this.autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1);this._buffer&&(this._buffer.destroy(),this._buffer=null);this._simulator._uvFilled=0;this._super()},lateUpdate:function(a){this._simulator.finished||this._simulator.step(a)},addParticle:function(){},stopSystem:function(){this._stopped=!0;this._simulator.stop()},resetSystem:function(){this._stopped=
!1;this._simulator.reset();this._activateMaterial()},isFull:function(){return this.particleCount>=this.totalParticles},setTextureWithRect:function(a,c){a instanceof cc.Texture2D&&(this.spriteFrame=new cc.SpriteFrame(a,c))},_applyFile:function(){var a=this._file;if(a){var c=this;cc.loader.load(a.nativeUrl,function(b,d){!b&&d?c.isValid&&(c._plistFile=a.nativeUrl,c._custom||c._initWithDictionary(d),c._spriteFrame?!c._renderSpriteFrame&&c._spriteFrame&&c._applySpriteFrame(c.spriteFrame):a.spriteFrame?
c.spriteFrame=a.spriteFrame:c._custom&&c._initTextureWithDictionary(d)):cc.errorID(6029)})}},_initTextureWithDictionary:function(e){var f=cc.path.changeBasename(this._plistFile,e.textureFileName||"");if(e.textureFileName)c.loadImage(f,function(a,c){a?(e.textureFileName=void 0,this._initTextureWithDictionary(e)):this.spriteFrame=new cc.SpriteFrame(c)},this);else if(e.textureImageData){var g=e.textureImageData;if(!(g&&0<g.length))return!1;var k=cc.loader.getRes(f);if(!k){g=d.unzipBase64AsArray(g,1);
if(!g)return cc.logID(6030),!1;k=8<g.length&&137===g[0]&&80===g[1]&&78===g[2]&&71===g[3]&&13===g[4]&&10===g[5]&&26===g[6]&&10===g[7]?h.ImageFormat.PNG:2<g.length&&(73===g[0]&&73===g[1]||77===g[0]&&77===g[1]||255===g[0]&&216===g[1])?h.ImageFormat.TIFF:h.ImageFormat.UNKNOWN;if(k!==h.ImageFormat.TIFF&&k!==h.ImageFormat.PNG)return cc.logID(6031),!1;var l=document.createElement("canvas");k===h.ImageFormat.PNG?(new b(g)).render(l):a.parseTIFF(g,l);k=c.cacheImage(f,l)}k||cc.logID(6032);this.spriteFrame=
new cc.SpriteFrame(k)}return!0},_initWithDictionary:function(a){this.totalParticles=parseInt(a.maxParticles||0);this.life=parseFloat(a.particleLifespan||0);this.lifeVar=parseFloat(a.particleLifespanVariance||0);this.emissionRate=a.emissionRate||Math.min(this.totalParticles/this.life,Number.MAX_VALUE);this.duration=parseFloat(a.duration||0);this.srcBlendFactor=parseInt(a.blendFuncSource||h.SRC_ALPHA);this.dstBlendFactor=parseInt(a.blendFuncDestination||h.ONE_MINUS_SRC_ALPHA);var c=this._startColor;
c.r=255*parseFloat(a.startColorRed||0);c.g=255*parseFloat(a.startColorGreen||0);c.b=255*parseFloat(a.startColorBlue||0);c.a=255*parseFloat(a.startColorAlpha||0);c=this._startColorVar;c.r=255*parseFloat(a.startColorVarianceRed||0);c.g=255*parseFloat(a.startColorVarianceGreen||0);c.b=255*parseFloat(a.startColorVarianceBlue||0);c.a=255*parseFloat(a.startColorVarianceAlpha||0);c=this._endColor;c.r=255*parseFloat(a.finishColorRed||0);c.g=255*parseFloat(a.finishColorGreen||0);c.b=255*parseFloat(a.finishColorBlue||
0);c.a=255*parseFloat(a.finishColorAlpha||0);c=this._endColorVar;if(c.r=255*parseFloat(a.finishColorVarianceRed||0),c.g=255*parseFloat(a.finishColorVarianceGreen||0),c.b=255*parseFloat(a.finishColorVarianceBlue||0),c.a=255*parseFloat(a.finishColorVarianceAlpha||0),this.startSize=parseFloat(a.startParticleSize||0),this.startSizeVar=parseFloat(a.startParticleSizeVariance||0),this.endSize=parseFloat(a.finishParticleSize||0),this.endSizeVar=parseFloat(a.finishParticleSizeVariance||0),this.positionType=
parseFloat(a.positionType||q.RELATIVE),this.sourcePos.x=0,this.sourcePos.y=0,this.posVar.x=parseFloat(a.sourcePositionVariancex||0),this.posVar.y=parseFloat(a.sourcePositionVariancey||0),this.angle=parseFloat(a.angle||0),this.angleVar=parseFloat(a.angleVariance||0),this.startSpin=parseFloat(a.rotationStart||0),this.startSpinVar=parseFloat(a.rotationStartVariance||0),this.endSpin=parseFloat(a.rotationEnd||0),this.endSpinVar=parseFloat(a.rotationEndVariance||0),this.emitterMode=parseInt(a.emitterType||
l.GRAVITY),this.emitterMode===l.GRAVITY)this.gravity.x=parseFloat(a.gravityx||0),this.gravity.y=parseFloat(a.gravityy||0),this.speed=parseFloat(a.speed||0),this.speedVar=parseFloat(a.speedVariance||0),this.radialAccel=parseFloat(a.radialAcceleration||0),this.radialAccelVar=parseFloat(a.radialAccelVariance||0),this.tangentialAccel=parseFloat(a.tangentialAcceleration||0),this.tangentialAccelVar=parseFloat(a.tangentialAccelVariance||0),c=a.rotationIsDir||"",null!==c?(c=c.toString().toLowerCase(),this.rotationIsDir=
"true"===c||"1"===c):this.rotationIsDir=!1;else{if(this.emitterMode!==l.RADIUS)return cc.warnID(6009),!1;this.startRadius=parseFloat(a.maxRadius||0);this.startRadiusVar=parseFloat(a.maxRadiusVariance||0);this.endRadius=parseFloat(a.minRadius||0);this.endRadiusVar=parseFloat(a.minRadiusVariance||0);this.rotatePerS=parseFloat(a.rotatePerSecond||0);this.rotatePerSVar=parseFloat(a.rotatePerSecondVariance||0)}return this._initTextureWithDictionary(a),!0},_onTextureLoaded:function(){this._texture=this._renderSpriteFrame.getTexture();
this._simulator.updateUVs(!0);this._activateMaterial()},_applySpriteFrame:function(a){a&&a.off&&a.off("load",this._onTextureLoaded,this);(a=this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame)&&(a.textureLoaded()?this._onTextureLoaded(null):(a.once("load",this._onTextureLoaded,this),a.ensureLoadTexture()))},_activateMaterial:function(){if(!this._texture||!this._texture.loaded)return this.markForUpdateRenderData(!1),this.markForRender(!1),void(this._renderSpriteFrame&&this._applySpriteFrame());
var a=this.sharedMaterials[0];(a=a?k.getInstantiatedMaterial(a,this):k.getInstantiatedBuiltinMaterial("2d-sprite",this)).define("CC_USE_MODEL",this._positionType!==q.FREE);a.setProperty("texture",this._texture);this.setMaterial(0,a);this.markForRender(!0)},_finishedSimulation:function(){this.resetSystem();this.stopSystem();this.disableRender();this.autoRemoveOnFinish&&this._stopped&&this.node.destroy()}});cc.ParticleSystem=n.exports=f},{"../compression/ZipUtils":22,"../core/assets/material/CCMaterial":53,
"../core/components/CCRenderComponent":74,"../core/platform/CCMacro":135,"../core/renderer/render-flow":179,"../core/utils/blend-func":214,"../core/utils/texture-util":228,"./CCPNGReader":259,"./CCParticleAsset":260,"./CCTIFFReader":262,"./particle-simulator":264,"fire-url":void 0}],262:[function(f,n,m){var h=f("../core/CCDebug");n.exports={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(e){return this._tiffData[e]},getUint16:function(e){return this._littleEndian?this._tiffData[e+
1]<<8|this._tiffData[e]:this._tiffData[e]<<8|this._tiffData[e+1]},getUint32:function(e){var d=this._tiffData;return this._littleEndian?d[e+3]<<24|d[e+2]<<16|d[e+1]<<8|d[e]:d[e]<<24|d[e+1]<<16|d[e+2]<<8|d[e+3]},checkLittleEndian:function(){var e=this.getUint16(0);if(18761===e)this.littleEndian=!0;else{if(19789!==e)throw console.log(e),TypeError(h.getError(6019));this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError(h.getError(6020));return!0},
getFieldTypeName:function(e){var d=this.fieldTypeNames;return e in d?d[e]:null},getFieldTagName:function(e){var d=this.fieldTagNames;return e in d?d[e]:(cc.logID(6021,e),"Tag"+e)},getFieldTypeLength:function(e){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(e)?1:-1!==["SHORT","SSHORT"].indexOf(e)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(e)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(e)?8:null},getFieldValues:function(e,d,b,a){e=[];var c=this.getFieldTypeLength(d);if(4>=c*b)!1===this.littleEndian?
e.push(a>>>8*(4-c)):e.push(a);else for(var f=0;f<b;f++){var k=c*f;8<=c?-1!==["RATIONAL","SRATIONAL"].indexOf(d)?(e.push(this.getUint32(a+k)),e.push(this.getUint32(a+k+4))):cc.logID(8E3):e.push(this.getBytes(c,a+k))}return"ASCII"===d&&e.forEach(function(a,c,b){b[c]=String.fromCharCode(a)}),e},getBytes:function(e,d){if(0>=e)cc.logID(8001);else{if(1>=e)return this.getUint8(d);if(2>=e)return this.getUint16(d);if(3>=e)return this.getUint32(d)>>>8;if(4>=e)return this.getUint32(d);cc.logID(8002)}},getBits:function(e,
d,b){b=b||0;var a,c;d+=Math.floor(b/8);var f=b+e;e=32-e;return 0>=f?cc.logID(6023):8>=f?(a=24+b,c=this.getUint8(d)):16>=f?(a=16+b,c=this.getUint16(d)):32>=f?(a=b,c=this.getUint32(d)):cc.logID(6022),{bits:c<<a>>>e,byteOffset:d+Math.floor(f/8),bitOffset:f%8}},parseFileDirectory:function(e){var d=this.getUint16(e),b=[];e+=2;for(var a=0;a<d;e+=12,a++){var c=this.getUint16(e),f=this.getUint16(e+2),k=this.getUint32(e+4),l=this.getUint32(e+8);c=this.getFieldTagName(c);f=this.getFieldTypeName(f);k=this.getFieldValues(c,
f,k,l);b[c]={type:f,values:k}}this._fileDirectories.push(b);d=this.getUint32(e);0!==d&&this.parseFileDirectory(d)},clampColorSample:function(e,d){d=Math.pow(2,8-d);return Math.floor(e*d+(d-1))},parseTIFF:function(e,d){if(d=d||document.createElement("canvas"),this._tiffData=e,this.canvas=d,this.checkLittleEndian(),this.hasTowel()){e=this.getUint32(4);this._fileDirectories.length=0;this.parseFileDirectory(e);var b=this._fileDirectories[0];e=b.ImageWidth.values[0];var a=b.ImageLength.values[0];this.canvas.width=
e;this.canvas.height=a;var c=[],f=b.Compression?b.Compression.values[0]:1,k=b.SamplesPerPixel.values[0],l=[],q=0,r=!1;if(b.BitsPerSample.values.forEach(function(a,c,b){l[c]={bitsPerSample:a,hasBytesPerSample:!1,bytesPerSample:void 0};0==a%8&&(l[c].hasBytesPerSample=!0,l[c].bytesPerSample=a/8);q+=a},this),0==q%8){r=!0;var t=q/8}var p=b.StripOffsets.values,v=p.length;if(b.StripByteCounts)var w=b.StripByteCounts.values;else{if(cc.logID(8003),1!==v)throw Error(h.getError(6024));w=[Math.ceil(e*a*q/8)]}for(var m=
0;m<v;m++){var x=p[m];c[m]=[];for(var y=w[m],u=0,n=0,C=1,z=!0,A=[],D=0,I=0,F=0;u<y;u+=C)switch(f){case 1:C=0;for(A=[];C<k;C++){if(!l[C].hasBytesPerSample){var G=this.getBits(l[C].bitsPerSample,x+u,n);throw A.push(G.bits),u=G.byteOffset-x,n=G.bitOffset,RangeError(h.getError(6025));}A.push(this.getBytes(l[C].bytesPerSample,x+u+l[C].bytesPerSample*C))}if(c[m].push(A),!r)throw C=0,RangeError(h.getError(6026));C=t;break;case 32773:if(z){z=!1;var J=1,N=1;C=this.getInt8(x+u);0<=C&&127>=C?J=C+1:-127<=C&&
-1>=C?N=1-C:z=!0}else{var K=this.getUint8(x+u);for(C=0;C<N;C++){if(!l[I].hasBytesPerSample)throw RangeError(h.getError(6025));F=F<<8*D|K;++D===l[I].bytesPerSample&&(A.push(F),F=D=0,I++);I===k&&(c[m].push(A),A=[],I=0)}0===--J&&(z=!0)}C=1}}if(d.getContext){d=this.canvas.getContext("2d");d.fillStyle="rgba(255, 255, 255, 0)";m=b.RowsPerStrip?b.RowsPerStrip.values[0]:a;t=c.length;a%=m;a=0===a?m:a;J=m;A=0;N=b.PhotometricInterpretation.values[0];x=[];u=0;if(b.ExtraSamples&&(u=(x=b.ExtraSamples.values).length),
b.ColorMap){G=b.ColorMap.values;var P=Math.pow(2,l[0].bitsPerSample)}for(m=0;m<t;m++){m+1===t&&(J=a);b=c[m].length;A*=m;for(k=f=0;k<b;f++)for(r=0;r<e;r++,k++){v=c[m][k];n=y=w=0;p=1;if(0<u)for(w=0;w<u;w++)if(1===x[w]||2===x[w]){p=v[3+w]/256;break}switch(N){case 0:if(l[0].hasBytesPerSample)var L=Math.pow(16,2*l[0].bytesPerSample);v.forEach(function(a,c,b){b[c]=L-a});case 1:w=y=n=this.clampColorSample(v[0],l[0].bitsPerSample);break;case 2:w=this.clampColorSample(v[0],l[0].bitsPerSample);y=this.clampColorSample(v[1],
l[1].bitsPerSample);n=this.clampColorSample(v[2],l[2].bitsPerSample);break;case 3:if(void 0===G)throw Error(h.getError(6027));v=v[0];w=this.clampColorSample(G[v],16);y=this.clampColorSample(G[P+v],16);n=this.clampColorSample(G[2*P+v],16);break;default:throw RangeError(h.getError(6028,N));}d.fillStyle="rgba("+w+", "+y+", "+n+", "+p+")";d.fillRect(r,A+f,1,1)}A=J}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",
306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",
263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",
322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",
37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}}},{"../core/CCDebug":27}],263:[function(f,n,m){f("./CCParticleAsset");f("./CCParticleSystem");f("./particle-simulator");f("./particle-system-assembler")},{"./CCParticleAsset":260,"./CCParticleSystem":261,"./particle-simulator":264,
"./particle-system-assembler":265}],264:[function(f,n,m){var h=f("../core/utils/affine-transform");m=f("../core/platform/js");var e=f("../core/utils/misc"),d=cc.v2(0,0),b=h.create(),a=cc.v2(),c=cc.v2(),g=cc.v2(),k=cc.v2(),l=function(){this.pos=cc.v2(0,0);this.startPos=cc.v2(0,0);this.color=cc.color(0,0,0,255);this.deltaColor={r:0,g:0,b:0,a:255};this.timeToLive=this.deltaRotation=this.rotation=this.deltaSize=this.size=0;this.drawPos=cc.v2(0,0);this.dir=cc.v2(0,0);this.deltaRadius=this.radius=this.degreesPerSecond=
this.angle=this.tangentialAccel=this.radialAccel=0},q=new m.Pool(function(a){a.pos.set(d);a.startPos.set(d);a.color._val=4278190080;a.deltaColor.r=a.deltaColor.g=a.deltaColor.b=0;a.deltaColor.a=255;a.size=0;a.deltaSize=0;a.rotation=0;a.deltaRotation=0;a.timeToLive=0;a.drawPos.set(d);a.dir.set(d);a.radialAccel=0;a.tangentialAccel=0;a.angle=0;a.degreesPerSecond=0;a.radius=0;a.deltaRadius=0},1024);q.get=function(){return this._get()||new l};f=function(a){this.sys=a;this.particles=[];this.active=!1;this.readyToPlay=
!0;this.finished=!1;this._uvFilled=this.emitCounter=this.elapsed=0};f.prototype.stop=function(){this.readyToPlay=this.active=!1;this.elapsed=this.sys.duration;this.emitCounter=0};f.prototype.reset=function(){this.readyToPlay=this.active=!0;this.emitCounter=this.elapsed=0;this.finished=!1;for(var a=this.particles,c=0;c<a.length;++c)q.put(a[c]);a.length=0};f.prototype.emitParticle=function(a){var c=this.sys,b=e.clampf,d=q.get();this.particles.push(d);d.timeToLive=c.life+c.lifeVar*(Math.random()-.5)*
2;var f=d.timeToLive=Math.max(0,d.timeToLive);d.pos.x=c.sourcePos.x+c.posVar.x*(Math.random()-.5)*2;d.pos.y=c.sourcePos.y+c.posVar.y*(Math.random()-.5)*2;var g,k,l;var h=c._startColor;var r=c._startColorVar,m=c._endColor,n=c._endColorVar;d.color.r=g=b(h.r+r.r*(Math.random()-.5)*2,0,255);d.color.g=k=b(h.g+r.g*(Math.random()-.5)*2,0,255);d.color.b=l=b(h.b+r.b*(Math.random()-.5)*2,0,255);d.color.a=h=b(h.a+r.a*(Math.random()-.5)*2,0,255);d.deltaColor.r=(b(m.r+n.r*(Math.random()-.5)*2,0,255)-g)/f;d.deltaColor.g=
(b(m.g+n.g*(Math.random()-.5)*2,0,255)-k)/f;d.deltaColor.b=(b(m.b+n.b*(Math.random()-.5)*2,0,255)-l)/f;d.deltaColor.a=(b(m.a+n.a*(Math.random()-.5)*2,0,255)-h)/f;b=c.startSize+c.startSizeVar*(Math.random()-.5)*2;(b=Math.max(0,b),d.size=b,c.endSize===cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)?d.deltaSize=0:(g=c.endSize+c.endSizeVar*(Math.random()-.5)*2,g=Math.max(0,g),d.deltaSize=(g-b)/f);b=c.startSpin+c.startSpinVar*(Math.random()-.5)*2;g=c.endSpin+c.endSpinVar*(Math.random()-.5)*2;d.rotation=
b;d.deltaRotation=(g-b)/f;d.startPos.x=a.x;d.startPos.y=a.y;a=0;for(b=c.node;b;)a+=b.angle,b=b.parent;a=e.degreesToRadians((c.positionType===cc.ParticleSystem.PositionType.FREE?c.angle+a:c.angle)+c.angleVar*(Math.random()-.5)*2);c.emitterMode===cc.ParticleSystem.EmitterMode.GRAVITY?(f=c.speed+c.speedVar*(Math.random()-.5)*2,d.dir.x=Math.cos(a),d.dir.y=Math.sin(a),d.dir.mulSelf(f),d.radialAccel=c.radialAccel+c.radialAccelVar*(Math.random()-.5)*2,d.tangentialAccel=c.tangentialAccel+c.tangentialAccelVar*
(Math.random()-.5)*2,c.rotationIsDir&&(d.rotation=-e.radiansToDegrees(Math.atan2(d.dir.y,d.dir.x)))):(b=c.startRadius+c.startRadiusVar*(Math.random()-.5)*2,g=c.endRadius+c.endRadiusVar*(Math.random()-.5)*2,d.radius=b,d.deltaRadius=c.endRadius===cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(g-b)/f,d.angle=a,d.degreesPerSecond=e.degreesToRadians(c.rotatePerS+c.rotatePerSVar*(Math.random()-.5)*2))};f.prototype.updateUVs=function(a){var c=this.sys._assembler;if(c){var b=c.getBuffer();if(b&&this.sys._renderSpriteFrame){c=
4*c._vfmt._bytes/4;b=b._vData;var d=this.sys._renderSpriteFrame.uv,e=this.particles.length;for(a=a?0:this._uvFilled;a<e;a++){var f=a*c;b[f+2]=d[0];b[f+3]=d[1];b[f+7]=d[2];b[f+8]=d[3];b[f+12]=d[4];b[f+13]=d[5];b[f+17]=d[6];b[f+18]=d[7]}this._uvFilled=e}}};f.prototype.updateParticleBuffer=function(a,c,b,d){var f=b._vData;b=b._uintVData;var g=c.x;c=c.y;var k=a.size/2;if(a.rotation){var l=-k,p=-k,h=-e.degreesToRadians(a.rotation),q=Math.cos(h);h=Math.sin(h);f[d]=l*q-p*h+g;f[d+1]=l*h+p*q+c;f[d+5]=k*q-
p*h+g;f[d+6]=k*h+p*q+c;f[d+10]=l*q-k*h+g;f[d+11]=l*h+k*q+c;f[d+15]=k*q-k*h+g;f[d+16]=k*h+k*q+c}else f[d]=g-k,f[d+1]=c-k,f[d+5]=g+k,f[d+6]=c-k,f[d+10]=g-k,f[d+11]=c+k,f[d+15]=g+k,f[d+16]=c+k;b[d+4]=a.color._val;b[d+9]=a.color._val;b[d+14]=a.color._val;b[d+19]=a.color._val};f.prototype.step=function(f){var l=this.sys,p=l.node,v=this.particles,r=4*this.sys._assembler._vfmt._bytes/4;if(p._updateWorldMatrix(),b=h.identity(),l.positionType===cc.ParticleSystem.PositionType.FREE)p=p._worldMatrix.m,b.tx=p[12],
b.ty=p[13],h.transformVec2(a,d,b);else if(l.positionType===cc.ParticleSystem.PositionType.RELATIVE){var m=e.degreesToRadians(-p.angle),x=Math.cos(m);m=Math.sin(m);b=h.create(x,-m,m,x,0,0);a.x=p.x;a.y=p.y}h.invert(b,b);p=b;if(this.active&&l.emissionRate){x=1/l.emissionRate;for(v.length<l.totalParticles&&(this.emitCounter+=f);v.length<l.totalParticles&&this.emitCounter>x;)this.emitParticle(a),this.emitCounter-=x;this.elapsed+=f;-1!==l.duration&&l.duration<this.elapsed&&l.stopSystem()}x=l._assembler.getBuffer();
m=v.length;x.reset();x.request(4*m,6*m);m>this._uvFilled&&this.updateUVs();for(m=0;m<v.length;){c.x=c.y=g.x=g.y=k.x=k.y=0;var y=v[m];if(y.timeToLive-=f,0<y.timeToLive){if(l.emitterMode===cc.ParticleSystem.EmitterMode.GRAVITY){var u=k,n=c,C=g;(y.pos.x||y.pos.y)&&(n.set(y.pos),n.normalizeSelf());C.set(n);n.mulSelf(y.radialAccel);var z=C.x;C.x=-C.y;C.y=z;C.mulSelf(y.tangentialAccel);u.set(n);u.addSelf(C);u.addSelf(l.gravity);u.mulSelf(f);y.dir.addSelf(u);u.set(y.dir);u.mulSelf(f);y.pos.addSelf(u)}else y.angle+=
y.degreesPerSecond*f,y.radius+=y.deltaRadius*f,y.pos.x=-Math.cos(y.angle)*y.radius,y.pos.y=-Math.sin(y.angle)*y.radius;y.color.r+=y.deltaColor.r*f;y.color.g+=y.deltaColor.g*f;y.color.b+=y.deltaColor.b*f;y.color.a+=y.deltaColor.a*f;y.size+=y.deltaSize*f;0>y.size&&(y.size=0);y.rotation+=y.deltaRotation*f;u=c;n=g;l.positionType===cc.ParticleSystem.PositionType.FREE?(n.set(y.startPos),n.negSelf(),u.set(y.pos),u.subSelf(n)):l.positionType===cc.ParticleSystem.PositionType.RELATIVE?(C=k,h.transformVec2(n,
a,p),h.transformVec2(C,y.startPos,p),n.subSelf(C),u.set(y.pos),u.subSelf(n)):u.set(y.pos);this.updateParticleBuffer(y,u,x,r*m);++m}else y=v[m],m!==v.length-1&&(v[m]=v[v.length-1]),q.put(y),v.length--}0<v.length?(x.uploadData(),l._assembler._ia._count=6*v.length):this.active||this.readyToPlay||(this.finished=!0,l._finishedSimulation())};n.exports=f},{"../core/platform/js":150,"../core/utils/affine-transform":211,"../core/utils/misc":220}],265:[function(f,n,m){function h(a){return a&&a.__esModule?a:
{default:a}}function e(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m=h(f("../core/renderer/assembler"));var d=h(f("../renderer/core/input-assembler")),b=f("./CCParticleSystem"),a=f("../core/renderer/"),c=f("../core/renderer/webgl/quad-buffer"),
g=f("../core/renderer/webgl/vertex-format").vfmtPosUvColor;f=function(b){function f(a){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");a=b.call(this,a);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!=typeof a&&"function"!=typeof a?this:a;return a._buffer=null,a._ia=null,a._vfmt=g,a}return e(f,b),f.prototype.getBuffer=function(){return this._buffer||(this._buffer=new c(a._handle,g),this._ia=new d.default,
this._ia._vertexBuffer=this._buffer._vb,this._ia._indexBuffer=this._buffer._ib,this._ia._start=0,this._ia._count=0),this._buffer},f.prototype.fillBuffers=function(a,c){this._ia&&(c.node=a.node,c.material=a.sharedMaterials[0],c._flushIA(this._ia))},f}(m.default);m.default.register(b,f);n.exports=f},{"../core/renderer/":178,"../core/renderer/assembler":158,"../core/renderer/webgl/quad-buffer":206,"../core/renderer/webgl/vertex-format":209,"../renderer/core/input-assembler":270,"./CCParticleSystem":261}],
266:[function(f,n,m){var h,e,d;(function(a){a[a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT";a[a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT";a[a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT";a[a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT";a[a.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT";a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT";a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=
35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT";a[a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT";a[a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG";a[a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG";a[a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG";a[a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG";a[a.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL"})(h||
(h={}));(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.BUFFER=1]="BUFFER";a[a.TEXTURE=2]="TEXTURE";a[a.TEXTURE_VIEW=3]="TEXTURE_VIEW";a[a.RENDER_PASS=4]="RENDER_PASS";a[a.FRAMEBUFFER=5]="FRAMEBUFFER";a[a.SAMPLER=6]="SAMPLER";a[a.SHADER=7]="SHADER";a[a.PIPELINE_LAYOUT=8]="PIPELINE_LAYOUT";a[a.PIPELINE_STATE=9]="PIPELINE_STATE";a[a.BINDING_LAYOUT=10]="BINDING_LAYOUT";a[a.INPUT_ASSEMBLER=11]="INPUT_ASSEMBLER";a[a.COMMAND_ALLOCATOR=12]="COMMAND_ALLOCATOR";a[a.COMMAND_BUFFER=13]="COMMAND_BUFFER";a[a.QUEUE=
14]="QUEUE";a[a.WINDOW=15]="WINDOW"})(e||(e={}));(function(a){a[a.UNREADY=0]="UNREADY";a[a.FAILED=1]="FAILED";a[a.SUCCESS=2]="SUCCESS"})(d||(d={}));var b,a,c,g,k,l,q,r,t,p,v,w,E,x,y,u,B,C,z,A,D,I,F,G,J,N,K,P,L,M,U,R,O,H,S;(function(){function a(a){this._status=d.UNREADY;this._gfxType=a}Object.defineProperty(a.prototype,"gfxType",{get:function(){return this._gfxType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0})})();
(function(a){a.ATTR_POSITION="a_position";a.ATTR_NORMAL="a_normal";a.ATTR_TANGENT="a_tangent";a.ATTR_BITANGENT="a_bitangent";a.ATTR_WEIGHTS="a_weights";a.ATTR_JOINTS="a_joints";a.ATTR_COLOR="a_color";a.ATTR_COLOR1="a_color1";a.ATTR_COLOR2="a_color2";a.ATTR_TEX_COORD="a_texCoord";a.ATTR_TEX_COORD1="a_texCoord1";a.ATTR_TEX_COORD2="a_texCoord2";a.ATTR_TEX_COORD3="a_texCoord3";a.ATTR_TEX_COORD4="a_texCoord4";a.ATTR_TEX_COORD5="a_texCoord5";a.ATTR_TEX_COORD6="a_texCoord6";a.ATTR_TEX_COORD7="a_texCoord7";
a.ATTR_TEX_COORD8="a_texCoord8"})(b||(b={}));(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.BOOL=1]="BOOL";a[a.BOOL2=2]="BOOL2";a[a.BOOL3=3]="BOOL3";a[a.BOOL4=4]="BOOL4";a[a.INT=5]="INT";a[a.INT2=6]="INT2";a[a.INT3=7]="INT3";a[a.INT4=8]="INT4";a[a.UINT=9]="UINT";a[a.UINT2=10]="UINT2";a[a.UINT3=11]="UINT3";a[a.UINT4=12]="UINT4";a[a.FLOAT=13]="FLOAT";a[a.FLOAT2=14]="FLOAT2";a[a.FLOAT3=15]="FLOAT3";a[a.FLOAT4=16]="FLOAT4";a[a.COLOR4=17]="COLOR4";a[a.MAT2=18]="MAT2";a[a.MAT2X3=19]="MAT2X3";a[a.MAT2X4=20]=
"MAT2X4";a[a.MAT3X2=21]="MAT3X2";a[a.MAT3=22]="MAT3";a[a.MAT3X4=23]="MAT3X4";a[a.MAT4X2=24]="MAT4X2";a[a.MAT4X3=25]="MAT4X3";a[a.MAT4=26]="MAT4";a[a.SAMPLER1D=27]="SAMPLER1D";a[a.SAMPLER1D_ARRAY=28]="SAMPLER1D_ARRAY";a[a.SAMPLER2D=29]="SAMPLER2D";a[a.SAMPLER2D_ARRAY=30]="SAMPLER2D_ARRAY";a[a.SAMPLER3D=31]="SAMPLER3D";a[a.SAMPLER_CUBE=32]="SAMPLER_CUBE";a[a.COUNT=33]="COUNT"})(a||(a={}));(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.A8=1]="A8";a[a.L8=2]="L8";a[a.LA8=3]="LA8";a[a.R8=4]="R8";a[a.R8SN=5]=
"R8SN";a[a.R8UI=6]="R8UI";a[a.R8I=7]="R8I";a[a.R16F=8]="R16F";a[a.R16UI=9]="R16UI";a[a.R16I=10]="R16I";a[a.R32F=11]="R32F";a[a.R32UI=12]="R32UI";a[a.R32I=13]="R32I";a[a.RG8=14]="RG8";a[a.RG8SN=15]="RG8SN";a[a.RG8UI=16]="RG8UI";a[a.RG8I=17]="RG8I";a[a.RG16F=18]="RG16F";a[a.RG16UI=19]="RG16UI";a[a.RG16I=20]="RG16I";a[a.RG32F=21]="RG32F";a[a.RG32UI=22]="RG32UI";a[a.RG32I=23]="RG32I";a[a.RGB8=24]="RGB8";a[a.SRGB8=25]="SRGB8";a[a.RGB8SN=26]="RGB8SN";a[a.RGB8UI=27]="RGB8UI";a[a.RGB8I=28]="RGB8I";a[a.RGB16F=
29]="RGB16F";a[a.RGB16UI=30]="RGB16UI";a[a.RGB16I=31]="RGB16I";a[a.RGB32F=32]="RGB32F";a[a.RGB32UI=33]="RGB32UI";a[a.RGB32I=34]="RGB32I";a[a.RGBA8=35]="RGBA8";a[a.SRGB8_A8=36]="SRGB8_A8";a[a.RGBA8SN=37]="RGBA8SN";a[a.RGBA8UI=38]="RGBA8UI";a[a.RGBA8I=39]="RGBA8I";a[a.RGBA16F=40]="RGBA16F";a[a.RGBA16UI=41]="RGBA16UI";a[a.RGBA16I=42]="RGBA16I";a[a.RGBA32F=43]="RGBA32F";a[a.RGBA32UI=44]="RGBA32UI";a[a.RGBA32I=45]="RGBA32I";a[a.R5G6B5=46]="R5G6B5";a[a.R11G11B10F=47]="R11G11B10F";a[a.RGB5A1=48]="RGB5A1";
a[a.RGBA4=49]="RGBA4";a[a.RGB10A2=50]="RGB10A2";a[a.RGB10A2UI=51]="RGB10A2UI";a[a.RGB9E5=52]="RGB9E5";a[a.D16=53]="D16";a[a.D16S8=54]="D16S8";a[a.D24=55]="D24";a[a.D24S8=56]="D24S8";a[a.D32F=57]="D32F";a[a.D32F_S8=58]="D32F_S8";a[a.BC1=59]="BC1";a[a.BC1_ALPHA=60]="BC1_ALPHA";a[a.BC1_SRGB=61]="BC1_SRGB";a[a.BC1_SRGB_ALPHA=62]="BC1_SRGB_ALPHA";a[a.BC2=63]="BC2";a[a.BC2_SRGB=64]="BC2_SRGB";a[a.BC3=65]="BC3";a[a.BC3_SRGB=66]="BC3_SRGB";a[a.BC4=67]="BC4";a[a.BC4_SNORM=68]="BC4_SNORM";a[a.BC5=69]="BC5";
a[a.BC5_SNORM=70]="BC5_SNORM";a[a.BC6H_UF16=71]="BC6H_UF16";a[a.BC6H_SF16=72]="BC6H_SF16";a[a.BC7=73]="BC7";a[a.BC7_SRGB=74]="BC7_SRGB";a[a.ETC_RGB8=75]="ETC_RGB8";a[a.ETC2_RGB8=76]="ETC2_RGB8";a[a.ETC2_SRGB8=77]="ETC2_SRGB8";a[a.ETC2_RGB8_A1=78]="ETC2_RGB8_A1";a[a.ETC2_SRGB8_A1=79]="ETC2_SRGB8_A1";a[a.ETC2_RGBA8=80]="ETC2_RGBA8";a[a.ETC2_SRGB8_A8=81]="ETC2_SRGB8_A8";a[a.EAC_R11=82]="EAC_R11";a[a.EAC_R11SN=83]="EAC_R11SN";a[a.EAC_RG11=84]="EAC_RG11";a[a.EAC_RG11SN=85]="EAC_RG11SN";a[a.PVRTC_RGB2=
86]="PVRTC_RGB2";a[a.PVRTC_RGBA2=87]="PVRTC_RGBA2";a[a.PVRTC_RGB4=88]="PVRTC_RGB4";a[a.PVRTC_RGBA4=89]="PVRTC_RGBA4";a[a.PVRTC2_2BPP=90]="PVRTC2_2BPP";a[a.PVRTC2_4BPP=91]="PVRTC2_4BPP"})(c||(c={}));(function(a){a[a.NONE=0]="NONE";a[a.TRANSFER_SRC=1]="TRANSFER_SRC";a[a.TRANSFER_DST=2]="TRANSFER_DST";a[a.INDEX=4]="INDEX";a[a.VERTEX=8]="VERTEX";a[a.UNIFORM=16]="UNIFORM";a[a.STORAGE=32]="STORAGE";a[a.INDIRECT=64]="INDIRECT"})(g||(g={}));(function(a){a[a.NONE=0]="NONE";a[a.DEVICE=1]="DEVICE";a[a.HOST=
2]="HOST"})(k||(k={}));(function(a){a[a.NONE=0]="NONE";a[a.READ=1]="READ";a[a.WRITE=2]="WRITE"})(l||(l={}));(function(a){a[a.POINT_LIST=0]="POINT_LIST";a[a.LINE_LIST=1]="LINE_LIST";a[a.LINE_STRIP=2]="LINE_STRIP";a[a.LINE_LOOP=3]="LINE_LOOP";a[a.LINE_LIST_ADJACENCY=4]="LINE_LIST_ADJACENCY";a[a.LINE_STRIP_ADJACENCY=5]="LINE_STRIP_ADJACENCY";a[a.ISO_LINE_LIST=6]="ISO_LINE_LIST";a[a.TRIANGLE_LIST=7]="TRIANGLE_LIST";a[a.TRIANGLE_STRIP=8]="TRIANGLE_STRIP";a[a.TRIANGLE_FAN=9]="TRIANGLE_FAN";a[a.TRIANGLE_LIST_ADJACENCY=
10]="TRIANGLE_LIST_ADJACENCY";a[a.TRIANGLE_STRIP_ADJACENCY=11]="TRIANGLE_STRIP_ADJACENCY";a[a.TRIANGLE_PATCH_ADJACENCY=12]="TRIANGLE_PATCH_ADJACENCY";a[a.QUAD_PATCH_LIST=13]="QUAD_PATCH_LIST"})(q||(q={}));(function(a){a[a.FILL=0]="FILL";a[a.POINT=1]="POINT";a[a.LINE=2]="LINE"})(r||(r={}));(function(a){a[a.GOURAND=0]="GOURAND";a[a.FLAT=1]="FLAT"})(t||(t={}));(function(a){a[a.NONE=0]="NONE";a[a.FRONT=1]="FRONT";a[a.BACK=2]="BACK"})(p||(p={}));(function(a){a[a.NEVER=0]="NEVER";a[a.LESS=1]="LESS";a[a.EQUAL=
2]="EQUAL";a[a.LESS_EQUAL=3]="LESS_EQUAL";a[a.GREATER=4]="GREATER";a[a.NOT_EQUAL=5]="NOT_EQUAL";a[a.GREATER_EQUAL=6]="GREATER_EQUAL";a[a.ALWAYS=7]="ALWAYS"})(v||(v={}));(function(a){a[a.ZERO=0]="ZERO";a[a.KEEP=1]="KEEP";a[a.REPLACE=2]="REPLACE";a[a.INCR=3]="INCR";a[a.DECR=4]="DECR";a[a.INVERT=5]="INVERT";a[a.INCR_WRAP=6]="INCR_WRAP";a[a.DECR_WRAP=7]="DECR_WRAP"})(w||(w={}));(function(a){a[a.ADD=0]="ADD";a[a.SUB=1]="SUB";a[a.REV_SUB=2]="REV_SUB";a[a.MIN=3]="MIN";a[a.MAX=4]="MAX"})(E||(E={}));(function(a){a[a.ZERO=
0]="ZERO";a[a.ONE=1]="ONE";a[a.SRC_ALPHA=2]="SRC_ALPHA";a[a.DST_ALPHA=3]="DST_ALPHA";a[a.ONE_MINUS_SRC_ALPHA=4]="ONE_MINUS_SRC_ALPHA";a[a.ONE_MINUS_DST_ALPHA=5]="ONE_MINUS_DST_ALPHA";a[a.SRC_COLOR=6]="SRC_COLOR";a[a.DST_COLOR=7]="DST_COLOR";a[a.ONE_MINUS_SRC_COLOR=8]="ONE_MINUS_SRC_COLOR";a[a.ONE_MINUS_DST_COLOR=9]="ONE_MINUS_DST_COLOR";a[a.SRC_ALPHA_SATURATE=10]="SRC_ALPHA_SATURATE";a[a.CONSTANT_COLOR=11]="CONSTANT_COLOR";a[a.ONE_MINUS_CONSTANT_COLOR=12]="ONE_MINUS_CONSTANT_COLOR";a[a.CONSTANT_ALPHA=
13]="CONSTANT_ALPHA";a[a.ONE_MINUS_CONSTANT_ALPHA=14]="ONE_MINUS_CONSTANT_ALPHA"})(x||(x={}));(function(a){a[a.NONE=0]="NONE";a[a.R=1]="R";a[a.G=2]="G";a[a.B=4]="B";a[a.A=8]="A";a[a.ALL=15]="ALL"})(y||(y={}));(function(a){a[a.NONE=0]="NONE";a[a.POINT=1]="POINT";a[a.LINEAR=2]="LINEAR";a[a.ANISOTROPIC=3]="ANISOTROPIC"})(u||(u={}));(function(a){a[a.WRAP=0]="WRAP";a[a.MIRROR=1]="MIRROR";a[a.CLAMP=2]="CLAMP";a[a.BORDER=3]="BORDER"})(B||(B={}));(function(a){a[a.TEX1D=0]="TEX1D";a[a.TEX2D=1]="TEX2D";a[a.TEX3D=
2]="TEX3D"})(C||(C={}));(function(a){a[a.NONE=0]="NONE";a[a.TRANSFER_SRC=1]="TRANSFER_SRC";a[a.TRANSFER_DST=2]="TRANSFER_DST";a[a.SAMPLED=4]="SAMPLED";a[a.STORAGE=8]="STORAGE";a[a.COLOR_ATTACHMENT=16]="COLOR_ATTACHMENT";a[a.DEPTH_STENCIL_ATTACHMENT=32]="DEPTH_STENCIL_ATTACHMENT";a[a.TRANSIENT_ATTACHMENT=64]="TRANSIENT_ATTACHMENT";a[a.INPUT_ATTACHMENT=128]="INPUT_ATTACHMENT"})(z||(z={}));(function(a){a[a.X1=0]="X1";a[a.X2=1]="X2";a[a.X4=2]="X4";a[a.X8=3]="X8";a[a.X16=4]="X16";a[a.X32=5]="X32";a[a.X64=
6]="X64"})(A||(A={}));(function(a){a[a.NONE=0]="NONE";a[a.GEN_MIPMAP=1]="GEN_MIPMAP";a[a.CUBEMAP=2]="CUBEMAP";a[a.BAKUP_BUFFER=4]="BAKUP_BUFFER"})(D||(D={}));(function(a){a[a.TV1D=0]="TV1D";a[a.TV2D=1]="TV2D";a[a.TV3D=2]="TV3D";a[a.CUBE=3]="CUBE";a[a.TV1D_ARRAY=4]="TV1D_ARRAY";a[a.TV2D_ARRAY=5]="TV2D_ARRAY"})(I||(I={}));(function(a){a[a.VERTEX=0]="VERTEX";a[a.HULL=1]="HULL";a[a.DOMAIN=2]="DOMAIN";a[a.GEOMETRY=3]="GEOMETRY";a[a.FRAGMENT=4]="FRAGMENT";a[a.COMPUTE=5]="COMPUTE";a[a.COUNT=6]="COUNT"})(F||
(F={}));(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.UNIFORM_BUFFER=1]="UNIFORM_BUFFER";a[a.SAMPLER=2]="SAMPLER";a[a.STORAGE_BUFFER=3]="STORAGE_BUFFER"})(G||(G={}));(function(a){a[a.PRIMARY=0]="PRIMARY";a[a.SECONDARY=1]="SECONDARY"})(J||(J={}));(function(a){a[a.LOAD=0]="LOAD";a[a.CLEAR=1]="CLEAR";a[a.DISCARD=2]="DISCARD"})(N||(N={}));(function(a){a[a.STORE=0]="STORE";a[a.DISCARD=1]="DISCARD"})(K||(K={}));(function(a){a[a.UNDEFINED=0]="UNDEFINED";a[a.GENERAL=1]="GENERAL";a[a.COLOR_ATTACHMENT_OPTIMAL=
2]="COLOR_ATTACHMENT_OPTIMAL";a[a.DEPTH_STENCIL_ATTACHMENT_OPTIMAL=3]="DEPTH_STENCIL_ATTACHMENT_OPTIMAL";a[a.DEPTH_STENCIL_READONLY_OPTIMAL=4]="DEPTH_STENCIL_READONLY_OPTIMAL";a[a.SHADER_READONLY_OPTIMAL=5]="SHADER_READONLY_OPTIMAL";a[a.TRANSFER_SRC_OPTIMAL=6]="TRANSFER_SRC_OPTIMAL";a[a.TRANSFER_DST_OPTIMAL=7]="TRANSFER_DST_OPTIMAL";a[a.PREINITIALIZED=8]="PREINITIALIZED";a[a.PRESENT_SRC=9]="PRESENT_SRC"})(P||(P={}));(function(a){a[a.GRAPHICS=0]="GRAPHICS";a[a.COMPUTE=1]="COMPUTE";a[a.RAY_TRACING=
2]="RAY_TRACING"})(L||(L={}));(function(a){a[a.VIEWPORT=0]="VIEWPORT";a[a.SCISSOR=1]="SCISSOR";a[a.LINE_WIDTH=2]="LINE_WIDTH";a[a.DEPTH_BIAS=3]="DEPTH_BIAS";a[a.BLEND_CONSTANTS=4]="BLEND_CONSTANTS";a[a.DEPTH_BOUNDS=5]="DEPTH_BOUNDS";a[a.STENCIL_WRITE_MASK=6]="STENCIL_WRITE_MASK";a[a.STENCIL_COMPARE_MASK=7]="STENCIL_COMPARE_MASK"})(M||(M={}));(function(a){a[a.FRONT=0]="FRONT";a[a.BACK=1]="BACK";a[a.ALL=2]="ALL"})(U||(U={}));(function(a){a[a.GRAPHICS=0]="GRAPHICS";a[a.COMPUTE=1]="COMPUTE";a[a.TRANSFER=
2]="TRANSFER"})(R||(R={}));(function(a){a[a.NONE=0]="NONE";a[a.COLOR=1]="COLOR";a[a.DEPTH=2]="DEPTH";a[a.STENCIL=4]="STENCIL";a[a.DEPTH_STENCIL=6]="DEPTH_STENCIL";a[a.ALL=7]="ALL"})(O||(O={}));(function(a){a[a.DEFAULT=100]="DEFAULT"})(H||(H={}));(function(a){a[a.MIN=0]="MIN";a[a.MAX=255]="MAX";a[a.DEFAULT=128]="DEFAULT"})(S||(S={}));var W,T,Q,Y;(function(a){a[a.UBO_GLOBAL=23]="UBO_GLOBAL";a[a.UBO_SHADOW=22]="UBO_SHADOW";a[a.UBO_LOCAL=21]="UBO_LOCAL";a[a.UBO_FORWARD_LIGHTS=20]="UBO_FORWARD_LIGHTS";
a[a.UBO_SKINNING=19]="UBO_SKINNING";a[a.UBO_SKINNING_TEXTURE=18]="UBO_SKINNING_TEXTURE";a[a.UBO_UI=17]="UBO_UI";a[a.SAMPLER_JOINTS=25]="SAMPLER_JOINTS";a[a.SAMPLER_ENVIRONMENT=26]="SAMPLER_ENVIRONMENT";a[a.CUSTUM_UBO_BINDING_END_POINT=17]="CUSTUM_UBO_BINDING_END_POINT";a[a.CUSTOM_SAMPLER_BINDING_START_POINT=30]="CUSTOM_SAMPLER_BINDING_START_POINT"})(W||(W={}));(function(a){a[a.minFilter=0]="minFilter";a[a.magFilter=1]="magFilter";a[a.mipFilter=2]="mipFilter";a[a.addressU=3]="addressU";a[a.addressV=
4]="addressV";a[a.addressW=5]="addressW";a[a.maxAnisotropy=6]="maxAnisotropy";a[a.cmpFunc=7]="cmpFunc";a[a.minLOD=8]="minLOD";a[a.maxLOD=9]="maxLOD";a[a.mipLODBias=10]="mipLODBias";a[a.borderColor=11]="borderColor";a[a.total=15]="total"})(Y||(Y={}));f={};f[f.bool=a.BOOL]="bool";f[f.int=a.INT]="int";f[f.ivec2=a.INT2]="ivec2invTypeParams";f[f.ivec3=a.INT3]="ivec3";f[f.ivec4=a.INT4]="ivec4";f[f.float=a.FLOAT]="float";f[f.vec2=a.FLOAT2]="vec2";f[f.vec3=a.FLOAT3]="vec3";f[f.vec4=a.FLOAT4]="vec4";f[f.mat2=
a.MAT2]="mat2";f[f.mat3=a.MAT3]="mat3";f[f.mat4=a.MAT4]="mat4";f[f.sampler2D=a.SAMPLER2D]="sampler2D";f[f.samplerCube=a.SAMPLER_CUBE]="samplerCube";m=((T={})[a.BOOL]=4,T[a.INT]=4,T[a.INT2]=8,T[a.INT3]=12,T[a.INT4]=16,T[a.FLOAT]=4,T[a.FLOAT2]=8,T[a.FLOAT3]=12,T[a.FLOAT4]=16,T[a.MAT2]=16,T[a.MAT3]=36,T[a.MAT4]=64,T[a.SAMPLER2D]=4,T[a.SAMPLER_CUBE]=4,T);c=((Q={})[a.BOOL]=c.R32I,Q[a.INT]=c.R32I,Q[a.INT2]=c.RG32I,Q[a.INT3]=c.RGB32I,Q[a.INT4]=c.RGBA32I,Q[a.FLOAT]=c.R32F,Q[a.FLOAT2]=c.RG32F,Q[a.FLOAT3]=
c.RGB32F,Q[a.FLOAT4]=c.RGBA32F,Q);Q={BACK:1029,FRONT:1028,NONE:0,ADD:32774,SUB:32778,REV_SUB:32779,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,SRC_ALPHA_SATURATE:776,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,
INCR:7682,INCR_WRAP:34055,DECR:7683,DECR_WRAP:34056,INVERT:5386};Object.assign(Q,H);n.exports={murmurhash2_32_gc:function(a,c){var b=a.length;c^=b;for(var d=0;4<=b;){var e=1540483477*(65535&(e=255&a.charCodeAt(d)|(255&a.charCodeAt(++d))<<8|(255&a.charCodeAt(++d))<<16|(255&a.charCodeAt(++d))<<24))+((1540483477*(e>>>16)&65535)<<16);c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(e=1540483477*(65535&(e^=e>>>24))+((1540483477*(e>>>16)&65535)<<16));b-=4;++d}switch(b){case 3:c^=(255&a.charCodeAt(d+
2))<<16;case 2:c^=(255&a.charCodeAt(d+1))<<8;case 1:c=1540483477*(65535&(c^=255&a.charCodeAt(d)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^c>>>15)>>>0},SamplerInfoIndex:Y,effectStructure:{$techniques:[{$passes:[{depthStencilState:{},rasterizerState:{},blendState:{targets:[{}]},properties:{any:{sampler:{},inspector:{}}}}]}]},typeMap:f,sizeMap:m,formatMap:c,passParams:Q,RenderQueue:{OPAQUE:0,TRANSPARENT:1,OVERLAY:2},RenderPriority:S,
GFXGetTypeSize:function(c){switch(c){case a.BOOL:case a.INT:case a.UINT:case a.FLOAT:return 4;case a.BOOL2:case a.INT2:case a.UINT2:case a.FLOAT2:return 8;case a.BOOL3:case a.INT3:case a.UINT3:case a.FLOAT3:return 12;case a.BOOL4:case a.INT4:case a.UINT4:case a.FLOAT4:case a.MAT2:return 16;case a.MAT2X3:return 24;case a.MAT2X4:return 32;case a.MAT3X2:return 24;case a.MAT3:return 36;case a.MAT3X4:return 48;case a.MAT4X2:case a.MAT4X2:return 32;case a.MAT4:return 64;case a.SAMPLER1D:case a.SAMPLER1D_ARRAY:case a.SAMPLER2D:case a.SAMPLER2D_ARRAY:case a.SAMPLER3D:case a.SAMPLER_CUBE:return 4;
default:return 0}},UniformBinding:W}},{}],267:[function(f,n,m){m.__esModule=!0;var h=0,e={};m.default={addStage:function(d){void 0===e[d]&&(e[d]=1<<h,h+=1)},stageID:function(d){d=e[d];return void 0===d?-1:d},stageIDs:function(d){for(var b=0,a=0;a<d.length;++a){var c=e[d[a]];void 0!==c&&(b|=c)}return b}};n.exports=m.default},{}],268:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}var e,d;m.__esModule=!0;m.default=void 0;var b=f("../memop"),a=h(f("../enums")),c=f("../../core/vmath"),
g=h(f("./program-lib")),k=h(f("./view")),l=h(f("../gfx"));c.mat3.create();var q=c.mat4.create(),r=new b.RecyclePool(function(){return{stage:null,items:null}},8),t=new b.RecyclePool(function(){return new Float32Array(2)},8),p=new b.RecyclePool(function(){return new Float32Array(3)},8),v=new b.RecyclePool(function(){return new Float32Array(4)},8),w=new b.RecyclePool(function(){return new Float32Array(9)},8),E=new b.RecyclePool(function(){return new Float32Array(16)},8),x=new b.RecyclePool(function(){return new Float32Array(64)},
8),y=new b.RecyclePool(function(){return new Int32Array(2)},8),u=new b.RecyclePool(function(){return new Int32Array(3)},8),B=new b.RecyclePool(function(){return new Int32Array(4)},8),C=new b.RecyclePool(function(){return new Int32Array(64)},8);f=((e={})[a.default.PARAM_INT]=function(a){return a},e[a.default.PARAM_INT2]=function(a){return c.vec2.array(y.add(),a)},e[a.default.PARAM_INT3]=function(a){return c.vec3.array(u.add(),a)},e[a.default.PARAM_INT4]=function(a){return c.vec4.array(B.add(),a)},
e[a.default.PARAM_FLOAT]=function(a){return a},e[a.default.PARAM_FLOAT2]=function(a){return c.vec2.array(t.add(),a)},e[a.default.PARAM_FLOAT3]=function(a){return c.vec3.array(p.add(),a)},e[a.default.PARAM_FLOAT4]=function(a){return c.vec4.array(v.add(),a)},e[a.default.PARAM_COLOR3]=function(a){return c.color3.array(p.add(),a)},e[a.default.PARAM_COLOR4]=function(a){return c.color4.array(v.add(),a)},e[a.default.PARAM_MAT2]=function(a){return c.mat2.array(v.add(),a)},e[a.default.PARAM_MAT3]=function(a){return c.mat3.array(w.add(),
a)},e[a.default.PARAM_MAT4]=function(a){return c.mat4.array(E.add(),a)},(d={})[a.default.PARAM_INT]={func:function(a){for(var c=C.add(),b=0;b<a.length;++b)c[b]=a[b];return c},size:1},d[a.default.PARAM_INT2]={func:function(a){for(var c=C.add(),b=0;b<a.length;++b)c[2*b]=a[b].x,c[2*b+1]=a[b].y;return c},size:2},d[a.default.PARAM_INT3]={func:void 0,size:3},d[a.default.PARAM_INT4]={func:function(a){for(var c=C.add(),b=0;b<a.length;++b){var d=a[b];c[4*b]=d.x;c[4*b+1]=d.y;c[4*b+2]=d.z;c[4*b+3]=d.w}return c},
size:4},d[a.default.PARAM_FLOAT]={func:function(a){for(var c=x.add(),b=0;b<a.length;++b)c[b]=a[b];return c},size:1},d[a.default.PARAM_FLOAT2]={func:function(a){for(var c=x.add(),b=0;b<a.length;++b)c[2*b]=a[b].x,c[2*b+1]=a[b].y;return c},size:2},d[a.default.PARAM_FLOAT3]={func:void 0,size:3},d[a.default.PARAM_FLOAT4]={func:function(a){for(var c=x.add(),b=0;b<a.length;++b){var d=a[b];c[4*b]=d.x;c[4*b+1]=d.y;c[4*b+2]=d.z;c[4*b+3]=d.w}return c},size:4},d[a.default.PARAM_COLOR3]={func:void 0,size:3},d[a.default.PARAM_COLOR4]=
{func:function(a){for(var c=x.add(),b=0;b<a.length;++b){var d=a[b];c[4*b]=d.r;c[4*b+1]=d.g;c[4*b+2]=d.b;c[4*b+3]=d.a}return c},size:4},d[a.default.PARAM_MAT2]={func:function(a){for(var c=x.add(),b=0;b<a.length;++b)c.set(a[b].m,4*b);return c},size:4},d[a.default.PARAM_MAT3]={func:void 0,size:9},d[a.default.PARAM_MAT4]={func:function(a){for(var c=x.add(),b=0;b<a.length;++b)c.set(a[b].m,16*b);return c},size:16},function(){function d(e,f){var l;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");
this._device=e;this._programLib=new g.default(e);this._opts=f;this._type2defaultValue=((l={})[a.default.PARAM_INT]=0,l[a.default.PARAM_INT2]=c.vec2.create(0,0),l[a.default.PARAM_INT3]=c.vec3.create(0,0,0),l[a.default.PARAM_INT4]=c.vec4.create(0,0,0,0),l[a.default.PARAM_FLOAT]=0,l[a.default.PARAM_FLOAT2]=c.vec2.create(0,0),l[a.default.PARAM_FLOAT3]=c.vec3.create(0,0,0),l[a.default.PARAM_FLOAT4]=c.vec4.create(0,0,0,0),l[a.default.PARAM_COLOR3]=c.color3.create(0,0,0),l[a.default.PARAM_COLOR4]=c.color4.create(0,
0,0,1),l[a.default.PARAM_MAT2]=c.mat2.create(),l[a.default.PARAM_MAT3]=c.mat3.create(),l[a.default.PARAM_MAT4]=c.mat4.create(),l[a.default.PARAM_TEXTURE_2D]=f.defaultTexture,l[a.default.PARAM_TEXTURE_CUBE]=f.defaultTextureCube,l);this._stage2fn={};this._usedTextureUnits=0;this._viewPools=new b.RecyclePool(function(){return new k.default},8);this._drawItemsPools=new b.RecyclePool(function(){return{model:null,node:null,ia:null,effect:null,defines:null,uniforms:null}},100);this._stageItemsPools=new b.RecyclePool(function(){return new b.RecyclePool(function(){return{model:null,
node:null,ia:null,effect:null,defines:null,technique:null,sortKey:-1,uniforms:null}},100)},16)}return d.prototype._resetTextuerUnit=function(){this._usedTextureUnits=0},d.prototype._allocTextureUnit=function(){var a=this._device,c=this._usedTextureUnits;return c>=a._caps.maxTextureUnits&&console.warn("Trying to use "+c+" texture units while this GPU supports only "+a._caps.maxTextureUnits),this._usedTextureUnits+=1,c},d.prototype._registerStage=function(a,c){this._stage2fn[a]=c},d.prototype.clear=
function(){this._programLib.clear();this.reset()},d.prototype.reset=function(){this._viewPools.reset();this._stageItemsPools.reset()},d.prototype._requestView=function(){return this._viewPools.add()},d.prototype._render=function(c,b){var d=this._device;d.setFrameBuffer(c._framebuffer);d.setViewport(c._rect.x,c._rect.y,c._rect.w,c._rect.h);var e={};c._clearFlags&a.default.CLEAR_COLOR&&(e.color=[c._color.r,c._color.g,c._color.b,c._color.a]);c._clearFlags&a.default.CLEAR_DEPTH&&(e.depth=c._depth);c._clearFlags&
a.default.CLEAR_STENCIL&&(e.stencil=c._stencil);d.clear(e);this._drawItemsPools.reset();for(d=0;d<b._models.length;++d)if(e=b._models.data[d],0!=(e._cullingMask&c._cullingMask)){var f=this._drawItemsPools.add();e.extractDrawItem(f)}r.reset();for(b=0;b<c._stages.length;++b){d=c._stages[b];e=this._stageItemsPools.add();e.reset();for(f=0;f<this._drawItemsPools.length;++f){var g=this._drawItemsPools.data[f],k=g.effect.getTechnique(d);if(k){var l=e.add();l.model=g.model;l.node=g.node;l.ia=g.ia;l.effect=
g.effect;l.defines=g.defines;l.technique=k;l.sortKey=-1;l.uniforms=g.uniforms}}f=r.add();f.stage=d;f.items=e}for(b=0;b<r.length;++b)d=r.data[b],(0,this._stage2fn[d.stage])(c,d.items)},d.prototype._setProperty=function(c){var b=this._device,d=c.value;if(void 0===d&&(d=c.val),void 0===d&&(d=this._type2defaultValue[c.type]),void 0!==d)if(c.type===a.default.PARAM_TEXTURE_2D||c.type===a.default.PARAM_TEXTURE_CUBE)if(Array.isArray(d)){if(d.length>c.count)return void console.error("Failed to set property ["+
c.name+"] : The length of texture array ["+d.length+"] is bigger than ["+c.count+"].");for(var e=C.add(),f=0;f<d.length;++f)e[f]=this._allocTextureUnit();b.setTextureArray(c.name,d,e)}else b.setTexture(c.name,d,this._allocTextureUnit());else c.directly?b.setUniformDirectly(c.name,d):b.setUniform(c.name,d);else console.warn("Failed to set technique property "+c.name+", value not found.")},d.prototype._draw=function(a){var b=this._device,d=this._programLib,e=a.node,f=a.ia,g=a.uniforms,k=a.technique,
h=a.defines;a=a.effect;t.reset();p.reset();v.reset();w.reset();E.reset();x.reset();y.reset();u.reset();B.reset();C.reset();e.getWorldMatrix(q);b.setUniform("cc_matWorld",c.mat4.array(E.add(),q));c.mat4.invert(q,q);c.mat4.transpose(q,q);b.setUniform("cc_matWorldIT",c.mat4.array(E.add(),q));for(e=0;e<g.length;e++){var r=g[e];for(m in r)this._setProperty(r[m])}for(g=0;g<k._passes.length;++g){var m=k._passes[g];e=f.count;f._vertexBuffer&&b.setVertexBuffer(0,f._vertexBuffer);f._indexBuffer&&b.setIndexBuffer(f._indexBuffer);
b.setPrimitiveType(f._primitiveType);r=d.getProgram(m._programName,h,a._name);b.setProgram(r);b.setCullMode(m._cullMode);m._blend&&(b.enableBlend(),b.setBlendFuncSep(m._blendSrc,m._blendDst,m._blendSrcAlpha,m._blendDstAlpha),b.setBlendEqSep(m._blendEq,m._blendAlphaEq),b.setBlendColor32(m._blendColor));m._depthTest&&(b.enableDepthTest(),b.setDepthFunc(m._depthFunc));m._depthWrite&&b.enableDepthWrite();b.setStencilTest(m._stencilTest);m._stencilTest===l.default.STENCIL_ENABLE&&(b.setStencilFuncFront(m._stencilFuncFront,
m._stencilRefFront,m._stencilMaskFront),b.setStencilOpFront(m._stencilFailOpFront,m._stencilZFailOpFront,m._stencilZPassOpFront,m._stencilWriteMaskFront),b.setStencilFuncBack(m._stencilFuncBack,m._stencilRefBack,m._stencilMaskBack),b.setStencilOpBack(m._stencilFailOpBack,m._stencilZFailOpBack,m._stencilZPassOpBack,m._stencilWriteMaskBack));b.draw(f._start,e);this._resetTextuerUnit()}},d}());m.default=f;n.exports=m.default},{"../../core/vmath":246,"../enums":275,"../gfx":280,"../memop":292,"./program-lib":272,
"./view":274}],269:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,c){var b={},d={};a.techniques.forEach(function(a){a.passes.forEach(function(a){Object.assign(d,a.properties)})});var e=function(e){for(var f=d[e],k=void 0,l=0;l<c.length&&!(k=c[l].uniforms.find(function(a){return a.name===e}));l++);if(!k)return cc.warn(a.name+" : illegal property: "+e+", myabe defined a not used property"),"continue";b[e]=Object.assign({},f);b[e].value=f.type===g.default.PARAM_TEXTURE_2D?
null:new Float32Array(f.value)},f;for(f in d)e(f);return b}m.__esModule=!0;var d=h(f("../config")),b=h(f("../core/pass")),a=h(f("../core/technique")),c=f("../types"),g=h(f("../enums"));h(f("../gfx"));var k=function(){function a(c,b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},f=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[];if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._name=
c;this._techniques=b;this._properties=d;this._defines=e;this._dependencies=f}return a.prototype.clear=function(){this._techniques.length=0;this._properties={};this._defines={}},a.prototype.setCullMode=function(a){for(var c=this._techniques[0].passes,b=0;b<c.length;b++)c[b].setCullMode(a)},a.prototype.setDepth=function(a,c,b){for(var d=this._techniques[0].passes,e=0;e<d.length;e++)d[e].setDepth(a,c,b)},a.prototype.setBlend=function(a,c,b,d,e,f,g,k){for(var l=this._techniques[0].passes,p=0;p<l.length;p++)l[p].setBlend(a,
c,b,d,e,f,g,k)},a.prototype.setStencilEnabled=function(a){for(var c=this._techniques[0].passes,b=0;b<c.length;b++)c[b].setStencilEnabled(a)},a.prototype.setStencil=function(a,c,b,d,e,f,g,k){for(var l=this._techniques[0].passes,p=0;p<l.length;++p){var h=l[p];h.setStencilFront(a,c,b,d,e,f,g,k);h.setStencilBack(a,c,b,d,e,f,g,k)}},a.prototype.getTechnique=function(a){a=d.default.stageID(a);if(-1===a)return null;for(var c=0;c<this._techniques.length;++c){var b=this._techniques[c];if(b.stageIDs&a)return b}return null},
a.prototype.getProperty=function(a){return this._properties[a]?this._properties[a].value:(cc.warn(this._name+" : Failed to get property "+a+", property not found."),null)},a.prototype.setProperty=function(a,c){var b=this._properties[a];if(b)if(Array.isArray(c)){b=b.value;if(b.length!==c.length)return void cc.warn(this._name+" : Failed to set property "+a+", property length not correct.");for(a=0;a<c.length;a++)b[a]=c[a]}else b.type===g.default.PARAM_TEXTURE_2D?b.value=c?c.getImpl():null:c.array?c.array(b.value):
(c&&"object"==typeof c&&cc.warn("Set effect property "+this._name+" warning : should transform object to ArrayBuffer"),b.value=c);else cc.warn(this._name+" : Failed to set property "+a+", property not found.")},a.prototype.updateHash=function(a){},a.prototype.getDefine=function(a){var c=this._defines[a];return void 0===c&&cc.warn(this._name+" : Failed to get define "+a+", define not found."),c},a.prototype.define=function(a,c){void 0!==this._defines[a]?this._defines[a]=c:cc.warn(this._name+" : Failed to set define "+
a+", define not found.")},a.prototype.extractProperties=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(a,this._properties),a},a.prototype.extractDefines=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(a,this._defines),a},a.prototype.extractDependencies=function(){for(var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=0;c<this._dependencies.length;++c){var b=this._dependencies[c];a[b.define]=
b.extension}return a},a.prototype.clone=function(){var a=this.extractDefines({}),c=this.extractDependencies({}),b={},d=this._properties,e;for(e in d){var f=d[e],g=b[e]={},k=f.value,l;for(l in Array.isArray(k)?g.value=k.concat():ArrayBuffer.isView(k)?g.value=new k.__proto__.constructor(k):g.value=k,f)"value"!==l&&(g[l]=f[l])}d=[];for(e=0;e<this._techniques.length;e++)d.push(this._techniques[e].clone());return new cc.Effect(this._name,d,b,a,c)},a}(),l=function(a){var c=[],b=cc.renderer._forward._programLib;
return a.techniques.forEach(function(a){a.passes.forEach(function(a){c.push(b.getTemplate(a.program))})}),c};k.parseTechniques=function(c){for(var d=c.techniques.length,e=Array(d),f=0;f<d;++f){var g=c.techniques[f];g.stages||(g.stages=["opaque"]);for(var k=g.passes.length,l=Array(k),h=0;h<k;++h){var q=g.passes[h];l[h]=new b.default(q.program);q.rasterizerState&&l[h].setCullMode(q.rasterizerState.cullMode);var m=q.blendState&&q.blendState.targets[0];m&&l[h].setBlend(m.blend,m.blendEq,m.blendSrc,m.blendDst,
m.blendAlphaEq,m.blendSrcAlpha,m.blendDstAlpha,m.blendColor);(q=q.depthStencilState)&&(l[h].setDepth(q.depthTest,q.depthWrite,q.depthFunc),l[h].setStencilFront(q.stencilTest,q.stencilFuncFront,q.stencilRefFront,q.stencilMaskFront,q.stencilFailOpFront,q.stencilZFailOpFront,q.stencilZPassOpFront,q.stencilWriteMaskFront),l[h].setStencilBack(q.stencilTest,q.stencilFuncBack,q.stencilRefBack,q.stencilMaskBack,q.stencilFailOpBack,q.stencilZFailOpBack,q.stencilZPassOpBack,q.stencilWriteMaskBack))}e[f]=new a.default(g.stages,
l,g.layer)}return e};k.parseEffect=function(a){var b=k.parseTechniques(a),d=l(a),f=e(a,d),g={},h={};d.forEach(function(a){a.uniforms.forEach(function(a){var b=a.name,d=g[b]=Object.assign({},a);f[b]?d.value=f[b].value:d.value=c.enums2default[a.type]});a.defines.forEach(function(a){h[a.name]=c.enums2default[a.type]})});d=d.reduce(function(a,c){return a.concat(c.extensions)},[]);return d=d.map(function(a){return Object.assign({},a)}),new cc.Effect(a.name,b,g,h,d,a)};cc.Effect=k;m.default=k;n.exports=
m.default},{"../config":267,"../core/pass":271,"../core/technique":273,"../enums":275,"../gfx":280,"../types":303}],270:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=function(){function d(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,a,c){return a&&d(b.prototype,a),c&&d(b,c),b}}(),e=function(d){return d&&d.__esModule?d:{default:d}}(f("../gfx"));f=function(){function d(b,
a){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e.default.PT_TRIANGLES;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._vertexBuffer=b;this._indexBuffer=a;this._primitiveType=c;this._start=0;this._count=-1}return h(d,[{key:"count",get:function(){return-1!==this._count?this._count:this._indexBuffer?this._indexBuffer.count:this._vertexBuffer?this._vertexBuffer.count:0}}]),d}();m.default=f;n.exports=m.default},{"../gfx":280}],271:[function(f,n,m){m.__esModule=
!0;m.default=void 0;var h=function(e){return e&&e.__esModule?e:{default:e}}(f("../gfx"));f=function(){function e(d){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._programName=d;this._cullMode=h.default.CULL_BACK;this._blend=!1;this._blendAlphaEq=this._blendEq=h.default.BLEND_FUNC_ADD;this._blendSrc=h.default.BLEND_SRC_ALPHA;this._blendDst=h.default.BLEND_ONE_MINUS_SRC_ALPHA;this._blendSrcAlpha=h.default.BLEND_SRC_ALPHA;this._blendDstAlpha=h.default.BLEND_ONE_MINUS_SRC_ALPHA;
this._blendColor=4294967295;this._depthWrite=this._depthTest=!1;this._depthFunc=h.default.DS_FUNC_LESS;this._stencilTest=h.default.STENCIL_INHERIT;this._stencilFuncFront=h.default.DS_FUNC_ALWAYS;this._stencilRefFront=0;this._stencilMaskFront=255;this._stencilZPassOpFront=this._stencilZFailOpFront=this._stencilFailOpFront=h.default.STENCIL_OP_KEEP;this._stencilWriteMaskFront=255;this._stencilFuncBack=h.default.DS_FUNC_ALWAYS;this._stencilRefBack=0;this._stencilMaskBack=255;this._stencilZPassOpBack=
this._stencilZFailOpBack=this._stencilFailOpBack=h.default.STENCIL_OP_KEEP;this._stencilWriteMaskBack=255}return e.prototype.setCullMode=function(){this._cullMode=0<arguments.length&&void 0!==arguments[0]?arguments[0]:h.default.CULL_BACK},e.prototype.setBlend=function(){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h.default.BLEND_FUNC_ADD,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:h.default.BLEND_SRC_ALPHA,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:h.default.BLEND_ONE_MINUS_SRC_ALPHA,
c=4<arguments.length&&void 0!==arguments[4]?arguments[4]:h.default.BLEND_FUNC_ADD,e=5<arguments.length&&void 0!==arguments[5]?arguments[5]:h.default.BLEND_SRC_ALPHA,f=6<arguments.length&&void 0!==arguments[6]?arguments[6]:h.default.BLEND_ONE_MINUS_SRC_ALPHA,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:4294967295;this._blend=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._blendEq=d;this._blendSrc=b;this._blendDst=a;this._blendAlphaEq=c;this._blendSrcAlpha=e;this._blendDstAlpha=
f;this._blendColor=l},e.prototype.setDepth=function(){var d=1<arguments.length&&void 0!==arguments[1]&&arguments[1],b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:h.default.DS_FUNC_LESS;this._depthTest=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._depthWrite=d;this._depthFunc=b},e.prototype.setStencilFront=function(){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h.default.DS_FUNC_ALWAYS,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&
void 0!==arguments[3]?arguments[3]:255,c=4<arguments.length&&void 0!==arguments[4]?arguments[4]:h.default.STENCIL_OP_KEEP,e=5<arguments.length&&void 0!==arguments[5]?arguments[5]:h.default.STENCIL_OP_KEEP,f=6<arguments.length&&void 0!==arguments[6]?arguments[6]:h.default.STENCIL_OP_KEEP,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:255;this._stencilTest=0<arguments.length&&void 0!==arguments[0]?arguments[0]:h.default.STENCIL_INHERIT;this._stencilFuncFront=d;this._stencilRefFront=b;this._stencilMaskFront=
a;this._stencilFailOpFront=c;this._stencilZFailOpFront=e;this._stencilZPassOpFront=f;this._stencilWriteMaskFront=l},e.prototype.setStencilEnabled=function(){this._stencilTest=0<arguments.length&&void 0!==arguments[0]?arguments[0]:h.default.STENCIL_INHERIT},e.prototype.setStencilBack=function(){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h.default.DS_FUNC_ALWAYS,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:255,
c=4<arguments.length&&void 0!==arguments[4]?arguments[4]:h.default.STENCIL_OP_KEEP,e=5<arguments.length&&void 0!==arguments[5]?arguments[5]:h.default.STENCIL_OP_KEEP,f=6<arguments.length&&void 0!==arguments[6]?arguments[6]:h.default.STENCIL_OP_KEEP,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:255;this._stencilTest=0<arguments.length&&void 0!==arguments[0]?arguments[0]:h.default.STENCIL_INHERIT;this._stencilFuncBack=d;this._stencilRefBack=b;this._stencilMaskBack=a;this._stencilFailOpBack=
c;this._stencilZFailOpBack=e;this._stencilZPassOpBack=f;this._stencilWriteMaskBack=l},e.prototype.clone=function(){var d=new e(this._programName);return Object.assign(d,this),d},e}();m.default=f;n.exports=m.default},{"../gfx":280}],272:[function(f,n,m){function h(a){for(var c=[],b={},d=a.length-1;0<=d;d--){var e=a[d],f;for(f in e){var h=e[f];void 0!==h&&void 0===b[f]&&("number"!=typeof h&&(h=h?1:0),b[f]=h,c.push("#define "+f+" "+h))}}return c.join("\n")+"\n"}function e(a,b){for(var c={},d=b.length-
1;0<=d;d--){var e=b[d],f;for(f in e){var g=e[f];void 0!==g&&void 0===c[f]&&Number.isInteger(g)&&(c[f]=g)}}for(var p in c)a=a.replace(new RegExp(p,"g"),c[p]);return a}function d(a){return a.replace(/#pragma for (\w+) in range\(\s*(\d+)\s*,\s*(\d+)\s*\)([\s\S]+?)#pragma endFor/g,function(a,c,b,d,e){a="";b=parseInt(b);d=parseInt(d);for((b.isNaN||d.isNaN)&&console.error("Unroll For Loops Error: begin and end of range must be an int num.");b<d;++b)a+=e.replace(new RegExp("{"+c+"}","g"),b);return a})}m.__esModule=
!0;m.default=void 0;var b=function(a){return a&&a.__esModule?a:{default:a}}(f("../gfx")),a=0;f=function(){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._device=a;this._templates={};this._cache={};this._checkPrecision()}return c.prototype.clear=function(){this._templates={};this._cache={}},c.prototype.define=function(c){var b=c.name,d=c.defines,e=c.glsl1||c,f=e.vert;e=e.frag;if(!this._templates[b]){for(var g=++a,p=0,h=0;h<d.length;++h){var m=d[h],
n=1;"number"===m.type?(n=m.range||[],m.min=n[0]||0,m.max=n[1]||4,n=Math.ceil(Math.log2(m.max-m.min)),m._map=function(a){return a-this.min<<this._offset}.bind(m)):m._map=function(a){return a?1<<this._offset:0}.bind(m);p+=n;m._offset=p}p=c.uniforms||[];if(c.samplers)for(h=0;h<c.samplers.length;h++)p.push(c.samplers[h]);if(c.blocks)for(h=0;h<c.blocks.length;h++){m=c.blocks[h].defines;n=c.blocks[h].members;for(var x=0;x<n.length;x++)p.push({defines:m,name:n[x].name,type:n[x].type})}this._templates[b]=
{id:g,name:b,vert:f,frag:e,defines:d,attributes:c.attributes,uniforms:p,extensions:c.extensions}}},c.prototype.getTemplate=function(a){return this._templates[a]},c.prototype.hasProgram=function(a){return void 0!==this._templates[a]},c.prototype.getKey=function(a,c){a=this._templates[a];for(var b=0,d=0;d<a.defines.length;++d){var e=a.defines[d],f=this._getValueFromDefineList(e.name,c);void 0!==f&&(b|=e._map(f))}return a.id+":"+b},c.prototype.getProgram=function(a,c,f){var g=this.getKey(a,c),k=this._cache[g];
if(k)return k;var l=this._templates[a];k=h(c);a=e(l.vert,c);a=k+d(a);this._highpSupported||(a=a.replace(/\bhighp\b/g,"mediump"));l=e(l.frag,c);l=k+d(l);this._highpSupported||(l=l.replace(/\bhighp\b/g,"mediump"));var p=(k=new b.default.Program(this._device,{vert:a,frag:l})).link();if(p){var v=a.split("\n"),m=l.split("\n"),n=Object.keys(c).length;p.forEach(function(a){var c=a.line-n,b=("vs"===a.type?v:m)[a.line-1];cc.error(f+" : "+(a.info||"Failed to compile "+a.type+" "+a.fileID+" (ln "+c+"): \n "+
a.message+": \n  "+b))})}return this._cache[g]=k,k},c.prototype._getValueFromDefineList=function(a,c){for(var b,d=c.length-1;0<=d;d--)if(void 0!==(b=c[d][a]))return b},c.prototype._checkPrecision=function(){var a=this._device._gl,c=!1;a.getShaderPrecisionFormat&&(c=a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT),a=a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT),c=c&&0<c.precision&&a&&0<a.precision);c||cc.warnID(9102);this._highpSupported=c},c}();m.default=f;n.exports=m.default},
{"../gfx":280}],273:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=function(){function b(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(a,c,d){return c&&b(a.prototype,c),d&&b(a,d),a}}(),e=function(b){return b&&b.__esModule?b:{default:b}}(f("../config")),d=0;f=function(){function b(a,c){var f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");this._id=d++;this._stages=a;this._stageIDs=e.default.stageIDs(a);this._passes=c;this._layer=f}return b.prototype.setStages=function(a){this._stageIDs=e.default.stageIDs(a)},b.prototype.clone=function(){for(var a=[],c=0;c<this._passes.length;c++)a.push(this._passes[c].clone());return new b(this._stages,a,this._layer)},h(b,[{key:"passes",get:function(){return this._passes}},{key:"stageIDs",get:function(){return this._stageIDs}}]),b}();m.default=
f;n.exports=m.default},{"../config":267}],274:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=f("../../core/vmath"),e=function(a){return a&&a.__esModule?a:{default:a}}(f("../enums")),d=h.mat4.create(),b=0;f=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._id=b++;this._priority=0;this._rect={x:0,y:0,w:1,h:1};this._color=h.color4.create(.3,.3,.3,1);this._depth=1;this._stencil=0;this._clearFlags=e.default.CLEAR_COLOR|e.default.CLEAR_DEPTH;
this._clearModel=null;this._matView=h.mat4.create();this._matProj=h.mat4.create();this._matViewProj=h.mat4.create();this._matInvViewProj=h.mat4.create();this._stages=[];this._cullingByID=!1;this._shadowLight=this._framebuffer=null;this._cullingMask=4294967295}return a.prototype.getForward=function(a){var c=this._matView.m;return h.vec3.set(a,-c[2],-c[6],-c[10])},a.prototype.getPosition=function(a){return h.mat4.invert(d,this._matView),h.mat4.getTranslation(a,d)},a}();m.default=f;n.exports=m.default},
{"../../core/vmath":246,"../enums":275}],275:[function(f,n,m){m.__esModule=!0;f=f("./build/mappings");m.default={PROJ_PERSPECTIVE:0,PROJ_ORTHO:1,LIGHT_DIRECTIONAL:0,LIGHT_POINT:1,LIGHT_SPOT:2,LIGHT_AMBIENT:3,SHADOW_NONE:0,SHADOW_HARD:1,SHADOW_SOFT:2,PARAM_INT:f.typeMap.int,PARAM_INT2:f.typeMap.ivec2,PARAM_INT3:f.typeMap.ivec3,PARAM_INT4:f.typeMap.ivec4,PARAM_FLOAT:f.typeMap.float,PARAM_FLOAT2:f.typeMap.vec2,PARAM_FLOAT3:f.typeMap.vec3,PARAM_FLOAT4:f.typeMap.vec4,PARAM_MAT2:f.typeMap.mat2,PARAM_MAT3:f.typeMap.mat3,
PARAM_MAT4:f.typeMap.mat4,PARAM_TEXTURE_2D:f.typeMap.sampler2D,PARAM_TEXTURE_CUBE:f.typeMap.samplerCube,CLEAR_COLOR:1,CLEAR_DEPTH:2,CLEAR_STENCIL:4,CLEAR_SKYBOX:8,BUFFER_VIEW_INT8:0,BUFFER_VIEW_UINT8:1,BUFFER_VIEW_INT16:2,BUFFER_VIEW_UINT16:3,BUFFER_VIEW_INT32:4,BUFFER_VIEW_UINT32:5,BUFFER_VIEW_FLOAT32:6};n.exports=m.default},{"./build/mappings":266}],276:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,c,b){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:
0;b instanceof k.default?a.framebufferTexture2D(a.FRAMEBUFFER,c,a.TEXTURE_2D,b._glID,0):b instanceof l.default?a.framebufferTexture2D(a.FRAMEBUFFER,c,a.TEXTURE_CUBE_MAP_POSITIVE_X+d,b._glID,0):a.framebufferRenderbuffer(a.FRAMEBUFFER,c,a.RENDERBUFFER,b._glID)}m.__esModule=!0;m.default=void 0;var d,b,a=function(){function a(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(c,b,d){return b&&
a(c.prototype,b),d&&a(c,d),c}}(),c=h(f("./state")),g=f("./enums"),k=h(f("./texture-2d")),l=h(f("./texture-cube")),q=((d={})[5124]=function(a,c,b){a.uniform1i(c,b)},d[5126]=function(a,c,b){a.uniform1f(c,b)},d[35664]=function(a,c,b){a.uniform2fv(c,b)},d[35665]=function(a,c,b){a.uniform3fv(c,b)},d[35666]=function(a,c,b){a.uniform4fv(c,b)},d[35667]=function(a,c,b){a.uniform2iv(c,b)},d[35668]=function(a,c,b){a.uniform3iv(c,b)},d[35669]=function(a,c,b){a.uniform4iv(c,b)},d[35670]=function(a,c,b){a.uniform1i(c,
b)},d[35671]=function(a,c,b){a.uniform2iv(c,b)},d[35672]=function(a,c,b){a.uniform3iv(c,b)},d[35673]=function(a,c,b){a.uniform4iv(c,b)},d[35674]=function(a,c,b){a.uniformMatrix2fv(c,!1,b)},d[35675]=function(a,c,b){a.uniformMatrix3fv(c,!1,b)},d[35676]=function(a,c,b){a.uniformMatrix4fv(c,!1,b)},d[35678]=function(a,c,b){a.uniform1i(c,b)},d[35680]=function(a,c,b){a.uniform1i(c,b)},d),r=((b={})[5124]=function(a,c,b){a.uniform1iv(c,b)},b[5126]=function(a,c,b){a.uniform1fv(c,b)},b[35664]=function(a,c,b){a.uniform2fv(c,
b)},b[35665]=function(a,c,b){a.uniform3fv(c,b)},b[35666]=function(a,c,b){a.uniform4fv(c,b)},b[35667]=function(a,c,b){a.uniform2iv(c,b)},b[35668]=function(a,c,b){a.uniform3iv(c,b)},b[35669]=function(a,c,b){a.uniform4iv(c,b)},b[35670]=function(a,c,b){a.uniform1iv(c,b)},b[35671]=function(a,c,b){a.uniform2iv(c,b)},b[35672]=function(a,c,b){a.uniform3iv(c,b)},b[35673]=function(a,c,b){a.uniform4iv(c,b)},b[35674]=function(a,c,b){a.uniformMatrix2fv(c,!1,b)},b[35675]=function(a,c,b){a.uniformMatrix3fv(c,!1,
b)},b[35676]=function(a,c,b){a.uniformMatrix4fv(c,!1,b)},b[35678]=function(a,c,b){a.uniform1iv(c,b)},b[35680]=function(a,c,b){a.uniform1iv(c,b)},b);f=function(){function b(a,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var e=void 0;void 0===(d=d||{}).alpha&&(d.alpha=!1);void 0===d.stencil&&(d.stencil=!0);void 0===d.depth&&(d.depth=!0);void 0===d.antialias&&(d.antialias=!1);void 0===d.preserveDrawingBuffer&&(d.preserveDrawingBuffer=!1);try{e=a.getContext("webgl",
d)||a.getContext("experimental-webgl",d)||a.getContext("webkit-3d",d)||a.getContext("moz-webgl",d)}catch(E){return void console.error(E)}e||console.error("This device does not support webgl");this._gl=e;this._extensions={};this._caps={};this._stats={texture:0,vb:0,ib:0,drawcalls:0};this._initExtensions("EXT_texture_filter_anisotropic EXT_shader_texture_lod OES_standard_derivatives OES_texture_float OES_texture_float_linear OES_texture_half_float OES_texture_half_float_linear OES_vertex_array_object WEBGL_compressed_texture_atc WEBGL_compressed_texture_etc WEBGL_compressed_texture_etc1 WEBGL_compressed_texture_pvrtc WEBGL_compressed_texture_s3tc WEBGL_depth_texture WEBGL_draw_buffers".split(" "));
this._initCaps();this._initStates();c.default.initDefault(this);this._current=new c.default(this);this._next=new c.default(this);this._uniforms={};this._sx=this._sy=this._sw=this._sh=this._vx=this._vy=this._vw=this._vh=0;this._framebuffer=null;this._enabledAttributes=Array(this._caps.maxVertexAttribs);this._newAttributes=Array(this._caps.maxVertexAttribs);for(a=0;a<this._caps.maxVertexAttribs;++a)this._enabledAttributes[a]=0,this._newAttributes[a]=0}return a(b,[{key:"caps",get:function(){return this._caps}}]),
b.prototype._initExtensions=function(a){for(var c=this._gl,b=0;b<a.length;++b)for(var d=a[b],e=["","WEBKIT_","MOZ_"],f=0;f<e.length;f++)try{var g=c.getExtension(e[f]+d);if(g){this._extensions[d]=g;break}}catch(B){console.error(B)}},b.prototype._initCaps=function(){var a=this._gl,c=this.ext("WEBGL_draw_buffers");this._caps.maxVertexStreams=4;this._caps.maxVertexTextures=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this._caps.maxFragUniforms=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS);this._caps.maxTextureUnits=
a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);this._caps.maxVertexAttribs=a.getParameter(a.MAX_VERTEX_ATTRIBS);this._caps.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this._caps.maxDrawBuffers=c?a.getParameter(c.MAX_DRAW_BUFFERS_WEBGL):1;this._caps.maxColorAttachments=c?a.getParameter(c.MAX_COLOR_ATTACHMENTS_WEBGL):1},b.prototype._initStates=function(){var a=this._gl;a.disable(a.BLEND);a.blendFunc(a.ONE,a.ZERO);a.blendEquation(a.FUNC_ADD);a.blendColor(1,1,1,1);a.colorMask(!0,!0,!0,!0);a.enable(a.CULL_FACE);
a.cullFace(a.BACK);a.disable(a.DEPTH_TEST);a.depthFunc(a.LESS);a.depthMask(!1);a.disable(a.POLYGON_OFFSET_FILL);a.depthRange(0,1);a.disable(a.STENCIL_TEST);a.stencilFunc(a.ALWAYS,0,255);a.stencilMask(255);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.clearDepth(1);a.clearColor(0,0,0,0);a.clearStencil(0);a.disable(a.SCISSOR_TEST)},b.prototype._restoreTexture=function(a){var c=this._gl;(a=this._current.textureUnits[a])&&-1!==a._glID?c.bindTexture(a._target,a._glID):c.bindTexture(c.TEXTURE_2D,null)},b.prototype._restoreIndexBuffer=
function(){var a=this._gl,c=this._current.indexBuffer;c&&-1!==c._glID?a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c._glID):a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null)},b.prototype.ext=function(a){return this._extensions[a]},b.prototype.allowFloatTexture=function(){return null!=this.ext("OES_texture_float")},b.prototype.setFrameBuffer=function(a){if(this._framebuffer!==a){this._framebuffer=a;var c=this._gl;if(null!==a){c.bindFramebuffer(c.FRAMEBUFFER,a._glID);for(var b=a._colors.length,d=0;d<b;++d)e(c,c.COLOR_ATTACHMENT0+
d,a._colors[d]);for(;b<this._caps.maxColorAttachments;++b)c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+b,c.TEXTURE_2D,null,0);a._depth&&e(c,c.DEPTH_ATTACHMENT,a._depth);a._stencil&&e(c,c.STENCIL_ATTACHMENT,a._stencil);a._depthStencil&&e(c,c.DEPTH_STENCIL_ATTACHMENT,a._depthStencil)}else c.bindFramebuffer(c.FRAMEBUFFER,null)}},b.prototype.setViewport=function(a,c,b,d){this._vx===a&&this._vy===c&&this._vw===b&&this._vh===d||(this._gl.viewport(a,c,b,d),this._vx=a,this._vy=c,this._vw=b,this._vh=
d)},b.prototype.setScissor=function(a,c,b,d){this._sx===a&&this._sy===c&&this._sw===b&&this._sh===d||(this._gl.scissor(a,c,b,d),this._sx=a,this._sy=c,this._sw=b,this._sh=d)},b.prototype.clear=function(a){if(void 0!==a.color||void 0!==a.depth||void 0!==a.stencil){var c=this._gl,b=0;void 0!==a.color&&(b|=c.COLOR_BUFFER_BIT,c.clearColor(a.color[0],a.color[1],a.color[2],a.color[3]));void 0!==a.depth&&(b|=c.DEPTH_BUFFER_BIT,c.clearDepth(a.depth),c.enable(c.DEPTH_TEST),c.depthMask(!0),c.depthFunc(c.ALWAYS));
void 0!==a.stencil&&(b|=c.STENCIL_BUFFER_BIT,c.clearStencil(a.stencil));c.clear(b);void 0!==a.depth&&(!1===this._current.depthTest?c.disable(c.DEPTH_TEST):(!1===this._current.depthWrite&&c.depthMask(!1),this._current.depthFunc!==g.enums.DS_FUNC_ALWAYS&&c.depthFunc(this._current.depthFunc)))}},b.prototype.enableBlend=function(){this._next.blend=!0},b.prototype.enableDepthTest=function(){this._next.depthTest=!0},b.prototype.enableDepthWrite=function(){this._next.depthWrite=!0},b.prototype.setStencilTest=
function(a){this._next.stencilTest=a},b.prototype.setStencilFunc=function(a,c,b){this._next.stencilSep=!1;this._next.stencilFuncFront=this._next.stencilFuncBack=a;this._next.stencilRefFront=this._next.stencilRefBack=c;this._next.stencilMaskFront=this._next.stencilMaskBack=b},b.prototype.setStencilFuncFront=function(a,c,b){this._next.stencilSep=!0;this._next.stencilFuncFront=a;this._next.stencilRefFront=c;this._next.stencilMaskFront=b},b.prototype.setStencilFuncBack=function(a,c,b){this._next.stencilSep=
!0;this._next.stencilFuncBack=a;this._next.stencilRefBack=c;this._next.stencilMaskBack=b},b.prototype.setStencilOp=function(a,c,b,d){this._next.stencilFailOpFront=this._next.stencilFailOpBack=a;this._next.stencilZFailOpFront=this._next.stencilZFailOpBack=c;this._next.stencilZPassOpFront=this._next.stencilZPassOpBack=b;this._next.stencilWriteMaskFront=this._next.stencilWriteMaskBack=d},b.prototype.setStencilOpFront=function(a,c,b,d){this._next.stencilSep=!0;this._next.stencilFailOpFront=a;this._next.stencilZFailOpFront=
c;this._next.stencilZPassOpFront=b;this._next.stencilWriteMaskFront=d},b.prototype.setStencilOpBack=function(a,c,b,d){this._next.stencilSep=!0;this._next.stencilFailOpBack=a;this._next.stencilZFailOpBack=c;this._next.stencilZPassOpBack=b;this._next.stencilWriteMaskBack=d},b.prototype.setDepthFunc=function(a){this._next.depthFunc=a},b.prototype.setBlendColor32=function(a){this._next.blendColor=a},b.prototype.setBlendColor=function(a,c,b,d){this._next.blendColor=(255*a<<24|255*c<<16|255*b<<8|255*d)>>>
0},b.prototype.setBlendFunc=function(a,c){this._next.blendSep=!1;this._next.blendSrc=a;this._next.blendDst=c},b.prototype.setBlendFuncSep=function(a,c,b,d){this._next.blendSep=!0;this._next.blendSrc=a;this._next.blendDst=c;this._next.blendSrcAlpha=b;this._next.blendDstAlpha=d},b.prototype.setBlendEq=function(a){this._next.blendSep=!1;this._next.blendEq=a},b.prototype.setBlendEqSep=function(a,c){this._next.blendSep=!0;this._next.blendEq=a;this._next.blendAlphaEq=c},b.prototype.setCullMode=function(a){this._next.cullMode=
a},b.prototype.setVertexBuffer=function(a,c){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this._next.vertexBuffers[a]=c;this._next.vertexBufferOffsets[a]=b;this._next.maxStream<a&&(this._next.maxStream=a)},b.prototype.setIndexBuffer=function(a){this._next.indexBuffer=a},b.prototype.setProgram=function(a){this._next.program=a},b.prototype.setTexture=function(a,c,b){b>=this._caps.maxTextureUnits?console.warn("Can not set texture "+a+" at stage "+b+", max texture exceed: "+this._caps.maxTextureUnits):
(this._next.textureUnits[b]=c,this.setUniform(a,b),this._next.maxTextureSlot<b&&(this._next.maxTextureSlot=b))},b.prototype.setTextureArray=function(a,c,b){var d=c.length;if(d>=this._caps.maxTextureUnits)console.warn("Can not set "+d+" textures for "+a+", max texture exceed: "+this._caps.maxTextureUnits);else{for(var e=0;e<d;++e)this._next.textureUnits[b[e]]=c[e];this.setUniform(a,b)}},b.prototype.setUniform=function(a,c){var b=this._uniforms[a],d=!1,e=!1,f=!1,g=!1;b&&(f=Array.isArray(c)||c instanceof
Float32Array,g=c instanceof Int32Array,e=f||g,b.isArray===e)&&(b.isArray&&b.value.length!==c.length||(d=!0));if(d){e=b.value;f=!1;if(b.isArray)for(g=0,d=e.length;g<d;g++)e[g]!==c[g]&&(f=!0,e[g]=c[g]);else e!==c&&(f=!0,b.value=c);f&&(b.dirty=!0)}else b=c,f?b=new Float32Array(c):g&&(b=new Int32Array(c)),b={dirty:!0,value:b,isArray:e};this._uniforms[a]=b},b.prototype.setUniformDirectly=function(a,c){var b=this._uniforms[a];b||(this._uniforms[a]=b={});b.dirty=!0;b.value=c},b.prototype.setPrimitiveType=
function(a){this._next.primitiveType=a},b.prototype.resetDrawCalls=function(){this._stats.drawcalls=0},b.prototype.getDrawCalls=function(){return this._stats.drawcalls},b.prototype.draw=function(a,c){var b=this._gl,d=this._current,e=this._next;d.blend!==e.blend?e.blend?(b.enable(b.BLEND),e.blendSrc!==g.enums.BLEND_CONSTANT_COLOR&&e.blendSrc!==g.enums.BLEND_ONE_MINUS_CONSTANT_COLOR&&e.blendDst!==g.enums.BLEND_CONSTANT_COLOR&&e.blendDst!==g.enums.BLEND_ONE_MINUS_CONSTANT_COLOR||b.blendColor((e.blendColor>>
24)/255,(e.blendColor>>16&255)/255,(e.blendColor>>8&255)/255,(255&e.blendColor)/255),e.blendSep?(b.blendFuncSeparate(e.blendSrc,e.blendDst,e.blendSrcAlpha,e.blendDstAlpha),b.blendEquationSeparate(e.blendEq,e.blendAlphaEq)):(b.blendFunc(e.blendSrc,e.blendDst),b.blendEquation(e.blendEq))):b.disable(b.BLEND):!1!==e.blend&&(d.blendColor!==e.blendColor&&b.blendColor((e.blendColor>>24)/255,(e.blendColor>>16&255)/255,(e.blendColor>>8&255)/255,(255&e.blendColor)/255),d.blendSep===e.blendSep?e.blendSep?(d.blendSrc===
e.blendSrc&&d.blendDst===e.blendDst&&d.blendSrcAlpha===e.blendSrcAlpha&&d.blendDstAlpha===e.blendDstAlpha||b.blendFuncSeparate(e.blendSrc,e.blendDst,e.blendSrcAlpha,e.blendDstAlpha),d.blendEq===e.blendEq&&d.blendAlphaEq===e.blendAlphaEq||b.blendEquationSeparate(e.blendEq,e.blendAlphaEq)):(d.blendSrc===e.blendSrc&&d.blendDst===e.blendDst||b.blendFunc(e.blendSrc,e.blendDst),d.blendEq!==e.blendEq&&b.blendEquation(e.blendEq)):e.blendSep?(b.blendFuncSeparate(e.blendSrc,e.blendDst,e.blendSrcAlpha,e.blendDstAlpha),
b.blendEquationSeparate(e.blendEq,e.blendAlphaEq)):(b.blendFunc(e.blendSrc,e.blendDst),b.blendEquation(e.blendEq)));d.depthTest!==e.depthTest?e.depthTest?(b.enable(b.DEPTH_TEST),b.depthFunc(e.depthFunc),b.depthMask(e.depthWrite)):b.disable(b.DEPTH_TEST):(d.depthWrite!==e.depthWrite&&b.depthMask(e.depthWrite),!1!==e.depthTest?d.depthFunc!==e.depthFunc&&b.depthFunc(e.depthFunc):e.depthWrite&&(e.depthTest=!0,e.depthFunc=g.enums.DS_FUNC_ALWAYS,b.enable(b.DEPTH_TEST),b.depthFunc(e.depthFunc)));e.stencilTest!==
g.enums.STENCIL_INHERIT&&(e.stencilTest!==d.stencilTest?e.stencilTest===g.enums.STENCIL_DISABLE?b.disable(b.STENCIL_TEST):(b.enable(b.STENCIL_TEST),e.stencilSep?(b.stencilFuncSeparate(b.FRONT,e.stencilFuncFront,e.stencilRefFront,e.stencilMaskFront),b.stencilMaskSeparate(b.FRONT,e.stencilWriteMaskFront),b.stencilOpSeparate(b.FRONT,e.stencilFailOpFront,e.stencilZFailOpFront,e.stencilZPassOpFront),b.stencilFuncSeparate(b.BACK,e.stencilFuncBack,e.stencilRefBack,e.stencilMaskBack),b.stencilMaskSeparate(b.BACK,
e.stencilWriteMaskBack),b.stencilOpSeparate(b.BACK,e.stencilFailOpBack,e.stencilZFailOpBack,e.stencilZPassOpBack)):(b.stencilFunc(e.stencilFuncFront,e.stencilRefFront,e.stencilMaskFront),b.stencilMask(e.stencilWriteMaskFront),b.stencilOp(e.stencilFailOpFront,e.stencilZFailOpFront,e.stencilZPassOpFront))):e.stencilTest!==g.enums.STENCIL_DISABLE&&(d.stencilSep===e.stencilSep?e.stencilSep?(d.stencilFuncFront===e.stencilFuncFront&&d.stencilRefFront===e.stencilRefFront&&d.stencilMaskFront===e.stencilMaskFront||
b.stencilFuncSeparate(b.FRONT,e.stencilFuncFront,e.stencilRefFront,e.stencilMaskFront),d.stencilWriteMaskFront!==e.stencilWriteMaskFront&&b.stencilMaskSeparate(b.FRONT,e.stencilWriteMaskFront),d.stencilFailOpFront===e.stencilFailOpFront&&d.stencilZFailOpFront===e.stencilZFailOpFront&&d.stencilZPassOpFront===e.stencilZPassOpFront||b.stencilOpSeparate(b.FRONT,e.stencilFailOpFront,e.stencilZFailOpFront,e.stencilZPassOpFront),d.stencilFuncBack===e.stencilFuncBack&&d.stencilRefBack===e.stencilRefBack&&
d.stencilMaskBack===e.stencilMaskBack||b.stencilFuncSeparate(b.BACK,e.stencilFuncBack,e.stencilRefBack,e.stencilMaskBack),d.stencilWriteMaskBack!==e.stencilWriteMaskBack&&b.stencilMaskSeparate(b.BACK,e.stencilWriteMaskBack),d.stencilFailOpBack===e.stencilFailOpBack&&d.stencilZFailOpBack===e.stencilZFailOpBack&&d.stencilZPassOpBack===e.stencilZPassOpBack||b.stencilOpSeparate(b.BACK,e.stencilFailOpBack,e.stencilZFailOpBack,e.stencilZPassOpBack)):(d.stencilFuncFront===e.stencilFuncFront&&d.stencilRefFront===
e.stencilRefFront&&d.stencilMaskFront===e.stencilMaskFront||b.stencilFunc(e.stencilFuncFront,e.stencilRefFront,e.stencilMaskFront),d.stencilWriteMaskFront!==e.stencilWriteMaskFront&&b.stencilMask(e.stencilWriteMaskFront),d.stencilFailOpFront===e.stencilFailOpFront&&d.stencilZFailOpFront===e.stencilZFailOpFront&&d.stencilZPassOpFront===e.stencilZPassOpFront||b.stencilOp(e.stencilFailOpFront,e.stencilZFailOpFront,e.stencilZPassOpFront)):e.stencilSep?(b.stencilFuncSeparate(b.FRONT,e.stencilFuncFront,
e.stencilRefFront,e.stencilMaskFront),b.stencilMaskSeparate(b.FRONT,e.stencilWriteMaskFront),b.stencilOpSeparate(b.FRONT,e.stencilFailOpFront,e.stencilZFailOpFront,e.stencilZPassOpFront),b.stencilFuncSeparate(b.BACK,e.stencilFuncBack,e.stencilRefBack,e.stencilMaskBack),b.stencilMaskSeparate(b.BACK,e.stencilWriteMaskBack),b.stencilOpSeparate(b.BACK,e.stencilFailOpBack,e.stencilZFailOpBack,e.stencilZPassOpBack)):(b.stencilFunc(e.stencilFuncFront,e.stencilRefFront,e.stencilMaskFront),b.stencilMask(e.stencilWriteMaskFront),
b.stencilOp(e.stencilFailOpFront,e.stencilZFailOpFront,e.stencilZPassOpFront))));d.cullMode!==e.cullMode&&(e.cullMode!==g.enums.CULL_NONE?(b.enable(b.CULL_FACE),b.cullFace(e.cullMode)):b.disable(b.CULL_FACE));var f=!1;if(-1!==e.maxStream){if(d.maxStream!==e.maxStream)f=!0;else if(d.program!==e.program)f=!0;else for(var k=0;k<e.maxStream+1;++k)if(d.vertexBuffers[k]!==e.vertexBuffers[k]||d.vertexBufferOffsets[k]!==e.vertexBufferOffsets[k]){f=!0;break}if(f){for(f=0;f<this._caps.maxVertexAttribs;++f)this._newAttributes[f]=
0;for(f=0;f<e.maxStream+1;++f){k=e.vertexBuffers[f];var l=e.vertexBufferOffsets[f];if(k&&-1!==k._glID){b.bindBuffer(b.ARRAY_BUFFER,k._glID);for(var h=0;h<e.program._attributes.length;++h){var p=e.program._attributes[h],m=k._format.element(p.name);m?(0===this._enabledAttributes[p.location]&&(b.enableVertexAttribArray(p.location),this._enabledAttributes[p.location]=1),this._newAttributes[p.location]=1,b.vertexAttribPointer(p.location,m.num,m.type,m.normalize,m.stride,m.offset+l*m.stride)):console.warn("Can not find vertex attribute: "+
p.name)}}}for(f=0;f<this._caps.maxVertexAttribs;++f)this._enabledAttributes[f]!==this._newAttributes[f]&&(b.disableVertexAttribArray(f),this._enabledAttributes[f]=0)}}d.indexBuffer!==e.indexBuffer&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.indexBuffer&&-1!==e.indexBuffer._glID?e.indexBuffer._glID:null);f=!1;d.program!==e.program&&(e.program._linked?b.useProgram(e.program._glID):console.warn("Failed to use program: has not linked yet."),f=!0);for(k=0;k<e.maxTextureSlot+1;++k)d.textureUnits[k]!==e.textureUnits[k]&&
(l=e.textureUnits[k])&&-1!==l._glID&&(b.activeTexture(b.TEXTURE0+k),b.bindTexture(l._target,l._glID));for(k=0;k<e.program._uniforms.length;++k)l=e.program._uniforms[k],(h=this._uniforms[l.name])&&(f||h.dirty)&&(h.dirty=!1,(p=void 0===l.size?q[l.type]:r[l.type])?p(b,l.location,h.value):console.warn("Can not find commit function for uniform "+l.name));c&&(e.indexBuffer?b.drawElements(this._next.primitiveType,c,e.indexBuffer._format,a*e.indexBuffer._bytesPerIndex):b.drawArrays(this._next.primitiveType,
a,c));this._stats.drawcalls++;d.set(e);e.reset()},b}();m.default=f;n.exports=m.default},{"./enums":277,"./state":284,"./texture-2d":285,"./texture-cube":286}],277:[function(f,n,m){m.__esModule=!0;m.attrTypeBytes=function(b){return b===d.ATTR_TYPE_INT8||b===d.ATTR_TYPE_UINT8?1:b===d.ATTR_TYPE_INT16||b===d.ATTR_TYPE_UINT16?2:b===d.ATTR_TYPE_INT32||b===d.ATTR_TYPE_UINT32||b===d.ATTR_TYPE_FLOAT32?4:(console.warn("Unknown ATTR_TYPE: "+b),0)};m.glFilter=function(b,a){var c=2<arguments.length&&void 0!==
arguments[2]?arguments[2]:-1,d=h[a][c+1];return void 0===d?(console.warn("Unknown FILTER: "+a),-1===c?b.LINEAR:b.LINEAR_MIPMAP_LINEAR):d};m.glTextureFmt=function(b){var a=e[b];return void 0===a?(console.warn("Unknown TEXTURE_FMT: "+b),e[d.TEXTURE_FMT_RGBA8]):a};var h=[[9728,9984,9986],[9729,9985,9987]],e=[{format:6407,internalFormat:33776,pixelType:null},{format:6408,internalFormat:33777,pixelType:null},{format:6408,internalFormat:33778,pixelType:null},{format:6408,internalFormat:33779,pixelType:null},
{format:6407,internalFormat:36196,pixelType:null},{format:6407,internalFormat:35841,pixelType:null},{format:6408,internalFormat:35843,pixelType:null},{format:6407,internalFormat:35840,pixelType:null},{format:6408,internalFormat:35842,pixelType:null},{format:6406,internalFormat:6406,pixelType:5121},{format:6409,internalFormat:6409,pixelType:5121},{format:6410,internalFormat:6410,pixelType:5121},{format:6407,internalFormat:6407,pixelType:33635},{format:6408,internalFormat:6408,pixelType:32820},{format:6408,
internalFormat:6408,pixelType:32819},{format:6407,internalFormat:6407,pixelType:5121},{format:6408,internalFormat:6408,pixelType:5121},{format:6407,internalFormat:6407,pixelType:36193},{format:6408,internalFormat:6408,pixelType:36193},{format:6407,internalFormat:6407,pixelType:5126},{format:6408,internalFormat:6408,pixelType:5126},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,
pixelType:null},{format:6402,internalFormat:6402,pixelType:5123},{format:6402,internalFormat:6402,pixelType:5125},{format:6402,internalFormat:6402,pixelType:5125},{format:6407,internalFormat:37492,pixelType:null},{format:6408,internalFormat:37496,pixelType:null}],d=m.enums={USAGE_STATIC:35044,USAGE_DYNAMIC:35048,USAGE_STREAM:35040,INDEX_FMT_UINT8:5121,INDEX_FMT_UINT16:5123,INDEX_FMT_UINT32:5125,ATTR_POSITION:"a_position",ATTR_NORMAL:"a_normal",ATTR_TANGENT:"a_tangent",ATTR_BITANGENT:"a_bitangent",
ATTR_WEIGHTS:"a_weights",ATTR_JOINTS:"a_joints",ATTR_COLOR:"a_color",ATTR_COLOR0:"a_color0",ATTR_COLOR1:"a_color1",ATTR_UV:"a_uv",ATTR_UV0:"a_uv0",ATTR_UV1:"a_uv1",ATTR_UV2:"a_uv2",ATTR_UV3:"a_uv3",ATTR_UV4:"a_uv4",ATTR_UV5:"a_uv5",ATTR_UV6:"a_uv6",ATTR_UV7:"a_uv7",ATTR_TYPE_INT8:5120,ATTR_TYPE_UINT8:5121,ATTR_TYPE_INT16:5122,ATTR_TYPE_UINT16:5123,ATTR_TYPE_INT32:5124,ATTR_TYPE_UINT32:5125,ATTR_TYPE_FLOAT32:5126,FILTER_NEAREST:0,FILTER_LINEAR:1,WRAP_REPEAT:10497,WRAP_CLAMP:33071,WRAP_MIRROR:33648,
TEXTURE_FMT_RGB_DXT1:0,TEXTURE_FMT_RGBA_DXT1:1,TEXTURE_FMT_RGBA_DXT3:2,TEXTURE_FMT_RGBA_DXT5:3,TEXTURE_FMT_RGB_ETC1:4,TEXTURE_FMT_RGB_PVRTC_2BPPV1:5,TEXTURE_FMT_RGBA_PVRTC_2BPPV1:6,TEXTURE_FMT_RGB_PVRTC_4BPPV1:7,TEXTURE_FMT_RGBA_PVRTC_4BPPV1:8,TEXTURE_FMT_A8:9,TEXTURE_FMT_L8:10,TEXTURE_FMT_L8_A8:11,TEXTURE_FMT_R5_G6_B5:12,TEXTURE_FMT_R5_G5_B5_A1:13,TEXTURE_FMT_R4_G4_B4_A4:14,TEXTURE_FMT_RGB8:15,TEXTURE_FMT_RGBA8:16,TEXTURE_FMT_RGB16F:17,TEXTURE_FMT_RGBA16F:18,TEXTURE_FMT_RGB32F:19,TEXTURE_FMT_RGBA32F:20,
TEXTURE_FMT_R32F:21,TEXTURE_FMT_111110F:22,TEXTURE_FMT_SRGB:23,TEXTURE_FMT_SRGBA:24,TEXTURE_FMT_D16:25,TEXTURE_FMT_D32:26,TEXTURE_FMT_D24S8:27,TEXTURE_FMT_RGB_ETC2:28,TEXTURE_FMT_RGBA_ETC2:29,DS_FUNC_NEVER:512,DS_FUNC_LESS:513,DS_FUNC_EQUAL:514,DS_FUNC_LEQUAL:515,DS_FUNC_GREATER:516,DS_FUNC_NOTEQUAL:517,DS_FUNC_GEQUAL:518,DS_FUNC_ALWAYS:519,RB_FMT_RGBA4:32854,RB_FMT_RGB5_A1:32855,RB_FMT_RGB565:36194,RB_FMT_D16:33189,RB_FMT_S8:36168,RB_FMT_D24S8:34041,BLEND_FUNC_ADD:32774,BLEND_FUNC_SUBTRACT:32778,
BLEND_FUNC_REVERSE_SUBTRACT:32779,BLEND_ZERO:0,BLEND_ONE:1,BLEND_SRC_COLOR:768,BLEND_ONE_MINUS_SRC_COLOR:769,BLEND_DST_COLOR:774,BLEND_ONE_MINUS_DST_COLOR:775,BLEND_SRC_ALPHA:770,BLEND_ONE_MINUS_SRC_ALPHA:771,BLEND_DST_ALPHA:772,BLEND_ONE_MINUS_DST_ALPHA:773,BLEND_CONSTANT_COLOR:32769,BLEND_ONE_MINUS_CONSTANT_COLOR:32770,BLEND_CONSTANT_ALPHA:32771,BLEND_ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_SRC_ALPHA_SATURATE:776,STENCIL_DISABLE:0,STENCIL_ENABLE:1,STENCIL_INHERIT:2,STENCIL_OP_KEEP:7680,STENCIL_OP_ZERO:0,
STENCIL_OP_REPLACE:7681,STENCIL_OP_INCR:7682,STENCIL_OP_INCR_WRAP:34055,STENCIL_OP_DECR:7683,STENCIL_OP_DECR_WRAP:34056,STENCIL_OP_INVERT:5386,CULL_NONE:0,CULL_FRONT:1028,CULL_BACK:1029,CULL_FRONT_AND_BACK:1032,PT_POINTS:0,PT_LINES:1,PT_LINE_LOOP:2,PT_LINE_STRIP:3,PT_TRIANGLES:4,PT_TRIANGLE_STRIP:5,PT_TRIANGLE_FAN:6}},{}],278:[function(f,n,m){m.__esModule=!0;f=function(){function f(e,d,b,a){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this._device=e;this._width=
d;this._height=b;this._colors=a.colors||[];this._depth=a.depth||null;this._stencil=a.stencil||null;this._depthStencil=a.depthStencil||null;this._glID=e._gl.createFramebuffer()}return f.prototype.destroy=function(){null!==this._glID?(this._device._gl.deleteFramebuffer(this._glID),this._glID=null):console.error("The frame-buffer already destroyed")},f.prototype.getHandle=function(){return this._glID},f}();m.default=f;n.exports=m.default},{}],279:[function(f,n,m){m.__esModule=!0;var h,e=function(){function b(a,
c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(a,c,d){return c&&b(a.prototype,c),d&&b(a,d),a}}();f=f("./enums");var d=((h={})[f.enums.INDEX_FMT_UINT8]=1,h[f.enums.INDEX_FMT_UINT16]=2,h[f.enums.INDEX_FMT_UINT32]=4,h);h=function(){function b(a,c,e,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this._device=a;this._format=c;this._usage=e;this._bytesPerIndex=
d[c];this._bytes=f.byteLength;this._numIndices=this._bytes/this._bytesPerIndex;this._needExpandDataStore=!0;this._glID=a._gl.createBuffer();this.update(0,f);a._stats.ib+=this._bytes}return b.prototype.destroy=function(){-1!==this._glID?(this._device._gl.deleteBuffer(this._glID),this._device._stats.ib-=this.bytes,this._glID=-1):console.error("The buffer already destroyed")},b.prototype.update=function(a,c){if(-1!==this._glID){if(0!==c.byteLength){if(a+c.byteLength>this._bytes){if(a)return void console.error("Failed to update data, bytes exceed.");
this._needExpandDataStore=!0;this._bytes=a+c.byteLength;this._numIndices=this._bytes/this._bytesPerIndex}var b=this._device._gl,d=this._usage;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._glID);this._needExpandDataStore?(b.bufferData(b.ELEMENT_ARRAY_BUFFER,c,d),this._needExpandDataStore=!1):b.bufferSubData(b.ELEMENT_ARRAY_BUFFER,a,c);this._device._restoreIndexBuffer()}}else console.error("The buffer is destroyed")},b.prototype.setUsage=function(a){this._usage=a},e(b,[{key:"count",get:function(){return this._numIndices}}]),
b}();h.BYTES_PER_INDEX=d;m.default=h;n.exports=m.default},{"./enums":277}],280:[function(f,n,m){m.__esModule=!0;var h=f("./enums");f={VertexFormat:f("./vertex-format"),IndexBuffer:f("./index-buffer"),VertexBuffer:f("./vertex-buffer"),Program:f("./program"),Texture:f("./texture"),Texture2D:f("./texture-2d"),TextureCube:f("./texture-cube"),RenderBuffer:f("./render-buffer"),FrameBuffer:f("./frame-buffer"),Device:f("./device"),attrTypeBytes:h.attrTypeBytes,glFilter:h.glFilter,glTextureFmt:h.glTextureFmt};
Object.assign(f,h.enums);m.default=f;cc.gfx=f;n.exports=m.default},{"./device":276,"./enums":277,"./frame-buffer":278,"./index-buffer":279,"./program":282,"./render-buffer":283,"./texture":287,"./texture-2d":285,"./texture-cube":286,"./vertex-buffer":288,"./vertex-format":289}],281:[function(f,n,m){m.__esModule=!0;m.isPow2=function(f){return!(f&f-1||!f)}},{}],282:[function(f,n,m){function h(a,c,b){b.split("\n").forEach(function(b){if(!(5>b.length)){var d=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(b);d?
a.push({type:c,fileID:0|d[1],line:0|d[2],message:d[3].trim()}):0<b.length&&a.push({type:c,fileID:-1,line:0,message:b})}})}function e(a,c,b){c=a.createShader(c);return a.shaderSource(c,b),a.compileShader(c),c}m.__esModule=!0;var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(c,b,d){return b&&a(c.prototype,b),d&&a(c,d),c}}(),b=0;f=function(){function a(c,
d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._device=c;this._attributes=[];this._uniforms=[];this._samplers=[];this._errors=[];this._linked=!1;this._vertSource=d.vert;this._fragSource=d.frag;this._glID=null;this._id=b++}return a.prototype.link=function(){if(!this._linked){var a=this._device._gl,b=e(a,a.VERTEX_SHADER,this._vertSource),d=e(a,a.FRAGMENT_SHADER,this._fragSource),f=a.createProgram();a.attachShader(f,b);a.attachShader(f,d);a.linkProgram(f);var q=
!1,r=this._errors;if(a.getShaderParameter(b,a.COMPILE_STATUS)||(h(r,"vs",a.getShaderInfoLog(b)),q=!0),a.getShaderParameter(d,a.COMPILE_STATUS)||(h(r,"fs",a.getShaderInfoLog(d)),q=!0),a.deleteShader(b),a.deleteShader(d),q)return r;if(!a.getProgramParameter(f,a.LINK_STATUS))return r.push({info:"Failed to link shader program: "+a.getProgramInfoLog(f)}),r;this._glID=f;b=a.getProgramParameter(f,a.ACTIVE_ATTRIBUTES);for(d=0;d<b;++d)q=a.getActiveAttrib(f,d),r=a.getAttribLocation(f,q.name),this._attributes.push({name:q.name,
location:r,type:q.type});b=a.getProgramParameter(f,a.ACTIVE_UNIFORMS);for(d=0;d<b;++d){q=a.getActiveUniform(f,d);r=q.name;var m=a.getUniformLocation(f,r),p="[0]"===r.substr(r.length-3);p&&(r=r.substr(0,r.length-3));this._uniforms.push({name:r,location:m,type:q.type,size:p?q.size:void 0})}this._linked=!0}},a.prototype.destroy=function(){this._device._gl.deleteProgram(this._glID);this._linked=!1;this._glID=null;this._attributes=[];this._uniforms=[];this._samplers=[]},d(a,[{key:"id",get:function(){return this._id}}]),
a}();m.default=f;n.exports=m.default},{}],283:[function(f,n,m){m.__esModule=!0;f=function(){function f(e,d,b,a){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this._device=e;this._format=d;this._glID=e._gl.createRenderbuffer();this.update(b,a)}return f.prototype.update=function(e,d){this._width=e;this._height=d;var b=this._device._gl;b.bindRenderbuffer(b.RENDERBUFFER,this._glID);b.renderbufferStorage(b.RENDERBUFFER,this._format,e,d);b.bindRenderbuffer(b.RENDERBUFFER,
null)},f.prototype.destroy=function(){if(null!==this._glID){var e=this._device._gl;e.bindRenderbuffer(e.RENDERBUFFER,null);e.deleteRenderbuffer(this._glID);this._glID=null}else console.error("The render-buffer already destroyed")},f}();m.default=f;n.exports=m.default},{}],284:[function(f,n,m){m.__esModule=!0;m.default=void 0;f=f("./enums");var h={blend:!1,blendSep:!1,blendColor:4294967295,blendEq:f.enums.BLEND_FUNC_ADD,blendAlphaEq:f.enums.BLEND_FUNC_ADD,blendSrc:f.enums.BLEND_ONE,blendDst:f.enums.BLEND_ZERO,
blendSrcAlpha:f.enums.BLEND_ONE,blendDstAlpha:f.enums.BLEND_ZERO,depthTest:!1,depthWrite:!1,depthFunc:f.enums.DS_FUNC_LESS,stencilTest:!1,stencilSep:!1,stencilFuncFront:f.enums.DS_FUNC_ALWAYS,stencilRefFront:0,stencilMaskFront:255,stencilFailOpFront:f.enums.STENCIL_OP_KEEP,stencilZFailOpFront:f.enums.STENCIL_OP_KEEP,stencilZPassOpFront:f.enums.STENCIL_OP_KEEP,stencilWriteMaskFront:255,stencilFuncBack:f.enums.DS_FUNC_ALWAYS,stencilRefBack:0,stencilMaskBack:255,stencilFailOpBack:f.enums.STENCIL_OP_KEEP,
stencilZFailOpBack:f.enums.STENCIL_OP_KEEP,stencilZPassOpBack:f.enums.STENCIL_OP_KEEP,stencilWriteMaskBack:255,cullMode:f.enums.CULL_BACK,primitiveType:f.enums.PT_TRIANGLES,maxStream:-1,vertexBuffers:[],vertexBufferOffsets:[],indexBuffer:null,maxTextureSlot:-1,textureUnits:[],program:null};f=function(){function e(d){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.vertexBuffers=Array(d._caps.maxVertexStreams);this.vertexBufferOffsets=Array(d._caps.maxVertexStreams);
this.textureUnits=Array(d._caps.maxTextureUnits);this.set(h)}return e.initDefault=function(d){h.vertexBuffers=Array(d._caps.maxVertexStreams);h.vertexBufferOffsets=Array(d._caps.maxVertexStreams);h.textureUnits=Array(d._caps.maxTextureUnits)},e.prototype.reset=function(){this.set(h)},e.prototype.set=function(d){this.blend=d.blend;this.blendSep=d.blendSep;this.blendColor=d.blendColor;this.blendEq=d.blendEq;this.blendAlphaEq=d.blendAlphaEq;this.blendSrc=d.blendSrc;this.blendDst=d.blendDst;this.blendSrcAlpha=
d.blendSrcAlpha;this.blendDstAlpha=d.blendDstAlpha;this.depthTest=d.depthTest;this.depthWrite=d.depthWrite;this.depthFunc=d.depthFunc;this.stencilTest=d.stencilTest;this.stencilSep=d.stencilSep;this.stencilFuncFront=d.stencilFuncFront;this.stencilRefFront=d.stencilRefFront;this.stencilMaskFront=d.stencilMaskFront;this.stencilFailOpFront=d.stencilFailOpFront;this.stencilZFailOpFront=d.stencilZFailOpFront;this.stencilZPassOpFront=d.stencilZPassOpFront;this.stencilWriteMaskFront=d.stencilWriteMaskFront;
this.stencilFuncBack=d.stencilFuncBack;this.stencilRefBack=d.stencilRefBack;this.stencilMaskBack=d.stencilMaskBack;this.stencilFailOpBack=d.stencilFailOpBack;this.stencilZFailOpBack=d.stencilZFailOpBack;this.stencilZPassOpBack=d.stencilZPassOpBack;this.stencilWriteMaskBack=d.stencilWriteMaskBack;this.cullMode=d.cullMode;this.primitiveType=d.primitiveType;this.maxStream=d.maxStream;for(var b=0;b<d.vertexBuffers.length;++b)this.vertexBuffers[b]=d.vertexBuffers[b];for(b=0;b<d.vertexBufferOffsets.length;++b)this.vertexBufferOffsets[b]=
d.vertexBufferOffsets[b];this.indexBuffer=d.indexBuffer;this.maxTextureSlot=d.maxTextureSlot;for(b=0;b<d.textureUnits.length;++b)this.textureUnits[b]=d.textureUnits[b];this.program=d.program},e}();m.default=f;n.exports=m.default},{"./enums":277}],285:[function(f,n,m){function h(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var e=function(a){return a&&a.__esModule?a:{default:a}}(f("./texture")),d=f("./enums"),b=f("./misc");Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;f=function(a){function c(b,d){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||
"object"!=typeof b&&"function"!=typeof b?this:b;var e=b._device._gl;return b._target=e.TEXTURE_2D,b._glID=e.createTexture(),d.images=d.images||[null],b.update(d),b}return h(c,a),c.prototype.update=function(a){var c=this._device._gl,e=this._genMipmap;if(a){void 0!==a.width&&(this._width=a.width);void 0!==a.height&&(this._height=a.height);void 0!==a.anisotropy&&(this._anisotropy=a.anisotropy);void 0!==a.minFilter&&(this._minFilter=a.minFilter);void 0!==a.magFilter&&(this._magFilter=a.magFilter);void 0!==
a.mipFilter&&(this._mipFilter=a.mipFilter);void 0!==a.wrapS&&(this._wrapS=a.wrapS);void 0!==a.wrapT&&(this._wrapT=a.wrapT);void 0!==a.format&&(this._format=a.format,this._compressed=this._format>=d.enums.TEXTURE_FMT_RGB_DXT1&&this._format<=d.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||this._format>=d.enums.TEXTURE_FMT_RGB_ETC2&&this._format<=d.enums.TEXTURE_FMT_RGBA_ETC2);void 0!==a.genMipmaps&&(this._genMipmap=a.genMipmaps,e=a.genMipmaps);var f=this._device.caps.maxTextureSize||Number.MAX_VALUE,g=Math.max(a.width||
0,a.height||0);(f<g&&console.warn("The current texture size "+g+" exceeds the maximum size ["+f+"] supported on the device."),void 0!==a.images)&&1<a.images.length&&(e=!1,1!=(a.width>a.height?a.width:a.height)>>a.images.length-1&&console.error("texture-2d mipmap is invalid, should have a 1x1 mipmap."))}(0,b.isPow2)(this._width)&&(0,b.isPow2)(this._height)||(e=!1);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,this._glID);void 0!==a.images&&0<a.images.length&&(this._setMipmap(a.images,a.flipY,
a.premultiplyAlpha),1<a.images.length&&(this._genMipmap=!0));e&&(c.hint(c.GENERATE_MIPMAP_HINT,c.NICEST),c.generateMipmap(c.TEXTURE_2D),this._genMipmap=!0);this._setTexInfo();this._device._restoreTexture(0)},c.prototype.updateSubImage=function(a){var c=this._device._gl,b=(0,d.glTextureFmt)(this._format);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,this._glID);this._setSubImage(b,a);this._device._restoreTexture(0)},c.prototype.updateImage=function(a){var c=this._device._gl,b=(0,d.glTextureFmt)(this._format);
c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,this._glID);this._setImage(b,a);this._device._restoreTexture(0)},c.prototype._setSubImage=function(a,c){var b=this._device._gl,d=c.flipY,e=c.premultiplyAlpha,f=c.image;!f||ArrayBuffer.isView(f)||f instanceof ArrayBuffer?(void 0===d?b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1):b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d),void 0===e?b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this._compressed?b.compressedTexSubImage2D(b.TEXTURE_2D,
c.level,c.x,c.y,c.width,c.height,a.format,f):b.texSubImage2D(b.TEXTURE_2D,c.level,c.x,c.y,c.width,c.height,a.format,a.pixelType,f)):(void 0===d?b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0):b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d),void 0===e?b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),b.texSubImage2D(b.TEXTURE_2D,c.level,c.x,c.y,a.format,a.pixelType,f))},c.prototype._setImage=function(a,c){var b=this._device._gl,d=c.flipY,e=c.premultiplyAlpha,f=c.image;
!f||ArrayBuffer.isView(f)||f instanceof ArrayBuffer?(void 0===d?b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1):b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d),void 0===e?b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this._compressed?b.compressedTexImage2D(b.TEXTURE_2D,c.level,a.internalFormat,c.width,c.height,0,f):b.texImage2D(b.TEXTURE_2D,c.level,a.internalFormat,c.width,c.height,0,a.format,a.pixelType,f)):(void 0===d?b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0):
b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d),void 0===e?b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),b.texImage2D(b.TEXTURE_2D,c.level,a.internalFormat,a.format,a.pixelType,f))},c.prototype._setMipmap=function(a,c,b){var e=(0,d.glTextureFmt)(this._format);c={width:this._width,height:this._height,flipY:c,premultiplyAlpha:b,level:0,image:null};for(b=0;b<a.length;++b)c.level=b,c.width=this._width>>b,c.height=this._height>>b,c.image=a[b],this._setImage(e,
c)},c.prototype._setTexInfo=function(){var a=this._device._gl,c=(0,b.isPow2)(this._width)&&(0,b.isPow2)(this._height);c||this._wrapS===d.enums.WRAP_CLAMP&&this._wrapT===d.enums.WRAP_CLAMP||(console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),this._wrapS=d.enums.WRAP_CLAMP,this._wrapT=d.enums.WRAP_CLAMP);var e=this._genMipmap?this._mipFilter:-1;c||-1===e||(console.warn("NPOT textures do not support mipmap filter"),e=-1);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,(0,d.glFilter)(a,
this._minFilter,e));a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,(0,d.glFilter)(a,this._magFilter,-1));a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,this._wrapS);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,this._wrapT);(c=this._device.ext("EXT_texture_filter_anisotropic"))&&a.texParameteri(a.TEXTURE_2D,c.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy)},c}(e.default);m.default=f;n.exports=m.default},{"./enums":277,"./misc":281,"./texture":287}],286:[function(f,n,m){function h(a,c){if("function"!=
typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var e=function(a){return a&&a.__esModule?a:{default:a}}(f("./texture")),d=f("./enums"),b=f("./misc");f=function(a){function c(b,d){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
b=a.call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!=typeof b&&"function"!=typeof b?this:b;var e=b._device._gl;return b._target=e.TEXTURE_CUBE_MAP,b._glID=e.createTexture(),b.update(d),b}return h(c,a),c.prototype.update=function(a){var c=this._device._gl,e=this._genMipmaps;a&&(void 0!==a.width&&(this._width=a.width),void 0!==a.height&&(this._height=a.height),void 0!==a.anisotropy&&(this._anisotropy=a.anisotropy),void 0!==a.minFilter&&
(this._minFilter=a.minFilter),void 0!==a.magFilter&&(this._magFilter=a.magFilter),void 0!==a.mipFilter&&(this._mipFilter=a.mipFilter),void 0!==a.wrapS&&(this._wrapS=a.wrapS),void 0!==a.wrapT&&(this._wrapT=a.wrapT),void 0!==a.format&&(this._format=a.format,this._compressed=this._format>=d.enums.TEXTURE_FMT_RGB_DXT1&&this._format<=d.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||this._format>=d.enums.TEXTURE_FMT_RGB_ETC2&&this._format<=d.enums.TEXTURE_FMT_RGBA_ETC2),void 0!==a.genMipmaps&&(this._genMipmaps=a.genMipmaps,
e=a.genMipmaps),void 0!==a.images&&1<a.images.length&&(e=!1,a.width!==a.height&&console.warn("texture-cube width and height should be identical."),1!=a.width>>a.images.length-1&&console.error("texture-cube mipmap is invalid. please set mipmap as 1x1, 2x2, 4x4 ... nxn")));(0,b.isPow2)(this._width)&&(0,b.isPow2)(this._height)||(e=!1);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_CUBE_MAP,this._glID);void 0!==a.images&&0<a.images.length&&(this._setMipmap(a.images,a.flipY,a.premultiplyAlpha),1<
a.images.length&&(this._genMipmaps=!0));e&&(c.hint(c.GENERATE_MIPMAP_HINT,c.NICEST),c.generateMipmap(c.TEXTURE_CUBE_MAP),this._genMipmaps=!0);this._setTexInfo();this._device._restoreTexture(0)},c.prototype.updateSubImage=function(a){var c=this._device._gl,b=(0,d.glTextureFmt)(this._format);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_CUBE_MAP,this._glID);this._setSubImage(b,a);this._device._restoreTexture(0)},c.prototype.updateImage=function(a){var c=this._device._gl,b=(0,d.glTextureFmt)(this._format);
c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_CUBE_MAP,this._glID);this._setImage(b,a);this._device._restoreTexture(0)},c.prototype._setSubImage=function(a,c){var b=this._device._gl,d=c.flipY,e=c.premultiplyAlpha,f=c.faceIndex,g=c.image;void 0===d?b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1):b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d);void 0===e?b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e);!g||ArrayBuffer.isView(g)||g instanceof ArrayBuffer?this._compressed?
b.compressedTexSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.level,c.x,c.y,c.width,c.height,a.format,g):b.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.level,c.x,c.y,c.width,c.height,a.format,a.pixelType,g):b.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.level,c.x,c.y,a.format,a.pixelType,g)},c.prototype._setImage=function(a,c){var b=this._device._gl,d=c.flipY,e=c.premultiplyAlpha,f=c.faceIndex,g=c.image;void 0===d?b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1):b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d);
void 0===e?b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e);!g||ArrayBuffer.isView(g)||g instanceof ArrayBuffer?this._compressed?b.compressedTexImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.level,a.internalFormat,c.width,c.height,0,g):b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.level,a.internalFormat,c.width,c.height,0,a.format,a.pixelType,g):b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,c.level,a.internalFormat,a.format,a.pixelType,g)},c.prototype._setMipmap=
function(a,c,b){var e=(0,d.glTextureFmt)(this._format);c={width:this._width,height:this._height,faceIndex:0,flipY:c,premultiplyAlpha:b,level:0,image:null};for(b=0;b<a.length;++b){var f=a[b];c.level=b;c.width=this._width>>b;c.height=this._height>>b;for(var g=0;6>g;++g)c.faceIndex=g,c.image=f[g],this._setImage(e,c)}},c.prototype._setTexInfo=function(){var a=this._device._gl,c=(0,b.isPow2)(this._width)&&(0,b.isPow2)(this._height);c||this._wrapS===d.enums.WRAP_CLAMP&&this._wrapT===d.enums.WRAP_CLAMP||
(console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),this._wrapS=d.enums.WRAP_CLAMP,this._wrapT=d.enums.WRAP_CLAMP);var e=this._genMipmaps?this._mipFilter:-1;c||-1===e||(console.warn("NPOT textures do not support mipmap filter"),e=-1);a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,(0,d.glFilter)(a,this._minFilter,e));a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,(0,d.glFilter)(a,this._magFilter,-1));a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,this._wrapS);
a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,this._wrapT);(c=this._device.ext("EXT_texture_filter_anisotropic"))&&a.texParameteri(a.TEXTURE_CUBE_MAP,c.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy)},c}(e.default);m.default=f;n.exports=m.default},{"./enums":277,"./misc":281,"./texture":287}],287:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=f("./enums"),e=0;f=function(){function d(b){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._device=b;this._height=
this._width=4;this._compressed=this._genMipmaps=!1;this._anisotropy=1;this._mipFilter=this._magFilter=this._minFilter=h.enums.FILTER_LINEAR;this._wrapT=this._wrapS=h.enums.WRAP_REPEAT;this._format=h.enums.TEXTURE_FMT_RGBA8;this._target=-1;this._id=e++}return d.prototype.destroy=function(){null!==this._glID?(this._device._gl.deleteTexture(this._glID),this._device._stats.tex-=this.bytes,this._glID=null):console.error("The texture already destroyed")},d}();m.default=f;n.exports=m.default},{"./enums":277}],
288:[function(f,n,m){m.__esModule=!0;var h=function(){function e(d,b){for(var a=0;a<b.length;a++){var c=b[a];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}return function(d,b,a){return b&&e(d.prototype,b),a&&e(d,a),d}}();f("./enums");f=function(){function e(d,b,a,c){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._device=d;this._format=b;this._usage=a;this._bytesPerVertex=this._format._bytes;this._bytes=
c.byteLength;this._numVertices=this._bytes/this._bytesPerVertex;this._needExpandDataStore=!0;this._glID=d._gl.createBuffer();this.update(0,c);d._stats.vb+=this._bytes}return e.prototype.destroy=function(){-1!==this._glID?(this._device._gl.deleteBuffer(this._glID),this._device._stats.vb-=this.bytes,this._glID=-1):console.error("The buffer already destroyed")},e.prototype.update=function(d,b){if(-1!==this._glID){if(0!==b.byteLength){if(d+b.byteLength>this._bytes){if(d)return void console.error("Failed to update data, bytes exceed.");
this._needExpandDataStore=!0;this._bytes=d+b.byteLength;this._numVertices=this._bytes/this._bytesPerVertex}var a=this._device._gl,c=this._usage;a.bindBuffer(a.ARRAY_BUFFER,this._glID);this._needExpandDataStore?(a.bufferData(a.ARRAY_BUFFER,b,c),this._needExpandDataStore=!1):a.bufferSubData(a.ARRAY_BUFFER,d,b);a.bindBuffer(a.ARRAY_BUFFER,null)}}else console.error("The buffer is destroyed")},e.prototype.getFormat=function(d){return this._format.element(d)},e.prototype.setUsage=function(d){this._usage=
d},h(e,[{key:"count",get:function(){return this._numVertices}}]),e}();m.default=f;n.exports=m.default},{"./enums":277}],289:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=f("./enums"),e=function(d){return d&&d.__esModule?d:{default:d}}(f("../murmurhash2_gc"));f=function(){function d(b){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._attr2el={};this._elements=[];this._bytes=0;for(var a="",c=0,f=b.length;c<f;++c){var k=b[c];k={name:k.name,offset:this._bytes,
stride:0,stream:-1,type:k.type,num:k.num,normalize:void 0!==k.normalize&&k.normalize,bytes:k.num*(0,h.attrTypeBytes)(k.type)};this._attr2el[k.name]=k;this._elements.push(k);this._bytes+=k.bytes;a+=k.name+":"+k.num+":"+k.type+":"+k.normalize}b=0;for(c=this._elements.length;b<c;++b)this._elements[b].stride=this._bytes;this._hash=(0,e.default)(a,666)}return d.prototype.element=function(b){return this._attr2el[b]},d.prototype.getHash=function(){return this._hash},d}();m.default=f;n.exports=m.default},
{"../murmurhash2_gc":298,"./enums":277}],290:[function(f,n,m){m.__esModule=!0;f=function(){function f(e,d){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this._cursor=0;this._data=Array(d);for(var b=0;b<d;++b)this._data[b]=e()}return f.prototype.request=function(){var e=this._data[this._cursor];return this._cursor=(this._cursor+1)%this._data.length,e},f}();m.default=f;n.exports=m.default},{}],291:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=function(){function d(b,
a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,a,c){return a&&d(b.prototype,a),c&&d(b,c),b}}(),e=function(d){return d&&d.__esModule?d:{default:d}}(f("./timsort"));f=function(){function d(b){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._count=0;this._data=Array(b)}return d.prototype._resize=function(b){if(b>this._data.length)for(var a=
this._data.length;a<b;++a)this._data[a]=void 0},d.prototype.reset=function(){for(var b=0;b<this._count;++b)this._data[b]=void 0;this._count=0},d.prototype.push=function(b){this._count>=this._data.length&&this._resize(2*this._data.length);this._data[this._count]=b;++this._count},d.prototype.pop=function(){--this._count;0>this._count&&(this._count=0);var b=this._data[this._count];return this._data[this._count]=void 0,b},d.prototype.fastRemove=function(b){if(!(b>=this._count||0>b)){var a=this._count-
1;this._data[b]=this._data[a];this._data[a]=void 0;--this._count}},d.prototype.indexOf=function(b){return this._data.indexOf(b)},d.prototype.sort=function(b){return(0,e.default)(this._data,0,this._count,b)},h(d,[{key:"length",get:function(){return this._count}},{key:"data",get:function(){return this._data}}]),d}();m.default=f;n.exports=m.default},{"./timsort":296}],292:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}m.__esModule=!0;var e=f("./circular-pool");Object.defineProperty(m,
"CircularPool",{enumerable:!0,get:function(){return h(e).default}});var d=f("./fixed-array");Object.defineProperty(m,"FixedArray",{enumerable:!0,get:function(){return h(d).default}});var b=f("./linked-array");Object.defineProperty(m,"LinkedArray",{enumerable:!0,get:function(){return h(b).default}});var a=f("./pool");Object.defineProperty(m,"Pool",{enumerable:!0,get:function(){return h(a).default}});var c=f("./recycle-pool");Object.defineProperty(m,"RecyclePool",{enumerable:!0,get:function(){return h(c).default}});
var g=f("./typed-array-pool");Object.defineProperty(m,"TypedArrayPool",{enumerable:!0,get:function(){return h(g).default}})},{"./circular-pool":290,"./fixed-array":291,"./linked-array":293,"./pool":294,"./recycle-pool":295,"./typed-array-pool":297}],293:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=function(){function d(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,
a,c){return a&&d(b.prototype,a),c&&d(b,c),b}}(),e=function(d){return d&&d.__esModule?d:{default:d}}(f("./pool"));f=function(){function d(b,a){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._fn=b;this._count=0;this._tail=this._head=null;this._pool=new e.default(b,a)}return d.prototype.add=function(){var b=this._pool.alloc();return this._tail?(this._tail._next=b,b._prev=this._tail):this._head=b,this._tail=b,this._count+=1,b},d.prototype.remove=function(b){b._prev?
b._prev._next=b._next:this._head=b._next;b._next?b._next._prev=b._prev:this._tail=b._prev;b._next=null;b._prev=null;this._pool.free(b);--this._count},d.prototype.forEach=function(b,a){var c=this._head;if(c){a&&(b=b.bind(a));a=0;for(var d;c;)d=c._next,b(c,a,this),c=d,++a}},h(d,[{key:"head",get:function(){return this._head}},{key:"tail",get:function(){return this._tail}},{key:"length",get:function(){return this._count}}]),d}();m.default=f;n.exports=m.default},{"./pool":294}],294:[function(f,n,m){m.__esModule=
!0;f=function(){function f(e,d){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this._fn=e;this._idx=d-1;this._frees=Array(d);for(var b=0;b<d;++b)this._frees[b]=e()}return f.prototype._expand=function(e){var d=this._frees;this._frees=Array(e);for(var b=e-d.length,a=0;a<b;++a)this._frees[a]=this._fn();a=b;for(var c=0;a<e;++a,++c)this._frees[a]=d[c];this._idx+=b},f.prototype.alloc=function(){0>this._idx&&this._expand(Math.round(1.2*this._frees.length)+1);var e=this._frees[this._idx];
return this._frees[this._idx]=null,--this._idx,e},f.prototype.free=function(e){++this._idx;this._frees[this._idx]=e},f}();m.default=f;n.exports=m.default},{}],295:[function(f,n,m){m.__esModule=!0;m.default=void 0;var h=function(){function d(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,a,c){return a&&d(b.prototype,a),c&&d(b,c),b}}(),e=function(d){return d&&d.__esModule?d:
{default:d}}(f("./timsort"));f=function(){function d(b,a){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._fn=b;this._count=0;this._data=Array(a);for(var c=0;c<a;++c)this._data[c]=b()}return d.prototype.reset=function(){this._count=0},d.prototype.resize=function(b){if(b>this._data.length)for(var a=this._data.length;a<b;++a)this._data[a]=this._fn()},d.prototype.add=function(){return this._count>=this._data.length&&this.resize(2*this._data.length),this._data[this._count++]},
d.prototype.remove=function(b){if(!(b>=this._count)){var a=this._count-1,c=this._data[b];this._data[b]=this._data[a];this._data[a]=c;--this._count}},d.prototype.sort=function(b){return(0,e.default)(this._data,0,this._count,b)},h(d,[{key:"length",get:function(){return this._count}},{key:"data",get:function(){return this._data}}]),d}();m.default=f;n.exports=m.default},{"./timsort":296}],296:[function(f,n,m){function h(a){return 1E5>a?100>a?10>a?0:1:1E4>a?1E3>a?2:3:4:1E7>a?1E6>a?5:6:1E9>a?1E8>a?7:8:
9}function e(a,c){if(a===c)return 0;if(~~a===a&&~~c===c){if(0===a||0===c)return a<c?-1:1;if(0>a||0>c){if(0<=c)return-1;if(0<=a)return 1;a=-a;c=-c}var b=h(a),d=h(c),e=0;return b<d?(a*=k[d-b-1],c/=10,e=-1):b>d&&(c*=k[b-d-1],a/=10,e=1),a===c?e:a<c?-1:1}a=String(a);c=String(c);return a===c?0:a<c?-1:1}function d(a,c,b,d){var e=c+1;if(e===b)return 1;if(0>d(a[e++],a[c])){for(;e<b&&0>d(a[e],a[e-1]);)e++;b=c;d=e;for(d--;b<d;){var f=a[b];a[b++]=a[d];a[d--]=f}}else for(;e<b&&0<=d(a[e],a[e-1]);)e++;return e-
c}function b(a,c,b,d,e){for(d===c&&d++;d<b;d++){for(var f=a[d],g=c,k=d;g<k;){var l=g+k>>>1;0>e(f,a[l])?k=l:g=l+1}k=d-g;switch(k){case 3:a[g+3]=a[g+2];case 2:a[g+2]=a[g+1];case 1:a[g+1]=a[g];break;default:for(;0<k;)a[g+k]=a[g+k-1],k--}a[g]=f}}function a(a,c,b,d,e,f){var g=0,k=1;if(0<f(a,c[b+e])){for(d-=e;k<d&&0<f(a,c[b+e+k]);)g=k,0>=(k=1+(k<<1))&&(k=d);k>d&&(k=d);g+=e;k+=e}else{for(d=e+1;k<d&&0>=f(a,c[b+e-k]);)g=k,0>=(k=1+(k<<1))&&(k=d);k>d&&(k=d);d=g;g=e-k;k=e-d}for(g++;g<k;)e=g+(k-g>>>1),0<f(a,c[b+
e])?g=e+1:k=e;return k}function c(a,c,b,d,e,f){var g=0,k=1;if(0>f(a,c[b+e])){for(d=e+1;k<d&&0>f(a,c[b+e-k]);)g=k,0>=(k=1+(k<<1))&&(k=d);k>d&&(k=d);d=g;g=e-k;k=e-d}else{for(d-=e;k<d&&0<=f(a,c[b+e+k]);)g=k,0>=(k=1+(k<<1))&&(k=d);k>d&&(k=d);g+=e;k+=e}for(g++;g<k;)e=g+(k-g>>>1),0>f(a,c[b+e])?k=e:g=e+1;return k}m.__esModule=!0;m.default=function(a,c,f,k){if(!Array.isArray(a))throw new TypeError("Can only sort arrays");void 0===c&&(c=0);void 0===f&&(f=a.length);void 0===k&&(k=e);var h=f-c;if(!(2>h))if(h<
g)b(a,c,f,c+d(a,c,f,k),k);else{var p=new l(a,k),q;var m=h;for(q=0;m>=g;)q|=1&m,m>>=1;q=m+q;do{if((m=d(a,c,f,k))<q){var r=h;r>q&&(r=q);b(a,c,c+r,c+m,k);m=r}p.pushRun(c,m);p.mergeRuns();h-=m;c+=m}while(0!==h);p.forceMergeRuns()}};var g=32,k=[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8,1E9],l=function(){function b(a,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.array=a;this.compare=c;this.minGallop=7;this.length=a.length;this.tmpStorageLength=256;512>this.length&&(this.tmpStorageLength=
this.length>>>1);this.tmp=Array(this.tmpStorageLength);this.stackLength=120>this.length?5:1542>this.length?10:119151>this.length?19:40;this.runStart=Array(this.stackLength);this.runLength=Array(this.stackLength);this.stackSize=0}return b.prototype.pushRun=function(a,c){this.runStart[this.stackSize]=a;this.runLength[this.stackSize]=c;this.stackSize+=1},b.prototype.mergeRuns=function(){for(;1<this.stackSize;){var a=this.stackSize-2;if(1<=a&&this.runLength[a-1]<=this.runLength[a]+this.runLength[a+1]||
2<=a&&this.runLength[a-2]<=this.runLength[a]+this.runLength[a-1])this.runLength[a-1]<this.runLength[a+1]&&a--;else if(this.runLength[a]>this.runLength[a+1])break;this.mergeAt(a)}},b.prototype.forceMergeRuns=function(){for(;1<this.stackSize;){var a=this.stackSize-2;0<a&&this.runLength[a-1]<this.runLength[a+1]&&a--;this.mergeAt(a)}},b.prototype.mergeAt=function(b){var d=this.compare,e=this.array,f=this.runStart[b],g=this.runLength[b],k=this.runStart[b+1],l=this.runLength[b+1];this.runLength[b]=g+l;
b===this.stackSize-3&&(this.runStart[b+1]=this.runStart[b+2],this.runLength[b+1]=this.runLength[b+2]);this.stackSize--;b=c(e[k],e,f,g,0,d);f+=b;0!==(g-=b)&&0!==(l=a(e[f+g-1],e,k,l,l-1,d))&&(g<=l?this.mergeLow(f,g,k,l):this.mergeHigh(f,g,k,l))},b.prototype.mergeLow=function(b,d,e,f){var g=this.compare,k=this.array,l=this.tmp,h;for(h=0;h<d;h++)l[h]=k[b+h];var p=0;if(k[b++]=k[e++],0!=--f)if(1!==d){for(var q=this.minGallop;;){var m=0,r=0,v=!1;do if(0>g(k[e],l[p])){if(k[b++]=k[e++],r++,m=0,0==--f){v=!0;
break}}else if(k[b++]=l[p++],m++,r=0,1==--d){v=!0;break}while((m|r)<q);if(v)break;do{if(0!==(m=c(k[e],l,p,d,0,g))){for(h=0;h<m;h++)k[b+h]=l[p+h];if(b+=m,p+=m,1>=(d-=m)){v=!0;break}}if(k[b++]=k[e++],0==--f){v=!0;break}if(0!==(r=a(l[p],k,e,f,0,g))){for(h=0;h<r;h++)k[b+h]=k[e+h];if(b+=r,e+=r,0===(f-=r)){v=!0;break}}if(k[b++]=l[p++],1==--d){v=!0;break}q--}while(7<=m||7<=r);if(v)break;0>q&&(q=0);q+=2}if(this.minGallop=q,1>q&&(this.minGallop=1),1===d){for(h=0;h<f;h++)k[b+h]=k[e+h];k[b+f]=l[p]}else{if(0===
d)throw Error("mergeLow preconditions were not respected");for(h=0;h<d;h++)k[b+h]=l[p+h]}}else{for(h=0;h<f;h++)k[b+h]=k[e+h];k[b+f]=l[p]}else for(h=0;h<d;h++)k[b+h]=l[p+h]},b.prototype.mergeHigh=function(b,d,e,f){var g=this.compare,k=this.array,l=this.tmp,h;for(h=0;h<f;h++)l[h]=k[e+h];var p=b+d-1,q=f-1;e=e+f-1;if(k[e--]=k[p--],0!=--d)if(1!==f){for(var m=this.minGallop;;){var r=0,v=0,t=!1;do if(0>g(l[q],k[p])){if(k[e--]=k[p--],r++,v=0,0==--d){t=!0;break}}else if(k[e--]=l[q--],v++,r=0,1==--f){t=!0;
break}while((r|v)<m);if(t)break;do{if(0!==(r=d-c(l[q],k,b,d,d-1,g))){d-=r;var n=(e-=r)+1;var F=(p-=r)+1;for(h=r-1;0<=h;h--)k[n+h]=k[F+h];if(0===d){t=!0;break}}if(k[e--]=l[q--],1==--f){t=!0;break}if(0!==(v=f-a(k[p],l,0,f,f-1,g))){f-=v;n=(e-=v)+1;F=(q-=v)+1;for(h=0;h<v;h++)k[n+h]=l[F+h];if(1>=f){t=!0;break}}if(k[e--]=k[p--],0==--d){t=!0;break}m--}while(7<=r||7<=v);if(t)break;0>m&&(m=0);m+=2}if(this.minGallop=m,1>m&&(this.minGallop=1),1===f){n=(e-=d)+1;F=p-d+1;for(h=d-1;0<=h;h--)k[n+h]=k[F+h];k[e]=l[q]}else{if(0===
f)throw Error("mergeHigh preconditions were not respected");F=e-(f-1);for(h=0;h<f;h++)k[F+h]=l[h]}}else{n=(e-=d)+1;F=p-d+1;for(h=d-1;0<=h;h--)k[n+h]=k[F+h];k[e]=l[q]}else for(F=e-(f-1),h=0;h<f;h++)k[F+h]=l[h]},b}();n.exports=m.default},{}],297:[function(f,n,m){function h(b){var a=void 0,c=void 0;return a=(65535<b)<<4,a|=c=(255<(b>>>=a))<<3,a|=c=(15<(b>>>=c))<<2,a|(c=(3<(b>>>=c))<<1)|b>>>c>>1}function e(b){a:{for(var a=16;268435456>=a;a*=16)if(b<=a){b=a;break a}b=0}a=d[h(b)>>2];return 0<a.length?a.pop():
new ArrayBuffer(b)}m.__esModule=!0;var d=Array(8);for(f=0;8>f;++f)d[f]=[];m.default={alloc_int8:function(b){var a=new Int8Array(e(b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_uint8:function(b){var a=new Uint8Array(e(b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_int16:function(b){var a=new Int16Array(e(2*b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_uint16:function(b){var a=new Uint16Array(e(2*b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_int32:function(b){var a=new Int32Array(e(4*
b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_uint32:function(b){var a=new Uint32Array(e(4*b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_float32:function(b){var a=new Float32Array(e(4*b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_float64:function(b){var a=new Float64Array(e(8*b),0,b);return a.length!==b?a.subarray(0,b):a},alloc_dataview:function(b){var a=new DataView(e(b),0,b);return a.length!==b?a.subarray(0,b):a},free:function(b){b=b.buffer;d[h(b.byteLength)>>2].push(b)},reset:function(){for(var b=
Array(8),a=0;8>a;++a)b[a]=[]}};n.exports=m.default},{}],298:[function(f,n,m){m.__esModule=!0;m.default=function(f,e){var d=f.length;e^=d;for(var b=0;4<=d;){var a=1540483477*(65535&(a=255&f.charCodeAt(b)|(255&f.charCodeAt(++b))<<8|(255&f.charCodeAt(++b))<<16|(255&f.charCodeAt(++b))<<24))+((1540483477*(a>>>16)&65535)<<16);e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16));d-=4;++b}switch(d){case 3:e^=(255&f.charCodeAt(b+2))<<
16;case 2:e^=(255&f.charCodeAt(b+1))<<8;case 1:e=1540483477*(65535&(e^=255&f.charCodeAt(b)))+((1540483477*(e>>>16)&65535)<<16)}return e=1540483477*(65535&(e^=e>>>13))+((1540483477*(e>>>16)&65535)<<16),(e^e>>>15)>>>0};n.exports=m.default},{}],299:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}function e(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}m.__esModule=!0;m.default=void 0;var d=f("../../core/vmath"),b=h(f("../core/base-renderer")),a=h(f("../enums"));f=f("../memop");var c=new Float32Array(16),g=new Float32Array(16),k=new Float32Array(16),l=new Float32Array(4),q=new Float32Array(64),r=[],t=new Float32Array(4),p=cc.v4(0,0,0,0),v=cc.v3(0,0,0),w=cc.v3(0,0,0),E=new f.RecyclePool(function(){return new Float32Array(16)},8);b=function(b){function f(a,
c){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");a=b.call(this,a,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!=typeof a&&"function"!=typeof a?this:a;return a._time=new Float32Array(4),a._directionalLights=[],a._pointLights=[],a._spotLights=[],a._shadowLights=[],a._ambientLights=[],a._shadowMaps=[],a._shadowMapSlots=new Int32Array(4),a._numLights=0,a._defines={},a._registerStage("shadowcast",a._shadowStage.bind(a)),
a._registerStage("opaque",a._opaqueStage.bind(a)),a._registerStage("transparent",a._transparentStage.bind(a)),a}return e(f,b),f.prototype.reset=function(){E.reset();b.prototype.reset.call(this)},f.prototype.render=function(a,c){this.reset();this._time[0]+=c;this._device.setUniform("cc_time",this._time);this._updateLights(a);c=this._device._gl.canvas;for(var b=0;b<a._cameras.length;++b){var d=this._requestView();a._cameras.data[b].extractView(d,c.width,c.height)}this._viewPools.sort(function(a,c){return a._priority-
c._priority});for(c=0;c<this._viewPools.length;++c)this._render(this._viewPools.data[c],a)},f.prototype.renderCamera=function(a,c){this.reset();var b=this._device._gl.canvas,d=b.width;b=b.height;var e=this._requestView();a.extractView(e,d,b);this._render(e,c)},f.prototype._updateLights=function(c){this._directionalLights.length=0;this._pointLights.length=0;this._spotLights.length=0;this._shadowLights.length=0;this._ambientLights.length=0;c=c._lights;for(var b=0;b<c.length;++b){var d=c.data[b];if(d.update(this._device),
d.shadowType!==a.default.SHADOW_NONE){this._shadowLights.push(d);var e=this._requestView();d.extractView(e,["shadowcast"])}d._type===a.default.LIGHT_DIRECTIONAL?this._directionalLights.push(d):d._type===a.default.LIGHT_POINT?this._pointLights.push(d):d._type===a.default.LIGHT_SPOT?this._spotLights.push(d):this._ambientLights.push(d)}this._updateDefines();this._numLights=c._count},f.prototype._updateDefines=function(){var a=this._defines;a.CC_NUM_DIR_LIGHTS=Math.min(4,this._directionalLights.length);
a.CC_NUM_POINT_LIGHTS=Math.min(4,this._pointLights.length);a.CC_NUM_SPOT_LIGHTS=Math.min(4,this._spotLights.length);a.CC_NUM_AMBIENT_LIGHTS=Math.min(4,this._ambientLights.length);a.CC_NUM_SHADOW_LIGHTS=Math.min(4,this._shadowLights.length)},f.prototype._submitLightsUniforms=function(){var a=this._device;if(0<this._directionalLights.length){for(var c=E.add(),b=E.add(),d=Math.min(4,this._directionalLights.length),e=0;e<d;++e){var f=this._directionalLights[e],g=4*e;c.set(f._directionUniform,g);b.set(f._colorUniform,
g)}a.setUniform("cc_dirLightDirection",c);a.setUniform("cc_dirLightColor",b)}if(0<this._pointLights.length){c=E.add();b=E.add();d=Math.min(4,this._pointLights.length);for(e=0;e<d;++e)f=this._pointLights[e],g=4*e,c.set(f._positionUniform,g),c[g+3]=f._range,b.set(f._colorUniform,g);a.setUniform("cc_pointLightPositionAndRange",c);a.setUniform("cc_pointLightColor",b)}if(0<this._spotLights.length){c=E.add();b=E.add();d=E.add();e=Math.min(4,this._spotLights.length);for(f=0;f<e;++f){g=this._spotLights[f];
var k=4*f;c.set(g._positionUniform,k);c[k+3]=g._range;b.set(g._directionUniform,k);b[k+3]=g._spotUniform[0];d.set(g._colorUniform,k);d[k+3]=g._spotUniform[1]}a.setUniform("cc_spotLightPositionAndRange",c);a.setUniform("cc_spotLightDirection",b);a.setUniform("cc_spotLightColor",d)}if(0<this._ambientLights.length){c=E.add();b=Math.min(4,this._ambientLights.length);for(d=0;d<b;++d)c.set(this._ambientLights[d]._colorUniform,4*d);a.setUniform("cc_ambientColor",c)}},f.prototype._submitShadowStageUniforms=
function(a){var c=a._shadowLight;t[0]=c.shadowMinDepth;t[1]=c.shadowMaxDepth;t[2]=c.shadowDepthScale;t[3]=c.shadowDarkness;this._device.setUniform("cc_shadow_map_lightViewProjMatrix",d.mat4.array(k,a._matViewProj));this._device.setUniform("cc_shadow_map_info",t);this._device.setUniform("cc_shadow_map_bias",c.shadowBias)},f.prototype._submitOtherStagesUniforms=function(){for(var a=E.add(),c=0;c<this._shadowLights.length;++c){var b=this._shadowLights[c],e=r[c];e||(e=r[c]=new Float32Array(q.buffer,16*
c,16));d.mat4.array(e,b.viewProjMatrix);e=4*c;a[e]=b.shadowMinDepth;a[e+1]=b.shadowMaxDepth;a[e+2]=b.shadowDepthScale;a[e+3]=b.shadowDarkness}this._device.setUniform("cc_shadow_lightViewProjMatrix",q);this._device.setUniform("cc_shadow_info",a)},f.prototype._updateShaderDefines=function(a){a.defines.push(this._defines)},f.prototype._sortItems=function(a){a.sort(function(a,c){var b=a.technique,d=c.technique;return b._layer!==d._layer?b._layer-d._layer:b._passes.length!==d._passes.length?b._passes.length-
d._passes.length:a.sortKey-c.sortKey})},f.prototype._shadowStage=function(a,c){this._submitShadowStageUniforms(a);for(a=0;a<c.length;++a){var b=c.data[a];this._programLib._getValueFromDefineList("CC_SHADOW_CASTING",b.defines)&&(this._updateShaderDefines(b),this._draw(b))}},f.prototype._drawItems=function(a,c){a=this._shadowLights;if(0===a.length&&0===this._numLights)for(a=0;a<c.length;++a){var b=c.data[a];this._updateShaderDefines(b);this._draw(b)}else for(b=0;b<c.length;++b){var d=c.data[b];this._shadowMaps.length=
a.length;for(var e=0;e<a.length;++e)this._shadowMaps[e]=a[e].shadowMap,this._shadowMapSlots[e]=this._allocTextureUnit();this._device.setTextureArray("cc_shadow_map",this._shadowMaps,this._shadowMapSlots);this._updateShaderDefines(d);this._draw(d)}},f.prototype._opaqueStage=function(a,b){a.getPosition(p);this._device.setUniform("cc_matView",d.mat4.array(c,a._matView));this._device.setUniform("cc_matpProj",d.mat4.array(g,a._matProj));this._device.setUniform("cc_matViewProj",d.mat4.array(k,a._matViewProj));
this._device.setUniform("cc_cameraPos",d.vec4.array(l,p));this._submitLightsUniforms();this._submitOtherStagesUniforms();this._drawItems(a,b)},f.prototype._transparentStage=function(a,b){a.getPosition(p);a.getForward(v);this._device.setUniform("cc_matView",d.mat4.array(c,a._matView));this._device.setUniform("cc_matpProj",d.mat4.array(g,a._matProj));this._device.setUniform("cc_matViewProj",d.mat4.array(k,a._matViewProj));this._device.setUniform("cc_cameraPos",d.vec4.array(l,p));this._submitLightsUniforms();
this._submitOtherStagesUniforms();for(var e=0;e<b.length;++e){var f=b.data[e];f.node.getWorldPosition(w);d.vec3.sub(w,w,p);f.sortKey=-d.vec3.dot(w,v)}this._sortItems(b);this._drawItems(a,b)},f}(b.default);m.default=b;n.exports=m.default},{"../../core/vmath":246,"../core/base-renderer":268,"../enums":275,"../memop":292}],300:[function(f,n,m){function h(a){return a&&a.__esModule?a:{default:a}}m.__esModule=!0;m.default=void 0;var e=function(){function a(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=
d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(c,b,d){return b&&a(c.prototype,b),d&&a(c,d),c}}(),d=f("../../core/vmath"),b=h(f("../../core/geom-utils")),a=h(f("../enums")),c=d.mat4.create(),g=d.mat4.create(),k=d.mat4.create(),l=d.mat4.create(),q=d.mat4.create(),r=cc.v3(),t=cc.v3();f=function(){function f(){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this._poolID=-1;this._node=null;this._projection=
a.default.PROJ_PERSPECTIVE;this._priority=0;this._color=d.color4.create(.2,.3,.47,1);this._depth=1;this._stencil=0;this._clearFlags=a.default.CLEAR_COLOR|a.default.CLEAR_DEPTH;this._clearModel=null;this._stages=[];this._framebuffer=null;this._near=.01;this._far=1E3;this._fov=Math.PI/4;this._rect={x:0,y:0,w:1,h:1};this._orthoHeight=10;this._cullingMask=4294967295}return f.prototype.setCullingMask=function(a){this._cullingMask=a},f.prototype.getNode=function(){return this._node},f.prototype.setNode=
function(a){this._node=a},f.prototype.getType=function(){return this._projection},f.prototype.setType=function(a){this._projection=a},f.prototype.getPriority=function(){return this._priority},f.prototype.setPriority=function(a){this._priority=a},f.prototype.getOrthoHeight=function(){return this._orthoHeight},f.prototype.setOrthoHeight=function(a){this._orthoHeight=a},f.prototype.getFov=function(){return this._fov},f.prototype.setFov=function(a){this._fov=a},f.prototype.getNear=function(){return this._near},
f.prototype.setNear=function(a){this._near=a},f.prototype.getFar=function(){return this._far},f.prototype.setFar=function(a){this._far=a},f.prototype.getColor=function(a){return d.color4.copy(a,this._color)},f.prototype.setColor=function(a,c,b,e){d.color4.set(this._color,a,c,b,e)},f.prototype.getDepth=function(){return this._depth},f.prototype.setDepth=function(a){this._depth=a},f.prototype.getStencil=function(){return this._stencil},f.prototype.setStencil=function(a){this._stencil=a},f.prototype.getClearFlags=
function(){return this._clearFlags},f.prototype.setClearFlags=function(a){this._clearFlags=a},f.prototype.getRect=function(a){return a.x=this._rect.x,a.y=this._rect.y,a.w=this._rect.w,a.h=this._rect.h,a},f.prototype.setRect=function(a,c,b,d){this._rect.x=a;this._rect.y=c;this._rect.w=b;this._rect.h=d},f.prototype.getStages=function(){return this._stages},f.prototype.setStages=function(a){this._stages=a},f.prototype.getFramebuffer=function(){return this._framebuffer},f.prototype.setFrameBuffer=function(a){this._framebuffer=
a},f.prototype._calcMatrices=function(c,b){this._node.getWorldRT(g);d.mat4.invert(g,g);c/=b;this._projection===a.default.PROJ_PERSPECTIVE?d.mat4.perspective(k,this._fov,c,this._near,this._far):(c*=this._orthoHeight,b=this._orthoHeight,d.mat4.ortho(k,-c,c,-b,b,this._near,this._far));d.mat4.mul(l,k,g);d.mat4.invert(q,l)},f.prototype.extractView=function(a,c,b){this._framebuffer&&(c=this._framebuffer._width,b=this._framebuffer._height);a._priority=this._priority;a._rect.x=this._rect.x*c;a._rect.y=this._rect.y*
b;a._rect.w=this._rect.w*c;a._rect.h=this._rect.h*b;this.getColor(a._color);a._depth=this._depth;a._stencil=this._stencil;a._clearFlags=this._clearFlags;a._clearModel=this._clearModel;a._stages=this._stages;a._framebuffer=this._framebuffer;this._calcMatrices(c,b);d.mat4.copy(a._matView,g);d.mat4.copy(a._matProj,k);d.mat4.copy(a._matViewProj,l);d.mat4.copy(a._matInvViewProj,q);a._cullingMask=this._cullingMask},f.prototype.screenPointToRay=function(c,e,f,g,k){if(!b.default)return k;k=k||b.default.Ray.create();
this._calcMatrices(f,g);var l=this._rect.x*f,h=this._rect.y*g;f*=this._rect.w;g*=this._rect.h;return d.vec3.set(t,(c-l)/f*2-1,(e-h)/g*2-1,1),d.vec3.transformMat4(t,t,q),this._projection===a.default.PROJ_PERSPECTIVE?this._node.getWorldPosition(r):(d.vec3.set(r,(c-l)/f*2-1,(e-h)/g*2-1,-1),d.vec3.transformMat4(r,r,q)),b.default.Ray.fromPoints(k,r,t)},f.prototype.screenToWorld=function(c,b,e,f){this._calcMatrices(e,f);var g=this._rect.x*e,k=this._rect.y*f;e*=this._rect.w;f*=this._rect.h;return this._projection===
a.default.PROJ_PERSPECTIVE?(d.vec3.set(c,(b.x-g)/e*2-1,(b.y-k)/f*2-1,.9999),d.vec3.transformMat4(c,c,q),this._node.getWorldPosition(r),d.vec3.lerp(c,r,c,(0,d.lerp)(this._near/this._far,1,b.z))):(d.vec3.set(c,(b.x-g)/e*2-1,(b.y-k)/f*2-1,2*b.z-1),d.vec3.transformMat4(c,c,q)),c},f.prototype.worldToScreen=function(a,c,b,e){this._calcMatrices(b,e);var f=this._rect.x*b,g=this._rect.y*e;b*=this._rect.w;e*=this._rect.h;return d.vec3.transformMat4(a,c,l),a.x=f+.5*(a.x+1)*b,a.y=g+.5*(a.y+1)*e,a.z=.5*a.z+.5,
a},f.prototype.worldMatrixToScreen=function(a,b,e,f){this._calcMatrices(e,f);d.mat4.mul(a,l,b);b=e/2;f/=2;return d.mat4.identity(c),d.mat4.translate(c,c,d.vec3.set(r,b,f,0)),d.mat4.scale(c,c,d.vec3.set(r,b,f,1)),d.mat4.mul(a,c,a),a},e(f,[{key:"cullingMask",get:function(){return this._cullingMask},set:function(a){this._cullingMask=a}}]),f}();m.default=f;n.exports=m.default},{"../../core/geom-utils":void 0,"../../core/vmath":246,"../enums":275}],301:[function(f,n,m){m.__esModule=!0;f=function(){function f(){if(!(this instanceof
f))throw new TypeError("Cannot call a class as a function");this._type="default";this._poolID=-1;this._effect=this._inputAssembler=this._node=null;this._userKey=this._cameraID=this._viewID=-1;this._castShadow=!1;this._boundingShape=null;this._defines=[];this._uniforms=[]}return f.prototype.setNode=function(e){this._node=e},f.prototype.setInputAssembler=function(e){this._inputAssembler=e},f.prototype.setEffect=function(e,d){this._effect=e;var b=this._defines,a=this._uniforms;b.length=0;a.length=0;
e&&(b.push(e._defines),a.push(e._properties));d&&(b.push(d._defines),a.push(d._properties))},f.prototype.setUserKey=function(e){this._userKey=e},f.prototype.extractDrawItem=function(e){e.model=this;e.node=this._node;e.ia=this._inputAssembler;e.effect=this._effect;e.defines=this._defines;e.dependencies=this._dependencies;e.uniforms=this._uniforms},f}();m.default=f;n.exports=m.default},{}],302:[function(f,n,m){m.__esModule=!0;var h=f("../memop");f=function(){function e(d){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");
this._lights=new h.FixedArray(16);this._models=new h.FixedArray(16);this._cameras=new h.FixedArray(16);this._debugCamera=null;this._app=d;this._views=[]}return e.prototype._add=function(d,b){-1===b._poolID&&(d.push(b),b._poolID=d.length-1)},e.prototype._remove=function(d,b){-1!==b._poolID&&(d.data[d.length-1]._poolID=b._poolID,d.fastRemove(b._poolID),b._poolID=-1)},e.prototype.reset=function(){for(var d=0;d<this._models.length;++d)this._models.data[d]._viewID=-1},e.prototype.setDebugCamera=function(d){this._debugCamera=
d},e.prototype.getCameraCount=function(){return this._cameras.length},e.prototype.getCamera=function(d){return this._cameras.data[d]},e.prototype.addCamera=function(d){this._add(this._cameras,d)},e.prototype.removeCamera=function(d){this._remove(this._cameras,d)},e.prototype.getModelCount=function(){return this._models.length},e.prototype.getModel=function(d){return this._models.data[d]},e.prototype.addModel=function(d){this._add(this._models,d)},e.prototype.removeModel=function(d){this._remove(this._models,
d)},e.prototype.getLightCount=function(){return this._lights.length},e.prototype.getLight=function(d){return this._lights.data[d]},e.prototype.addLight=function(d){this._add(this._lights,d)},e.prototype.removeLight=function(d){this._remove(this._lights,d)},e.prototype.addView=function(d){-1===this._views.indexOf(d)&&this._views.push(d)},e.prototype.removeView=function(d){d=this._views.indexOf(d);-1!==d&&this._views.splice(d,1)},e}();m.default=f;n.exports=m.default},{"../memop":292}],303:[function(f,
n,m){function h(a){return a&&a.__esModule?a:{default:a}}var e,d,b,a;m.__esModule=!0;m.getClassName=m.getInstanceCtor=m.getInstanceType=m.enums2default=m.ctor2enums=void 0;m.getInspectorProps=function(a){var c={type:a.type};Object.assign(c,a.inspector);c.defines=a.defines;c.value=t(c.type)(a.value);a=p(c.type);c.typeName=v[a]||a;"cc.Texture2D"==c.typeName&&(c.typeName="cc.Asset",c.assetType="cc.Texture2D");return c};n=h(f("./enums"));var c=f("../core/value-types"),g=h(f("../core/assets/CCTexture2D")),
k=null;k=f("./gfx/texture-2d");f=cc.Object;var l=((e={})[Boolean]=function(a){return a||!1},e[Number]=function(a){return a?ArrayBuffer.isView(a)?a[0]:a:0},e[c.Vec2]=function(a){return a?cc.v2(a[0],a[1]):cc.v2()},e[c.Vec3]=function(a){return a?cc.v3(a[0],a[1],a[2]):cc.v3()},e[c.Vec4]=function(a){return a?cc.v4(a[0],a[1],a[2],a[3]):cc.v4()},e[c.Color]=function(a){return a?cc.color(255*a[0],255*a[1],255*a[2],255*(a[3]||1)):cc.color()},e[c.Mat4]=function(a){return a?cc.mat4(a[0],a[1],a[2],a[3],a[4],a[5],
a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]):cc.mat4()},e[g.default]=function(){return null},e[f]=function(){return null},e),q=((d={})[n.default.PARAM_INT]=Number,d[n.default.PARAM_INT2]=c.Vec2,d[n.default.PARAM_INT3]=c.Vec3,d[n.default.PARAM_INT4]=c.Vec4,d[n.default.PARAM_FLOAT]=Number,d[n.default.PARAM_FLOAT2]=c.Vec2,d[n.default.PARAM_FLOAT3]=c.Vec3,d[n.default.PARAM_FLOAT4]=c.Vec4,d[n.default.PARAM_MAT4]=c.Mat4,d[n.default.PARAM_TEXTURE_2D]=g.default,d.color=c.Color,d.number=Number,
d.boolean=Boolean,d.default=f,d),r=(m.ctor2enums=((b={})[Number]=n.default.PARAM_FLOAT,b[c.Vec2]=n.default.PARAM_FLOAT2,b[c.Vec3]=n.default.PARAM_FLOAT3,b[c.Vec4]=n.default.PARAM_FLOAT4,b[c.Color]=n.default.PARAM_COLOR3,b[c.Color]=n.default.PARAM_COLOR4,b[c.Mat4]=n.default.PARAM_MAT4,b[g.default]=n.default.PARAM_TEXTURE_2D,b[k]=n.default.PARAM_TEXTURE_2D,b),m.enums2default=((a={})[n.default.PARAM_INT]=new Uint32Array([0]),a[n.default.PARAM_INT2]=new Uint32Array([0,0]),a[n.default.PARAM_INT3]=new Uint32Array([0,
0,0]),a[n.default.PARAM_INT4]=new Uint32Array([0,0,0,0]),a[n.default.PARAM_FLOAT]=new Float32Array([0]),a[n.default.PARAM_FLOAT2]=new Float32Array([0,0]),a[n.default.PARAM_FLOAT3]=new Float32Array([0,0,0]),a[n.default.PARAM_FLOAT4]=new Float32Array([0,0,0,0]),a[n.default.PARAM_MAT4]=cc.mat4().m,a[n.default.PARAM_TEXTURE_2D]=null,a.number=0,a.boolean=!1,a),m.getInstanceType=function(a){return q[a]||q.default}),t=m.getInstanceCtor=function(a){return l[r(a)]},p=m.getClassName=function(a){return cc.js.getClassName(r(a))},
v={Number:"number",Boolean:"boolean"}},{"../core/assets/CCTexture2D":51,"../core/value-types":235,"./enums":275,"./gfx/texture-2d":285}],304:[function(f,n,m){f=cc.Class({name:"cc.TiledMapAsset",extends:cc.Asset,properties:{tmxXmlStr:"",textures:{default:[],type:[cc.Texture2D]},textureNames:[cc.String],imageLayerTextures:{default:[],type:[cc.Texture2D]},imageLayerTextureNames:[cc.String],tsxFiles:[cc.TextAsset],tsxFileNames:[cc.String]},statics:{preventDeferredLoadDependents:!0},createNode:!1});cc.TiledMapAsset=
f;n.exports=f},{}],305:[function(f,n,m){f("./cocos2d/core");f("./cocos2d/animation");f("./cocos2d/particle");f("./cocos2d/tilemap");f("./cocos2d/videoplayer/CCVideoPlayer");f("./cocos2d/webview/CCWebView");f("./cocos2d/core/components/CCStudioComponent");f("./extensions/ccpool/CCNodePool");f("./cocos2d/actions");f("./extensions/spine");f("./extensions/dragonbones");f("./cocos2d/deprecated")},{"./cocos2d/actions":7,"./cocos2d/animation":16,"./cocos2d/core":107,"./cocos2d/core/components/CCStudioComponent":80,
"./cocos2d/deprecated":257,"./cocos2d/particle":263,"./cocos2d/particle/CCParticleAsset":260,"./cocos2d/tilemap":void 0,"./cocos2d/tilemap/CCTiledMapAsset":304,"./cocos2d/videoplayer/CCVideoPlayer":void 0,"./cocos2d/webview/CCWebView":void 0,"./extensions/ccpool/CCNodePool":306,"./extensions/dragonbones":void 0,"./extensions/spine":308}],306:[function(f,n,m){cc.NodePool=function(f){this.poolHandlerComp=f;this._pool=[]};cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return this._pool.length},
clear:function(){for(var f=this._pool.length,e=0;e<f;++e)this._pool[e].destroy();this._pool.length=0},put:function(f){if(f&&-1===this._pool.indexOf(f)){f.removeFromParent(!1);var e=this.poolHandlerComp?f.getComponent(this.poolHandlerComp):null;e&&e.unuse&&e.unuse();this._pool.push(f)}},get:function(){var f=this._pool.length-1;if(0>f)return null;var e=this._pool[f];this._pool.length=f;f=this.poolHandlerComp?e.getComponent(this.poolHandlerComp):null;return f&&f.reuse&&f.reuse.apply(f,arguments),e}};
n.exports=cc.NodePool},{}],307:[function(f,n,m){var h=f("./track-entry-listeners");m=f("../../cocos2d/core/components/CCRenderComponent");var e=f("./lib/spine"),d=f("../../cocos2d/core/assets/material/CCMaterial"),b=f("../../cocos2d/core/graphics/graphics"),a=f("./skeleton-cache");f=cc.Enum({default:-1});var c=cc.Enum({"<None>":0}),g=cc.Enum({REALTIME:0,SHARED_CACHE:1,PRIVATE_CACHE:2});sp.Skeleton=cc.Class({name:"sp.Skeleton",extends:m,editor:!1,statics:{AnimationCacheMode:g},properties:{paused:{default:!1,
visible:!1},skeletonData:{default:null,type:sp.SkeletonData,notify:function(){this.defaultAnimation=this.defaultSkin="";this._updateSkeletonData()},tooltip:!1},defaultSkin:{default:"",visible:!1},defaultAnimation:{default:"",visible:!1},animation:{get:function(){if(this.isAnimationCached())return this._animationName;var a=this.getCurrent(0);return a&&a.animation.name||""},set:function(a){(this.defaultAnimation=a)?this.setAnimation(0,a,this.loop):this.isAnimationCached()||(this.clearTrack(0),this.setToSetupPose())},
visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData&&this.defaultSkin){var a=this.skeletonData.getSkinsEnum();if(a&&(a=a[this.defaultSkin],void 0!==a))return a}return 0},set:function(a){var c;if(this.skeletonData&&(c=this.skeletonData.getSkinsEnum()),!c)return cc.errorID("",this.name);a=c[a];void 0!==a?(this.defaultSkin=a,this.setSkin(this.defaultSkin)):cc.errorID(7501,this.name)},type:f,visible:!0,displayName:"Default Skin",tooltip:!1},_animationIndex:{get:function(){var a=this.animation;
if(this.skeletonData&&a){var c=this.skeletonData.getAnimsEnum();if(c&&(a=c[a],void 0!==a))return a}return 0},set:function(a){if(0!==a){var c;if(this.skeletonData&&(c=this.skeletonData.getAnimsEnum()),!c)return cc.errorID(7502,this.name);a=c[a];void 0!==a?this.animation=a:cc.errorID(7503,this.name)}else this.animation=""},type:c,visible:!0,displayName:"Animation",tooltip:!1},_preCacheMode:-1,_cacheMode:g.REALTIME,_defaultCacheMode:{default:0,type:g,notify:function(){this.setAnimationCacheMode(this._defaultCacheMode)},
editorOnly:!0,visible:!0,animatable:!1,displayName:"Animation Cache Mode",tooltip:!1},loop:{default:!0,tooltip:!1},premultipliedAlpha:{default:!0,tooltip:!1},timeScale:{default:1,tooltip:!1},debugSlots:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},debugBones:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},debugMesh:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},useTint:{default:!1,tooltip:!1,notify:function(){this._updateUseTint()}},
enableBatch:{default:!1,notify:function(){this._updateBatch()},tooltip:!1},_accTime:0,_playCount:0,_frameCache:null,_curFrame:null,_skeletonCache:null,_animationName:"",_animationQueue:[],_headAniInfo:null,_playTimes:0,_isAniComplete:!0},ctor:function(){this._listener=this._rootBone=this._skeleton=this._effectDelegate=null;this._boundingBox=cc.rect();this._materialCache={};this._debugRenderer=null;this._endSlotIndex=this._startSlotIndex=-1;this._startEntry={animation:{name:""},trackIndex:0};this._endEntry=
{animation:{name:""},trackIndex:0}},setMaterial:function(a,c){this._super(a,c);this._materialCache={}},_updateUseTint:function(){var a=this.getMaterial(0),c=this.useTint||this.isAnimationCached();a&&a.define("USE_TINT",c);a=this._materialCache;for(var b in a){var d=a[b];d&&d.define("USE_TINT",c)}},_updateBatch:function(){var a=this.getMaterial(0);a&&a.define("CC_USE_MODEL",!this.enableBatch);a=this._materialCache;for(var c in a){var b=a[c];b&&b.define("CC_USE_MODEL",!this.enableBatch)}},setSkeletonData:function(c){(null!=
c.width&&null!=c.height&&this.node.setContentSize(c.width,c.height),this._cacheMode===g.SHARED_CACHE?this._skeletonCache=a.sharedCache:this._cacheMode===g.PRIVATE_CACHE&&(this._skeletonCache=new a),this.isAnimationCached())?((this.debugBones||this.debugSlots)&&cc.warn("Debug bones or slots is invalid in cached mode"),c=this._skeletonCache.getSkeletonCache(this.skeletonData._uuid,c),this._skeleton=c.skeleton,this._clipper=c.clipper):(this._skeleton=new e.Skeleton(c),this._clipper=new e.SkeletonClipping);
this._rootBone=this._skeleton.getRootBone();this._activateMaterial()},setSlotsRange:function(a,c){this.isAnimationCached()?cc.warn("Slots visible range can not be modified in cached mode."):(this._startSlotIndex=a,this._endSlotIndex=c)},setAnimationStateData:function(a){this.isAnimationCached()?cc.warn("'setAnimationStateData' interface can not be invoked in cached mode."):(a=new e.AnimationState(a),this._listener&&(this._state&&this._state.removeListener(this._listener),a.addListener(this._listener)),
this._state=a)},__preload:function(){for(var a=this.node.children,c=0,b=a.length;c<b;c++){var d=a[c];d&&"DEBUG_DRAW_NODE"===d._name&&d.destroy()}this._resetAssembler();this._updateSkeletonData();this._updateDebugDraw();this._updateUseTint();this._updateBatch()},setAnimationCacheMode:function(a){this._preCacheMode!==a&&(this._cacheMode=a,this._updateSkeletonData(),this._updateUseTint())},isAnimationCached:function(){return this._cacheMode!==g.REALTIME},update:function(a){if(!this.paused)if(a*=this.timeScale*
sp.timeScale,this.isAnimationCached())if(this._isAniComplete)if(0===this._animationQueue.length&&!this._headAniInfo)(a=this._frameCache)&&a.isInvalid()&&(a.updateToFrame(),a=a.frames,this._curFrame=a[a.length-1]);else{if(this._headAniInfo||(this._headAniInfo=this._animationQueue.shift()),this._accTime+=a,this._accTime>this._headAniInfo.delay)a=this._headAniInfo,this._headAniInfo=null,this.setAnimation(0,a.animationName,a.loop)}else this._updateCache(a);else this._updateRealtime(a)},_emitCacheCompleteEvent:function(){this._listener&&
(this._endEntry.animation.name=this._animationName,this._listener.complete&&this._listener.complete(this._endEntry),this._listener.end&&this._listener.end(this._endEntry))},_updateCache:function(c){var b=this._frameCache;if(b.isInited()){var d=b.frames,e=a.FrameTime;0==this._accTime&&0==this._playCount&&(this._startEntry.animation.name=this._animationName,this._listener&&this._listener.start&&this._listener.start(this._startEntry));this._accTime+=c;c=Math.floor(this._accTime/e);if(b.isCompleted||
b.updateToFrame(c),b.isCompleted&&c>=d.length){if(this._playCount++,0<this._playTimes&&this._playCount>=this._playTimes)return this._curFrame=d[d.length-1],this._accTime=0,this._playCount=0,this._isAniComplete=!0,void this._emitCacheCompleteEvent();c=this._accTime=0;this._emitCacheCompleteEvent()}this._curFrame=d[c]}},_updateRealtime:function(a){var c=this._skeleton,b=this._state;c&&(c.update(a),b&&(b.update(a),b.apply(c)))},_activateMaterial:function(){this.skeletonData?this.skeletonData.ensureTexturesLoaded(function(a){a?
(a=this.sharedMaterials[0],(a=a?d.getInstantiatedMaterial(a,this):d.getInstantiatedBuiltinMaterial("2d-spine",this)).define("CC_USE_MODEL",!0),this._prepareToRender(a)):this.disableRender()},this):this.disableRender()},_prepareToRender:function(a){this.setMaterial(0,a);this.node&&this.node._renderComponent==this&&this.markForRender(!0)},onEnable:function(){this._super();this._activateMaterial()},onRestore:function(){this._boundingBox=cc.rect()},setVertexEffectDelegate:function(a){this._effectDelegate=
a},updateWorldTransform:function(){this.isAnimationCached()&&this._skeleton&&this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton&&this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton&&this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton&&this._skeleton.setSlotsToSetupPose()},updateAnimationCache:function(a){if(this.isAnimationCached()){var c=this.skeletonData._uuid;this._skeletonCache&&this._skeletonCache.updateAnimationCache(c,
a)}},invalidAnimationCache:function(){this.isAnimationCached()&&this._skeletonCache&&this._skeletonCache.invalidAnimationCache(this.skeletonData._uuid)},findBone:function(a){return this._skeleton?this._skeleton.findBone(a):null},findSlot:function(a){return this._skeleton?this._skeleton.findSlot(a):null},setSkin:function(a){this._skeleton&&(this._skeleton.setSkinByName(a),this._skeleton.setSlotsToSetupPose());this.invalidAnimationCache()},getAttachment:function(a,c){return this._skeleton?this._skeleton.getAttachmentByName(a,
c):null},setAttachment:function(a,c){this._skeleton&&this._skeleton.setAttachment(a,c);this.invalidAnimationCache()},getTextureAtlas:function(a){return a.region},setMix:function(a,c,b){this._state&&this._state.data.setMix(a,c,b)},setAnimation:function(a,c,b){if(this._playTimes=b?0:1,this._animationName=c,this.isAnimationCached()){if(0!==a&&cc.warn("Track index can not greater than 0 in cached mode."),!this._skeletonCache)return null;(a=this._skeletonCache.getAnimationCache(this.skeletonData._uuid,
c))||(a=this._skeletonCache.initAnimationCache(this.skeletonData._uuid,c));a&&(this._isAniComplete=!1,this._accTime=0,this._playCount=0,this._frameCache=a,this._frameCache.updateToFrame(0),this._curFrame=this._frameCache.frames[0])}else if(this._skeleton){var d=this._skeleton.data.findAnimation(c);if(!d)return cc.logID(7509,c),null;c=this._state.setAnimationWith(a,d,b);return this._state.apply(this._skeleton),c}return null},addAnimation:function(a,c,b,d){if(d=d||0,this.isAnimationCached())0!==a&&
cc.warn("Track index can not greater than 0 in cached mode."),this._animationQueue.push({animationName:c,loop:b,delay:d});else if(this._skeleton){var e=this._skeleton.data.findAnimation(c);return e?this._state.addAnimationWith(a,e,b,d):(cc.logID(7510,c),null)}return null},findAnimation:function(a){return this._skeleton?this._skeleton.data.findAnimation(a):null},getCurrent:function(a){if(this.isAnimationCached())cc.warn("'getCurrent' interface can not be invoked in cached mode.");else if(this._state)return this._state.getCurrent(a);
return null},clearTracks:function(){this.isAnimationCached()?cc.warn("'clearTracks' interface can not be invoked in cached mode."):this._state&&this._state.clearTracks()},clearTrack:function(a){this.isAnimationCached()?cc.warn("'clearTrack' interface can not be invoked in cached mode."):this._state&&this._state.clearTrack(a)},setStartListener:function(a){this._ensureListener();this._listener.start=a},setInterruptListener:function(a){this._ensureListener();this._listener.interrupt=a},setEndListener:function(a){this._ensureListener();
this._listener.end=a},setDisposeListener:function(a){this._ensureListener();this._listener.dispose=a},setCompleteListener:function(a){this._ensureListener();this._listener.complete=a},setEventListener:function(a){this._ensureListener();this._listener.event=a},setTrackStartListener:function(a,c){h.getListeners(a).start=c},setTrackInterruptListener:function(a,c){h.getListeners(a).interrupt=c},setTrackEndListener:function(a,c){h.getListeners(a).end=c},setTrackDisposeListener:function(a,c){h.getListeners(a).dispose=
c},setTrackCompleteListener:function(a,c){h.getListeners(a).complete=function(a){c(a,Math.floor(a.trackTime/a.animationEnd))}},setTrackEventListener:function(a,c){h.getListeners(a).event=c},getState:function(){return this._state},_updateAnimEnum:!1,_updateSkinEnum:!1,_ensureListener:function(){this._listener||(this._listener=new h,this._state&&this._state.addListener(this._listener))},_updateSkeletonData:function(){if(this.skeletonData){var a=this.skeletonData.getRuntimeData();if(a){try{this.setSkeletonData(a),
this.isAnimationCached()||this.setAnimationStateData(new e.AnimationStateData(this._skeleton.data)),this.defaultSkin&&this.setSkin(this.defaultSkin)}catch(l){cc.warn(l)}this._preCacheMode=this._cacheMode;this.animation=this.defaultAnimation}}},_refreshInspector:function(){this._updateAnimEnum();this._updateSkinEnum();Editor.Utils.refreshSelectedInspector("node",this.node.uuid)},_updateDebugDraw:function(){if(this.debugBones||this.debugSlots){if(!this._debugRenderer){var a=new cc.PrivateNode;a.name=
"DEBUG_DRAW_NODE";a=a.addComponent(b);a.lineWidth=1;a.strokeColor=cc.color(255,0,0,255);this._debugRenderer=a}this._debugRenderer.node.parent=this.node;this.isAnimationCached()&&cc.warn("Debug bones or slots is invalid in cached mode")}else this._debugRenderer&&(this._debugRenderer.node.parent=null)}});n.exports=sp.Skeleton},{"../../cocos2d/core/assets/material/CCMaterial":53,"../../cocos2d/core/components/CCRenderComponent":74,"../../cocos2d/core/graphics/graphics":103,"./lib/spine":309,"./skeleton-cache":310,
"./track-entry-listeners":314}],308:[function(f,n,m){("undefined"==typeof window?global:window).sp={};sp._timeScale=1;Object.defineProperty(sp,"timeScale",{get:function(){return this._timeScale},set:function(f){this._timeScale=f},configurable:!0});sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3};sp.AnimationEventType=cc.Enum({START:0,INTERRUPT:1,END:2,DISPOSE:3,COMPLETE:4,EVENT:5});sp.spine=f("./lib/spine");f("./skeleton-texture");f("./skeleton-data");f("./vertex-effect-delegate");
f("./Skeleton");f("./spine-assembler")},{"./Skeleton":307,"./lib/spine":309,"./skeleton-data":311,"./skeleton-texture":312,"./spine-assembler":313,"./vertex-effect-delegate":315}],309:[function(f,n,m){var h,e=function(){var d=function(b,a){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,a)};return function(b,a){function c(){this.constructor=b}d(b,a);b.prototype=null===a?Object.create(a):
(c.prototype=a.prototype,new c)}}();(function(d){var b,a,c,f=function(){function a(a,c,b){if(null==a)throw Error("name cannot be null.");if(null==c)throw Error("timelines cannot be null.");this.name=a;this.timelines=c;this.duration=b}return a.prototype.apply=function(a,c,b,d,e,f,g,k){if(null==a)throw Error("skeleton cannot be null.");d&&0!=this.duration&&(b%=this.duration,0<c&&(c%=this.duration));d=this.timelines;for(var l=0,h=d.length;l<h;l++)d[l].apply(a,c,b,e,f,g,k)},a.binarySearch=function(a,
c,b){void 0===b&&(b=1);var d=0,e=a.length/b-2;if(0==e)return b;for(var f=e>>>1;;){if(a[(f+1)*b]<=c?d=f+1:e=f,d==e)return(d+1)*b;f=d+e>>>1}},a.linearSearch=function(a,c,b){for(var d=0,e=a.length-b;d<=e;d+=b)if(a[d]>c)return d;return-1},a}();d.Animation=f;(function(a){a[a.setup=0]="setup";a[a.current=1]="current";a[a.currentLayered=2]="currentLayered"})(b=d.MixPose||(d.MixPose={}));(function(a){a[a.in=0]="in";a[a.out=1]="out"})(a=d.MixDirection||(d.MixDirection={}));(function(a){a[a.rotate=0]="rotate";
a[a.translate=1]="translate";a[a.scale=2]="scale";a[a.shear=3]="shear";a[a.attachment=4]="attachment";a[a.color=5]="color";a[a.deform=6]="deform";a[a.event=7]="event";a[a.drawOrder=8]="drawOrder";a[a.ikConstraint=9]="ikConstraint";a[a.transformConstraint=10]="transformConstraint";a[a.pathConstraintPosition=11]="pathConstraintPosition";a[a.pathConstraintSpacing=12]="pathConstraintSpacing";a[a.pathConstraintMix=13]="pathConstraintMix";a[a.twoColor=14]="twoColor"})(c=d.TimelineType||(d.TimelineType=
{}));var k=function(){function a(c){if(0>=c)throw Error("frameCount must be > 0: "+c);this.curves=d.Utils.newFloatArray((c-1)*a.BEZIER_SIZE)}return a.prototype.getFrameCount=function(){return this.curves.length/a.BEZIER_SIZE+1},a.prototype.setLinear=function(c){this.curves[c*a.BEZIER_SIZE]=a.LINEAR},a.prototype.setStepped=function(c){this.curves[c*a.BEZIER_SIZE]=a.STEPPED},a.prototype.getCurveType=function(c){c*=a.BEZIER_SIZE;if(c==this.curves.length)return a.LINEAR;c=this.curves[c];return c==a.LINEAR?
a.LINEAR:c==a.STEPPED?a.STEPPED:a.BEZIER},a.prototype.setCurve=function(c,b,d,e,f){var g=.03*(2*-b+e),k=.03*(2*-d+f);e=.006*(3*(b-e)+1);f=.006*(3*(d-f)+1);var l=2*g+e,h=2*k+f;b=.3*b+g+.16666667*e;d=.3*d+k+.16666667*f;c*=a.BEZIER_SIZE;k=this.curves;k[c++]=a.BEZIER;g=b;for(var p=d,q=c+a.BEZIER_SIZE-1;c<q;c+=2)k[c]=g,k[c+1]=p,b+=l,d+=h,l+=e,h+=f,g+=b,p+=d},a.prototype.getCurvePercent=function(c,b){b=d.MathUtils.clamp(b,0,1);var e=this.curves;c*=a.BEZIER_SIZE;var f=e[c];if(f==a.LINEAR)return b;if(f==
a.STEPPED)return 0;f=0;for(var g=++c,k=c+a.BEZIER_SIZE-1;c<k;c+=2)if((f=e[c])>=b){var l=k=void 0;return c==g?(k=0,l=0):(k=e[c-2],l=e[c-1]),l+(e[c+1]-l)*(b-k)/(f-k)}e=e[c-1];return e+(1-e)*(b-f)/(1-f)},a.LINEAR=0,a.STEPPED=1,a.BEZIER=2,a.BEZIER_SIZE=19,a}();d.CurveTimeline=k;var l=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c<<1),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.rotate<<24)+this.boneIndex},g.prototype.setFrame=function(a,c,
b){a<<=1;this.frames[a]=c;this.frames[a+g.ROTATION]=b},g.prototype.apply=function(a,c,d,e,k,l,h){c=this.frames;a=a.bones[this.boneIndex];if(d<c[0])switch(l){case b.setup:return void(a.rotation=a.data.rotation);case b.current:l=a.data.rotation-a.rotation,a.rotation+=(l-360*(16384-(16384.499999999996-l/360|0)))*k}else if(d>=c[c.length-g.ENTRIES])l==b.setup?a.rotation=a.data.rotation+c[c.length+g.PREV_ROTATION]*k:(l=a.data.rotation+c[c.length+g.PREV_ROTATION]-a.rotation,a.rotation+=(l-360*(16384-(16384.499999999996-
l/360|0)))*k);else{h=f.binarySearch(c,d,g.ENTRIES);e=c[h+g.PREV_ROTATION];var p=c[h];d=this.getCurvePercent((h>>1)-1,1-(d-p)/(c[h+g.PREV_TIME]-p));c=c[h+g.ROTATION]-e;c=e+(c-=360*(16384-(16384.499999999996-c/360|0)))*d;l==b.setup?(c-=360*(16384-(16384.499999999996-c/360|0)),a.rotation=a.data.rotation+c*k):(c=a.data.rotation+c-a.rotation,c-=360*(16384-(16384.499999999996-c/360|0)),a.rotation+=c*k)}},g.ENTRIES=2,g.PREV_TIME=-2,g.PREV_ROTATION=-1,g.ROTATION=1,g}(k);d.RotateTimeline=l;l=function(a){function g(c){var b=
a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c*g.ENTRIES),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.translate<<24)+this.boneIndex},g.prototype.setFrame=function(a,c,b,d){a*=g.ENTRIES;this.frames[a]=c;this.frames[a+g.X]=b;this.frames[a+g.Y]=d},g.prototype.apply=function(a,c,d,e,k,l,h){c=this.frames;a=a.bones[this.boneIndex];if(d<c[0])switch(l){case b.setup:return a.x=a.data.x,void(a.y=a.data.y);case b.current:a.x+=(a.data.x-a.x)*k,a.y+=(a.data.y-a.y)*k}else{if(d>=
c[c.length-g.ENTRIES])e=c[c.length+g.PREV_X],h=c[c.length+g.PREV_Y];else{var p=f.binarySearch(c,d,g.ENTRIES);e=c[p+g.PREV_X];h=c[p+g.PREV_Y];var q=c[p];d=this.getCurvePercent(p/g.ENTRIES-1,1-(d-q)/(c[p+g.PREV_TIME]-q));e+=(c[p+g.X]-e)*d;h+=(c[p+g.Y]-h)*d}l==b.setup?(a.x=a.data.x+e*k,a.y=a.data.y+h*k):(a.x+=(a.data.x+e-a.x)*k,a.y+=(a.data.y+h-a.y)*k)}},g.ENTRIES=3,g.PREV_TIME=-3,g.PREV_X=-2,g.PREV_Y=-1,g.X=1,g.Y=2,g}(k);d.TranslateTimeline=l;var h=function(g){function k(a){return g.call(this,a)||this}
return e(k,g),k.prototype.getPropertyId=function(){return(c.scale<<24)+this.boneIndex},k.prototype.apply=function(c,e,g,l,h,p,q){var m=this.frames;c=c.bones[this.boneIndex];if(g<m[0])switch(p){case b.setup:return c.scaleX=c.data.scaleX,void(c.scaleY=c.data.scaleY);case b.current:c.scaleX+=(c.data.scaleX-c.scaleX)*h,c.scaleY+=(c.data.scaleY-c.scaleY)*h}else{if(g>=m[m.length-k.ENTRIES])e=m[m.length+k.PREV_X]*c.data.scaleX,l=m[m.length+k.PREV_Y]*c.data.scaleY;else{var r=f.binarySearch(m,g,k.ENTRIES);
e=m[r+k.PREV_X];l=m[r+k.PREV_Y];var v=m[r];g=this.getCurvePercent(r/k.ENTRIES-1,1-(g-v)/(m[r+k.PREV_TIME]-v));e=(e+(m[r+k.X]-e)*g)*c.data.scaleX;l=(l+(m[r+k.Y]-l)*g)*c.data.scaleY}1==h?(c.scaleX=e,c.scaleY=l):(m=g=0,p==b.setup?(g=c.data.scaleX,m=c.data.scaleY):(g=c.scaleX,m=c.scaleY),q==a.out?(e=Math.abs(e)*d.MathUtils.signum(g),l=Math.abs(l)*d.MathUtils.signum(m)):(g=Math.abs(g)*d.MathUtils.signum(e),m=Math.abs(m)*d.MathUtils.signum(l)),c.scaleX=g+(e-g)*h,c.scaleY=m+(l-m)*h)}},k}(l);d.ScaleTimeline=
h;l=function(a){function d(c){return a.call(this,c)||this}return e(d,a),d.prototype.getPropertyId=function(){return(c.shear<<24)+this.boneIndex},d.prototype.apply=function(a,c,e,g,k,l,h){c=this.frames;a=a.bones[this.boneIndex];if(e<c[0])switch(l){case b.setup:return a.shearX=a.data.shearX,void(a.shearY=a.data.shearY);case b.current:a.shearX+=(a.data.shearX-a.shearX)*k,a.shearY+=(a.data.shearY-a.shearY)*k}else{if(e>=c[c.length-d.ENTRIES])g=c[c.length+d.PREV_X],h=c[c.length+d.PREV_Y];else{var p=f.binarySearch(c,
e,d.ENTRIES);g=c[p+d.PREV_X];h=c[p+d.PREV_Y];var q=c[p];e=this.getCurvePercent(p/d.ENTRIES-1,1-(e-q)/(c[p+d.PREV_TIME]-q));g+=(c[p+d.X]-g)*e;h+=(c[p+d.Y]-h)*e}l==b.setup?(a.shearX=a.data.shearX+g*k,a.shearY=a.data.shearY+h*k):(a.shearX+=(a.data.shearX+g-a.shearX)*k,a.shearY+=(a.data.shearY+h-a.shearY)*k)}},d}(l);d.ShearTimeline=l;l=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c*g.ENTRIES),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.color<<
24)+this.slotIndex},g.prototype.setFrame=function(a,c,b,d,e,f){a*=g.ENTRIES;this.frames[a]=c;this.frames[a+g.R]=b;this.frames[a+g.G]=d;this.frames[a+g.B]=e;this.frames[a+g.A]=f},g.prototype.apply=function(a,c,d,e,k,l,h){a=a.slots[this.slotIndex];var p=this.frames;if(d<p[0])switch(l){case b.setup:return void a.color.setFromColor(a.data.color);case b.current:d=a.color,l=a.data.color,d.add((l.r-d.r)*k,(l.g-d.g)*k,(l.b-d.b)*k,(l.a-d.a)*k)}else{if(d>=p[p.length-g.ENTRIES]){d=p.length;c=p[d+g.PREV_R];e=
p[d+g.PREV_G];h=p[d+g.PREV_B];var q=p[d+g.PREV_A]}else{var m=f.binarySearch(p,d,g.ENTRIES);c=p[m+g.PREV_R];e=p[m+g.PREV_G];h=p[m+g.PREV_B];q=p[m+g.PREV_A];var r=p[m];d=this.getCurvePercent(m/g.ENTRIES-1,1-(d-r)/(p[m+g.PREV_TIME]-r));c+=(p[m+g.R]-c)*d;e+=(p[m+g.G]-e)*d;h+=(p[m+g.B]-h)*d;q+=(p[m+g.A]-q)*d}1==k?a.color.set(c,e,h,q):(d=a.color,l==b.setup&&d.setFromColor(a.data.color),d.add((c-d.r)*k,(e-d.g)*k,(h-d.b)*k,(q-d.a)*k))}},g.ENTRIES=5,g.PREV_TIME=-5,g.PREV_R=-4,g.PREV_G=-3,g.PREV_B=-2,g.PREV_A=
-1,g.R=1,g.G=2,g.B=3,g.A=4,g}(k);d.ColorTimeline=l;l=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c*g.ENTRIES),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.twoColor<<24)+this.slotIndex},g.prototype.setFrame=function(a,c,b,d,e,f,k,l,h){a*=g.ENTRIES;this.frames[a]=c;this.frames[a+g.R]=b;this.frames[a+g.G]=d;this.frames[a+g.B]=e;this.frames[a+g.A]=f;this.frames[a+g.R2]=k;this.frames[a+g.G2]=l;this.frames[a+g.B2]=h},g.prototype.apply=function(a,
c,d,e,k,l,h){a=a.slots[this.slotIndex];var p=this.frames;if(d<p[0])switch(l){case b.setup:return a.color.setFromColor(a.data.color),void a.darkColor.setFromColor(a.data.darkColor);case b.current:d=a.color,p=a.darkColor,l=a.data.color,a=a.data.darkColor,d.add((l.r-d.r)*k,(l.g-d.g)*k,(l.b-d.b)*k,(l.a-d.a)*k),p.add((a.r-p.r)*k,(a.g-p.g)*k,(a.b-p.b)*k,0)}else{if(d>=p[p.length-g.ENTRIES]){d=p.length;c=p[d+g.PREV_R];e=p[d+g.PREV_G];h=p[d+g.PREV_B];var q=p[d+g.PREV_A];var m=p[d+g.PREV_R2];var r=p[d+g.PREV_G2];
var v=p[d+g.PREV_B2]}else{var t=f.binarySearch(p,d,g.ENTRIES);c=p[t+g.PREV_R];e=p[t+g.PREV_G];h=p[t+g.PREV_B];q=p[t+g.PREV_A];m=p[t+g.PREV_R2];r=p[t+g.PREV_G2];v=p[t+g.PREV_B2];var u=p[t];d=this.getCurvePercent(t/g.ENTRIES-1,1-(d-u)/(p[t+g.PREV_TIME]-u));c+=(p[t+g.R]-c)*d;e+=(p[t+g.G]-e)*d;h+=(p[t+g.B]-h)*d;q+=(p[t+g.A]-q)*d;m+=(p[t+g.R2]-m)*d;r+=(p[t+g.G2]-r)*d;v+=(p[t+g.B2]-v)*d}1==k?(a.color.set(c,e,h,q),a.darkColor.set(m,r,v,1)):(d=a.color,p=a.darkColor,l==b.setup&&(d.setFromColor(a.data.color),
p.setFromColor(a.data.darkColor)),d.add((c-d.r)*k,(e-d.g)*k,(h-d.b)*k,(q-d.a)*k),p.add((m-p.r)*k,(r-p.g)*k,(v-p.b)*k,0))}},g.ENTRIES=8,g.PREV_TIME=-8,g.PREV_R=-7,g.PREV_G=-6,g.PREV_B=-5,g.PREV_A=-4,g.PREV_R2=-3,g.PREV_G2=-2,g.PREV_B2=-1,g.R=1,g.G=2,g.B=3,g.A=4,g.R2=5,g.G2=6,g.B2=7,g}(k);d.TwoColorTimeline=l;l=function(){function e(a){this.frames=d.Utils.newFloatArray(a);this.attachmentNames=Array(a)}return e.prototype.getPropertyId=function(){return(c.attachment<<24)+this.slotIndex},e.prototype.getFrameCount=
function(){return this.frames.length},e.prototype.setFrame=function(a,c,b){this.frames[a]=c;this.attachmentNames[a]=b},e.prototype.apply=function(c,d,e,g,k,l,h){d=c.slots[this.slotIndex];h!=a.out||l!=b.setup?(h=this.frames,e<h[0]?l==b.setup&&(e=d.data.attachmentName,d.setAttachment(null==e?null:c.getAttachment(this.slotIndex,e))):(e=e>=h[h.length-1]?h.length-1:f.binarySearch(h,e,1)-1,e=this.attachmentNames[e],c.slots[this.slotIndex].setAttachment(null==e?null:c.getAttachment(this.slotIndex,e)))):
(e=d.data.attachmentName,d.setAttachment(null==e?null:c.getAttachment(this.slotIndex,e)))},e}();d.AttachmentTimeline=l;var m=null;l=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c),b.frameVertices=Array(c),null==m&&(m=d.Utils.newFloatArray(64)),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.deform<<27)+ +this.attachment.id+this.slotIndex},g.prototype.setFrame=function(a,c,b){this.frames[a]=c;this.frameVertices[a]=b},g.prototype.apply=function(a,
c,e,g,k,l,h){a=a.slots[this.slotIndex];var p=a.getAttachment();if(p instanceof d.VertexAttachment&&p.applyDeform(this.attachment)){c=a.attachmentVertices;0==c.length&&(k=1);h=this.frameVertices;a=h[0].length;var q=this.frames;if(e<q[0])switch(l){case b.setup:return void(c.length=0);case b.current:if(1==k)c.length=0;else if(c=d.Utils.setArraySize(c,a),null==p.bones)for(l=p.vertices,g=0;g<a;g++)c[g]+=(l[g]-c[g])*k;else for(k=1-k,g=0;g<a;g++)c[g]*=k}else if(c=d.Utils.setArraySize(c,a),e>=q[q.length-
1])if(g=h[q.length-1],1==k)d.Utils.arrayCopy(g,0,c,0,a);else if(l==b.setup)if(null==p.bones)for(h=p.vertices,e=0;e<a;e++)l=h[e],c[e]=l+(g[e]-l)*k;else for(l=0;l<a;l++)c[l]=g[l]*k;else for(l=0;l<a;l++)c[l]+=(g[l]-c[l])*k;else{var m=f.binarySearch(q,e);g=h[m-1];h=h[m];var r=q[m];e=this.getCurvePercent(m-1,1-(e-r)/(q[m-1]-r));if(1==k)for(k=0;k<a;k++)p=g[k],c[k]=p+(h[k]-p)*e;else if(l==b.setup)if(null==p.bones)for(q=p.vertices,m=0;m<a;m++)p=g[m],l=q[m],c[m]=l+(p+(h[m]-p)*e-l)*k;else for(l=0;l<a;l++)p=
g[l],c[l]=(p+(h[l]-p)*e)*k;else for(l=0;l<a;l++)p=g[l],c[l]+=(p+(h[l]-p)*e-c[l])*k}}},g}(k);d.DeformTimeline=l;l=function(){function a(a){this.frames=d.Utils.newFloatArray(a);this.events=Array(a)}return a.prototype.getPropertyId=function(){return c.event<<24},a.prototype.getFrameCount=function(){return this.frames.length},a.prototype.setFrame=function(a,c){this.frames[a]=c.time;this.events[a]=c},a.prototype.apply=function(a,c,b,d,e,g,k){if(null!=d){var l=this.frames,h=this.frames.length;if(c>b)this.apply(a,
c,Number.MAX_VALUE,d,e,g,k),c=-1;else if(c>=l[h-1])return;if(!(b<l[0])){if(c<l[0])a=0;else for(c=l[a=f.binarySearch(l,c)];0<a&&l[a-1]==c;)a--;for(;a<h&&b>=l[a];a++)d.push(this.events[a])}}},a}();d.EventTimeline=l;l=function(){function e(a){this.frames=d.Utils.newFloatArray(a);this.drawOrders=Array(a)}return e.prototype.getPropertyId=function(){return c.drawOrder<<24},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(a,c,b){this.frames[a]=c;this.drawOrders[a]=
b},e.prototype.apply=function(c,e,g,k,l,h,q){e=c.drawOrder;k=c.slots;if(q!=a.out||h!=b.setup)if(q=this.frames,g<q[0])h==b.setup&&d.Utils.arrayCopy(c.slots,0,c.drawOrder,0,c.slots.length);else if(c=g>=q[q.length-1]?q.length-1:f.binarySearch(q,g)-1,c=this.drawOrders[c],null==c)d.Utils.arrayCopy(k,0,e,0,k.length);else for(g=0,h=c.length;g<h;g++)e[g]=k[c[g]];else d.Utils.arrayCopy(c.slots,0,c.drawOrder,0,c.slots.length)},e}();d.DrawOrderTimeline=l;l=function(g){function k(a){var c=g.call(this,a)||this;
return c.frames=d.Utils.newFloatArray(a*k.ENTRIES),c}return e(k,g),k.prototype.getPropertyId=function(){return(c.ikConstraint<<24)+this.ikConstraintIndex},k.prototype.setFrame=function(a,c,b,d){a*=k.ENTRIES;this.frames[a]=c;this.frames[a+k.MIX]=b;this.frames[a+k.BEND_DIRECTION]=d},k.prototype.apply=function(c,d,e,g,l,h,q){d=this.frames;c=c.ikConstraints[this.ikConstraintIndex];if(e<d[0])switch(h){case b.setup:return c.mix=c.data.mix,void(c.bendDirection=c.data.bendDirection);case b.current:c.mix+=
(c.data.mix-c.mix)*l,c.bendDirection=c.data.bendDirection}else if(e>=d[d.length-k.ENTRIES])h==b.setup?(c.mix=c.data.mix+(d[d.length+k.PREV_MIX]-c.data.mix)*l,c.bendDirection=q==a.out?c.data.bendDirection:d[d.length+k.PREV_BEND_DIRECTION]):(c.mix+=(d[d.length+k.PREV_MIX]-c.mix)*l,q==a.in&&(c.bendDirection=d[d.length+k.PREV_BEND_DIRECTION]));else{g=f.binarySearch(d,e,k.ENTRIES);var p=d[g+k.PREV_MIX],m=d[g];e=this.getCurvePercent(g/k.ENTRIES-1,1-(e-m)/(d[g+k.PREV_TIME]-m));h==b.setup?(c.mix=c.data.mix+
(p+(d[g+k.MIX]-p)*e-c.data.mix)*l,c.bendDirection=q==a.out?c.data.bendDirection:d[g+k.PREV_BEND_DIRECTION]):(c.mix+=(p+(d[g+k.MIX]-p)*e-c.mix)*l,q==a.in&&(c.bendDirection=d[g+k.PREV_BEND_DIRECTION]))}},k.ENTRIES=3,k.PREV_TIME=-3,k.PREV_MIX=-2,k.PREV_BEND_DIRECTION=-1,k.MIX=1,k.BEND_DIRECTION=2,k}(k);d.IkConstraintTimeline=l;l=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c*g.ENTRIES),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.transformConstraint<<
24)+this.transformConstraintIndex},g.prototype.setFrame=function(a,c,b,d,e,f){a*=g.ENTRIES;this.frames[a]=c;this.frames[a+g.ROTATE]=b;this.frames[a+g.TRANSLATE]=d;this.frames[a+g.SCALE]=e;this.frames[a+g.SHEAR]=f},g.prototype.apply=function(a,c,d,e,k,l,h){c=this.frames;a=a.transformConstraints[this.transformConstraintIndex];if(d<c[0])switch(d=a.data,l){case b.setup:return a.rotateMix=d.rotateMix,a.translateMix=d.translateMix,a.scaleMix=d.scaleMix,void(a.shearMix=d.shearMix);case b.current:a.rotateMix+=
(d.rotateMix-a.rotateMix)*k,a.translateMix+=(d.translateMix-a.translateMix)*k,a.scaleMix+=(d.scaleMix-a.scaleMix)*k,a.shearMix+=(d.shearMix-a.shearMix)*k}else{if(d>=c[c.length-g.ENTRIES]){d=c.length;e=c[d+g.PREV_ROTATE];h=c[d+g.PREV_TRANSLATE];var q=c[d+g.PREV_SCALE];var m=c[d+g.PREV_SHEAR]}else{var p=f.binarySearch(c,d,g.ENTRIES);e=c[p+g.PREV_ROTATE];h=c[p+g.PREV_TRANSLATE];q=c[p+g.PREV_SCALE];m=c[p+g.PREV_SHEAR];var r=c[p];d=this.getCurvePercent(p/g.ENTRIES-1,1-(d-r)/(c[p+g.PREV_TIME]-r));e+=(c[p+
g.ROTATE]-e)*d;h+=(c[p+g.TRANSLATE]-h)*d;q+=(c[p+g.SCALE]-q)*d;m+=(c[p+g.SHEAR]-m)*d}l==b.setup?(d=a.data,a.rotateMix=d.rotateMix+(e-d.rotateMix)*k,a.translateMix=d.translateMix+(h-d.translateMix)*k,a.scaleMix=d.scaleMix+(q-d.scaleMix)*k,a.shearMix=d.shearMix+(m-d.shearMix)*k):(a.rotateMix+=(e-a.rotateMix)*k,a.translateMix+=(h-a.translateMix)*k,a.scaleMix+=(q-a.scaleMix)*k,a.shearMix+=(m-a.shearMix)*k)}},g.ENTRIES=5,g.PREV_TIME=-5,g.PREV_ROTATE=-4,g.PREV_TRANSLATE=-3,g.PREV_SCALE=-2,g.PREV_SHEAR=
-1,g.ROTATE=1,g.TRANSLATE=2,g.SCALE=3,g.SHEAR=4,g}(k);d.TransformConstraintTimeline=l;l=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c*g.ENTRIES),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.pathConstraintPosition<<24)+this.pathConstraintIndex},g.prototype.setFrame=function(a,c,b){a*=g.ENTRIES;this.frames[a]=c;this.frames[a+g.VALUE]=b},g.prototype.apply=function(a,c,d,e,k,l,h){c=this.frames;a=a.pathConstraints[this.pathConstraintIndex];
if(d<c[0])switch(l){case b.setup:return void(a.position=a.data.position);case b.current:a.position+=(a.data.position-a.position)*k}else{if(d>=c[c.length-g.ENTRIES])e=c[c.length+g.PREV_VALUE];else{h=f.binarySearch(c,d,g.ENTRIES);e=c[h+g.PREV_VALUE];var q=c[h];d=this.getCurvePercent(h/g.ENTRIES-1,1-(d-q)/(c[h+g.PREV_TIME]-q));e+=(c[h+g.VALUE]-e)*d}l==b.setup?a.position=a.data.position+(e-a.data.position)*k:a.position+=(e-a.position)*k}},g.ENTRIES=2,g.PREV_TIME=-2,g.PREV_VALUE=-1,g.VALUE=1,g}(k);d.PathConstraintPositionTimeline=
l;l=function(a){function d(c){return a.call(this,c)||this}return e(d,a),d.prototype.getPropertyId=function(){return(c.pathConstraintSpacing<<24)+this.pathConstraintIndex},d.prototype.apply=function(a,c,e,g,k,l,h){c=this.frames;a=a.pathConstraints[this.pathConstraintIndex];if(e<c[0])switch(l){case b.setup:return void(a.spacing=a.data.spacing);case b.current:a.spacing+=(a.data.spacing-a.spacing)*k}else{if(e>=c[c.length-d.ENTRIES])g=c[c.length+d.PREV_VALUE];else{h=f.binarySearch(c,e,d.ENTRIES);g=c[h+
d.PREV_VALUE];var q=c[h];e=this.getCurvePercent(h/d.ENTRIES-1,1-(e-q)/(c[h+d.PREV_TIME]-q));g+=(c[h+d.VALUE]-g)*e}l==b.setup?a.spacing=a.data.spacing+(g-a.data.spacing)*k:a.spacing+=(g-a.spacing)*k}},d}(l);d.PathConstraintSpacingTimeline=l;k=function(a){function g(c){var b=a.call(this,c)||this;return b.frames=d.Utils.newFloatArray(c*g.ENTRIES),b}return e(g,a),g.prototype.getPropertyId=function(){return(c.pathConstraintMix<<24)+this.pathConstraintIndex},g.prototype.setFrame=function(a,c,b,d){a*=g.ENTRIES;
this.frames[a]=c;this.frames[a+g.ROTATE]=b;this.frames[a+g.TRANSLATE]=d},g.prototype.apply=function(a,c,d,e,k,l,h){c=this.frames;a=a.pathConstraints[this.pathConstraintIndex];if(d<c[0])switch(l){case b.setup:return a.rotateMix=a.data.rotateMix,void(a.translateMix=a.data.translateMix);case b.current:a.rotateMix+=(a.data.rotateMix-a.rotateMix)*k,a.translateMix+=(a.data.translateMix-a.translateMix)*k}else{if(d>=c[c.length-g.ENTRIES])e=c[c.length+g.PREV_ROTATE],h=c[c.length+g.PREV_TRANSLATE];else{var q=
f.binarySearch(c,d,g.ENTRIES);e=c[q+g.PREV_ROTATE];h=c[q+g.PREV_TRANSLATE];var m=c[q];d=this.getCurvePercent(q/g.ENTRIES-1,1-(d-m)/(c[q+g.PREV_TIME]-m));e+=(c[q+g.ROTATE]-e)*d;h+=(c[q+g.TRANSLATE]-h)*d}l==b.setup?(a.rotateMix=a.data.rotateMix+(e-a.data.rotateMix)*k,a.translateMix=a.data.translateMix+(h-a.data.translateMix)*k):(a.rotateMix+=(e-a.rotateMix)*k,a.translateMix+=(h-a.translateMix)*k)}},g.ENTRIES=3,g.PREV_TIME=-3,g.PREV_ROTATE=-2,g.PREV_TRANSLATE=-1,g.ROTATE=1,g.TRANSLATE=2,g}(k);d.PathConstraintMixTimeline=
k})(h||(h={}));(function(d){var b=function(){function c(c){this.tracks=[];this.events=[];this.listeners=[];this.queue=new e(this);this.propertyIDs=new d.IntSet;this.mixingTo=[];this.animationsChanged=!1;this.timeScale=1;this.trackEntryPool=new d.Pool(function(){return new a});this.data=c}return c.prototype.update=function(a){a*=this.timeScale;for(var c=this.tracks,b=0,d=c.length;b<d;b++){var e=c[b];if(null!=e){e.animationLast=e.nextAnimationLast;e.trackLast=e.nextTrackLast;var f=a*e.timeScale;if(0<
e.delay){if(e.delay-=f,0<e.delay)continue;f=-e.delay;e.delay=0}var g=e.next;if(null!=g){var k=e.trackLast-g.delay;if(0<=k){g.delay=0;g.trackTime=k+a*g.timeScale;e.trackTime+=f;for(this.setCurrent(b,g,!0);null!=g.mixingFrom;)g.mixTime+=f,g=g.mixingFrom;continue}}else if(e.trackLast>=e.trackEnd&&null==e.mixingFrom){c[b]=null;this.queue.end(e);this.disposeNext(e);continue}if(null!=e.mixingFrom&&this.updateMixingFrom(e,a))for(g=e.mixingFrom,e.mixingFrom=null;null!=g;)this.queue.end(g),g=g.mixingFrom;
e.trackTime+=f}}this.queue.drain()},c.prototype.updateMixingFrom=function(a,c){var b=a.mixingFrom;if(null==b)return!0;var d=this.updateMixingFrom(b,c);return b.animationLast=b.nextAnimationLast,b.trackLast=b.nextTrackLast,0<a.mixTime&&(a.mixTime>=a.mixDuration||0==a.timeScale)?(0!=b.totalAlpha&&0!=a.mixDuration||(a.mixingFrom=b.mixingFrom,a.interruptAlpha=b.interruptAlpha,this.queue.end(b)),d):(b.trackTime+=c*b.timeScale,a.mixTime+=c*a.timeScale,!1)},c.prototype.apply=function(a){if(null==a)throw Error("skeleton cannot be null.");
this.animationsChanged&&this._animationsChanged();for(var b=this.events,e=this.tracks,f=!1,g=0,k=e.length;g<k;g++){var l=e[g];if(!(null==l||0<l.delay)){f=!0;var h=0==g?d.MixPose.current:d.MixPose.currentLayered,q=l.alpha;null!=l.mixingFrom?q*=this.applyMixingFrom(l,a,h):l.trackTime>=l.trackEnd&&null==l.next&&(q=0);var m=l.animationLast,n=l.getAnimationTime(),C=l.animation.timelines.length,z=l.animation.timelines;if(1==q)for(var A=0;A<C;A++)z[A].apply(a,m,n,b,1,d.MixPose.setup,d.MixDirection.in);else{var D=
l.timelineData,I=0==l.timelinesRotation.length;I&&d.Utils.setArraySize(l.timelinesRotation,C<<1,null);var F=l.timelinesRotation;for(A=0;A<C;A++){var G=z[A],J=D[A]>=c.FIRST?d.MixPose.setup:h;G instanceof d.RotateTimeline?this.applyRotateTimeline(G,a,n,q,J,F,A<<1,I):(d.Utils.webkit602BugfixHelper(q,J),G.apply(a,m,n,b,q,J,d.MixDirection.in))}}this.queueEvents(l,n);b.length=0;l.nextAnimationLast=n;l.nextTrackLast=l.trackTime}}return this.queue.drain(),f},c.prototype.applyMixingFrom=function(a,b,e){var f=
a.mixingFrom;null!=f.mixingFrom&&this.applyMixingFrom(f,b,e);var g=0;0==a.mixDuration?(g=1,e=d.MixPose.setup):1<(g=a.mixTime/a.mixDuration)&&(g=1);var k=g<f.eventThreshold?this.events:null,l=g<f.attachmentThreshold,h=g<f.drawOrderThreshold,q=f.animationLast,m=f.getAnimationTime(),r=f.animation.timelines.length,t=f.animation.timelines,n=f.timelineData,A=f.timelineDipMix,D=0==f.timelinesRotation.length;D&&d.Utils.setArraySize(f.timelinesRotation,r<<1,null);for(var I,F=f.timelinesRotation,G=f.alpha*
a.interruptAlpha,J=G*(1-g),N,K=f.totalAlpha=0;K<r;K++){var P=t[K];switch(n[K]){case c.SUBSEQUENT:if(!l&&P instanceof d.AttachmentTimeline)continue;if(!h&&P instanceof d.DrawOrderTimeline)continue;I=e;N=J;break;case c.FIRST:I=d.MixPose.setup;N=J;break;case c.DIP:I=d.MixPose.setup;N=G;break;default:I=d.MixPose.setup;N=G;var L=A[K];N*=Math.max(0,1-L.mixTime/L.mixDuration)}f.totalAlpha+=N;P instanceof d.RotateTimeline?this.applyRotateTimeline(P,b,m,N,I,F,K<<1,D):(d.Utils.webkit602BugfixHelper(N,I),P.apply(b,
q,m,k,N,I,d.MixDirection.out))}return 0<a.mixDuration&&this.queueEvents(f,m),this.events.length=0,f.nextAnimationLast=m,f.nextTrackLast=f.trackTime,g},c.prototype.applyRotateTimeline=function(a,c,b,e,f,g,k,l){if(l&&(g[k]=0),1!=e){var h=a.frames;c=c.bones[a.boneIndex];if(b<h[0])f==d.MixPose.setup&&(c.rotation=c.data.rotation);else{if(b>=h[h.length-d.RotateTimeline.ENTRIES])h=c.data.rotation+h[h.length+d.RotateTimeline.PREV_ROTATION];else{var q=d.Animation.binarySearch(h,b,d.RotateTimeline.ENTRIES),
m=h[q+d.RotateTimeline.PREV_ROTATION],p=h[q];a=a.getCurvePercent((q>>1)-1,1-(b-p)/(h[q+d.RotateTimeline.PREV_TIME]-p));h=h[q+d.RotateTimeline.ROTATION]-m;h=m+(h-=360*(16384-(16384.499999999996-h/360|0)))*a+c.data.rotation;h-=360*(16384-(16384.499999999996-h/360|0))}f=f==d.MixPose.setup?c.data.rotation:c.rotation;h-=f;0==h?a=g[k]:(h-=360*(16384-(16384.499999999996-h/360|0)),a=m=0,l?(m=0,a=h):(m=g[k],a=g[k+1]),l=0<h,b=0<=m,d.MathUtils.signum(a)!=d.MathUtils.signum(h)&&90>=Math.abs(a)&&(180<Math.abs(m)&&
(m+=360*d.MathUtils.signum(m)),b=l),a=h+m-m%360,b!=l&&(a+=360*d.MathUtils.signum(m)),g[k]=a);g[k+1]=h;f+=a*e;c.rotation=f-360*(16384-(16384.499999999996-f/360|0))}}else a.apply(c,0,b,null,1,f,d.MixDirection.in)},c.prototype.queueEvents=function(a,c){for(var b=a.animationStart,d=a.animationEnd,e=d-b,f=a.trackLast%e,g=this.events,k=0,l=g.length;k<l;k++){var h=g[k];if(h.time<f)break;h.time>d||this.queue.event(a,h)}for((a.loop?0==e||f>a.trackTime%e:c>=d&&a.animationLast<d)&&this.queue.complete(a);k<l;k++)g[k].time<
b||this.queue.event(a,g[k])},c.prototype.clearTracks=function(){var a=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var c=0,b=this.tracks.length;c<b;c++)this.clearTrack(c);this.tracks.length=0;this.queue.drainDisabled=a;this.queue.drain()},c.prototype.clearTrack=function(a){if(!(a>=this.tracks.length)&&(a=this.tracks[a],null!=a)){this.queue.end(a);this.disposeNext(a);for(var c=a;;){var b=c.mixingFrom;if(null==b)break;this.queue.end(b);c.mixingFrom=null;c=b}this.tracks[a.trackIndex]=null;
this.queue.drain()}},c.prototype.setCurrent=function(a,c,b){var d=this.expandToIndex(a);this.tracks[a]=c;null!=d&&(b&&this.queue.interrupt(d),c.mixingFrom=d,c.mixTime=0,null!=d.mixingFrom&&0<d.mixDuration&&(c.interruptAlpha*=Math.min(1,d.mixTime/d.mixDuration)),d.timelinesRotation.length=0);this.queue.start(c)},c.prototype.setAnimation=function(a,c,b){var d=this.data.skeletonData.findAnimation(c);if(null==d)throw Error("Animation not found: "+c);return this.setAnimationWith(a,d,b)},c.prototype.setAnimationWith=
function(a,c,b){if(null==c)throw Error("animation cannot be null.");var d=!0,e=this.expandToIndex(a);null!=e&&(-1==e.nextTrackLast?(this.tracks[a]=e.mixingFrom,this.queue.interrupt(e),this.queue.end(e),this.disposeNext(e),e=e.mixingFrom,d=!1):this.disposeNext(e));c=this.trackEntry(a,c,b,e);return this.setCurrent(a,c,d),this.queue.drain(),c},c.prototype.addAnimation=function(a,c,b,d){var e=this.data.skeletonData.findAnimation(c);if(null==e)throw Error("Animation not found: "+c);return this.addAnimationWith(a,
e,b,d)},c.prototype.addAnimationWith=function(a,c,b,d){if(null==c)throw Error("animation cannot be null.");var e=this.expandToIndex(a);if(null!=e)for(;null!=e.next;)e=e.next;b=this.trackEntry(a,c,b,e);if(null==e)this.setCurrent(a,b,!0),this.queue.drain();else if(e.next=b,0>=d)a=e.animationEnd-e.animationStart,0!=a?(e.loop?d+=a*(1+(e.trackTime/a|0)):d+=a,d-=this.data.getMix(e.animation,c)):d=0;return b.delay=d,b},c.prototype.setEmptyAnimation=function(a,b){a=this.setAnimationWith(a,c.emptyAnimation,
!1);return a.mixDuration=b,a.trackEnd=b,a},c.prototype.addEmptyAnimation=function(a,b,d){0>=d&&(d-=b);a=this.addAnimationWith(a,c.emptyAnimation,!1,d);return a.mixDuration=b,a.trackEnd=b,a},c.prototype.setEmptyAnimations=function(a){var c=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var b=0,d=this.tracks.length;b<d;b++){var e=this.tracks[b];null!=e&&this.setEmptyAnimation(e.trackIndex,a)}this.queue.drainDisabled=c;this.queue.drain()},c.prototype.expandToIndex=function(a){return a<this.tracks.length?
this.tracks[a]:(d.Utils.ensureArrayCapacity(this.tracks,a-this.tracks.length+1,null),this.tracks.length=a+1,null)},c.prototype.trackEntry=function(a,c,b,d){var e=this.trackEntryPool.obtain();return e.trackIndex=a,e.animation=c,e.loop=b,e.eventThreshold=0,e.attachmentThreshold=0,e.drawOrderThreshold=0,e.animationStart=0,e.animationEnd=c.duration,e.animationLast=-1,e.nextAnimationLast=-1,e.delay=0,e.trackTime=0,e.trackLast=-1,e.nextTrackLast=-1,e.trackEnd=Number.MAX_VALUE,e.timeScale=1,e.alpha=1,e.interruptAlpha=
1,e.mixTime=0,e.mixDuration=null==d?0:this.data.getMix(d.animation,c),e},c.prototype.disposeNext=function(a){for(var c=a.next;null!=c;)this.queue.dispose(c),c=c.next;a.next=null},c.prototype._animationsChanged=function(){this.animationsChanged=!1;var a=this.propertyIDs;a.clear();for(var c=this.mixingTo,b=0,d=this.tracks.length;b<d;b++){var e=this.tracks[b];null!=e&&e.setTimelineData(null,c,a)}},c.prototype.getCurrent=function(a){return a>=this.tracks.length?null:this.tracks[a]},c.prototype.addListener=
function(a){if(null==a)throw Error("listener cannot be null.");this.listeners.push(a)},c.prototype.removeListener=function(a){a=this.listeners.indexOf(a);0<=a&&this.listeners.splice(a,1)},c.prototype.clearListeners=function(){this.listeners.length=0},c.prototype.clearListenerNotifications=function(){this.queue.clear()},c.emptyAnimation=new d.Animation("<empty>",[],0),c.SUBSEQUENT=0,c.FIRST=1,c.DIP=2,c.DIP_MIX=3,c}();d.AnimationState=b;var a=function(){function a(){this.timelineData=[];this.timelineDipMix=
[];this.timelinesRotation=[]}return a.prototype.reset=function(){this.listener=this.animation=this.mixingFrom=this.next=null;this.timelineData.length=0;this.timelineDipMix.length=0;this.timelinesRotation.length=0},a.prototype.setTimelineData=function(a,c,e){null!=a&&c.push(a);var f=null!=this.mixingFrom?this.mixingFrom.setTimelineData(this,c,e):this;null!=a&&c.pop();var g=c.length-1,k=this.animation.timelines,l=this.animation.timelines.length,h=d.Utils.setArraySize(this.timelineData,l);this.timelineDipMix.length=
0;var m=d.Utils.setArraySize(this.timelineDipMix,l),q=0;a:for(;q<l;q++){var r=k[q].getPropertyId();if(e.add(r))if(null!=a&&a.hasTimeline(r)){for(var t=g;0<=t;t--){var n=c[t];if(!n.hasTimeline(r)&&0<n.mixDuration){h[q]=b.DIP_MIX;m[q]=n;continue a}}h[q]=b.DIP}else h[q]=b.FIRST;else h[q]=b.SUBSEQUENT}return f},a.prototype.hasTimeline=function(a){for(var c=this.animation.timelines,b=0,d=c.length;b<d;b++)if(c[b].getPropertyId()==a)return!0;return!1},a.prototype.getAnimationTime=function(){if(this.loop){var a=
this.animationEnd-this.animationStart;return 0==a?this.animationStart:this.trackTime%a+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},a.prototype.setAnimationLast=function(a){this.nextAnimationLast=this.animationLast=a},a.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},a.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},a}();d.TrackEntry=a;var c,e=function(){function a(a){this.objects=
[];this.drainDisabled=!1;this.animState=a}return a.prototype.start=function(a){this.objects.push(c.start);this.objects.push(a);this.animState.animationsChanged=!0},a.prototype.interrupt=function(a){this.objects.push(c.interrupt);this.objects.push(a)},a.prototype.end=function(a){this.objects.push(c.end);this.objects.push(a);this.animState.animationsChanged=!0},a.prototype.dispose=function(a){this.objects.push(c.dispose);this.objects.push(a)},a.prototype.complete=function(a){this.objects.push(c.complete);
this.objects.push(a)},a.prototype.event=function(a,b){this.objects.push(c.event);this.objects.push(a);this.objects.push(b)},a.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var a=this.objects,b=this.animState.listeners,d=0;d<a.length;d+=2){var e=a[d+1];switch(a[d]){case c.start:null!=e.listener&&e.listener.start&&e.listener.start(e);for(var f=0;f<b.length;f++)b[f].start&&b[f].start(e);break;case c.interrupt:null!=e.listener&&e.listener.interrupt&&e.listener.interrupt(e);
for(f=0;f<b.length;f++)b[f].interrupt&&b[f].interrupt(e);break;case c.end:for(null!=e.listener&&e.listener.end&&e.listener.end(e),f=0;f<b.length;f++)b[f].end&&b[f].end(e);case c.dispose:null!=e.listener&&e.listener.dispose&&e.listener.dispose(e);for(f=0;f<b.length;f++)b[f].dispose&&b[f].dispose(e);this.animState.trackEntryPool.free(e);break;case c.complete:null!=e.listener&&e.listener.complete&&e.listener.complete(e);for(f=0;f<b.length;f++)b[f].complete&&b[f].complete(e);break;case c.event:var g=
a[2+d++];null!=e.listener&&e.listener.event&&e.listener.event(e,g);for(f=0;f<b.length;f++)b[f].event&&b[f].event(e,g)}}this.clear();this.drainDisabled=!1}},a.prototype.clear=function(){this.objects.length=0},a}();d.EventQueue=e;(function(a){a[a.start=0]="start";a[a.interrupt=1]="interrupt";a[a.end=2]="end";a[a.dispose=3]="dispose";a[a.complete=4]="complete";a[a.event=5]="event"})(c=d.EventType||(d.EventType={}));var f=function(){function a(){}return a.prototype.start=function(a){},a.prototype.interrupt=
function(a){},a.prototype.end=function(a){},a.prototype.dispose=function(a){},a.prototype.complete=function(a){},a.prototype.event=function(a,c){},a}();d.AnimationStateAdapter2=f})(h||(h={}));(function(d){var b=function(){function a(a){if(this.animationToMixTime={},this.defaultMix=0,null==a)throw Error("skeletonData cannot be null.");this.skeletonData=a}return a.prototype.setMix=function(a,b,d){var c=this.skeletonData.findAnimation(a);if(null==c)throw Error("Animation not found: "+a);a=this.skeletonData.findAnimation(b);
if(null==a)throw Error("Animation not found: "+b);this.setMixWith(c,a,d)},a.prototype.setMixWith=function(a,b,d){if(null==a)throw Error("from cannot be null.");if(null==b)throw Error("to cannot be null.");this.animationToMixTime[a.name+"."+b.name]=d},a.prototype.getMix=function(a,b){a=this.animationToMixTime[a.name+"."+b.name];return void 0===a?this.defaultMix:a},a}();d.AnimationStateData=b})(h||(h={}));(function(d){var b=function(){function a(a,b){void 0===b&&(b="");this.assets={};this.errors={};
this.loaded=this.toLoad=0;this.textureLoader=a;this.pathPrefix=b}return a.downloadText=function(a,b,d){var c=new XMLHttpRequest;c.open("GET",a,!0);c.onload=function(){200==c.status?b(c.responseText):d(c.status,c.responseText)};c.onerror=function(){d(c.status,c.responseText)};c.send()},a.downloadBinary=function(a,b,d){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=function(){200==c.status?b(new Uint8Array(c.response)):d(c.status,c.responseText)};c.onerror=function(){d(c.status,
c.responseText)};c.send()},a.prototype.loadText=function(c,b,d){var e=this;void 0===b&&(b=null);void 0===d&&(d=null);c=this.pathPrefix+c;this.toLoad++;a.downloadText(c,function(a){e.assets[c]=a;b&&b(c,a);e.toLoad--;e.loaded++},function(a,b){e.errors[c]="Couldn't load text "+c+": status "+status+", "+b;d&&d(c,"Couldn't load text "+c+": status "+status+", "+b);e.toLoad--;e.loaded++})},a.prototype.loadTexture=function(a,b,d){var c=this;void 0===b&&(b=null);void 0===d&&(d=null);a=this.pathPrefix+a;this.toLoad++;
var e=new Image;e.crossOrigin="anonymous";e.onload=function(d){d=c.textureLoader(e);c.assets[a]=d;c.toLoad--;c.loaded++;b&&b(a,e)};e.onerror=function(b){c.errors[a]="Couldn't load image "+a;c.toLoad--;c.loaded++;d&&d(a,"Couldn't load image "+a)};e.src=a},a.prototype.loadTextureData=function(a,b,d,e){var c=this;void 0===d&&(d=null);void 0===e&&(e=null);a=this.pathPrefix+a;this.toLoad++;var f=new Image;f.onload=function(b){b=c.textureLoader(f);c.assets[a]=b;c.toLoad--;c.loaded++;d&&d(a,f)};f.onerror=
function(b){c.errors[a]="Couldn't load image "+a;c.toLoad--;c.loaded++;e&&e(a,"Couldn't load image "+a)};f.src=b},a.prototype.loadTextureAtlas=function(c,b,e){var f=this;void 0===b&&(b=null);void 0===e&&(e=null);var g=0<=c.lastIndexOf("/")?c.substring(0,c.lastIndexOf("/")):"";c=this.pathPrefix+c;this.toLoad++;a.downloadText(c,function(a){var k=0,l=[];try{new d.TextureAtlas(a,function(a){l.push(g+"/"+a);a=document.createElement("img");return a.width=16,a.height=16,new d.FakeTexture(a)})}catch(E){var h=
E;return f.errors[c]="Couldn't load texture atlas "+c+": "+h.message,e&&e(c,"Couldn't load texture atlas "+c+": "+h.message),f.toLoad--,void f.loaded++}h=function(h){var m=!1;f.loadTexture(h,function(h,q){if(k++,k==l.length)if(m)f.errors[c]="Couldn't load texture atlas page "+h+"} of atlas "+c,e&&e(c,"Couldn't load texture atlas page "+h+" of atlas "+c),f.toLoad--,f.loaded++;else try{var p=new d.TextureAtlas(a,function(a){return f.get(g+"/"+a)});f.assets[c]=p;b&&b(c,p);f.toLoad--;f.loaded++}catch(C){h=
C,f.errors[c]="Couldn't load texture atlas "+c+": "+h.message,e&&e(c,"Couldn't load texture atlas "+c+": "+h.message),f.toLoad--,f.loaded++}},function(a,b){m=!0;k++;k==l.length&&(f.errors[c]="Couldn't load texture atlas page "+a+"} of atlas "+c,e&&e(c,"Couldn't load texture atlas page "+a+" of atlas "+c),f.toLoad--,f.loaded++)})};for(var m=0;m<l.length;m++)h(l[m])},function(a,b){f.errors[c]="Couldn't load texture atlas "+c+": status "+status+", "+b;e&&e(c,"Couldn't load texture atlas "+c+": status "+
status+", "+b);f.toLoad--;f.loaded++})},a.prototype.get=function(a){return a=this.pathPrefix+a,this.assets[a]},a.prototype.remove=function(a){a=this.pathPrefix+a;var c=this.assets[a];c.dispose&&c.dispose();this.assets[a]=null},a.prototype.removeAll=function(){for(var a in this.assets){var b=this.assets[a];b.dispose&&b.dispose()}this.assets={}},a.prototype.isLoadingComplete=function(){return 0==this.toLoad},a.prototype.getToLoad=function(){return this.toLoad},a.prototype.getLoaded=function(){return this.loaded},
a.prototype.dispose=function(){this.removeAll()},a.prototype.hasErrors=function(){return 0<Object.keys(this.errors).length},a.prototype.getErrors=function(){return this.errors},a}();d.AssetManager=b})(h||(h={}));(function(d){var b=function(){function a(a){this.atlas=a}return a.prototype.newRegionAttachment=function(a,b,e){a=this.atlas.findRegion(e);if(null==a)throw Error("Region not found in atlas: "+e+" (region attachment: "+b+")");a.renderObject=a;b=new d.RegionAttachment(b);return b.setRegion(a),
b},a.prototype.newMeshAttachment=function(a,b,e){a=this.atlas.findRegion(e);if(null==a)throw Error("Region not found in atlas: "+e+" (mesh attachment: "+b+")");a.renderObject=a;b=new d.MeshAttachment(b);return b.region=a,b},a.prototype.newBoundingBoxAttachment=function(a,b){return new d.BoundingBoxAttachment(b)},a.prototype.newPathAttachment=function(a,b){return new d.PathAttachment(b)},a.prototype.newPointAttachment=function(a,b){return new d.PointAttachment(b)},a.prototype.newClippingAttachment=
function(a,b){return new d.ClippingAttachment(b)},a}();d.AtlasAttachmentLoader=b})(h||(h={}));(function(d){d=d.BlendMode||(d.BlendMode={});d[d.Normal=0]="Normal";d[d.Additive=1]="Additive";d[d.Multiply=2]="Multiply";d[d.Screen=3]="Screen"})(h||(h={}));(function(d){var b=function(){function a(a,b,d){if(this.children=[],this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=
0,this.appliedValid=!1,this.a=0,this.b=0,this.worldX=0,this.c=0,this.d=0,this.worldY=0,this.sorted=!1,null==a)throw Error("data cannot be null.");if(null==b)throw Error("skeleton cannot be null.");this.data=a;this.skeleton=b;this.parent=d;this.setToSetupPose()}return a.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},a.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,
this.scaleX,this.scaleY,this.shearX,this.shearY)},a.prototype.updateWorldTransformWith=function(a,b,e,f,h,m,t){this.ax=a;this.ay=b;this.arotation=e;this.ascaleX=f;this.ascaleY=h;this.ashearX=m;this.ashearY=t;this.appliedValid=!0;var c=this.parent;if(null==c){t=e+90+t;var g=d.MathUtils.cosDeg(e+m)*f;c=d.MathUtils.cosDeg(t)*h;f*=d.MathUtils.sinDeg(e+m);h*=d.MathUtils.sinDeg(t);var k=this.skeleton;return k.flipX&&(a=-a,g=-g,c=-c),k.flipY&&(b=-b,f=-f,h=-h),this.a=g,this.b=c,this.c=f,this.d=h,this.worldX=
a+k.x,void(this.worldY=b+k.y)}k=c.a;var l=c.b,q=c.c,r=c.d;switch(this.worldX=k*a+l*b+c.worldX,this.worldY=q*a+r*b+c.worldY,this.data.transformMode){case d.TransformMode.Normal:return t=e+90+t,g=d.MathUtils.cosDeg(e+m)*f,c=d.MathUtils.cosDeg(t)*h,f*=d.MathUtils.sinDeg(e+m),h*=d.MathUtils.sinDeg(t),this.a=k*g+l*f,this.b=k*c+l*h,this.c=q*g+r*f,void(this.d=q*c+r*h);case d.TransformMode.OnlyTranslation:t=e+90+t;this.a=d.MathUtils.cosDeg(e+m)*f;this.b=d.MathUtils.cosDeg(t)*h;this.c=d.MathUtils.sinDeg(e+
m)*f;this.d=d.MathUtils.sinDeg(t)*h;break;case d.TransformMode.NoRotationOrReflection:c=0;1E-4<(g=k*k+q*q)?(l=q*(g=Math.abs(k*r-l*q)/g),r=k*g,c=Math.atan2(q,k)*d.MathUtils.radDeg):(k=0,q=0,c=90-Math.atan2(r,l)*d.MathUtils.radDeg);m=e+m-c;t=e+t-c+90;g=d.MathUtils.cosDeg(m)*f;c=d.MathUtils.cosDeg(t)*h;f*=d.MathUtils.sinDeg(m);h*=d.MathUtils.sinDeg(t);this.a=k*g-l*f;this.b=k*c-l*h;this.c=q*g+r*f;this.d=q*c+r*h;break;case d.TransformMode.NoScale:case d.TransformMode.NoScaleOrReflection:c=d.MathUtils.cosDeg(e);
b=d.MathUtils.sinDeg(e);a=k*c+l*b;b=q*c+r*b;1E-5<(g=Math.sqrt(a*a+b*b))&&(g=1/g);a*=g;b*=g;g=Math.sqrt(a*a+b*b);c=Math.PI/2+Math.atan2(b,a);e=Math.cos(c)*g;var n=Math.sin(c)*g;g=d.MathUtils.cosDeg(m)*f;c=d.MathUtils.cosDeg(90+t)*h;f*=d.MathUtils.sinDeg(m);h*=d.MathUtils.sinDeg(90+t);return(this.data.transformMode!=d.TransformMode.NoScaleOrReflection?0>k*r-l*q:this.skeleton.flipX!=this.skeleton.flipY)&&(e=-e,n=-n),this.a=a*g+e*f,this.b=a*c+e*h,this.c=b*g+n*f,void(this.d=b*c+n*h)}this.skeleton.flipX&&
(this.a=-this.a,this.b=-this.b);this.skeleton.flipY&&(this.c=-this.c,this.d=-this.d)},a.prototype.setToSetupPose=function(){var a=this.data;this.x=a.x;this.y=a.y;this.rotation=a.rotation;this.scaleX=a.scaleX;this.scaleY=a.scaleY;this.shearX=a.shearX;this.shearY=a.shearY},a.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*d.MathUtils.radDeg},a.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*d.MathUtils.radDeg},a.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*
this.a+this.c*this.c)},a.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},a.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var a=this.parent;if(null==a)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*d.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-
this.b*this.c)*d.MathUtils.radDeg);var b=a.a,e=a.b,f=a.c,h=a.d,m=1/(b*h-e*f),t=this.worldX-a.worldX;a=this.worldY-a.worldY;this.ax=t*h*m-a*e*m;this.ay=a*b*m-t*f*m;h*=m;b*=m;e*=m;m*=f;f=h*this.a-e*this.c;e=h*this.b-e*this.d;h=b*this.c-m*this.a;m=b*this.d-m*this.b;(this.ashearX=0,this.ascaleX=Math.sqrt(f*f+h*h),1E-4<this.ascaleX)?(b=f*m-e*h,this.ascaleY=b/this.ascaleX,this.ashearY=Math.atan2(f*e+h*m,b)*d.MathUtils.radDeg,this.arotation=Math.atan2(h,f)*d.MathUtils.radDeg):(this.ascaleX=0,this.ascaleY=
Math.sqrt(e*e+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,e)*d.MathUtils.radDeg)},a.prototype.worldToLocal=function(a){var c=this.a,b=this.b,d=this.c,e=this.d,f=1/(c*e-b*d),h=a.x-this.worldX,m=a.y-this.worldY;return a.x=h*e*f-m*b*f,a.y=m*c*f-h*d*f,a},a.prototype.localToWorld=function(a){var c=a.x,b=a.y;return a.x=c*this.a+b*this.b+this.worldX,a.y=c*this.c+b*this.d+this.worldY,a},a.prototype.worldToLocalRotation=function(a){var c=d.MathUtils.sinDeg(a);a=d.MathUtils.cosDeg(a);return Math.atan2(this.a*
c-this.c*a,this.d*a-this.b*c)*d.MathUtils.radDeg},a.prototype.localToWorldRotation=function(a){var c=d.MathUtils.sinDeg(a);a=d.MathUtils.cosDeg(a);return Math.atan2(a*this.c+c*this.d,a*this.a+c*this.b)*d.MathUtils.radDeg},a.prototype.rotateWorld=function(a){var c=this.a,b=this.b,e=this.c,f=this.d,h=d.MathUtils.cosDeg(a);a=d.MathUtils.sinDeg(a);this.a=h*c-a*e;this.b=h*b-a*f;this.c=a*c+h*e;this.d=a*b+h*f;this.appliedValid=!1},a}();d.Bone=b})(h||(h={}));(function(d){var b,a=function(){return function(a,
d,e){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=b.Normal,0>a)throw Error("index must be >= 0.");if(null==d)throw Error("name cannot be null.");this.index=a;this.name=d;this.parent=e}}();d.BoneData=a;(function(a){a[a.Normal=0]="Normal";a[a.OnlyTranslation=1]="OnlyTranslation";a[a.NoRotationOrReflection=2]="NoRotationOrReflection";a[a.NoScale=3]="NoScale";a[a.NoScaleOrReflection=4]="NoScaleOrReflection"})(b=d.TransformMode||(d.TransformMode=
{}))})(h||(h={}));(function(d){var b=function(){return function(a,c){if(null==c)throw Error("data cannot be null.");this.time=a;this.data=c}}();d.Event=b})(h||(h={}));(function(d){var b=function(){return function(a){this.name=a}}();d.EventData=b})(h||(h={}));(function(d){var b=function(){function a(a,b){if(this.mix=1,this.bendDirection=0,null==a)throw Error("data cannot be null.");if(null==b)throw Error("skeleton cannot be null.");this.data=a;this.mix=a.mix;this.bendDirection=a.bendDirection;this.bones=
[];for(var c=0;c<a.bones.length;c++)this.bones.push(b.findBone(a.bones[c].name));this.target=b.findBone(a.target.name)}return a.prototype.getOrder=function(){return this.data.order},a.prototype.apply=function(){this.update()},a.prototype.update=function(){var a=this.target,b=this.bones;switch(b.length){case 1:this.apply1(b[0],a.worldX,a.worldY,this.mix);break;case 2:this.apply2(b[0],b[1],a.worldX,a.worldY,this.bendDirection,this.mix)}},a.prototype.apply1=function(a,b,e,f){a.appliedValid||a.updateAppliedTransform();
var c=a.parent,g=1/(c.a*c.d-c.b*c.c);b-=c.worldX;e-=c.worldY;c=Math.atan2((e*c.a-b*c.c)*g-a.ay,(b*c.d-e*c.b)*g-a.ax)*d.MathUtils.radDeg-a.ashearX-a.arotation;0>a.ascaleX&&(c+=180);180<c?c-=360:-180>c&&(c+=360);a.updateWorldTransformWith(a.ax,a.ay,a.arotation+c*f,a.ascaleX,a.ascaleY,a.ashearX,a.ashearY)},a.prototype.apply2=function(a,b,e,f,h,m){if(0!=m){a.appliedValid||a.updateAppliedTransform();b.appliedValid||b.updateAppliedTransform();var c=a.ax,g=a.ay,k=a.ascaleX,l=a.ascaleY,q=b.ascaleX,r=0,n=
0,u=0;0>k?(k=-k,r=180,u=-1):(r=0,u=1);0>l&&(l=-l,u=-u);0>q?(q=-q,n=180):n=0;var B=b.ax,C=0,z=0,A=0,D=a.a,I=a.b,F=a.c,G=a.d,J=1E-4>=Math.abs(k-l);J?(z=D*B+I*(C=b.ay)+a.worldX,A=F*B+G*C+a.worldY):(C=0,z=D*B+a.worldX,A=F*B+a.worldY);var N=a.parent;D=N.a;I=N.b;F=N.c;var K=1/(D*(G=N.d)-I*F);e-=N.worldX;f-=N.worldY;var P=(e*G-f*I)*K-c,L=(f*D-e*F)*K-g;G=((e=z-N.worldX)*G-(f=A-N.worldY)*I)*K-c;F=(f*D-e*F)*K-g;K=Math.sqrt(G*G+F*F);F=b.data.length*q;q=z=0;a:if(J)D=(P*P+L*L-K*K-(F*=k)*F)/(2*K*F),-1>D?D=-1:1<
D&&(D=1),q=Math.acos(D)*h,D=K+F*D,I=F*Math.sin(q),z=Math.atan2(L*D-P*I,P*D+L*I);else{J=(D=k*F)*D;A=(I=l*F)*I;N=P*P+L*L;P=Math.atan2(L,P);var M=-2*A*K,U=A-J;if(0<=(G=M*M-4*U*(F=A*K*K+J*N-J*A))&&(L=Math.sqrt(G),0>M&&(L=-L),M=(L=-(M+L)/2)/U,L=F/L,L=Math.abs(M)<Math.abs(L)?M:L,L*L<=N)){f=Math.sqrt(N-L*L)*h;z=P-Math.atan2(f,L);q=Math.atan2(f/l,(L-K)/k);break a}k=d.MathUtils.PI;l=K-D;L=l*l;U=M=0;var R=K+D,O=R*R,H=0;-1<=(F=-D*K/(J-A))&&1>=F&&(F=Math.acos(F),(G=(e=D*Math.cos(F)+K)*e+(f=I*Math.sin(F))*f)<
L&&(k=F,L=G,l=e,M=f),G>O&&(U=F,O=G,R=e,H=f));N<=(L+O)/2?(z=P-Math.atan2(M*h,l),q=k*h):(z=P-Math.atan2(H*h,R),q=U*h)}h=Math.atan2(C,B)*u;D=a.arotation;180<(z=(z-h)*d.MathUtils.radDeg+r-D)?z-=360:-180>z&&(z+=360);a.updateWorldTransformWith(c,g,D+z*m,a.ascaleX,a.ascaleY,0,0);D=b.arotation;180<(q=((q+h)*d.MathUtils.radDeg-b.ashearX)*u+n-D)?q-=360:-180>q&&(q+=360);b.updateWorldTransformWith(B,C,D+q*m,b.ascaleX,b.ascaleY,b.ashearX,b.ashearY)}else b.updateWorldTransform()},a}();d.IkConstraint=b})(h||(h=
{}));(function(d){var b=function(){return function(a){this.order=0;this.bones=[];this.mix=this.bendDirection=1;this.name=a}}();d.IkConstraintData=b})(h||(h={}));(function(d){var b=function(){function a(a,b){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=[],this.positions=[],this.world=[],this.curves=[],this.lengths=[],this.segments=[],null==a)throw Error("data cannot be null.");if(null==b)throw Error("skeleton cannot be null.");this.data=a;this.bones=[];for(var c=
0,d=a.bones.length;c<d;c++)this.bones.push(b.findBone(a.bones[c].name));this.target=b.findSlot(a.target.name);this.position=a.position;this.spacing=a.spacing;this.rotateMix=a.rotateMix;this.translateMix=a.translateMix}return a.prototype.apply=function(){this.update()},a.prototype.update=function(){var c=this.target.getAttachment();if(c instanceof d.PathAttachment){var b=this.rotateMix,e=this.translateMix,f=0<b;if(0<e||f){var h=this.data,m=h.spacingMode,t=m==d.SpacingMode.Length,p=h.rotateMode,n=p==
d.RotateMode.Tangent,w=p==d.RotateMode.ChainScale,E=this.bones.length,x=n?E:E+1,y=this.bones,u=d.Utils.setArraySize(this.spaces,x),B=null,C=this.spacing;if(w||t){w&&(B=d.Utils.setArraySize(this.lengths,E));for(var z=0,A=x-1;z<A;){var D=(J=y[z]).data.length;if(D<a.epsilon)w&&(B[z]=0),u[++z]=0;else{var I=D*J.a,F=D*J.c;I=Math.sqrt(I*I+F*F);w&&(B[z]=I);u[++z]=(t?D+C:C)*I/D}}}else for(z=1;z<x;z++)u[z]=C;c=this.computeWorldPositions(c,x,n,h.positionMode==d.PositionMode.Percent,m==d.SpacingMode.Percent);
m=c[0];t=c[1];h=h.offsetRotation;0==h?p=p==d.RotateMode.Chain:(p=!1,h*=0<(G=this.target.bone).a*G.d-G.b*G.c?d.MathUtils.degRad:-d.MathUtils.degRad);z=0;for(var G=3;z<E;z++,G+=3){var J;(J=y[z]).worldX+=(m-J.worldX)*e;J.worldY+=(t-J.worldY)*e;x=(I=c[G])-m;C=(F=c[G+1])-t;w&&(m=B[z],0!=m&&(m=(Math.sqrt(x*x+C*C)/m-1)*b+1,J.a*=m,J.c*=m));if(m=I,t=F,f){I=J.a;F=J.b;A=J.c;D=J.d;var N=0;if(N=n?c[G-1]:0==u[z+1]?c[G+2]:Math.atan2(C,x),N-=Math.atan2(A,I),p){var K=Math.cos(N);var P=Math.sin(N);var L=J.data.length;
m+=(L*(K*I-P*A)-x)*b;t+=(L*(P*I+K*A)-C)*b}else N+=h;N>d.MathUtils.PI?N-=d.MathUtils.PI2:N<-d.MathUtils.PI&&(N+=d.MathUtils.PI2);N*=b;K=Math.cos(N);P=Math.sin(N);J.a=K*I-P*A;J.b=K*F-P*D;J.c=P*I+K*A;J.d=P*F+K*D}J.appliedValid=!1}}}},a.prototype.computeWorldPositions=function(c,b,e,f,h){var g=this.target,k=this.position,l=this.spaces,m=d.Utils.setArraySize(this.positions,3*b+2),q=null,n=c.closed,x=c.worldVerticesLength,y=x/6,u=a.NONE;if(!c.constantSpeed){var B=c.lengths,C=B[y-=n?1:2];if(f&&(k*=C),h)for(var z=
0;z<b;z++)l[z]*=C;q=d.Utils.setArraySize(this.world,8);for(h=f=z=0;z<b;z++,f+=3){var A=k+=H=l[z];if(n)0>(A%=C)&&(A+=C),h=0;else{if(0>A){u!=a.BEFORE&&(u=a.BEFORE,c.computeWorldVertices(g,2,4,q,0,2));this.addBeforePosition(A,q,0,m,f);continue}if(A>C){u!=a.AFTER&&(u=a.AFTER,c.computeWorldVertices(g,x-6,4,q,0,2));this.addAfterPosition(A-C,q,0,m,f);continue}}for(;;h++){var D=B[h];if(!(A>D)){A=0==h?A/D:(A-(W=B[h-1]))/(D-W);break}}h!=u&&(u=h,n&&h==y?(c.computeWorldVertices(g,x-4,4,q,0,2),c.computeWorldVertices(g,
0,4,q,4,2)):c.computeWorldVertices(g,6*h+2,8,q,0,2));this.addCurvePosition(A,q[0],q[1],q[2],q[3],q[4],q[5],q[6],q[7],m,f,e||0<z&&0==H)}return m}n?(x+=2,q=d.Utils.setArraySize(this.world,x),c.computeWorldVertices(g,2,x-4,q,0,2),c.computeWorldVertices(g,0,2,q,x-4,2),q[x-2]=q[0],q[x-1]=q[1]):(y--,x-=4,q=d.Utils.setArraySize(this.world,x),c.computeWorldVertices(g,2,x,q,0,2));c=d.Utils.setArraySize(this.curves,y);g=0;B=q[0];C=q[1];var I=D=0,F=0,G=0,J=0,N=0,K,P,L,M;for(A=(z=0,2);z<y;z++,A+=6){D=q[A];I=
q[A+1];F=q[A+2];G=q[A+3];J=q[A+4];N=q[A+5];var U=2*(K=.1875*(B-2*D+F))+(L=.09375*(3*(D-F)-B+J));var R=2*(P=.1875*(C-2*I+G))+(M=.09375*(3*(I-G)-C+N));K=.75*(D-B)+K+.16666667*L;P=.75*(I-C)+P+.16666667*M;g+=Math.sqrt(K*K+P*P);K+=U;P+=R;U+=L;R+=M;g+=Math.sqrt(K*K+P*P);K+=U;P+=R;g+=Math.sqrt(K*K+P*P);K+=U+L;P+=R+M;g+=Math.sqrt(K*K+P*P);c[z]=g;B=J;C=N}if(f&&(k*=g),h)for(z=0;z<b;z++)l[z]*=g;y=this.segments;var O=0;for(L=(z=0,f=0,h=0,0);z<b;z++,f+=3){var H;A=k+=H=l[z];if(n)0>(A%=g)&&(A+=g),h=0;else{if(0>
A){this.addBeforePosition(A,q,0,m,f);continue}if(A>g){this.addAfterPosition(A-g,q,x-4,m,f);continue}}for(;;h++)if(M=c[h],!(A>M)){A=0==h?A/M:(A-(W=c[h-1]))/(M-W);break}if(h!=u){u=h;var S=6*h;B=q[S];C=q[S+1];D=q[S+2];I=q[S+3];F=q[S+4];G=q[S+5];J=q[S+6];N=q[S+7];U=2*(K=.03*(B-2*D+F))+(L=.006*(3*(D-F)-B+J));R=2*(P=.03*(C-2*I+G))+(M=.006*(3*(I-G)-C+N));K=.3*(D-B)+K+.16666667*L;P=.3*(I-C)+P+.16666667*M;O=Math.sqrt(K*K+P*P);y[0]=O;for(S=1;8>S;S++)K+=U,P+=R,U+=L,R+=M,O+=Math.sqrt(K*K+P*P),y[S]=O;K+=U;P+=
R;O+=Math.sqrt(K*K+P*P);y[8]=O;K+=U+L;P+=R+M;O+=Math.sqrt(K*K+P*P);y[9]=O;L=0}for(A*=O;;L++)if(M=y[L],!(A>M)){var W;A=0==L?A/M:L+(A-(W=y[L-1]))/(M-W);break}this.addCurvePosition(.1*A,B,C,D,I,F,G,J,N,m,f,e||0<z&&0==H)}return m},a.prototype.addBeforePosition=function(a,b,d,e,f){var c=b[d],g=b[d+1];b=Math.atan2(b[d+3]-g,b[d+2]-c);e[f]=c+a*Math.cos(b);e[f+1]=g+a*Math.sin(b);e[f+2]=b},a.prototype.addAfterPosition=function(a,b,d,e,f){var c=b[d+2],g=b[d+3];b=Math.atan2(g-b[d+1],c-b[d]);e[f]=c+a*Math.cos(b);
e[f+1]=g+a*Math.sin(b);e[f+2]=b},a.prototype.addCurvePosition=function(a,b,d,e,f,h,m,p,n,w,E,x){(0==a||isNaN(a))&&(a=1E-4);var c=a*a,g=c*a,k=1-a,l=k*k,q=l*k,r=k*a,t=3*r;k*=t;a*=t;p=b*q+e*k+h*a+p*g;n=d*q+f*k+m*a+n*g;w[E]=p;w[E+1]=n;x&&(w[E+2]=Math.atan2(n-(d*l+f*r*2+m*c),p-(b*l+e*r*2+h*c)))},a.prototype.getOrder=function(){return this.data.order},a.NONE=-1,a.BEFORE=-2,a.AFTER=-3,a.epsilon=1E-5,a}();d.PathConstraint=b})(h||(h={}));(function(d){var b=function(){return function(a){this.order=0;this.bones=
[];this.name=a}}();d.PathConstraintData=b;(function(a){a[a.Fixed=0]="Fixed";a[a.Percent=1]="Percent"})(d.PositionMode||(d.PositionMode={}));(function(a){a[a.Length=0]="Length";a[a.Fixed=1]="Fixed";a[a.Percent=2]="Percent"})(d.SpacingMode||(d.SpacingMode={}));(function(a){a[a.Tangent=0]="Tangent";a[a.Chain=1]="Chain";a[a.ChainScale=2]="ChainScale"})(d.RotateMode||(d.RotateMode={}))})(h||(h={}));(function(d){var b=function(){function a(a){this.toLoad=[];this.assets={};this.clientId=a}return a.prototype.loaded=
function(){var a=0,c;for(c in this.assets)a++;return a},a}(),a=function(){function a(a){void 0===a&&(a="");this.clientAssets={};this.queuedAssets={};this.rawAssets={};this.errors={};this.pathPrefix=a}return a.prototype.queueAsset=function(a,c,d){var e=this.clientAssets[a];return null!==e&&void 0!==e||(e=new b(a),this.clientAssets[a]=e),null!==c&&(e.textureLoader=c),e.toLoad.push(d),this.queuedAssets[d]!==d&&(this.queuedAssets[d]=d,!0)},a.prototype.loadText=function(a,c){var b=this;if(c=this.pathPrefix+
c,this.queueAsset(a,null,c)){var d=new XMLHttpRequest;d.onreadystatechange=function(){d.readyState==XMLHttpRequest.DONE&&(200<=d.status&&300>d.status?b.rawAssets[c]=d.responseText:b.errors[c]="Couldn't load text "+c+": status "+d.status+", "+d.responseText)};d.open("GET",c,!0);d.send()}},a.prototype.loadJson=function(a,c){var b=this;if(c=this.pathPrefix+c,this.queueAsset(a,null,c)){var d=new XMLHttpRequest;d.onreadystatechange=function(){d.readyState==XMLHttpRequest.DONE&&(200<=d.status&&300>d.status?
b.rawAssets[c]=JSON.parse(d.responseText):b.errors[c]="Couldn't load text "+c+": status "+d.status+", "+d.responseText)};d.open("GET",c,!0);d.send()}},a.prototype.loadTexture=function(a,c,b){var d=this;if(b=this.pathPrefix+b,this.queueAsset(a,c,b)){var e=new Image;e.src=b;e.crossOrigin="anonymous";e.onload=function(a){d.rawAssets[b]=e};e.onerror=function(a){d.errors[b]="Couldn't load image "+b}}},a.prototype.get=function(a,c){c=this.pathPrefix+c;a=this.clientAssets[a];return null===a||void 0===a||
a.assets[c]},a.prototype.updateClientAssets=function(a){for(var c=0;c<a.toLoad.length;c++){var b=a.toLoad[c],d=a.assets[b];if(null===d||void 0===d)d=this.rawAssets[b],null!==d&&void 0!==d&&(d instanceof HTMLImageElement?a.assets[b]=a.textureLoader(d):a.assets[b]=d)}},a.prototype.isLoadingComplete=function(a){a=this.clientAssets[a];return null===a||void 0===a||(this.updateClientAssets(a),a.toLoad.length==a.loaded())},a.prototype.dispose=function(){},a.prototype.hasErrors=function(){return 0<Object.keys(this.errors).length},
a.prototype.getErrors=function(){return this.errors},a}();d.SharedAssetManager=a})(h||(h={}));(function(d){var b=function(){function a(a){if(this._updateCache=[],this.updateCacheReset=[],this.time=0,this.flipX=!1,this.flipY=!1,this.x=0,this.y=0,null==a)throw Error("data cannot be null.");this.data=a;this.bones=[];for(var c=0;c<a.bones.length;c++){var b=a.bones[c];if(null==b.parent)b=new d.Bone(b,this,null);else{var e=this.bones[b.parent.index];b=new d.Bone(b,this,e);e.children.push(b)}this.bones.push(b)}this.slots=
[];this.drawOrder=[];for(c=0;c<a.slots.length;c++)e=a.slots[c],e=(b=this.bones[e.boneData.index],new d.Slot(e,b)),this.slots.push(e),this.drawOrder.push(e);this.ikConstraints=[];for(c=0;c<a.ikConstraints.length;c++)this.ikConstraints.push(new d.IkConstraint(a.ikConstraints[c],this));this.transformConstraints=[];for(c=0;c<a.transformConstraints.length;c++)this.transformConstraints.push(new d.TransformConstraint(a.transformConstraints[c],this));this.pathConstraints=[];for(c=0;c<a.pathConstraints.length;c++)this.pathConstraints.push(new d.PathConstraint(a.pathConstraints[c],
this));this.color=new d.Color(1,1,1,1);this.updateCache()}return a.prototype.updateCache=function(){this._updateCache.length=0;this.updateCacheReset.length=0;for(var a=this.bones,b=0,d=a.length;b<d;b++)a[b].sorted=!1;d=this.ikConstraints;var e=this.transformConstraints,f=this.pathConstraints,h=d.length,m=e.length,p=f.length,n=h+m+p;b=0;a:for(;b<n;b++){for(var w=0;w<h;w++)if((E=d[w]).data.order==b){this.sortIkConstraint(E);continue a}for(w=0;w<m;w++)if((E=e[w]).data.order==b){this.sortTransformConstraint(E);
continue a}for(w=0;w<p;w++){var E;if((E=f[w]).data.order==b){this.sortPathConstraint(E);continue a}}}b=0;for(d=a.length;b<d;b++)this.sortBone(a[b])},a.prototype.sortIkConstraint=function(a){this.sortBone(a.target);var c=a.bones,b=c[0];if(this.sortBone(b),1<c.length){var d=c[c.length-1];-1<this._updateCache.indexOf(d)||this.updateCacheReset.push(d)}this._updateCache.push(a);this.sortReset(b.children);c[c.length-1].sorted=!0},a.prototype.sortPathConstraint=function(a){var c=a.target,b=c.data.index,
e=c.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,b,e);null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,b,e);for(var f=0,h=this.data.skins.length;f<h;f++)this.sortPathConstraintAttachment(this.data.skins[f],b,e);f=c.getAttachment();f instanceof d.PathAttachment&&this.sortPathConstraintAttachmentWith(f,e);e=a.bones;c=e.length;for(f=0;f<c;f++)this.sortBone(e[f]);this._updateCache.push(a);for(f=0;f<c;f++)this.sortReset(e[f].children);
for(f=0;f<c;f++)e[f].sorted=!0},a.prototype.sortTransformConstraint=function(a){this.sortBone(a.target);var c=a.bones,b=c.length;if(a.data.local)for(var d=0;d<b;d++){var e=c[d];this.sortBone(e.parent);-1<this._updateCache.indexOf(e)||this.updateCacheReset.push(e)}else for(d=0;d<b;d++)this.sortBone(c[d]);this._updateCache.push(a);for(a=0;a<b;a++)this.sortReset(c[a].children);for(a=0;a<b;a++)c[a].sorted=!0},a.prototype.sortPathConstraintAttachment=function(a,b,d){if(a=a.attachments[b])for(var c in a)this.sortPathConstraintAttachmentWith(a[c],
d)},a.prototype.sortPathConstraintAttachmentWith=function(a,b){if(a instanceof d.PathAttachment)if(a=a.bones,null==a)this.sortBone(b);else{b=this.bones;for(var c=0;c<a.length;){var e=a[c++];for(e=c+e;c<e;c++)this.sortBone(b[a[c]])}}},a.prototype.sortBone=function(a){if(!a.sorted){var c=a.parent;null!=c&&this.sortBone(c);a.sorted=!0;this._updateCache.push(a)}},a.prototype.sortReset=function(a){for(var c=0,b=a.length;c<b;c++){var d=a[c];d.sorted&&this.sortReset(d.children);d.sorted=!1}},a.prototype.updateWorldTransform=
function(){for(var a=this.updateCacheReset,b=0,d=a.length;b<d;b++){var e=a[b];e.ax=e.x;e.ay=e.y;e.arotation=e.rotation;e.ascaleX=e.scaleX;e.ascaleY=e.scaleY;e.ashearX=e.shearX;e.ashearY=e.shearY;e.appliedValid=!0}a=this._updateCache;b=0;for(d=a.length;b<d;b++)a[b].update()},a.prototype.setToSetupPose=function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},a.prototype.setBonesToSetupPose=function(){for(var a=this.bones,b=0,d=a.length;b<d;b++)a[b].setToSetupPose();a=this.ikConstraints;b=0;
for(d=a.length;b<d;b++)(f=a[b]).bendDirection=f.data.bendDirection,f.mix=f.data.mix;var e=this.transformConstraints;b=0;for(d=e.length;b<d;b++)a=(f=e[b]).data,f.rotateMix=a.rotateMix,f.translateMix=a.translateMix,f.scaleMix=a.scaleMix,f.shearMix=a.shearMix;e=this.pathConstraints;b=0;for(d=e.length;b<d;b++){var f;a=(f=e[b]).data;f.position=a.position;f.spacing=a.spacing;f.rotateMix=a.rotateMix;f.translateMix=a.translateMix}},a.prototype.setSlotsToSetupPose=function(){var a=this.slots;d.Utils.arrayCopy(a,
0,this.drawOrder,0,a.length);for(var b=0,e=a.length;b<e;b++)a[b].setToSetupPose()},a.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},a.prototype.findBone=function(a){if(null==a)throw Error("boneName cannot be null.");for(var c=this.bones,b=0,d=c.length;b<d;b++){var e=c[b];if(e.data.name==a)return e}return null},a.prototype.findBoneIndex=function(a){if(null==a)throw Error("boneName cannot be null.");for(var c=this.bones,b=0,d=c.length;b<d;b++)if(c[b].data.name==a)return b;
return-1},a.prototype.findSlot=function(a){if(null==a)throw Error("slotName cannot be null.");for(var c=this.slots,b=0,d=c.length;b<d;b++){var e=c[b];if(e.data.name==a)return e}return null},a.prototype.findSlotIndex=function(a){if(null==a)throw Error("slotName cannot be null.");for(var c=this.slots,b=0,d=c.length;b<d;b++)if(c[b].data.name==a)return b;return-1},a.prototype.setSkinByName=function(a){var c=this.data.findSkin(a);if(null==c)throw Error("Skin not found: "+a);this.setSkin(c)},a.prototype.setSkin=
function(a){if(null!=a)if(null!=this.skin)a.attachAll(this,this.skin);else for(var c=this.slots,b=0,d=c.length;b<d;b++){var e=c[b],f=e.data.attachmentName;null!=f&&(f=a.getAttachment(b,f),null!=f&&e.setAttachment(f))}this.skin=a},a.prototype.getAttachmentByName=function(a,b){return this.getAttachment(this.data.findSlotIndex(a),b)},a.prototype.getAttachment=function(a,b){if(null==b)throw Error("attachmentName cannot be null.");if(null!=this.skin){var c=this.skin.getAttachment(a,b);if(null!=c)return c}return null!=
this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},a.prototype.setAttachment=function(a,b){if(null==a)throw Error("slotName cannot be null.");for(var c=this.slots,d=0,e=c.length;d<e;d++){var f=c[d];if(f.data.name==a){c=null;if(null!=b&&null==(c=this.getAttachment(d,b)))throw Error("Attachment not found: "+b+", for slot: "+a);return void f.setAttachment(c)}}throw Error("Slot not found: "+a);},a.prototype.findIkConstraint=function(a){if(null==a)throw Error("constraintName cannot be null.");
for(var c=this.ikConstraints,b=0,d=c.length;b<d;b++){var e=c[b];if(e.data.name==a)return e}return null},a.prototype.findTransformConstraint=function(a){if(null==a)throw Error("constraintName cannot be null.");for(var c=this.transformConstraints,b=0,d=c.length;b<d;b++){var e=c[b];if(e.data.name==a)return e}return null},a.prototype.findPathConstraint=function(a){if(null==a)throw Error("constraintName cannot be null.");for(var c=this.pathConstraints,b=0,d=c.length;b<d;b++){var e=c[b];if(e.data.name==
a)return e}return null},a.prototype.getBounds=function(a,b,e){if(null==a)throw Error("offset cannot be null.");if(null==b)throw Error("size cannot be null.");for(var c=this.drawOrder,f=Number.POSITIVE_INFINITY,g=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,m=0,n=c.length;m<n;m++){var E=c[m],x=null,y=E.getAttachment();if(y instanceof d.RegionAttachment){var u=8;x=d.Utils.setArraySize(e,u,0);y.computeWorldVertices(E.bone,x,0,2)}else y instanceof d.MeshAttachment&&(u=
y.worldVerticesLength,x=d.Utils.setArraySize(e,u,0),y.computeWorldVertices(E,0,u,x,0,2));if(null!=x)for(E=0,u=x.length;E<u;E+=2){y=x[E];var B=x[E+1];f=Math.min(f,y);g=Math.min(g,B);k=Math.max(k,y);h=Math.max(h,B)}}a.set(f,g);b.set(k-f,h-g)},a.prototype.update=function(a){this.time+=a},a}();d.Skeleton=b})(h||(h={}));(function(d){var b=function(){function a(){this.maxY=this.maxX=this.minY=this.minX=0;this.boundingBoxes=[];this.polygons=[];this.polygonPool=new d.Pool(function(){return d.Utils.newFloatArray(16)})}
return a.prototype.update=function(a,b){if(null==a)throw Error("skeleton cannot be null.");var c=this.boundingBoxes,e=this.polygons,f=this.polygonPool;a=a.slots;var g=a.length;c.length=0;f.freeAll(e);for(var h=e.length=0;h<g;h++){var m=a[h],n=m.getAttachment();if(n instanceof d.BoundingBoxAttachment){c.push(n);var w=f.obtain();w.length!=n.worldVerticesLength&&(w=d.Utils.newFloatArray(n.worldVerticesLength));e.push(w);n.computeWorldVertices(m,0,n.worldVerticesLength,w,0,2)}}b?this.aabbCompute():(this.minX=
Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},a.prototype.aabbCompute=function(){for(var a=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,e=Number.NEGATIVE_INFINITY,f=this.polygons,h=0,m=f.length;h<m;h++){var p=f[h],n=p,w=0;for(p=p.length;w<p;w+=2){var E=n[w],x=n[w+1];a=Math.min(a,E);b=Math.min(b,x);d=Math.max(d,E);e=Math.max(e,x)}}this.minX=a;this.minY=b;this.maxX=d;this.maxY=e},
a.prototype.aabbContainsPoint=function(a,b){return a>=this.minX&&a<=this.maxX&&b>=this.minY&&b<=this.maxY},a.prototype.aabbIntersectsSegment=function(a,b,d,e){var c=this.minX,f=this.minY,g=this.maxX,k=this.maxY;if(a<=c&&d<=c||b<=f&&e<=f||a>=g&&d>=g||b>=k&&e>=k)return!1;d=(e-b)/(d-a);e=d*(c-a)+b;if(e>f&&e<k||(e=d*(g-a)+b)>f&&e<k)return!0;f=(f-b)/d+a;return f>c&&f<g||(f=(k-b)/d+a)>c&&f<g},a.prototype.aabbIntersectsSkeleton=function(a){return this.minX<a.maxX&&this.maxX>a.minX&&this.minY<a.maxY&&this.maxY>
a.minY},a.prototype.containsPoint=function(a,b){for(var c=this.polygons,d=0,e=c.length;d<e;d++)if(this.containsPointPolygon(c[d],a,b))return this.boundingBoxes[d];return null},a.prototype.containsPointPolygon=function(a,b,d){for(var c=a.length,e=c-2,f=!1,g=0;g<c;g+=2){var k=a[g+1],h=a[e+1];if(k<d&&h>=d||h<d&&k>=d){var m=a[g];m+(d-k)/(h-k)*(a[e]-m)<b&&(f=!f)}e=g}return f},a.prototype.intersectsSegment=function(a,b,d,e){for(var c=this.polygons,f=0,g=c.length;f<g;f++)if(this.intersectsSegmentPolygon(c[f],
a,b,d,e))return this.boundingBoxes[f];return null},a.prototype.intersectsSegmentPolygon=function(a,b,d,e,f){for(var c=a.length,g=b-e,k=d-f,l=b*f-d*e,h=a[c-2],m=a[c-1],q=0;q<c;q+=2){var n=a[q],u=a[q+1],B=h*u-m*n,C=h-n,z=m-u,A=g*z-k*C;C=(l*C-g*B)/A;if((C>=h&&C<=n||C>=n&&C<=h)&&(C>=b&&C<=e||C>=e&&C<=b)&&(h=(l*z-k*B)/A,(h>=m&&h<=u||h>=u&&h<=m)&&(h>=d&&h<=f||h>=f&&h<=d)))return!0;h=n;m=u}return!1},a.prototype.getPolygon=function(a){if(null==a)throw Error("boundingBox cannot be null.");a=this.boundingBoxes.indexOf(a);
return-1==a?null:this.polygons[a]},a.prototype.getWidth=function(){return this.maxX-this.minX},a.prototype.getHeight=function(){return this.maxY-this.minY},a}();d.SkeletonBounds=b})(h||(h={}));(function(d){var b=function(){function a(){this.triangulator=new d.Triangulator;this.clippingPolygon=[];this.clipOutput=[];this.clippedVertices=[];this.clippedTriangles=[];this.scratch=[]}return a.prototype.clipStart=function(b,e){if(null!=this.clipAttachment)return 0;this.clipAttachment=e;var c=e.worldVerticesLength,
f=d.Utils.setArraySize(this.clippingPolygon,c);e.computeWorldVertices(b,0,c,f,0,2);b=this.clippingPolygon;a.makeClockwise(b);b=this.clippingPolygons=this.triangulator.decompose(b,this.triangulator.triangulate(b));e=0;for(c=b.length;e<c;e++)f=b[e],a.makeClockwise(f),f.push(f[0]),f.push(f[1]);return b.length},a.prototype.clipEndWithSlot=function(a){null!=this.clipAttachment&&this.clipAttachment.endSlot==a.data&&this.clipEnd()},a.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=
null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},a.prototype.isClipping=function(){return null!=this.clipAttachment},a.prototype.clipTriangles=function(a,b,e,f,h,m,n,p,v,w,E,x){b=this.clipOutput;var c=this.clippedVertices,g=this.clippedTriangles,k=this.clippingPolygons,l=this.clippingPolygons.length,q=p?12:8,r=0;w=w||0;E=E||0;x=x||0;c.length=0;g.length=0;var t=w;f=w+f;a:for(;t<f;t+=3){var I=e[t]*v,F=I+E,G=I+x;w=a[F];var J=
a[F+1],N=h[G],K=h[G+1];G=(I=e[t+1]*v)+x;var P=a[F=I+E],L=a[F+1],M=h[G],U=h[G+1];G=(I=e[t+2]*v)+x;I=a[F=I+E];F=a[F+1];var R=h[G];G=h[G+1];for(var O=0;O<l;O++){var H=c.length;if(!this.clip(w,J,P,L,I,F,k[O],b)){(V=d.Utils.setArraySize(c,H+3*q))[H]=w;V[H+1]=J;V[H+2]=m.r;V[H+3]=m.g;V[H+4]=m.b;V[H+5]=m.a;p?(V[H+6]=N,V[H+7]=K,V[H+8]=n.r,V[H+9]=n.g,V[H+10]=n.b,V[H+11]=n.a,V[H+12]=P,V[H+13]=L,V[H+14]=m.r,V[H+15]=m.g,V[H+16]=m.b,V[H+17]=m.a,V[H+18]=M,V[H+19]=U,V[H+20]=n.r,V[H+21]=n.g,V[H+22]=n.b,V[H+23]=n.a,
V[H+24]=I,V[H+25]=F,V[H+26]=m.r,V[H+27]=m.g,V[H+28]=m.b,V[H+29]=m.a,V[H+30]=R,V[H+31]=G,V[H+32]=n.r,V[H+33]=n.g,V[H+34]=n.b,V[H+35]=n.a):(V[H+6]=N,V[H+7]=K,V[H+8]=P,V[H+9]=L,V[H+10]=m.r,V[H+11]=m.g,V[H+12]=m.b,V[H+13]=m.a,V[H+14]=M,V[H+15]=U,V[H+16]=I,V[H+17]=F,V[H+18]=m.r,V[H+19]=m.g,V[H+20]=m.b,V[H+21]=m.a,V[H+22]=R,V[H+23]=G);H=g.length;(aa=d.Utils.setArraySize(g,H+3))[H]=r;aa[H+1]=r+1;aa[H+2]=r+2;r+=3;continue a}aa=b.length;if(0!=aa){for(var S=L-F,W=I-P,T=w-I,Q=F-J,Y=1/(S*T+W*(J-F)),Z=aa>>1,ba=
this.clipOutput,V=d.Utils.setArraySize(c,H+Z*q),X=0;X<aa;X+=2){var ea=ba[X],fa=ba[X+1];V[H]=ea;V[H+1]=fa;V[H+2]=m.r;V[H+3]=m.g;V[H+4]=m.b;V[H+5]=m.a;ea-=I;var ha=fa-F;fa=(S*ea+W*ha)*Y;ea=(Q*ea+T*ha)*Y;ha=1-fa-ea;V[H+6]=N*fa+M*ea+R*ha;V[H+7]=K*fa+U*ea+G*ha;p&&(V[H+8]=n.r,V[H+9]=n.g,V[H+10]=n.b,V[H+11]=n.a);H+=q}H=g.length;var aa=d.Utils.setArraySize(g,H+3*(Z-2));Z--;for(X=1;X<Z;X++)aa[H]=r,aa[H+1]=r+X,aa[H+2]=r+X+1,H+=3;r+=Z+1}}}},a.prototype.clip=function(a,b,d,e,f,h,m,p){var c=p,g=!1,k=null;2<=m.length%
4?(k=p,p=this.scratch):k=this.scratch;k.length=0;k.push(a);k.push(b);k.push(d);k.push(e);k.push(f);k.push(h);k.push(a);k.push(b);p.length=0;b=m.length-4;for(a=0;;a+=2){d=m[a];e=m[a+1];f=m[a+2];h=m[a+3];for(var l=d-f,q=e-h,r=k,n=k.length-2,t=p.length,z=0;z<n;z+=2){var A=r[z],D=r[z+1],I=r[z+2],F=r[z+3],G=0<l*(F-h)-q*(I-f);if(0<l*(D-h)-q*(A-f)){if(G){p.push(I);p.push(F);continue}g=((N=I-A)*(e-D)-(J=F-D)*(d-A))/(J*(f-d)-N*(h-e));p.push(d+(f-d)*g);p.push(e+(h-e)*g)}else if(G){var J,N;g=((N=I-A)*(e-D)-
(J=F-D)*(d-A))/(J*(f-d)-N*(h-e));p.push(d+(f-d)*g);p.push(e+(h-e)*g);p.push(I);p.push(F)}g=!0}if(t==p.length)return c.length=0,!0;if(p.push(p[0]),p.push(p[1]),a==b)break;d=p;(p=k).length=0;k=d}if(c!=p)for(a=c.length=0,m=p.length-2;a<m;a++)c[a]=p[a];else c.length-=2;return g},a.makeClockwise=function(a){for(var b=a.length,c=a[b-2]*a[1]-a[0]*a[b-1],d,e,f,h=0,m=b-3;h<m;h+=2)d=a[h],e=a[h+1],f=a[h+2],c+=d*a[h+3]-f*e;if(!(0>c))for(h=0,c=b-2,m=b>>1;h<m;h+=2)b=a[h],d=a[h+1],e=c-h,a[h]=a[e],a[h+1]=a[e+1],
a[e]=b,a[e+1]=d},a}();d.SkeletonClipping=b})(h||(h={}));(function(d){var b=function(){function a(){this.bones=[];this.slots=[];this.skins=[];this.events=[];this.animations=[];this.ikConstraints=[];this.transformConstraints=[];this.pathConstraints=[];this.fps=0}return a.prototype.findBone=function(a){if(null==a)throw Error("boneName cannot be null.");for(var b=this.bones,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findBoneIndex=function(a){if(null==a)throw Error("boneName cannot be null.");
for(var b=this.bones,c=0,d=b.length;c<d;c++)if(b[c].name==a)return c;return-1},a.prototype.findSlot=function(a){if(null==a)throw Error("slotName cannot be null.");for(var b=this.slots,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findSlotIndex=function(a){if(null==a)throw Error("slotName cannot be null.");for(var b=this.slots,c=0,d=b.length;c<d;c++)if(b[c].name==a)return c;return-1},a.prototype.findSkin=function(a){if(null==a)throw Error("skinName cannot be null.");
for(var b=this.skins,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findEvent=function(a){if(null==a)throw Error("eventDataName cannot be null.");for(var b=this.events,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findAnimation=function(a){if(null==a)throw Error("animationName cannot be null.");for(var b=this.animations,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findIkConstraint=function(a){if(null==
a)throw Error("constraintName cannot be null.");for(var b=this.ikConstraints,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findTransformConstraint=function(a){if(null==a)throw Error("constraintName cannot be null.");for(var b=this.transformConstraints,c=0,d=b.length;c<d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findPathConstraint=function(a){if(null==a)throw Error("constraintName cannot be null.");for(var b=this.pathConstraints,c=0,d=b.length;c<
d;c++){var e=b[c];if(e.name==a)return e}return null},a.prototype.findPathConstraintIndex=function(a){if(null==a)throw Error("pathConstraintName cannot be null.");for(var b=this.pathConstraints,c=0,d=b.length;c<d;c++)if(b[c].name==a)return c;return-1},a}();d.SkeletonData=b})(h||(h={}));(function(d){var b=function(){function b(a){this.scale=1;this.linkedMeshes=[];this.attachmentLoader=a}return b.prototype.readSkeletonData=function(a){var c=this.scale,e=new d.SkeletonData;a="string"==typeof a?JSON.parse(a):
a;var f=a.skeleton;if(null!=f&&(e.hash=f.hash,e.version=f.spine,e.width=f.width,e.height=f.height,e.fps=f.fps,e.imagesPath=f.images),a.bones)for(f=0;f<a.bones.length;f++){var g=a.bones[f],h=null,m=this.getValue(g,"parent",null);if(null!=m&&null==(h=e.findBone(m)))throw Error("Parent bone not found: "+m);(h=new d.BoneData(e.bones.length,g.name,h)).length=this.getValue(g,"length",0)*c;h.x=this.getValue(g,"x",0)*c;h.y=this.getValue(g,"y",0)*c;h.rotation=this.getValue(g,"rotation",0);h.scaleX=this.getValue(g,
"scaleX",1);h.scaleY=this.getValue(g,"scaleY",1);h.shearX=this.getValue(g,"shearX",0);h.shearY=this.getValue(g,"shearY",0);h.transformMode=b.transformModeFromString(this.getValue(g,"transform","normal"));e.bones.push(h)}if(a.slots)for(f=0;f<a.slots.length;f++){var n=(g=a.slots[f]).name;m=g.bone;h=e.findBone(m);if(null==h)throw Error("Slot bone not found: "+m);h=new d.SlotData(e.slots.length,n,h);m=this.getValue(g,"color",null);null!=m&&h.color.setFromString(m);m=this.getValue(g,"dark",null);null!=
m&&(h.darkColor=new d.Color(1,1,1,1),h.darkColor.setFromString(m));h.attachmentName=this.getValue(g,"attachment",null);h.blendMode=b.blendModeFromString(this.getValue(g,"blend","normal"));e.slots.push(h)}if(a.ik)for(f=0;f<a.ik.length;f++){g=a.ik[f];(h=new d.IkConstraintData(g.name)).order=this.getValue(g,"order",0);for(var w=0;w<g.bones.length;w++){m=g.bones[w];if(null==(E=e.findBone(m)))throw Error("IK bone not found: "+m);h.bones.push(E)}m=g.target;if(h.target=e.findBone(m),null==h.target)throw Error("IK target bone not found: "+
m);h.bendDirection=this.getValue(g,"bendPositive",!0)?1:-1;h.mix=this.getValue(g,"mix",1);e.ikConstraints.push(h)}if(a.transform)for(f=0;f<a.transform.length;f++){g=a.transform[f];(h=new d.TransformConstraintData(g.name)).order=this.getValue(g,"order",0);for(w=0;w<g.bones.length;w++){m=g.bones[w];if(null==(E=e.findBone(m)))throw Error("Transform constraint bone not found: "+m);h.bones.push(E)}m=g.target;if(h.target=e.findBone(m),null==h.target)throw Error("Transform constraint target bone not found: "+
m);h.local=this.getValue(g,"local",!1);h.relative=this.getValue(g,"relative",!1);h.offsetRotation=this.getValue(g,"rotation",0);h.offsetX=this.getValue(g,"x",0)*c;h.offsetY=this.getValue(g,"y",0)*c;h.offsetScaleX=this.getValue(g,"scaleX",0);h.offsetScaleY=this.getValue(g,"scaleY",0);h.offsetShearY=this.getValue(g,"shearY",0);h.rotateMix=this.getValue(g,"rotateMix",1);h.translateMix=this.getValue(g,"translateMix",1);h.scaleMix=this.getValue(g,"scaleMix",1);h.shearMix=this.getValue(g,"shearMix",1);
e.transformConstraints.push(h)}if(a.path)for(f=0;f<a.path.length;f++){g=a.path[f];(h=new d.PathConstraintData(g.name)).order=this.getValue(g,"order",0);for(w=0;w<g.bones.length;w++){var E;m=g.bones[w];if(null==(E=e.findBone(m)))throw Error("Transform constraint bone not found: "+m);h.bones.push(E)}m=g.target;if(h.target=e.findSlot(m),null==h.target)throw Error("Path target slot not found: "+m);h.positionMode=b.positionModeFromString(this.getValue(g,"positionMode","percent"));h.spacingMode=b.spacingModeFromString(this.getValue(g,
"spacingMode","length"));h.rotateMode=b.rotateModeFromString(this.getValue(g,"rotateMode","tangent"));h.offsetRotation=this.getValue(g,"rotation",0);h.position=this.getValue(g,"position",0);h.positionMode==d.PositionMode.Fixed&&(h.position*=c);h.spacing=this.getValue(g,"spacing",0);h.spacingMode!=d.SpacingMode.Length&&h.spacingMode!=d.SpacingMode.Fixed||(h.spacing*=c);h.rotateMix=this.getValue(g,"rotateMix",1);h.translateMix=this.getValue(g,"translateMix",1);e.pathConstraints.push(h)}if(a.skins)for(var x in a.skins){f=
a.skins[x];c=new d.Skin(x);for(n in f){h=e.findSlotIndex(n);if(-1==h)throw Error("Slot not found: "+n);g=f[n];for(var y in g)m=this.readAttachment(g[y],c,h,y,e),null!=m&&c.addAttachment(h,y,m)}e.skins.push(c);"default"==c.name&&(e.defaultSkin=c)}f=0;for(n=this.linkedMeshes.length;f<n;f++){x=this.linkedMeshes[f];if(null==(c=null==x.skin?e.defaultSkin:e.findSkin(x.skin)))throw Error("Skin not found: "+x.skin);y=c.getAttachment(x.slotIndex,x.parent);if(null==y)throw Error("Parent mesh not found: "+x.parent);
x.mesh.setParentMesh(y);x.mesh.updateUVs()}if(this.linkedMeshes.length=0,a.events)for(var u in a.events)n=a.events[u],(h=new d.EventData(u)).intValue=this.getValue(n,"int",0),h.floatValue=this.getValue(n,"float",0),h.stringValue=this.getValue(n,"string",""),e.events.push(h);if(a.animations)for(var B in a.animations)this.readAnimation(a.animations[B],B,e);return e},b.prototype.readAttachment=function(b,c,e,f,h){var g=this.scale;switch(f=this.getValue(b,"name",f),this.getValue(b,"type","region")){case "region":return h=
this.getValue(b,"path",f),e=this.attachmentLoader.newRegionAttachment(c,f,h),null==e?null:(e.path=h,e.x=this.getValue(b,"x",0)*g,e.y=this.getValue(b,"y",0)*g,e.scaleX=this.getValue(b,"scaleX",1),e.scaleY=this.getValue(b,"scaleY",1),e.rotation=this.getValue(b,"rotation",0),e.width=b.width*g,e.height=b.height*g,null!=(k=this.getValue(b,"color",null))&&e.color.setFromString(k),e.updateOffset(),e);case "boundingbox":return g=this.attachmentLoader.newBoundingBoxAttachment(c,f),null==g?null:(this.readVertices(b,
g,b.vertexCount<<1),null!=(k=this.getValue(b,"color",null))&&g.color.setFromString(k),g);case "mesh":case "linkedmesh":h=this.getValue(b,"path",f);g=this.attachmentLoader.newMeshAttachment(c,f,h);if(null==g)break;g.path=h;null!=(k=this.getValue(b,"color",null))&&g.color.setFromString(k);k=this.getValue(b,"parent",null);if(null!=k)return g.inheritDeform=this.getValue(b,"deform",!0),this.linkedMeshes.push(new a(g,this.getValue(b,"skin",null),e,k)),g;k=b.uvs;return this.readVertices(b,g,k.length),g.triangles=
b.triangles,g.regionUVs=k,g.updateUVs(),g.hullLength=2*this.getValue(b,"hull",0),g;case "path":if(null==(h=this.attachmentLoader.newPathAttachment(c,f)))break;h.closed=this.getValue(b,"closed",!1);h.constantSpeed=this.getValue(b,"constantSpeed",!0);e=b.vertexCount;this.readVertices(b,h,e<<1);e=d.Utils.newArray(e/3,0);for(c=0;c<b.lengths.length;c++)e[c]=b.lengths[c]*g;return h.lengths=e,null!=(k=this.getValue(b,"color",null))&&h.color.setFromString(k),h;case "point":return h=this.attachmentLoader.newPointAttachment(c,
f),null==h?null:(h.x=this.getValue(b,"x",0)*g,h.y=this.getValue(b,"y",0)*g,h.rotation=this.getValue(b,"rotation",0),null!=(k=this.getValue(b,"color",null))&&h.color.setFromString(k),h);case "clipping":if(g=this.attachmentLoader.newClippingAttachment(c,f),null!=g){e=this.getValue(b,"end",null);if(null!=e){h=h.findSlot(e);if(null==h)throw Error("Clipping end slot not found: "+e);g.endSlot=h}var k;e=b.vertexCount;return this.readVertices(b,g,e<<1),null!=(k=this.getValue(b,"color",null))&&g.color.setFromString(k),
g}}return null},b.prototype.readVertices=function(a,b,c){var e=this.scale;b.worldVerticesLength=c;a=a.vertices;if(c!=a.length){var f=[],g=[];c=0;for(h=a.length;c<h;){var k=a[c++];g.push(k);for(k=c+4*k;c<k;c+=4)g.push(a[c]),f.push(a[c+1]*e),f.push(a[c+2]*e),f.push(a[c+3])}b.bones=g;b.vertices=d.Utils.toFloatArray(f)}else{f=d.Utils.toFloatArray(a);if(1!=e){c=0;for(var h=a.length;c<h;c++)f[c]*=e}b.vertices=f}},b.prototype.readAnimation=function(a,b,c){var e=this.scale,f=[],g=0;if(a.slots)for(var k in a.slots){var h=
a.slots[k];if(-1==(K=c.findSlotIndex(k)))throw Error("Slot not found: "+k);for(var l in h){var m=h[l];if("attachment"==l){(A=new d.AttachmentTimeline(m.length)).slotIndex=K;for(var n=0,y=0;y<m.length;y++){var u=m[y];A.setFrame(n++,u.time,u.name)}f.push(A);g=Math.max(g,A.frames[A.getFrameCount()-1])}else if("color"==l){(A=new d.ColorTimeline(m.length)).slotIndex=K;for(y=n=0;y<m.length;y++){u=m[y];var B=new d.Color;B.setFromString(u.color);A.setFrame(n,u.time,B.r,B.g,B.b,B.a);this.readCurve(u,A,n);
n++}f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.ColorTimeline.ENTRIES])}else{if("twoColor"!=l)throw Error("Invalid timeline type for a slot: "+l+" ("+k+")");(A=new d.TwoColorTimeline(m.length)).slotIndex=K;for(y=n=0;y<m.length;y++){u=m[y];B=new d.Color;var C=new d.Color;B.setFromString(u.light);C.setFromString(u.dark);A.setFrame(n,u.time,B.r,B.g,B.b,B.a,C.r,C.g,C.b);this.readCurve(u,A,n);n++}f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.TwoColorTimeline.ENTRIES])}}}if(a.bones)for(var z in a.bones){h=
a.bones[z];B=c.findBoneIndex(z);if(-1==B)throw Error("Bone not found: "+z);for(l in h)if(m=h[l],"rotate"===l){(A=new d.RotateTimeline(m.length)).boneIndex=B;for(y=n=0;y<m.length;y++)u=m[y],A.setFrame(n,u.time,u.angle),this.readCurve(u,A,n),n++;f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.RotateTimeline.ENTRIES])}else{if("translate"!==l&&"scale"!==l&&"shear"!==l)throw Error("Invalid timeline type for a bone: "+l+" ("+z+")");var A=null;K=1;"scale"===l?A=new d.ScaleTimeline(m.length):"shear"===
l?A=new d.ShearTimeline(m.length):(A=new d.TranslateTimeline(m.length),K=e);A.boneIndex=B;for(y=n=0;y<m.length;y++){u=m[y];C=this.getValue(u,"x",0);var D=this.getValue(u,"y",0);A.setFrame(n,u.time,C*K,D*K);this.readCurve(u,A,n);n++}f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.TranslateTimeline.ENTRIES])}}if(a.ik)for(var I in a.ik){h=a.ik[I];n=c.findIkConstraint(I);(A=new d.IkConstraintTimeline(h.length)).ikConstraintIndex=c.ikConstraints.indexOf(n);for(y=n=0;y<h.length;y++)u=h[y],A.setFrame(n,
u.time,this.getValue(u,"mix",1),this.getValue(u,"bendPositive",!0)?1:-1),this.readCurve(u,A,n),n++;f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.IkConstraintTimeline.ENTRIES])}if(a.transform)for(I in a.transform){h=a.transform[I];n=c.findTransformConstraint(I);(A=new d.TransformConstraintTimeline(h.length)).transformConstraintIndex=c.transformConstraints.indexOf(n);for(y=n=0;y<h.length;y++)u=h[y],A.setFrame(n,u.time,this.getValue(u,"rotateMix",1),this.getValue(u,"translateMix",1),this.getValue(u,
"scaleMix",1),this.getValue(u,"shearMix",1)),this.readCurve(u,A,n),n++;f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.TransformConstraintTimeline.ENTRIES])}if(a.paths)for(I in a.paths){h=a.paths[I];z=c.findPathConstraintIndex(I);if(-1==z)throw Error("Path constraint not found: "+I);B=c.pathConstraints[z];for(l in h)if(m=h[l],"position"===l||"spacing"===l){A=null;K=1;"spacing"===l?(A=new d.PathConstraintSpacingTimeline(m.length),B.spacingMode!=d.SpacingMode.Length&&B.spacingMode!=d.SpacingMode.Fixed||
(K=e)):(A=new d.PathConstraintPositionTimeline(m.length),B.positionMode==d.PositionMode.Fixed&&(K=e));A.pathConstraintIndex=z;for(y=n=0;y<m.length;y++)u=m[y],A.setFrame(n,u.time,this.getValue(u,l,0)*K),this.readCurve(u,A,n),n++;f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===l){(A=new d.PathConstraintMixTimeline(m.length)).pathConstraintIndex=z;for(y=n=0;y<m.length;y++)u=m[y],A.setFrame(n,u.time,this.getValue(u,"rotateMix",1),this.getValue(u,
"translateMix",1)),this.readCurve(u,A,n),n++;f.push(A);g=Math.max(g,A.frames[(A.getFrameCount()-1)*d.PathConstraintMixTimeline.ENTRIES])}}if(a.deform)for(var F in a.deform){z=a.deform[F];B=c.findSkin(F);if(null==B)throw Error("Skin not found: "+F);for(k in z){h=z[k];if(-1==(K=c.findSlotIndex(k)))throw Error("Slot not found: "+h.name);for(l in h){m=h[l];n=B.getAttachment(K,l);if(null==n)throw Error("Deform attachment not found: "+m.name);C=null!=n.bones;D=n.vertices;var G=C?D.length/3*2:D.length;(A=
new d.DeformTimeline(m.length)).slotIndex=K;A.attachment=n;for(I=n=0;I<m.length;I++){u=m[I];var J=this.getValue(u,"vertices",null);if(null==J)var N=C?d.Utils.newFloatArray(G):D;else{N=d.Utils.newFloatArray(G);y=this.getValue(u,"offset",0);if(d.Utils.arrayCopy(J,0,N,y,J.length),1!=e)for(J=y+J.length;y<J;y++)N[y]*=e;if(!C)for(y=0;y<G;y++)N[y]+=D[y]}A.setFrame(n,u.time,N);this.readCurve(u,A,n);n++}f.push(A);g=Math.max(g,A.frames[A.getFrameCount()-1])}}}e=a.drawOrder;if(null==e&&(e=a.draworder),null!=
e){A=new d.DrawOrderTimeline(e.length);k=c.slots.length;for(I=n=0;I<e.length;I++){l=e[I];F=null;m=this.getValue(l,"offsets",null);if(null!=m){F=d.Utils.newArray(k,-1);u=d.Utils.newArray(k-m.length,0);for(y=z=h=0;y<m.length;y++){var K;B=m[y];if(-1==(K=c.findSlotIndex(B.slot)))throw Error("Slot not found: "+B.slot);for(;h!=K;)u[z++]=h++;F[h+B.offset]=h++}for(;h<k;)u[z++]=h++;for(y=k-1;0<=y;y--)-1==F[y]&&(F[y]=u[--z])}A.setFrame(n++,l.time,F)}f.push(A);g=Math.max(g,A.frames[A.getFrameCount()-1])}if(a.events){A=
new d.EventTimeline(a.events.length);for(y=n=0;y<a.events.length;y++){e=a.events[y];k=c.findEvent(e.name);if(null==k)throw Error("Event not found: "+e.name);l=new d.Event(d.Utils.toSinglePrecision(e.time),k);l.intValue=this.getValue(e,"int",k.intValue);l.floatValue=this.getValue(e,"float",k.floatValue);l.stringValue=this.getValue(e,"string",k.stringValue);A.setFrame(n++,l)}f.push(A);g=Math.max(g,A.frames[A.getFrameCount()-1])}if(isNaN(g))throw Error("Error while parsing animation, duration is NaN");
c.animations.push(new d.Animation(b,f,g))},b.prototype.readCurve=function(a,b,c){a.curve&&("stepped"===a.curve?b.setStepped(c):"[object Array]"===Object.prototype.toString.call(a.curve)&&(a=a.curve,b.setCurve(c,a[0],a[1],a[2],a[3])))},b.prototype.getValue=function(a,b,c){return void 0!==a[b]?a[b]:c},b.blendModeFromString=function(a){if("normal"==(a=a.toLowerCase()))return d.BlendMode.Normal;if("additive"==a)return d.BlendMode.Additive;if("multiply"==a)return d.BlendMode.Multiply;if("screen"==a)return d.BlendMode.Screen;
throw Error("Unknown blend mode: "+a);},b.positionModeFromString=function(a){if("fixed"==(a=a.toLowerCase()))return d.PositionMode.Fixed;if("percent"==a)return d.PositionMode.Percent;throw Error("Unknown position mode: "+a);},b.spacingModeFromString=function(a){if("length"==(a=a.toLowerCase()))return d.SpacingMode.Length;if("fixed"==a)return d.SpacingMode.Fixed;if("percent"==a)return d.SpacingMode.Percent;throw Error("Unknown position mode: "+a);},b.rotateModeFromString=function(a){if("tangent"==
(a=a.toLowerCase()))return d.RotateMode.Tangent;if("chain"==a)return d.RotateMode.Chain;if("chainscale"==a)return d.RotateMode.ChainScale;throw Error("Unknown rotate mode: "+a);},b.transformModeFromString=function(a){if("normal"==(a=a.toLowerCase()))return d.TransformMode.Normal;if("onlytranslation"==a)return d.TransformMode.OnlyTranslation;if("norotationorreflection"==a)return d.TransformMode.NoRotationOrReflection;if("noscale"==a)return d.TransformMode.NoScale;if("noscaleorreflection"==a)return d.TransformMode.NoScaleOrReflection;
throw Error("Unknown transform mode: "+a);},b}();d.SkeletonJson=b;var a=function(){return function(a,b,d,e){this.mesh=a;this.skin=b;this.slotIndex=d;this.parent=e}}()})(h||(h={}));(function(d){var b=function(){function a(a){if(this.attachments=[],null==a)throw Error("name cannot be null.");this.name=a}return a.prototype.addAttachment=function(a,b,d){if(null==d)throw Error("attachment cannot be null.");var c=this.attachments;a>=c.length&&(c.length=a+1);c[a]||(c[a]={});c[a][b]=d},a.prototype.getAttachment=
function(a,b){return(a=this.attachments[a])?a[b]:null},a.prototype.attachAll=function(a,b){for(var c=0,d=0;d<a.slots.length;d++){var e=a.slots[d],f=e.getAttachment();if(f&&c<b.attachments.length){var g=b.attachments[c],h;for(h in g)if(f==g[h]){f=this.getAttachment(c,h);null!=f&&e.setAttachment(f);break}}c++}},a}();d.Skin=b})(h||(h={}));(function(d){var b=function(){function a(a,b){if(this.attachmentVertices=[],null==a)throw Error("data cannot be null.");if(null==b)throw Error("bone cannot be null.");
this.data=a;this.bone=b;this.color=new d.Color;this.darkColor=null==a.darkColor?null:new d.Color;this.setToSetupPose()}return a.prototype.getAttachment=function(){return this.attachment},a.prototype.setAttachment=function(a){this.attachment!=a&&(this.attachment=a,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},a.prototype.setAttachmentTime=function(a){this.attachmentTime=this.bone.skeleton.time-a},a.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-
this.attachmentTime},a.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color);null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor);null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},a}();d.Slot=b})(h||(h={}));(function(d){var b=function(){return function(a,b,e){if(this.color=new d.Color(1,1,1,1),0>a)throw Error("index must be >= 0.");if(null==
b)throw Error("name cannot be null.");if(null==e)throw Error("boneData cannot be null.");this.index=a;this.name=b;this.boneData=e}}();d.SlotData=b})(h||(h={}));(function(d){var b,a,c=function(){function c(a){this._image=a}return c.prototype.getImage=function(){return this._image},c.filterFromString=function(a){switch(a.toLowerCase()){case "nearest":return b.Nearest;case "linear":return b.Linear;case "mipmap":return b.MipMap;case "mipmapnearestnearest":return b.MipMapNearestNearest;case "mipmaplinearnearest":return b.MipMapLinearNearest;
case "mipmapnearestlinear":return b.MipMapNearestLinear;case "mipmaplinearlinear":return b.MipMapLinearLinear;default:throw Error("Unknown texture filter "+a);}},c.wrapFromString=function(b){switch(b.toLowerCase()){case "mirroredtepeat":return a.MirroredRepeat;case "clamptoedge":return a.ClampToEdge;case "repeat":return a.Repeat;default:throw Error("Unknown texture wrap "+b);}},c}();d.Texture=c;(function(a){a[a.Nearest=9728]="Nearest";a[a.Linear=9729]="Linear";a[a.MipMap=9987]="MipMap";a[a.MipMapNearestNearest=
9984]="MipMapNearestNearest";a[a.MipMapLinearNearest=9985]="MipMapLinearNearest";a[a.MipMapNearestLinear=9986]="MipMapNearestLinear";a[a.MipMapLinearLinear=9987]="MipMapLinearLinear"})(b=d.TextureFilter||(d.TextureFilter={}));(function(a){a[a.MirroredRepeat=33648]="MirroredRepeat";a[a.ClampToEdge=33071]="ClampToEdge";a[a.Repeat=10497]="Repeat"})(a=d.TextureWrap||(d.TextureWrap={}));c=function(){return function(){this.height=this.width=this.v2=this.u2=this.v=this.u=0;this.rotate=!1;this.originalHeight=
this.originalWidth=this.offsetY=this.offsetX=0}}();d.TextureRegion=c;c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return e(b,a),b.prototype.setFilters=function(a,b){},b.prototype.setWraps=function(a,b){},b.prototype.dispose=function(){},b}(d.Texture);d.FakeTexture=c})(h||(h={}));(function(d){var b=function(){function b(a,b){this.pages=[];this.regions=[];this.load(a,b)}return b.prototype.load=function(b,e){if(null==e)throw Error("textureLoader cannot be null.");b=new a(b);
for(var g=Array(4),k=null;;){var h=b.readLine();if(null==h)break;if(0==(h=h.trim()).length)k=null;else if(k){var l=new f;l.name=h;l.page=k;l.rotate="true"==b.readValue();b.readTuple(g);h=parseInt(g[0]);var m=parseInt(g[1]);b.readTuple(g);var q=parseInt(g[0]),n=parseInt(g[1]);l.u=h/k.width;l.v=m/k.height;l.rotate?(l.u2=(h+n)/k.width,l.v2=(m+q)/k.height):(l.u2=(h+q)/k.width,l.v2=(m+n)/k.height);l.x=h;l.y=m;l.width=Math.abs(q);l.height=Math.abs(n);4==b.readTuple(g)&&4==b.readTuple(g)&&b.readTuple(g);
l.originalWidth=parseInt(g[0]);l.originalHeight=parseInt(g[1]);b.readTuple(g);l.offsetX=parseInt(g[0]);l.offsetY=parseInt(g[1]);l.index=parseInt(b.readValue());l.texture=k.texture;this.regions.push(l)}else(k=new c).name=h,2==b.readTuple(g)&&(k.width=parseInt(g[0]),k.height=parseInt(g[1]),b.readTuple(g)),b.readTuple(g),k.minFilter=d.Texture.filterFromString(g[0]),k.magFilter=d.Texture.filterFromString(g[1]),l=b.readValue(),k.uWrap=d.TextureWrap.ClampToEdge,k.vWrap=d.TextureWrap.ClampToEdge,"x"==l?
k.uWrap=d.TextureWrap.Repeat:"y"==l?k.vWrap=d.TextureWrap.Repeat:"xy"==l&&(k.uWrap=k.vWrap=d.TextureWrap.Repeat),k.texture=e(h),k.texture.setFilters(k.minFilter,k.magFilter),k.texture.setWraps(k.uWrap,k.vWrap),k.width=k.texture.getImage().width,k.height=k.texture.getImage().height,this.pages.push(k)}},b.prototype.findRegion=function(a){for(var b=0;b<this.regions.length;b++)if(this.regions[b].name==a)return this.regions[b];return null},b.prototype.dispose=function(){for(var a=0;a<this.pages.length;a++)this.pages[a].texture.dispose()},
b}();d.TextureAtlas=b;var a=function(){function a(a){this.index=0;this.lines=a.split(/\r\n|\r|\n/)}return a.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},a.prototype.readValue=function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw Error("Invalid line: "+a);return a.substring(b+1).trim()},a.prototype.readTuple=function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw Error("Invalid line: "+b);var d=0;for(c+=1;3>d;d++){var e=b.indexOf(",",
c);if(-1==e)break;a[d]=b.substr(c,e-c).trim();c=e+1}return a[d]=b.substring(c).trim(),d+1},a}(),c=function(){return function(){}}();d.TextureAtlasPage=c;var f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return e(b,a),b}(d.TextureRegion);d.TextureAtlasRegion=f})(h||(h={}));(function(d){var b=function(){function a(a,b){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new d.Vector2,null==a)throw Error("data cannot be null.");if(null==b)throw Error("skeleton cannot be null.");
this.data=a;this.rotateMix=a.rotateMix;this.translateMix=a.translateMix;this.scaleMix=a.scaleMix;this.shearMix=a.shearMix;this.bones=[];for(var c=0;c<a.bones.length;c++)this.bones.push(b.findBone(a.bones[c].name));this.target=b.findBone(a.target.name)}return a.prototype.apply=function(){this.update()},a.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},a.prototype.applyAbsoluteWorld=
function(){var a=this.rotateMix,b=this.translateMix,e=this.scaleMix,f=this.shearMix,h=this.target,m=h.a,n=h.b,p=h.c,v=h.d,w=0<m*v-n*p?d.MathUtils.degRad:-d.MathUtils.degRad,E=this.data.offsetRotation*w;w*=this.data.offsetShearY;for(var x=this.bones,y=0,u=x.length;y<u;y++){var B=x[y],C=!1;if(0!=a){var z=B.a;C=B.b;var A=B.c,D=B.d;(G=Math.atan2(p,m)-Math.atan2(A,z)+E)>d.MathUtils.PI?G-=d.MathUtils.PI2:G<-d.MathUtils.PI&&(G+=d.MathUtils.PI2);G*=a;var I=Math.cos(G),F=Math.sin(G);B.a=I*z-F*A;B.b=I*C-F*
D;B.c=F*z+I*A;B.d=F*C+I*D;C=!0}0!=b&&(C=this.temp,h.localToWorld(C.set(this.data.offsetX,this.data.offsetY)),B.worldX+=(C.x-B.worldX)*b,B.worldY+=(C.y-B.worldY)*b,C=!0);0<e&&(C=Math.sqrt(B.a*B.a+B.c*B.c),D=Math.sqrt(m*m+p*p),1E-5<C&&(C=(C+(D-C+this.data.offsetScaleX)*e)/C),B.a*=C,B.c*=C,C=Math.sqrt(B.b*B.b+B.d*B.d),D=Math.sqrt(n*n+v*v),1E-5<C&&(C=(C+(D-C+this.data.offsetScaleY)*e)/C),B.b*=C,B.d*=C,C=!0);if(0<f){C=B.b;D=B.d;var G;z=Math.atan2(D,C);(G=Math.atan2(v,n)-Math.atan2(p,m)-(z-Math.atan2(B.c,
B.a)))>d.MathUtils.PI?G-=d.MathUtils.PI2:G<-d.MathUtils.PI&&(G+=d.MathUtils.PI2);G=z+(G+w)*f;C=Math.sqrt(C*C+D*D);B.b=Math.cos(G)*C;B.d=Math.sin(G)*C;C=!0}C&&(B.appliedValid=!1)}},a.prototype.applyRelativeWorld=function(){var a=this.rotateMix,b=this.translateMix,e=this.scaleMix,f=this.shearMix,h=this.target,m=h.a,n=h.b,p=h.c,v=h.d,w=0<m*v-n*p?d.MathUtils.degRad:-d.MathUtils.degRad,E=this.data.offsetRotation*w;w*=this.data.offsetShearY;for(var x=this.bones,y=0,u=x.length;y<u;y++){var B=x[y],C=!1;if(0!=
a){C=B.a;var z=B.b,A=B.c,D=B.d;(G=Math.atan2(p,m)+E)>d.MathUtils.PI?G-=d.MathUtils.PI2:G<-d.MathUtils.PI&&(G+=d.MathUtils.PI2);G*=a;var I=Math.cos(G),F=Math.sin(G);B.a=I*C-F*A;B.b=I*z-F*D;B.c=F*C+I*A;B.d=F*z+I*D;C=!0}0!=b&&(C=this.temp,h.localToWorld(C.set(this.data.offsetX,this.data.offsetY)),B.worldX+=C.x*b,B.worldY+=C.y*b,C=!0);0<e&&(C=(Math.sqrt(m*m+p*p)-1+this.data.offsetScaleX)*e+1,B.a*=C,B.c*=C,C=(Math.sqrt(n*n+v*v)-1+this.data.offsetScaleY)*e+1,B.b*=C,B.d*=C,C=!0);if(0<f){var G;(G=Math.atan2(v,
n)-Math.atan2(p,m))>d.MathUtils.PI?G-=d.MathUtils.PI2:G<-d.MathUtils.PI&&(G+=d.MathUtils.PI2);z=B.b;D=B.d;G=Math.atan2(D,z)+(G-d.MathUtils.PI/2+w)*f;C=Math.sqrt(z*z+D*D);B.b=Math.cos(G)*C;B.d=Math.sin(G)*C;C=!0}C&&(B.appliedValid=!1)}},a.prototype.applyAbsoluteLocal=function(){var a=this.rotateMix,b=this.translateMix,d=this.scaleMix,e=this.shearMix,f=this.target;f.appliedValid||f.updateAppliedTransform();for(var h=this.bones,m=0,p=h.length;m<p;m++){var n=h[m];n.appliedValid||n.updateAppliedTransform();
var w=n.arotation;if(0!=a){var E=f.arotation-w+this.data.offsetRotation;w+=(E-360*(16384-(16384.499999999996-E/360|0)))*a}var x=n.ax,y=n.ay;0!=b&&(x+=(f.ax-x+this.data.offsetX)*b,y+=(f.ay-y+this.data.offsetY)*b);var u=n.ascaleX,B=n.ascaleY;0<d&&(1E-5<u&&(u=(u+(f.ascaleX-u+this.data.offsetScaleX)*d)/u),1E-5<B&&(B=(B+(f.ascaleY-B+this.data.offsetScaleY)*d)/B));var C=n.ashearY;0<e&&(E=f.ashearY-C+this.data.offsetShearY,E-=360*(16384-(16384.499999999996-E/360|0)),n.shearY+=E*e);n.updateWorldTransformWith(x,
y,w,u,B,n.ashearX,C)}},a.prototype.applyRelativeLocal=function(){var a=this.rotateMix,b=this.translateMix,d=this.scaleMix,e=this.shearMix,f=this.target;f.appliedValid||f.updateAppliedTransform();for(var h=this.bones,m=0,p=h.length;m<p;m++){var n=h[m];n.appliedValid||n.updateAppliedTransform();var w=n.arotation;0!=a&&(w+=(f.arotation+this.data.offsetRotation)*a);var E=n.ax,x=n.ay;0!=b&&(E+=(f.ax+this.data.offsetX)*b,x+=(f.ay+this.data.offsetY)*b);var y=n.ascaleX,u=n.ascaleY;0<d&&(1E-5<y&&(y*=(f.ascaleX-
1+this.data.offsetScaleX)*d+1),1E-5<u&&(u*=(f.ascaleY-1+this.data.offsetScaleY)*d+1));var B=n.ashearY;0<e&&(B+=(f.ashearY+this.data.offsetShearY)*e);n.updateWorldTransformWith(E,x,w,y,u,n.ashearX,B)}},a.prototype.getOrder=function(){return this.data.order},a}();d.TransformConstraint=b})(h||(h={}));(function(d){var b=function(){return function(a){if(this.order=0,this.bones=[],this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=
0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==a)throw Error("name cannot be null.");this.name=a}}();d.TransformConstraintData=b})(h||(h={}));(function(d){var b=function(){function a(){this.convexPolygons=[];this.convexPolygonsIndices=[];this.indicesArray=[];this.isConcaveArray=[];this.triangles=[];this.polygonPool=new d.Pool(function(){return[]});this.polygonIndicesPool=new d.Pool(function(){return[]})}return a.prototype.triangulate=function(b){for(var c=b.length>>
1,d=this.indicesArray,e=d.length=0;e<c;e++)d[e]=e;var f=this.isConcaveArray;e=f.length=0;for(var h=c;e<h;++e)f[e]=a.isConcave(e,c,b,d);h=this.triangles;for(h.length=0;3<c;){for(var m=c-1,p=(e=0,1);;){a:if(!f[e]){var n=d[m]<<1,w=d[e]<<1,E=d[p]<<1,x=b[n];n=b[n+1];var y=b[w];w=b[w+1];var u=b[E];E=b[E+1];for(var B=(p+1)%c;B!=m;B=(B+1)%c)if(f[B]){var C=d[B]<<1,z=b[C];C=b[C+1];if(a.positiveArea(u,E,x,n,z,C)&&a.positiveArea(x,n,y,w,z,C)&&a.positiveArea(y,w,u,E,z,C))break a}break}if(0==p){do{if(!f[e])break;
e--}while(0<e);break}m=e;e=p;p=(p+1)%c}h.push(d[(c+e-1)%c]);h.push(d[e]);h.push(d[(e+1)%c]);d.splice(e,1);f.splice(e,1);m=(--c+e-1)%c;e=e==c?0:e;f[m]=a.isConcave(m,c,b,d);f[e]=a.isConcave(e,c,b,d)}return 3==c&&(h.push(d[2]),h.push(d[0]),h.push(d[1])),h},a.prototype.decompose=function(b,d){var c=this.convexPolygons;this.polygonPool.freeAll(c);c.length=0;var e=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(e);e.length=0;var f=this.polygonIndicesPool.obtain();f.length=0;var g=this.polygonPool.obtain();
g.length=0;for(var h=-1,m=0,n=0,w=d.length;n<w;n+=3){var E=d[n]<<1,x=d[n+1]<<1,y=d[n+2]<<1,u=b[E],B=b[E+1],C=b[x],z=b[x+1],A=b[y],D=b[y+1],I=!1;if(h==E){var F=g.length-4;F=a.winding(g[F],g[F+1],g[F+2],g[F+3],A,D);var G=a.winding(A,D,g[0],g[1],g[2],g[3]);F==m&&G==m&&(g.push(A),g.push(D),f.push(y),I=!0)}I||(0<g.length?(c.push(g),e.push(f)):(this.polygonPool.free(g),this.polygonIndicesPool.free(f)),(g=this.polygonPool.obtain()).length=0,g.push(u),g.push(B),g.push(C),g.push(z),g.push(A),g.push(D),(f=
this.polygonIndicesPool.obtain()).length=0,f.push(E),f.push(x),f.push(y),m=a.winding(u,B,C,z,A,D),h=E)}0<g.length&&(c.push(g),e.push(f));n=0;for(w=c.length;n<w;n++)if(0!=(f=e[n]).length)for(b=f[0],d=f[f.length-1],h=(g=c[n])[F=g.length-4],m=g[F+1],E=g[F+2],x=g[F+3],y=g[0],u=g[1],B=g[2],C=g[3],z=a.winding(h,m,E,x,y,u),I=0;I<w;I++)if(I!=n){var J=e[I];if(3==J.length){F=J[0];G=J[1];var N=J[2],K=c[I];A=K[K.length-2];D=K[K.length-1];F==b&&G==d&&(F=a.winding(h,m,E,x,A,D),G=a.winding(A,D,y,u,B,C),F==z&&G==
z&&(K.length=0,J.length=0,g.push(A),g.push(D),f.push(N),h=E,m=x,E=A,x=D,I=0))}}for(n=c.length-1;0<=n;n--)0==(g=c[n]).length&&(c.splice(n,1),this.polygonPool.free(g),f=e[n],e.splice(n,1),this.polygonIndicesPool.free(f));return c},a.isConcave=function(a,b,d,e){var c=e[(b+a-1)%b]<<1,f=e[a]<<1;a=e[(a+1)%b]<<1;return!this.positiveArea(d[c],d[c+1],d[f],d[f+1],d[a],d[a+1])},a.positiveArea=function(a,b,d,e,f,h){return 0<=a*(h-e)+d*(b-h)+f*(e-b)},a.winding=function(a,b,d,e,f,h){d-=a;e-=b;return 0<=f*e-h*d+
d*b-a*e?1:-1},a}();d.Triangulator=b})(h||(h={}));(function(d){var b=function(){function a(){this.array=[]}return a.prototype.add=function(a){var b=this.contains(a);return this.array[0|a]=0|a,!b},a.prototype.contains=function(a){return void 0!=this.array[0|a]},a.prototype.remove=function(a){this.array[0|a]=void 0},a.prototype.clear=function(){this.array.length=0},a}();d.IntSet=b;b=function(){function a(a,b,d,e){void 0===a&&(a=0);void 0===b&&(b=0);void 0===d&&(d=0);void 0===e&&(e=0);this.r=a;this.g=
b;this.b=d;this.a=e}return a.prototype.set=function(a,b,d,e){return this.r=a,this.g=b,this.b=d,this.a=e,this.clamp(),this},a.prototype.setFromColor=function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a,this},a.prototype.setFromString=function(a){return a="#"==a.charAt(0)?a.substr(1):a,this.r=parseInt(a.substr(0,2),16)/255,this.g=parseInt(a.substr(2,2),16)/255,this.b=parseInt(a.substr(4,2),16)/255,this.a=(8!=a.length?255:parseInt(a.substr(6,2),16))/255,this},a.prototype.add=function(a,b,d,
e){return this.r+=a,this.g+=b,this.b+=d,this.a+=e,this.clamp(),this},a.prototype.clamp=function(){return 0>this.r?this.r=0:1<this.r&&(this.r=1),0>this.g?this.g=0:1<this.g&&(this.g=1),0>this.b?this.b=0:1<this.b&&(this.b=1),0>this.a?this.a=0:1<this.a&&(this.a=1),this},a.WHITE=new a(1,1,1,1),a.RED=new a(1,0,0,1),a.GREEN=new a(0,1,0,1),a.BLUE=new a(0,0,1,1),a.MAGENTA=new a(1,0,1,1),a}();d.Color=b;b=function(){function a(){}return a.clamp=function(a,b,d){return a<b?b:a>d?d:a},a.cosDeg=function(b){return Math.cos(b*
a.degRad)},a.sinDeg=function(b){return Math.sin(b*a.degRad)},a.signum=function(a){return 0<a?1:0>a?-1:0},a.toInt=function(a){return 0<a?Math.floor(a):Math.ceil(a)},a.cbrt=function(a){var b=Math.pow(Math.abs(a),1/3);return 0>a?-b:b},a.randomTriangular=function(b,d){return a.randomTriangularWith(b,d,.5*(b+d))},a.randomTriangularWith=function(a,b,d){var c=Math.random(),e=b-a;return c<=(d-a)/e?a+Math.sqrt(c*e*(d-a)):b-Math.sqrt((1-c)*e*(b-d))},a.PI=3.1415927,a.PI2=2*a.PI,a.radiansToDegrees=180/a.PI,a.radDeg=
a.radiansToDegrees,a.degreesToRadians=a.PI/180,a.degRad=a.degreesToRadians,a}();d.MathUtils=b;b=function(){function a(){}return a.prototype.apply=function(a,b,d){return a+(b-a)*this.applyInternal(d)},a}();d.Interpolation=b;b=function(a){function b(b){var c=a.call(this)||this;return c.power=b,c}return e(b,a),b.prototype.applyInternal=function(a){return.5>=a?Math.pow(2*a,this.power)/2:Math.pow(2*(a-1),this.power)/(0==this.power%2?-2:2)+1},b}(b);d.Pow=b;b=function(a){function b(b){return a.call(this,
b)||this}return e(b,a),b.prototype.applyInternal=function(a){return Math.pow(a-1,this.power)*(0==this.power%2?-1:1)+1},b}(b);d.PowOut=b;b=function(){function a(){}return a.arrayCopy=function(a,b,d,e,f){for(var c=b;c<b+f;c++,e++)d[e]=a[c]},a.setArraySize=function(a,b,d){void 0===d&&(d=0);var c=a.length;if(c==b)return a;if(a.length=b,c<b)for(;c<b;c++)a[c]=d;return a},a.ensureArrayCapacity=function(b,d,e){return void 0===e&&(e=0),b.length>=d?b:a.setArraySize(b,d,e)},a.newArray=function(a,b){for(var c=
Array(a),d=0;d<a;d++)c[d]=b;return c},a.newFloatArray=function(b){if(a.SUPPORTS_TYPED_ARRAYS)return new Float32Array(b);b=Array(b);for(var c=0;c<b.length;c++)b[c]=0;return b},a.newShortArray=function(b){if(a.SUPPORTS_TYPED_ARRAYS)return new Int16Array(b);b=Array(b);for(var c=0;c<b.length;c++)b[c]=0;return b},a.toFloatArray=function(b){return a.SUPPORTS_TYPED_ARRAYS?new Float32Array(b):b},a.toSinglePrecision=function(b){return a.SUPPORTS_TYPED_ARRAYS?Math.fround(b):b},a.webkit602BugfixHelper=function(a,
b){},a.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,a}();d.Utils=b;b=function(){function a(){}return a.logBones=function(a){for(var b=0;b<a.bones.length;b++){var c=a.bones[b];console.log(c.data.name+", "+c.a+", "+c.b+", "+c.c+", "+c.d+", "+c.worldX+", "+c.worldY)}},a}();d.DebugUtils=b;b=function(){function a(a){this.items=[];this.instantiator=a}return a.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},a.prototype.free=function(a){a.reset&&a.reset();
this.items.push(a)},a.prototype.freeAll=function(a){for(var b=0;b<a.length;b++)a[b].reset&&a[b].reset(),this.items[b]=a[b]},a.prototype.clear=function(){this.items.length=0},a}();d.Pool=b;b=function(){function a(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.x=a;this.y=b}return a.prototype.set=function(a,b){return this.x=a,this.y=b,this},a.prototype.length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)},a.prototype.normalize=function(){var a=this.length();return 0!=a&&(this.x/=a,this.y/=
a),this},a}();d.Vector2=b;b=function(){function a(){this.maxDelta=.064;this.totalTime=this.delta=this.framesPerSecond=0;this.lastTime=Date.now()/1E3;this.frameTime=this.frameCount=0}return a.prototype.update=function(){var a=Date.now()/1E3;this.delta=a-this.lastTime;this.frameTime+=this.delta;this.totalTime+=this.delta;this.delta>this.maxDelta&&(this.delta=this.maxDelta);this.lastTime=a;this.frameCount++;1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=
0)},a}();d.TimeKeeper=b;b=function(){function a(a){void 0===a&&(a=32);this.mean=this.lastValue=this.addedValues=0;this.dirty=!0;this.values=Array(a)}return a.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},a.prototype.addValue=function(a){this.addedValues<this.values.length&&this.addedValues++;this.values[this.lastValue++]=a;this.lastValue>this.values.length-1&&(this.lastValue=0);this.dirty=!0},a.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var a=
0,b=0;b<this.values.length;b++)a+=this.values[b];this.mean=a/this.values.length;this.dirty=!1}return this.mean}return 0},a}();d.WindowedMean=b})(h||(h={}));Math.fround||(Math.fround=function(d){return function(b){return d[0]=b,d[0]}}(new Float32Array(1)));(function(d){var b=function(){return function(a){if(null==a)throw Error("name cannot be null.");this.name=a}}();d.Attachment=b;b=function(a){function b(c){c=a.call(this,c)||this;return c.id=(65535&b.nextID++)<<11,c.worldVerticesLength=0,c}return e(b,
a),b.prototype.computeWorldVertices=function(a,b,c,d,e,f){c=e+(c>>1)*f;var g=a.bone.skeleton,k=a.attachmentVertices,h=this.vertices,l=this.bones;if(null!=l){for(var m=0,n=a=0;n<b;n+=2)m+=(z=l[m])+1,a+=z;var q=g.bones;if(0==k.length)for(g=3*a;e<c;e+=f){var r=0,t=0,z=l[m++];for(z+=m;m<z;m++,g+=3){a=q[l[m]];b=h[g];n=h[g+1];var A=h[g+2];r+=(b*a.a+n*a.b+a.worldX)*A;t+=(b*a.c+n*a.d+a.worldY)*A}d[e]=r;d[e+1]=t}else for(var D=(g=3*a,a<<1);e<c;e+=f){t=r=0;z=l[m++];for(z+=m;m<z;m++,g+=3,D+=2)a=q[l[m]],b=h[g]+
k[D],n=h[g+1]+k[D+1],A=h[g+2],r+=(b*a.a+n*a.b+a.worldX)*A,t+=(b*a.c+n*a.d+a.worldY)*A;d[e]=r;d[e+1]=t}}else for(0<k.length&&(h=k),k=(a=a.bone).worldX,l=a.worldY,m=a.a,g=a.b,z=a.c,a=a.d,q=b;e<c;q+=2,e+=f)b=h[q],n=h[q+1],d[e]=b*m+n*g+k,d[e+1]=b*z+n*a+l},b.prototype.applyDeform=function(a){return this==a},b.nextID=0,b}(b);d.VertexAttachment=b})(h||(h={}));(function(d){d=d.AttachmentType||(d.AttachmentType={});d[d.Region=0]="Region";d[d.BoundingBox=1]="BoundingBox";d[d.Mesh=2]="Mesh";d[d.LinkedMesh=3]=
"LinkedMesh";d[d.Path=4]="Path";d[d.Point=5]="Point"})(h||(h={}));(function(d){var b=function(a){function b(b){b=a.call(this,b)||this;return b.color=new d.Color(1,1,1,1),b}return e(b,a),b}(d.VertexAttachment);d.BoundingBoxAttachment=b})(h||(h={}));(function(d){var b=function(a){function b(b){b=a.call(this,b)||this;return b.color=new d.Color(.2275,.2275,.8078,1),b}return e(b,a),b}(d.VertexAttachment);d.ClippingAttachment=b})(h||(h={}));(function(d){var b=function(a){function b(b){b=a.call(this,b)||
this;return b.color=new d.Color(1,1,1,1),b.inheritDeform=!1,b.tempColor=new d.Color(0,0,0,0),b}return e(b,a),b.prototype.updateUVs=function(){var a=0,b=0,c=0,e=0;null==this.region?(a=b=0,c=e=1):(a=this.region.u,b=this.region.v,c=this.region.u2-a,e=this.region.v2-b);var f=this.regionUVs;null!=this.uvs&&this.uvs.length==f.length||(this.uvs=d.Utils.newFloatArray(f.length));var h=this.uvs;if(this.region.rotate)for(var m=0,n=h.length;m<n;m+=2)h[m]=a+f[m+1]*c,h[m+1]=b+e-f[m]*e;else for(m=0,n=h.length;m<
n;m+=2)h[m]=a+f[m]*c,h[m+1]=b+f[m+1]*e},b.prototype.applyDeform=function(a){return this==a||this.inheritDeform&&this.parentMesh==a},b.prototype.getParentMesh=function(){return this.parentMesh},b.prototype.setParentMesh=function(a){this.parentMesh=a;null!=a&&(this.bones=a.bones,this.vertices=a.vertices,this.worldVerticesLength=a.worldVerticesLength,this.regionUVs=a.regionUVs,this.triangles=a.triangles,this.hullLength=a.hullLength,this.worldVerticesLength=a.worldVerticesLength)},b}(d.VertexAttachment);
d.MeshAttachment=b})(h||(h={}));(function(d){var b=function(a){function b(b){b=a.call(this,b)||this;return b.closed=!1,b.constantSpeed=!1,b.color=new d.Color(1,1,1,1),b}return e(b,a),b}(d.VertexAttachment);d.PathAttachment=b})(h||(h={}));(function(d){var b=function(a){function b(b){b=a.call(this,b)||this;return b.color=new d.Color(.38,.94,0,1),b}return e(b,a),b.prototype.computeWorldPosition=function(a,b){return b.x=this.x*a.a+this.y*a.b+a.worldX,b.y=this.x*a.c+this.y*a.d+a.worldY,b},b.prototype.computeWorldRotation=
function(a){var b=d.MathUtils.cosDeg(this.rotation),c=d.MathUtils.sinDeg(this.rotation);return Math.atan2(b*a.c+c*a.d,b*a.a+c*a.b)*d.MathUtils.radDeg},b}(d.VertexAttachment);d.PointAttachment=b})(h||(h={}));(function(d){var b=function(a){function b(b){b=a.call(this,b)||this;return b.x=0,b.y=0,b.scaleX=1,b.scaleY=1,b.rotation=0,b.width=0,b.height=0,b.color=new d.Color(1,1,1,1),b.offset=d.Utils.newFloatArray(8),b.uvs=d.Utils.newFloatArray(8),b.tempColor=new d.Color(1,1,1,1),b}return e(b,a),b.prototype.updateOffset=
function(){var a=this.width/this.region.originalWidth*this.scaleX,c=this.height/this.region.originalHeight*this.scaleY,d=-this.width/2*this.scaleX+this.region.offsetX*a,e=-this.height/2*this.scaleY+this.region.offsetY*c,f=d+this.region.width*a;a=e+this.region.height*c;c=this.rotation*Math.PI/180;var h=Math.cos(c),m=Math.sin(c);c=d*h+this.x;d*=m;var n=e*h+this.y;e*=m;var w=f*h+this.x;f*=m;h=a*h+this.y;a*=m;m=this.offset;m[b.OX1]=c-e;m[b.OY1]=n+d;m[b.OX2]=c-a;m[b.OY2]=h+d;m[b.OX3]=w-a;m[b.OY3]=h+f;
m[b.OX4]=w-e;m[b.OY4]=n+f},b.prototype.setRegion=function(a){this.region=a;var b=this.uvs;a.rotate?(b[2]=a.u,b[3]=a.v2,b[4]=a.u,b[5]=a.v,b[6]=a.u2,b[7]=a.v,b[0]=a.u2,b[1]=a.v2):(b[0]=a.u,b[1]=a.v2,b[2]=a.u,b[3]=a.v,b[4]=a.u2,b[5]=a.v,b[6]=a.u2,b[7]=a.v2)},b.prototype.computeWorldVertices=function(a,c,d,e){var f=this.offset,g=a.worldX,k=a.worldY,h=a.a,l=a.b,m=a.c;a=a.d;var n=f[b.OX1];var q=f[b.OY1];c[d]=n*h+q*l+g;c[d+1]=n*m+q*a+k;d+=e;n=f[b.OX2];q=f[b.OY2];c[d]=n*h+q*l+g;c[d+1]=n*m+q*a+k;d+=e;n=f[b.OX3];
q=f[b.OY3];c[d]=n*h+q*l+g;c[d+1]=n*m+q*a+k;d+=e;n=f[b.OX4];q=f[b.OY4];c[d]=n*h+q*l+g;c[d+1]=n*m+q*a+k},b.OX1=0,b.OY1=1,b.OX2=2,b.OY2=3,b.OX3=4,b.OY3=5,b.OX4=6,b.OY4=7,b.X1=0,b.Y1=1,b.C1R=2,b.C1G=3,b.C1B=4,b.C1A=5,b.U1=6,b.V1=7,b.X2=8,b.Y2=9,b.C2R=10,b.C2G=11,b.C2B=12,b.C2A=13,b.U2=14,b.V2=15,b.X3=16,b.Y3=17,b.C3R=18,b.C3G=19,b.C3B=20,b.C3A=21,b.U3=22,b.V3=23,b.X4=24,b.Y4=25,b.C4R=26,b.C4G=27,b.C4B=28,b.C4A=29,b.U4=30,b.V4=31,b}(d.Attachment);d.RegionAttachment=b})(h||(h={}));(function(d){var b=function(){function a(a,
b){this.jitterX=a;this.jitterY=b}return a.prototype.begin=function(a){},a.prototype.transform=function(a,b,e,f){a.x+=d.MathUtils.randomTriangular(-this.jitterX,this.jitterY);a.y+=d.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},a.prototype.end=function(){},a}();d.JitterEffect=b})(h||(h={}));(function(d){var b=function(){function a(a,b){this.worldY=this.worldX=this.angle=this.radius=this.centerY=this.centerX=0;this.radius=a;this.interpolation=b}return a.prototype.begin=function(a){this.worldX=
a.x+this.centerX;this.worldY=a.y+this.centerY},a.prototype.transform=function(a,b,e,f){f=this.angle*d.MathUtils.degreesToRadians;b=a.x-this.worldX;e=a.y-this.worldY;var c=Math.sqrt(b*b+e*e);c<this.radius&&(c=this.interpolation.apply(0,f,(this.radius-c)/this.radius),f=Math.cos(c),c=Math.sin(c),a.x=f*b-c*e+this.worldX,a.y=c*b+f*e+this.worldY)},a.prototype.end=function(){},a.interpolation=new d.PowOut(2),a}();d.SwirlEffect=b})(h||(h={}));n.exports=h},{}],310:[function(f,n,m){var h=f("./track-entry-listeners"),
e=f("./lib/spine"),d=[],b=[],a=0,c=0,g=null,k=null,l=0,q=0,r=0,t=0,p=null,v=null,w=0,E=0,x=void 0,y=void 0,u=void 0,B=void 0,C=void 0,z=void 0,A=new e.Color(1,1,1,1),D=new e.Color(1,1,1,1),I=[0,1,2,2,3,0],F=cc.Class({ctor:function(){this._inited=!1;this._invalid=!0;this.frames=[];this.totalTime=0;this._frameIdx=-1;this.isCompleted=!1;this._tempColors=this._tempSegments=this._animationName=this._skeletonInfo=null},init:function(a,b){this._inited=!0;this._animationName=b;this._skeletonInfo=a},clear:function(){this._inited=
!1;for(var a=0,b=this.frames.length;a<b;a++)this.frames[a].segments.length=0;this.invalidAllFrame()},bind:function(a){var b=function(a){a&&a.animation.name===this._animationName&&(this.isCompleted=!0)}.bind(this);a.complete=b},unbind:function(a){a.complete=null},begin:function(){if(this._invalid){var a=this._skeletonInfo,b=a.curAnimationCache;b&&b!==this&&b.updateToFrame();b=a.listener;var c=a.state,d=a.skeleton.data.findAnimation(this._animationName);c.setAnimationWith(0,d,!1);this.bind(b);a.curAnimationCache=
this;this._frameIdx=-1;this.isCompleted=!1;this.totalTime=0;this._invalid=!1}},end:function(){this._needToUpdate()||(this._skeletonInfo.curAnimationCache=null,this.frames.length=this._frameIdx+1,this.isCompleted=!0,this.unbind(this._skeletonInfo.listener))},_needToUpdate:function(a){return!this.isCompleted&&30>this.totalTime&&(void 0==a||this._frameIdx<a)},updateToFrame:function(a){if(this._inited&&(this.begin(),this._needToUpdate(a))){var b=this._skeletonInfo,c=b.skeleton,d=b.clipper;b=b.state;do c.update(1/
60),b.update(1/60),b.apply(c),c.updateWorldTransform(),this._frameIdx++,this._updateFrame(c,d,this._frameIdx),this.totalTime+=1/60;while(this._needToUpdate(a));this.end()}},isInited:function(){return this._inited},isInvalid:function(){return this._invalid},invalidAllFrame:function(){this.isCompleted=!1;this._invalid=!0},updateAllFrame:function(){this.invalidAllFrame();this.updateToFrame()},_updateFrame:function(e,f,h){a=c=0;0;k=g=null;t=r=q=l=0;v=p=null;this.frames[h]=this.frames[h]||{segments:[],
colors:[],vertices:null,uintVert:null,indices:null};h=this.frames[h];var m=this._tempSegments=h.segments,n=this._tempColors=h.colors;this._traverseSkeleton(e,f);0<t&&(n[t-1].vfOffset=c);n.length=t;e=r-1;0<=e&&(0<q?(e=m[e],e.indexCount=q,e.vfCount=6*l,e.vertexCount=l,m.length=r):m.length=r-1);if(0!=m.length){m=h.vertices;e=h.uintVert;(!m||m.length<c)&&(m=h.vertices=new Float32Array(c),e=h.uintVert=new Uint32Array(m.buffer));for(n=f=0;f<c;)m[f++]=d[n++],m[f++]=d[n++],m[f++]=d[n++],m[f++]=d[n++],e[f++]=
d[n++],e[f++]=d[n++];f=h.indices;(!f||f.length<a)&&(f=h.indices=new Uint16Array(a));for(n=0;n<a;n++)f[n]=b[n];h.vertices=m;h.uintVert=e;h.indices=f}},fillVertices:function(e,f,g,k,h){if(B=g.a*f.a*e.a*255,x=f.r*e.r*255,y=f.g*e.g*255,u=f.b*e.b*255,A.r=x*g.r,A.g=y*g.g,A.b=u*g.b,A.a=B,null==h.darkColor?D.set(0,0,0,1):(D.r=h.darkColor.r*x,D.g=h.darkColor.g*y,D.b=h.darkColor.b*u),D.a=0,C=(A.a<<24>>>0)+(A.b<<16)+(A.g<<8)+A.r,z=(D.a<<24>>>0)+(D.b<<16)+(D.g<<8)+D.r,p!==C||v!==z)e=this._tempColors,p=C,v=z,
0<t&&(e[t-1].vfOffset=c),e[t++]={fr:A.r,fg:A.g,fb:A.b,fa:A.a,dr:D.r,dg:D.g,db:D.b,da:D.a,vfOffset:0};if(k.isClipping()){k.clipTriangles(d,w,b,E,d,A,D,!0,6,a,c,c+2);e=k.clippedVertices;k=k.clippedTriangles;E=k.length;w=e.length/12*6;f=0;g=a;for(h=k.length;f<h;)b[g++]=k[f++];k=0;f=e.length;for(g=c;k<f;k+=12,g+=6)d[g]=e[k],d[g+1]=e[k+1],d[g+2]=e[k+6],d[g+3]=e[k+7],d[g+4]=C,d[g+5]=z}else for(e=c,k=c+w;e<k;e+=6)d[e+4]=C,d[e+5]=z},_traverseSkeleton:function(f,h){for(var m=this._tempSegments,n=f.color,p,
u=void 0,A=void 0,t,x=void 0,v,y,z=void 0,B=void 0,F=void 0,D=void 0,C=0,G=f.drawOrder.length;C<G;C++)if(D=f.drawOrder[C],w=0,E=0,p=D.getAttachment())if(t=p instanceof e.RegionAttachment,v=p instanceof e.MeshAttachment,p instanceof e.ClippingAttachment)h.clipStart(D,p);else{if(t||v)if(y=p.region.texture._texture)if(F=D.data.blendMode,g===y.url&&k===F||(g=y.url,k=F,0<=(z=r-1)&&(0<q?((B=m[z]).indexCount=q,B.vertexCount=l,B.vfCount=6*l):r--),m[r]={tex:y,blendMode:F,indexCount:0,vertexCount:0,vfCount:0},
r++,q=0,l=0),t?(x=I,w=24,E=6,p.computeWorldVertices(D.bone,d,c,6)):v&&(x=p.triangles,w=6*(p.worldVerticesLength>>1),E=x.length,p.computeWorldVertices(D,0,p.worldVerticesLength,d,c,6)),0!=w&&0!=E){t=0;v=a;for(y=x.length;t<y;)b[v++]=x[t++];t=p.uvs;v=c;y=c+w;for(var J=0;v<y;v+=6,J+=2)d[v+2]=t[J],d[v+3]=t[J+1];if(u=p.color,A=D.color,this.fillVertices(n,u,A,h,D),0<E){p=a;for(t=a+E;p<t;p++)b[p]+=l;a+=E;(c+=w)/6;q+=E;l+=w/6}}h.clipEndWithSlot(D)}else h.clipEndWithSlot(D);h.clipEnd()}});f=cc.Class({ctor:function(){this._animationPool=
{};this._skeletonCache={}},clear:function(){this._animationPool={};this._skeletonCache={}},removeSkeleton:function(a){var b=this._skeletonCache[a];if(b){b=b.animationsCache;for(var c in b){var d=b[c];d&&(this._animationPool[a+"#"+c]=d,d.clear())}delete this._skeletonCache[a]}},getSkeletonCache:function(a,b){var c=this._skeletonCache[a];if(!c){b=new e.Skeleton(b);c=new e.SkeletonClipping;var d=new e.AnimationStateData(b.data);d=new e.AnimationState(d);var f=new h;d.addListener(f);this._skeletonCache[a]=
c={skeleton:b,clipper:c,state:d,listener:f,animationsCache:{},curAnimationCache:null}}return c},getAnimationCache:function(a,b){return(a=this._skeletonCache[a])?a.animationsCache[b]:null},invalidAnimationCache:function(a){if((a=this._skeletonCache[a])&&a.skeleton){a=a.animationsCache;for(var b in a)a[b].invalidAllFrame()}},initAnimationCache:function(a,b){if(!b)return null;var c=this._skeletonCache[a],d=c&&c.skeleton;if(!d||!d.data.findAnimation(b))return null;d=c.animationsCache;var e=d[b];e||(a=
a+"#"+b,(e=this._animationPool[a])?delete this._animationPool[a]:e=new F,e.init(c,b),d[b]=e);return e},updateAnimationCache:function(a,b){if(b){var c=this.initAnimationCache(a,b);if(!c)return null;c.updateAllFrame()}else if((a=this._skeletonCache[a])&&a.skeleton)for(c in a=a.animationsCache,a)a[c].updateAllFrame()}});f.FrameTime=1/60;f.sharedCache=new f;n.exports=f},{"./lib/spine":309,"./track-entry-listeners":314}],311:[function(f,n,m){var h=f("./skeleton-cache").sharedCache;f=cc.Class({name:"sp.SkeletonData",
extends:cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJsonStr:{get:function(){return this._skeletonJson?JSON.stringify(this._skeletonJson):""}},skeletonJson:{get:function(){return this._skeletonJson},set:function(e){this._skeletonJson="string"==typeof e?JSON.parse(e):e;!this._uuid&&e.skeleton&&(this._uuid=e.skeleton.hash);this.reset()}},_atlasText:"",atlasText:{get:function(){return this._atlasText},set:function(e){this._atlasText=e;this.reset()}},textures:{default:[],
type:[cc.Texture2D]},textureNames:{default:[],type:[cc.String]},scale:1},statics:{preventDeferredLoadDependents:!0,preventPreloadNativeObject:!0},createNode:!1,reset:function(){this._atlasCache=this._skeletonCache=null},ensureTexturesLoaded:function(e,d){var b=this.textures,a=b.length;if(0!=a)for(var c=0,f=function(){++c>=a&&(e&&e.call(d,!0),e=null)},k=0;k<a;k++){var h=b[k];h.loaded?f():h.once("load",f)}else e.call(d,!1)},getRuntimeData:function(e){if(this._skeletonCache)return this._skeletonCache;
if(!(this.textures&&0<this.textures.length)&&this.textureNames&&0<this.textureNames.length)return e||cc.errorID(7507,this.name),null;e=this._getAtlas(e);if(!e)return null;var d=new sp.spine.AtlasAttachmentLoader(e);d=new sp.spine.SkeletonJson(d);d.scale=this.scale;return this._skeletonCache=d.readSkeletonData(this.skeletonJson),e.dispose(d),this._skeletonCache},getSkinsEnum:!1,getAnimsEnum:!1,_getTexture:function(e){for(var d=this.textureNames,b=0;b<d.length;b++)if(d[b]===e)return e=this.textures[b],
d=new sp.SkeletonTexture({width:e.width,height:e.height}),d.setRealTexture(e),d;return cc.errorID(7506,e),null},_getAtlas:function(e){return this._atlasCache?this._atlasCache:this.atlasText?this._atlasCache=new sp.spine.TextureAtlas(this.atlasText,this._getTexture.bind(this)):(e||cc.errorID(7508,this.name),null)},destroy:function(){h.removeSkeleton(this._uuid);this._super()}});sp.SkeletonData=n.exports=f},{"./skeleton-cache":310}],312:[function(f,n,m){sp.SkeletonTexture=cc.Class({name:"sp.SkeletonTexture",
extends:sp.spine.Texture,_texture:null,_material:null,setRealTexture:function(f){this._texture=f},getRealTexture:function(){return this._texture},setFilters:function(f,e){this._texture&&this._texture.setFilters(f,e)},setWraps:function(f,e){this._texture&&this._texture.setWrapMode(f,e)},dispose:function(){}})},{}],313:[function(f,n,m){function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&
b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function e(a,b){switch(b){case g.BlendMode.Additive:b=z?cc.macro.ONE:cc.macro.SRC_ALPHA;var c=cc.macro.ONE;break;case g.BlendMode.Multiply:b=cc.macro.DST_COLOR;c=cc.macro.ONE_MINUS_SRC_ALPHA;break;case g.BlendMode.Screen:b=cc.macro.ONE;c=cc.macro.ONE_MINUS_SRC_COLOR;break;default:b=z?cc.macro.ONE:cc.macro.SRC_ALPHA,c=cc.macro.ONE_MINUS_SRC_ALPHA}var d=
!ja.enableBatch,e=a.getId()+b+c+F+d,f=ja.sharedMaterials[0];if(!f)return null;var k=ja._materialCache,h=k[e];h?h.getProperty("texture")!==a&&(h.setProperty("texture",a),h.updateHash(e)):(k[f._hash]?(h=new cc.Material).copy(f):h=f,h.define("CC_USE_MODEL",d),h.define("USE_TINT",F),h.setProperty("texture",a),h.effect.setBlend(!0,r.BLEND_FUNC_ADD,b,c,r.BLEND_FUNC_ADD,b,c),h.updateHash(e),k[e]=h);return h}function d(a){Aa=a.fa*M;va=K*(A=z?Aa/255:1);ra=P*A;xa=L*A;ya=a.fr*va;ma=a.fg*ra;wa=a.fb*xa;U=(Aa<<
24>>>0)+(wa<<16)+(ma<<8)+ya;ta=a.dr*va;Ca=a.dg*ra;Da=a.db*xa;R=((z?255:0)<<24>>>0)+(Da<<16)+(Ca<<8)+ta}function b(a){return(a.a<<24>>>0)+(a.b<<16)+(a.g<<8)+a.r}m.__esModule=!0;m.default=void 0;var a=function(a){return a&&a.__esModule?a:{default:a}}(f("../../cocos2d/core/renderer/assembler")),c=f("./Skeleton"),g=f("./lib/spine"),k=f("../../cocos2d/core/renderer/render-flow");f=f("../../cocos2d/core/renderer/webgl/vertex-format");var l=f.vfmtPosUvColor,q=f.vfmtPosUvTwoColor,r=cc.gfx,t=0,p=[0,1,2,2,
3,0],v=cc.color(0,0,255,255),w=cc.color(255,0,0,255),E=cc.color(0,255,0,255),x=cc.color(255,255,0,255),y=null,u=null,B=null,C=null;y=new g.Color(1,1,1,1);u=new g.Color(1,1,1,1);B=new g.Vector2;C=new g.Vector2;var z=void 0,A=void 0,D=void 0,I=void 0,F=void 0,G=void 0,J=void 0,N=void 0,K=void 0,P=void 0,L=void 0,M=void 0,U=void 0,R=void 0,O=void 0,H=void 0,S=void 0,W=0,T=0,Q=0,Y=0,Z=0,ba=0,V=0,X=void 0,ea=void 0,fa=void 0,ha=void 0,aa=void 0,na=void 0,ka=void 0,ia=void 0,sa=void 0,qa=void 0,oa=void 0,
da=void 0,ua=void 0,va=void 0,ra=void 0,xa=void 0,ya=void 0,ma=void 0,wa=void 0,Aa=void 0,ta=void 0,Ca=void 0,Da=void 0,ja=void 0,ca=void 0,pa=void 0,za=void 0,Ba=void 0,la=void 0;f=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var b=a.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?this:b}return h(c,a),c.prototype.updateRenderData=
function(a){a.isAnimationCached()||(a=a._skeleton)&&a.updateWorldTransform()},c.prototype.fillVertices=function(a,c,d,e,f){var g=ca._vData,k=ca._iData,h=ca._uintVData,l=void 0;if(y.a=d.a*c.a*a.a*M*255,A=z?y.a:255,X=K*c.r*a.r*A,ea=P*c.g*a.g*A,fa=L*c.b*a.b*A,y.r=X*d.r,y.g=ea*d.g,y.b=fa*d.b,null==f.darkColor?u.set(0,0,0,1):(u.r=f.darkColor.r*X,u.g=f.darkColor.g*ea,u.b=f.darkColor.b*fa),u.a=z?255:0,e.isClipping())if(h=g.subarray(Q+2),e.clipTriangles(g.subarray(Q),W,k.subarray(ba),Z,h,y,u,F,H),a=new Float32Array(e.clippedVertices),
e=e.clippedTriangles,Z=e.length,W=a.length/S*H,l=ca.request(W/H,Z),ba=l.indiceOffset,Y=l.vertexOffset,Q=l.byteOffset>>2,g=ca._vData,k=ca._iData,h=ca._uintVData,k.set(e,ba),la)for(k=0,l=a.length,e=Q;k<l;k+=S,e+=H)B.x=a[k],B.y=a[k+1],y.set(a[k+2],a[k+3],a[k+4],a[k+5]),C.x=a[k+6],C.y=a[k+7],F?u.set(a[k+8],a[k+9],a[k+10],a[k+11]):u.set(0,0,0,0),la.transform(B,C,y,u),g[e]=B.x,g[e+1]=B.y,g[e+2]=C.x,g[e+3]=C.y,h[e+4]=b(y),F&&(h[e+5]=b(u));else for(k=0,l=a.length,e=Q;k<l;k+=S,e+=H)g[e]=a[k],g[e+1]=a[k+1],
g[e+2]=a[k+6],g[e+3]=a[k+7],U=(a[k+5]<<24>>>0)+(a[k+4]<<16)+(a[k+3]<<8)+a[k+2],h[e+4]=U,F&&(R=(a[k+11]<<24>>>0)+(a[k+10]<<16)+(a[k+9]<<8)+a[k+8],h[e+5]=R);else if(la)for(a=Q,k=Q+W;a<k;a+=H)B.x=g[a],B.y=g[a+1],C.x=g[a+2],C.y=g[a+3],la.transform(B,C,y,u),g[a]=B.x,g[a+1]=B.y,g[a+2]=C.x,g[a+3]=C.y,h[a+4]=b(y),F&&(h[a+5]=b(u));else for(U=b(y),R=b(u),g=Q,a=Q+W;g<a;g+=H)h[g+4]=U,F&&(h[g+5]=R)},c.prototype.realTimeTraverse=function(a){var b=void 0,c=void 0,d=ja._skeleton,f=d.color,k=ja._debugRenderer,h=ja._clipper,
l,m,n=void 0,q=void 0,r=void 0,u,A,t=void 0,y=void 0;D=ja._startSlotIndex;I=ja._endSlotIndex;ha=!1;-1==D&&(ha=!0);G=ja.debugSlots;J=ja.debugBones;N=ja.debugMesh;k&&(J||G||N)&&(k.clear(),k.lineWidth=2);S=F?12:8;for(var z=ba=Z=Y=Q=W=0,B=d.drawOrder.length;z<B;z++)if(y=d.drawOrder[z],0<=D&&D==y.data.index&&(ha=!0),ha)if(0<=I&&I==y.data.index&&(ha=!1),W=0,Z=0,m=y.getAttachment())if(u=m instanceof g.RegionAttachment,A=m instanceof g.MeshAttachment,m instanceof g.ClippingAttachment)h.clipStart(y,m);else{if(u||
A)if(l=e(m.region.texture._texture,y.data.blendMode)){if((aa||l._hash!==pa.material._hash)&&(aa=!1,pa._flush(),pa.node=za,pa.material=l),u){if(r=p,W=4*H,Z=6,t=ca.request(4,6),ba=t.indiceOffset,Y=t.vertexOffset,Q=t.byteOffset>>2,b=ca._vData,c=ca._iData,m.computeWorldVertices(y.bone,b,Q,H),k&&G){k.strokeColor=v;k.moveTo(b[Q],b[Q+1]);l=Q+H;for(u=Q+W;l<u;l+=H)k.lineTo(b[l],b[l+1]);k.close();k.stroke()}}else if(A&&(r=m.triangles,W=(m.worldVerticesLength>>1)*H,Z=r.length,t=ca.request(W/H,Z),ba=t.indiceOffset,
Y=t.vertexOffset,Q=t.byteOffset>>2,b=ca._vData,c=ca._iData,m.computeWorldVertices(y,0,m.worldVerticesLength,b,Q,H),k&&N))for(k.strokeColor=x,l=0,u=r.length;l<u;l+=3){A=r[l]*H+Q;var R=r[l+1]*H+Q,C=r[l+2]*H+Q;k.moveTo(b[A],b[A+1]);k.lineTo(b[R],b[R+1]);k.lineTo(b[C],b[C+1]);k.close();k.stroke()}if(0!=W&&0!=Z){c.set(r,ba);l=m.uvs;u=Q;A=Q+W;for(R=0;u<A;u+=H,R+=2)b[u+2]=l[R],b[u+3]=l[R+1];if(n=m.color,q=y.color,this.fillVertices(f,n,q,h,y),0<Z){m=ba;for(l=ba+Z;m<l;m++)c[m]+=Y;if(a)for(m=a.m,ia=m[0],sa=
m[4],qa=m[12],oa=m[1],da=m[5],ua=m[13],m=Q,l=Q+W;m<l;m+=H)na=b[m],ka=b[m+1],b[m]=na*ia+ka*sa+qa,b[m+1]=na*oa+ka*da+ua;ca.adjust(W/H,Z)}}}h.clipEndWithSlot(y)}else h.clipEndWithSlot(y);else h.clipEndWithSlot(y);if(h.clipEnd(),k&&J)for(a=void 0,k.strokeColor=w,k.fillColor=v,b=0,c=d.bones.length;b<c;b++)f=(a=d.bones[b]).data.length*a.a+a.worldX,h=a.data.length*a.c+a.worldY,k.moveTo(a.worldX,a.worldY),k.lineTo(f,h),k.stroke(),k.circle(a.worldX,a.worldY,1.5*Math.PI),k.fill(),0===b&&(k.fillColor=E)},c.prototype.cacheTraverse=
function(a){var b=ja._curFrame;if(b){var c=b.segments;if(0!=c.length){var f,g=b.vertices,k=b.indices,h=void 0,l=0,m=0,p=0;a&&(h=a.m,ia=h[0],oa=h[1],sa=h[4],da=h[5],qa=h[12],ua=h[13]);h=(a=16&t)&&1===ia&&0===oa&&0===sa&&1===da;var n=0;b=b.colors;var q=b[n++],r=q.vfOffset;d(q);for(var u=0,A=c.length;u<A;u++){var x=c[u];if(f=e(x.tex,x.blendMode)){(aa||f._hash!==pa.material._hash)&&(aa=!1,pa._flush(),pa.node=za,pa.material=f);T=x.vertexCount;Z=x.indexCount;f=ca.request(T,Z);ba=f.indiceOffset;Y=f.vertexOffset;
V=f.byteOffset>>2;var v=ca._vData;var y=ca._iData;f=ca._uintVData;for(var w=ba,z=ba+Z;w<z;w++)y[w]=Y+k[m++];if(p=x.vfCount,v.set(g.subarray(l,l+p),V),l+=p,h)for(x=V,y=V+p;x<y;x+=6)v[x]+=qa,v[x+1]+=ua;else if(a)for(x=V,y=V+p;x<y;x+=6)na=v[x],ka=v[x+1],v[x]=na*ia+ka*sa+qa,v[x+1]=na*oa+ka*da+ua;if(ca.adjust(T,Z),Ba)for(v=l-p,x=V+4,y=V+4+p;x<y;x+=6,v+=6)v>=r&&(d(q=b[n++]),r=q.vfOffset),f[x]=U,f[x+1]=R}}}}},c.prototype.fillBuffers=function(a,b){var c=a.node;if(c._renderFlag|=k.FLAG_UPDATE_RENDER_DATA,
a._skeleton)c=c._color,K=c.r/255,P=c.g/255,L=c.b/255,M=c.a/255,O=(F=a.useTint||a.isAnimationCached())?q:l,H=F?6:5,za=a.node,ca=b.getBuffer("spine",O),pa=b,ja=a,aa=!0,z=a.premultipliedAlpha,A=1,t=0,Ba=!1,la=a._effectDelegate&&a._effectDelegate._vertexEffect,(4294967295!==c._val||z)&&(Ba=!0),F&&(t|=1),b=void 0,ja.enableBatch&&(b=za._worldMatrix,aa=!1,t|=16),a.isAnimationCached()?this.cacheTraverse(b):(la&&la.begin(a._skeleton),this.realTimeTraverse(b),la&&la.end()),ja=pa=ca=za=void 0,la=null},c}(a.default);
m.default=f;a.default.register(c,f);n.exports=m.default},{"../../cocos2d/core/renderer/assembler":158,"../../cocos2d/core/renderer/render-flow":179,"../../cocos2d/core/renderer/webgl/vertex-format":209,"./Skeleton":307,"./lib/spine":309}],314:[function(f,n,m){var h=function(){this.dispose=this.interrupt=this.event=this.complete=this.end=this.start=null};h.getListeners=function(e){return e.listener||(e.listener=new h),e.listener};n.exports=h},{}],315:[function(f,n,m){var h=f("./lib/spine");sp.VertexEffectDelegate=
cc.Class({name:"sp.VertexEffectDelegate",ctor:function(){this._interpolation=this._vertexEffect=null;this._effectType="none"},clear:function(){this._interpolation=this._vertexEffect=null;this._effectType="none"},initJitter:function(e,d){return this._effectType="jitter",this._vertexEffect=new h.JitterEffect(e,d),this._vertexEffect},initSwirlWithPow:function(e,d){return this._interpolation=new h.Pow(d),this._vertexEffect=new h.SwirlEffect(e,this._interpolation),this._vertexEffect},initSwirlWithPowOut:function(e,
d){return this._interpolation=new h.PowOut(d),this._vertexEffect=new h.SwirlEffect(e,this._interpolation),this._vertexEffect},getJitterVertexEffect:function(){return this._vertexEffect},getSwirlVertexEffect:function(){return this._vertexEffect},getVertexEffect:function(){return this._vertexEffect},getEffectType:function(){return this._effectType}});n.exports=sp.VertexEffectDelegate},{"./lib/spine":309}],316:[function(f,n,m){m="undefined"==typeof window?global:window;m.cc=m.cc||{};m._cc=m._cc||{};
f("./predefine");f("./polyfill/string");f("./polyfill/misc");f("./polyfill/array");f("./polyfill/object");f("./polyfill/array-buffer");f("./polyfill/number");f("./polyfill/typescript");f("./cocos2d/core/predefine");f("./cocos2d");f("./extends");n.exports=m.cc},{"./cocos2d":258,"./cocos2d/core/predefine":155,"./extends":305,"./package":void 0,"./polyfill/array":318,"./polyfill/array-buffer":317,"./polyfill/misc":319,"./polyfill/number":320,"./polyfill/object":321,"./polyfill/string":322,"./polyfill/typescript":323,
"./predefine":324}],317:[function(f,n,m){if(!ArrayBuffer.isView){var h=Object.getPrototypeOf(Int8Array);ArrayBuffer.isView="function"==typeof h?function(e){return e instanceof h}:function(e){if("object"!=typeof e)return!1;e=e.constructor;return e===Float32Array||e===Uint8Array||e===Uint32Array||e===Int8Array}}},{}],318:[function(f,n,m){Array.isArray||(Array.isArray=function(f){return"[object Array]"===Object.prototype.toString.call(f)});Array.prototype.find||(Array.prototype.find=function(f){for(var e=
this.length,d=0;d<e;d++){var b=this[d];if(f.call(this,b,d,this))return b}});Array.prototype.includes||(Array.prototype.includes=function(f){return-1!==this.indexOf(f)})},{}],319:[function(f,n,m){if(Math.sign||(Math.sign=function(d){return 0===(d=+d)||isNaN(d)?d:0<d?1:-1}),Math.log2||(Math.log2=function(d){return Math.log(d)*Math.LOG2E}),Number.isInteger||(Number.isInteger=function(d){return"number"==typeof d&&isFinite(d)&&Math.floor(d)===d}),!console.time){var h=window.performance||Date,e=Object.create(null);
console.time=function(d){e[d]=h.now()};console.timeEnd=function(d){var b=e[d];b=h.now()-b;console.log(d+": "+b+"ms")}}},{}],320:[function(f,n,m){Number.parseFloat=Number.parseFloat||parseFloat;Number.parseInt=Number.parseInt||parseInt},{}],321:[function(f,n,m){Object.assign||(Object.assign=function(f,e){return cc.js.mixin(f,e)});Object.getOwnPropertyDescriptors||(Object.getOwnPropertyDescriptors=function(f){var e={},d=Object.getOwnPropertyNames(f);Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(f)));
for(var b=0;b<d.length;++b){var a=d[b];e[a]=Object.getOwnPropertyDescriptor(f,a)}return e})},{}],322:[function(f,n,m){String.prototype.startsWith||(String.prototype.startsWith=function(f,e){return e=e||0,this.lastIndexOf(f,e)===e});String.prototype.endsWith||(String.prototype.endsWith=function(f,e){(void 0===e||e>this.length)&&(e=this.length);e-=f.length;f=this.indexOf(f,e);return-1!==f&&f===e});String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")})},{}],
323:[function(f,n,m){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,d){e.__proto__=d}||function(e,d){for(var b in d)d.hasOwnProperty(b)&&(e[b]=d[b])};window.__extends=function(e,d){function b(){this.constructor=e}h(e,d);e.prototype=null===d?Object.create(d):(b.prototype=d.prototype,new b)};window.__assign=Object.assign||function(e){for(var d,b=1,a=arguments.length;b<a;b++)for(var c in d=arguments[b])Object.prototype.hasOwnProperty.call(d,c)&&(e[c]=d[c]);return e};window.__rest=
function(e,d){var b={},a;for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>d.indexOf(a)&&(b[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(a=Object.getOwnPropertySymbols(e);c<a.length;c++)0>d.indexOf(a[c])&&(b[a[c]]=e[a[c]])}return b};window.__decorate=function(e,d,b,a){var c,f=arguments.length,k=3>f?d:null===a?a=Object.getOwnPropertyDescriptor(d,b):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)k=Reflect.decorate(e,d,b,a);else for(var h=
e.length-1;0<=h;h--)(c=e[h])&&(k=(3>f?c(k):3<f?c(d,b,k):c(d,b))||k);return 3<f&&k&&Object.defineProperty(d,b,k),k};window.__param=function(e,d){return function(b,a){d(b,a,e)}};window.__metadata=function(e,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,d)};window.__awaiter=function(e,d,b,a){return new (b||(b=Promise))(function(c,f){function g(b){try{m(a.next(b))}catch(t){f(t)}}function h(b){try{m(a.throw(b))}catch(t){f(t)}}function m(a){a.done?c(a.value):
(new b(function(b){b(a.value)})).then(g,h)}m((a=a.apply(e,d||[])).next())})};window.__generator=function(e,d){function b(b){return function(c){return a([b,c])}}function a(a){if(c)throw new TypeError("Generator is already executing.");for(;m;)try{if(c=1,f&&(k=2&a[0]?f.return:a[0]?f.throw||((k=f.return)&&k.call(f),0):f.next)&&!(k=k.call(f,a[1])).done)return k;switch(f=0,k&&(a=[2&a[0],k.value]),a[0]){case 0:case 1:k=a;break;case 4:return m.label++,{value:a[1],done:!1};case 5:m.label++;f=a[1];a=[0];continue;
case 7:a=m.ops.pop();m.trys.pop();continue;default:if(!(k=0<(k=m.trys).length&&k[k.length-1])&&(6===a[0]||2===a[0])){m=0;continue}if(3===a[0]&&(!k||a[1]>k[0]&&a[1]<k[3]))m.label=a[1];else if(6===a[0]&&m.label<k[1])m.label=k[1],k=a;else if(k&&m.label<k[2])m.label=k[2],m.ops.push(a);else{k[2]&&m.ops.pop();m.trys.pop();continue}}a=d.call(e,m)}catch(t){a=[6,t],f=0}finally{c=k=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c,f,k,h,m={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},
trys:[],ops:[]};return h={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h};window.__exportStar=function(e,d){for(var b in e)d.hasOwnProperty(b)||(d[b]=e[b])};window.__values=function(e){var d="function"==typeof Symbol&&e[Symbol.iterator],b=0;return d?d.call(e):{next:function(){return e&&b>=e.length&&(e=void 0),{value:e&&e[b++],done:!e}}}};window.__read=function(e,d){var b="function"==typeof Symbol&&e[Symbol.iterator];if(!b)return e;var a;
e=b.call(e);var c=[];try{for(;(void 0===d||0<d--)&&!(a=e.next()).done;)c.push(a.value)}catch(k){var f={error:k}}finally{try{a&&!a.done&&(b=e.return)&&b.call(e)}finally{if(f)throw f.error;}}return c};window.__spread=function(){for(var e=[],d=0;d<arguments.length;d++)e=e.concat(__read(arguments[d]));return e};window.__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)};window.__asyncGenerator=function(e,d,b){function a(a){n[a]&&(m[a]=function(b){return new Promise(function(d,
e){1<t.push([a,b,d,e])||c(a,b)})})}function c(a,b){try{var c=n[a](b);c.value instanceof __await?Promise.resolve(c.value.v).then(f,k):h(t[0][2],c)}catch(E){h(t[0][3],E)}}function f(a){c("next",a)}function k(a){c("throw",a)}function h(a,b){a(b);t.shift();t.length&&c(t[0][0],t[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m,n=b.apply(e,d||[]),t=[];return m={},a("next"),a("throw"),a("return"),m[Symbol.asyncIterator]=function(){return this},m};window.__asyncDelegator=
function(e){function d(c,d){b[c]=e[c]?function(b){return(a=!a)?{value:__await(e[c](b)),done:"return"===c}:d?d(b):b}:d}var b,a;return b={},d("next"),d("throw",function(a){throw a;}),d("return"),b[Symbol.iterator]=function(){return this},b};window.__asyncValues=function(e){function d(c){a[c]=e[c]&&function(a){return new Promise(function(d,f){b(d,f,(a=e[c](a)).done,a.value)})}}function b(a,b,c,d){Promise.resolve(d).then(function(b){a({value:b,done:c})},b)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");
var a,c=e[Symbol.asyncIterator];return c?c.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),a={},d("next"),d("throw"),d("return"),a[Symbol.asyncIterator]=function(){return this},a)};window.__makeTemplateObject=function(e,d){return Object.defineProperty?Object.defineProperty(e,"raw",{value:d}):e.raw=d,e};window.__importStar=function(e){if(e&&e.__esModule)return e;var d={};if(null!=e)for(var b in e)Object.hasOwnProperty.call(e,b)&&(d[b]=e[b]);return d.default=e,d};window.__importDefault=
function(e){return e&&e.__esModule?e:{default:e}}},{}],324:[function(f,n,m){function h(a,c){void 0===b[a]&&(b[a]=c)}function e(a,c){void 0===b[a]&&Object.defineProperty(b,a,{get:function(){var b=void 0;return"CC_WECHATGAMESUB"===a?b="cc.sys.platform === cc.sys.WECHAT_GAME_SUB":"CC_WECHATGAME"===a?b="cc.sys.platform === cc.sys.WECHAT_GAME":"CC_QQPLAY"===a&&(b="cc.sys.platform === cc.sys.QQ_PLAY"),cc.warnID(1400,a,b),c}})}function d(a){return"object"==typeof b[a]}var b="undefined"==typeof window?global:
window;h("CC_BUILD",!1);b.CC_BUILD=!0;b.CC_DEV=!1;b.CC_DEBUG=!1;b.CC_JSB=!1;b.CC_NATIVERENDERER=!1;b.CC_SUPPORT_JIT=!0;h("CC_TEST",d("tap")||d("QUnit"));h("CC_EDITOR",d("Editor")&&d("process")&&"electron"in process.versions);h("CC_PREVIEW",!0);h("CC_RUNTIME","function"==typeof loadRuntime);h("CC_JSB",d("jsb")&&!0);f=!(!d("wx")||!wx.getSharedCanvas);n=!(!d("wx")||!wx.getSystemInfoSync&&!wx.getSharedCanvas);m=d("bk");e("CC_WECHATGAMESUB",f);e("CC_WECHATGAME",n);e("CC_QQPLAY",m);b.CocosEngine=cc.ENGINE_VERSION=
"2.2.1"},{}]},{},[316]);!function(f){"object"==typeof exports&&"undefined"!=typeof module?module.exports=f():"function"==typeof define&&define.amd?define([],f):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=f()}(function(){return function e(n,m,h){function d(a,g){if(!m[a]){if(!n[a]){var c="function"==typeof require&&require;if(!g&&c)return c(a,!0);if(b)return b(a,!0);g=Error("Cannot find module '"+a+"'");throw g.code="MODULE_NOT_FOUND",g;}g=m[a]={exports:{}};
n[a][0].call(g.exports,function(b){return d(n[a][1][b]||b)},g,g.exports,e,n,m,h)}return m[a].exports}for(var b="function"==typeof require&&require,a=0;a<h.length;a++)d(h[a]);return d}({1:[function(n,m,h){function e(d){if(!(this instanceof e))return new e(d);d=this.options=a.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},d||{});d.raw&&0<d.windowBits?d.windowBits=-d.windowBits:d.gzip&&0<d.windowBits&&16>d.windowBits&&(d.windowBits+=16);this.err=0;this.msg="";this.ended=
!1;this.chunks=[];this.strm=new k;this.strm.avail_out=0;var h=b.deflateInit2(this.strm,d.level,d.method,d.windowBits,d.memLevel,d.strategy);if(0!==h)throw Error(g[h]);if(d.header&&b.deflateSetHeader(this.strm,d.header),d.dictionary){var m;if(m="string"==typeof d.dictionary?c.string2buf(d.dictionary):"[object ArrayBuffer]"===l.call(d.dictionary)?new Uint8Array(d.dictionary):d.dictionary,0!==(h=b.deflateSetDictionary(this.strm,m)))throw Error(g[h]);this._dict_set=!0}}function d(a,b){b=new e(b);if(b.push(a,
!0),b.err)throw b.msg||g[b.err];return b.result}var b=n("./zlib/deflate"),a=n("./utils/common"),c=n("./utils/strings"),g=n("./zlib/messages"),k=n("./zlib/zstream"),l=Object.prototype.toString;e.prototype.push=function(d,e){var g,k=this.strm,h=this.options.chunkSize;if(this.ended)return!1;e=e===~~e?e:!0===e?4:0;"string"==typeof d?k.input=c.string2buf(d):"[object ArrayBuffer]"===l.call(d)?k.input=new Uint8Array(d):k.input=d;k.next_in=0;k.avail_in=k.input.length;do{if(0===k.avail_out&&(k.output=new a.Buf8(h),
k.next_out=0,k.avail_out=h),1!==(g=b.deflate(k,e))&&0!==g)return this.onEnd(g),!(this.ended=!0);0!==k.avail_out&&(0!==k.avail_in||4!==e&&2!==e)||("string"===this.options.to?this.onData(c.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||0===k.avail_out)&&1!==g);return 4===e?(g=b.deflateEnd(this.strm),this.onEnd(g),this.ended=!0,0===g):2!==e||(this.onEnd(0),!(k.avail_out=0))};e.prototype.onData=function(a){this.chunks.push(a)};e.prototype.onEnd=
function(b){0===b&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};h.Deflate=e;h.deflate=d;h.deflateRaw=function(a,b){return(b=b||{}).raw=!0,d(a,b)};h.gzip=function(a,b){return(b=b||{}).gzip=!0,d(a,b)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(n,m,h){function e(d){if(!(this instanceof e))return new e(d);var h=this.options=
a.assign({chunkSize:16384,windowBits:0,to:""},d||{});h.raw&&0<=h.windowBits&&16>h.windowBits&&(h.windowBits=-h.windowBits,0===h.windowBits&&(h.windowBits=-15));!(0<=h.windowBits&&16>h.windowBits)||d&&d.windowBits||(h.windowBits+=32);15<h.windowBits&&48>h.windowBits&&0==(15&h.windowBits)&&(h.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new l;this.strm.avail_out=0;d=b.inflateInit2(this.strm,h.windowBits);if(d!==g.Z_OK)throw Error(k[d]);if(this.header=new q,b.inflateGetHeader(this.strm,
this.header),h.dictionary&&("string"==typeof h.dictionary?h.dictionary=c.string2buf(h.dictionary):"[object ArrayBuffer]"===r.call(h.dictionary)&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(d=b.inflateSetDictionary(this.strm,h.dictionary))!==g.Z_OK))throw Error(k[d]);}function d(a,b){b=new e(b);if(b.push(a,!0),b.err)throw b.msg||k[b.err];return b.result}var b=n("./zlib/inflate"),a=n("./utils/common"),c=n("./utils/strings"),g=n("./zlib/constants"),k=n("./zlib/messages"),l=n("./zlib/zstream"),
q=n("./zlib/gzheader"),r=Object.prototype.toString;e.prototype.push=function(d,e){var k,h,l,m,n=this.strm,p=this.options.chunkSize,q=this.options.dictionary,t=!1;if(this.ended)return!1;e=e===~~e?e:!0===e?g.Z_FINISH:g.Z_NO_FLUSH;"string"==typeof d?n.input=c.binstring2buf(d):"[object ArrayBuffer]"===r.call(d)?n.input=new Uint8Array(d):n.input=d;n.next_in=0;n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new a.Buf8(p),n.next_out=0,n.avail_out=p),(k=b.inflate(n,g.Z_NO_FLUSH))===g.Z_NEED_DICT&&
q&&(k=b.inflateSetDictionary(this.strm,q)),k===g.Z_BUF_ERROR&&!0===t&&(k=g.Z_OK,t=!1),k!==g.Z_STREAM_END&&k!==g.Z_OK)return this.onEnd(k),!(this.ended=!0);n.next_out&&(0!==n.avail_out&&k!==g.Z_STREAM_END&&(0!==n.avail_in||e!==g.Z_FINISH&&e!==g.Z_SYNC_FLUSH)||("string"===this.options.to?(h=c.utf8border(n.output,n.next_out),l=n.next_out-h,m=c.buf2string(n.output,h),n.next_out=l,n.avail_out=p-l,l&&a.arraySet(n.output,n.output,h,l,0),this.onData(m)):this.onData(a.shrinkBuf(n.output,n.next_out))));0===
n.avail_in&&0===n.avail_out&&(t=!0)}while((0<n.avail_in||0===n.avail_out)&&k!==g.Z_STREAM_END);return k===g.Z_STREAM_END&&(e=g.Z_FINISH),e===g.Z_FINISH?(k=b.inflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===g.Z_OK):e!==g.Z_SYNC_FLUSH||(this.onEnd(g.Z_OK),!(n.avail_out=0))};e.prototype.onData=function(a){this.chunks.push(a)};e.prototype.onEnd=function(b){b===g.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks));this.chunks=[];this.err=b;
this.msg=this.strm.msg};h.Inflate=e;h.inflate=d;h.inflateRaw=function(a,b){return(b=b||{}).raw=!0,d(a,b)};h.ungzip=d},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(n,m,h){n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;h.assign=function(b){for(var a,c,d=Array.prototype.slice.call(arguments,1);d.length;){var e=d.shift();if(e){if("object"!=typeof e)throw new TypeError(e+
"must be non-object");for(var h in e)a=e,c=h,Object.prototype.hasOwnProperty.call(a,c)&&(b[h]=e[h])}}return b};h.shrinkBuf=function(b,a){return b.length===a?b:b.subarray?b.subarray(0,a):(b.length=a,b)};var e={arraySet:function(b,a,c,d,e){if(a.subarray&&b.subarray)b.set(a.subarray(c,c+d),e);else for(var g=0;g<d;g++)b[e+g]=a[c+g]},flattenChunks:function(b){var a,c;var d=c=0;for(a=b.length;d<a;d++)c+=b[d].length;var e=new Uint8Array(c);d=c=0;for(a=b.length;d<a;d++){var h=b[d];e.set(h,c);c+=h.length}return e}},
d={arraySet:function(b,a,c,d,e){for(var g=0;g<d;g++)b[e+g]=a[c+g]},flattenChunks:function(b){return[].concat.apply([],b)}};h.setTyped=function(b){b?(h.Buf8=Uint8Array,h.Buf16=Uint16Array,h.Buf32=Int32Array,h.assign(h,e)):(h.Buf8=Array,h.Buf16=Array,h.Buf32=Array,h.assign(h,d))};h.setTyped(n)},{}],4:[function(n,m,h){function e(c,e){if(65534>e&&(c.subarray&&a||!c.subarray&&b))return String.fromCharCode.apply(null,d.shrinkBuf(c,e));for(var g="",h=0;h<e;h++)g+=String.fromCharCode(c[h]);return g}var d=
n("./common"),b=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(g){b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(g){a=!1}var c=new d.Buf8(256);for(n=0;256>n;n++)c[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;c[254]=c[254]=1;h.string2buf=function(a){var b,c,e,g,h=a.length,m=0;for(e=0;e<h;e++)55296==(64512&(b=a.charCodeAt(e)))&&e+1<h&&56320==(64512&(c=a.charCodeAt(e+1)))&&(b=65536+(b-55296<<10)+(c-56320),e++),m+=128>b?1:2048>b?2:65536>b?3:4;var n=new d.Buf8(m);for(e=g=
0;g<m;e++)55296==(64512&(b=a.charCodeAt(e)))&&e+1<h&&56320==(64512&(c=a.charCodeAt(e+1)))&&(b=65536+(b-55296<<10)+(c-56320),e++),128>b?n[g++]=b:(2048>b?n[g++]=192|b>>>6:(65536>b?n[g++]=224|b>>>12:(n[g++]=240|b>>>18,n[g++]=128|b>>>12&63),n[g++]=128|b>>>6&63),n[g++]=128|63&b);return n};h.buf2binstring=function(a){return e(a,a.length)};h.binstring2buf=function(a){for(var b=new d.Buf8(a.length),c=0,e=b.length;c<e;c++)b[c]=a.charCodeAt(c);return b};h.buf2string=function(a,b){var d,g,h,k=b||a.length,m=
Array(2*k);for(b=d=0;b<k;)if(128>(g=a[b++]))m[d++]=g;else if(4<(h=c[g]))m[d++]=65533,b+=h-1;else{for(g&=2===h?31:3===h?15:7;1<h&&b<k;)g=g<<6|63&a[b++],h--;1<h?m[d++]=65533:65536>g?m[d++]=g:(g-=65536,m[d++]=55296|g>>10&1023,m[d++]=56320|1023&g)}return e(m,d)};h.utf8border=function(a,b){var d;(b=b||a.length)>a.length&&(b=a.length);for(d=b-1;0<=d&&128==(192&a[d]);)d--;return 0>d?b:0===d?b:d+c[a[d]]>b?d:b}},{"./common":3}],5:[function(n,m,h){m.exports=function(e,d,b,a){var c=65535&e|0;e=e>>>16&65535|
0;for(var g;0!==b;){for(b-=g=2E3<b?2E3:b;e=e+(c=c+d[a++]|0)|0,--g;);c%=65521;e%=65521}return c|e<<16|0}},{}],6:[function(n,m,h){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,
Z_DEFLATED:8}},{}],7:[function(n,m,h){var e=function(){for(var d,b=[],a=0;256>a;a++){d=a;for(var c=0;8>c;c++)d=1&d?3988292384^d>>>1:d>>>1;b[a]=d}return b}();m.exports=function(d,b,a,c){a=c+a;for(d^=-1;c<a;c++)d=d>>>8^e[255&(d^b[c])];return-1^d}},{}],8:[function(n,m,h){function e(a,b){return a.msg=C[b],b}function d(a){for(var b=a.length;0<=--b;)a[b]=0}function b(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out);0!==c&&(x.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=
c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function a(a,c){y._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,c);a.block_start=a.strstart;b(a.strm)}function c(a,b){a.pending_buf[a.pending++]=b}function g(a,b){a.pending_buf[a.pending++]=b>>>8&255;a.pending_buf[a.pending++]=255&b}function k(a,b){var c,d,e=a.max_chain_length,g=a.strstart,h=a.prev_length,k=a.nice_match,l=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):
0,m=a.window,n=a.w_mask,p=a.prev,q=a.strstart+258,r=m[g+h-1],u=m[g+h];a.prev_length>=a.good_match&&(e>>=2);k>a.lookahead&&(k=a.lookahead);do if(m[(c=b)+h]===u&&m[c+h-1]===r&&m[c]===m[g]&&m[++c]===m[g+1]){g+=2;for(c++;m[++g]===m[++c]&&m[++g]===m[++c]&&m[++g]===m[++c]&&m[++g]===m[++c]&&m[++g]===m[++c]&&m[++g]===m[++c]&&m[++g]===m[++c]&&m[++g]===m[++c]&&g<q;);if(d=258-(q-g),g=q-258,h<d){if(a.match_start=b,k<=(h=d))break;r=m[g+h-1];u=m[g+h]}}while((b=p[b&n])>l&&0!=--e);return h<=a.lookahead?h:a.lookahead}
function l(a){var b,c,d,e,g,h,k,l,m,n=a.w_size;do{if(e=a.window_size-a.lookahead-a.strstart,a.strstart>=n+(n-262)){x.arraySet(a.window,a.window,n,n,0);a.match_start-=n;a.strstart-=n;a.block_start-=n;for(b=c=a.hash_size;d=a.head[--b],a.head[b]=n<=d?d-n:0,--c;);for(b=c=n;d=a.prev[--b],a.prev[b]=n<=d?d-n:0,--c;);e+=n}if(0===a.strm.avail_in)break;if(g=a.strm,h=a.window,k=a.strstart+a.lookahead,l=e,m=void 0,m=g.avail_in,l<m&&(m=l),c=0===m?0:(g.avail_in-=m,x.arraySet(h,g.input,g.next_in,m,k),1===g.state.wrap?
g.adler=u(g.adler,h,m,k):2===g.state.wrap&&(g.adler=B(g.adler,h,m,k)),g.next_in+=m,g.total_in+=m,m),a.lookahead+=c,3<=a.lookahead+a.insert)for(b=a.strstart-a.insert,a.ins_h=a.window[b],a.ins_h=(a.ins_h<<a.hash_shift^a.window[b+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[b+3-1])&a.hash_mask,a.prev[b&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=b,b++,a.insert--,!(3>a.lookahead+a.insert)););}while(262>a.lookahead&&0!==a.strm.avail_in)}function q(b,c){for(var d,e;;){if(262>b.lookahead){if(l(b),
262>b.lookahead&&0===c)return 1;if(0===b.lookahead)break}if(d=0,3<=b.lookahead&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,d=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),0!==d&&b.strstart-d<=b.w_size-262&&(b.match_length=k(b,d)),3<=b.match_length)if(e=y._tr_tally(b,b.strstart-b.match_start,b.match_length-3),b.lookahead-=b.match_length,b.match_length<=b.max_lazy_match&&3<=b.lookahead){for(b.match_length--;b.strstart++,b.ins_h=(b.ins_h<<b.hash_shift^
b.window[b.strstart+3-1])&b.hash_mask,d=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart,0!=--b.match_length;);b.strstart++}else b.strstart+=b.match_length,b.match_length=0,b.ins_h=b.window[b.strstart],b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+1])&b.hash_mask;else e=y._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++;if(e&&(a(b,!1),0===b.strm.avail_out))return 1}return b.insert=2>b.strstart?b.strstart:2,4===c?(a(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&
(a(b,!1),0===b.strm.avail_out)?1:2}function r(b,c){for(var d,e,g;;){if(262>b.lookahead){if(l(b),262>b.lookahead&&0===c)return 1;if(0===b.lookahead)break}if(d=0,3<=b.lookahead&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,d=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),b.prev_length=b.match_length,b.prev_match=b.match_start,b.match_length=2,0!==d&&b.prev_length<b.max_lazy_match&&b.strstart-d<=b.w_size-262&&(b.match_length=k(b,d),5>=b.match_length&&
(1===b.strategy||3===b.match_length&&4096<b.strstart-b.match_start)&&(b.match_length=2)),3<=b.prev_length&&b.match_length<=b.prev_length){g=b.strstart+b.lookahead-3;e=y._tr_tally(b,b.strstart-1-b.prev_match,b.prev_length-3);b.lookahead-=b.prev_length-1;for(b.prev_length-=2;++b.strstart<=g&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,d=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart),0!=--b.prev_length;);if(b.match_available=0,b.match_length=2,b.strstart++,
e&&(a(b,!1),0===b.strm.avail_out))return 1}else if(b.match_available){if(y._tr_tally(b,0,b.window[b.strstart-1])&&a(b,!1),b.strstart++,b.lookahead--,0===b.strm.avail_out)return 1}else b.match_available=1,b.strstart++,b.lookahead--}return b.match_available&&(y._tr_tally(b,0,b.window[b.strstart-1]),b.match_available=0),b.insert=2>b.strstart?b.strstart:2,4===c?(a(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(a(b,!1),0===b.strm.avail_out)?1:2}function t(a,b,c,d,e){this.good_length=a;this.max_lazy=b;this.nice_length=
c;this.max_chain=d;this.func=e}function p(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=
this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new x.Buf16(1146);this.dyn_dtree=new x.Buf16(122);this.bl_tree=new x.Buf16(78);d(this.dyn_ltree);d(this.dyn_dtree);d(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new x.Buf16(16);this.heap=new x.Buf16(573);d(this.heap);this.heap_max=this.heap_len=0;this.depth=new x.Buf16(573);d(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=
this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function v(a){var b;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=2,(b=a.state).pending=0,b.pending_out=0,0>b.wrap&&(b.wrap=-b.wrap),b.status=b.wrap?42:113,a.adler=2===b.wrap?0:1,b.last_flush=0,y._tr_init(b),0):e(a,-2)}function w(a){var b,c=v(a);return 0===c&&((b=a.state).window_size=2*b.w_size,d(b.head),b.max_lazy_match=z[b.level].max_lazy,b.good_match=z[b.level].good_length,b.nice_match=z[b.level].nice_length,
b.max_chain_length=z[b.level].max_chain,b.strstart=0,b.block_start=0,b.lookahead=0,b.insert=0,b.match_length=b.prev_length=2,b.match_available=0,b.ins_h=0),c}function E(a,b,c,d,g,h){if(!a)return-2;var k=1;if(-1===b&&(b=6),0>d?(k=0,d=-d):15<d&&(k=2,d-=16),1>g||9<g||8!==c||8>d||15<d||0>b||9<b||0>h||4<h)return e(a,-2);8===d&&(d=9);var l=new p;return(a.state=l).strm=a,l.wrap=k,l.gzhead=null,l.w_bits=d,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=g+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-
1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new x.Buf8(2*l.w_size),l.head=new x.Buf16(l.hash_size),l.prev=new x.Buf16(l.w_size),l.lit_bufsize=1<<g+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new x.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=b,l.strategy=h,l.method=c,w(a)}var x=n("../utils/common"),y=n("./trees"),u=n("./adler32"),B=n("./crc32"),C=n("./messages");var z=[new t(0,0,0,0,function(b,c){var d=65535;for(d>b.pending_buf_size-5&&(d=b.pending_buf_size-
5);;){if(1>=b.lookahead){if(l(b),0===b.lookahead&&0===c)return 1;if(0===b.lookahead)break}b.strstart+=b.lookahead;b.lookahead=0;var e=b.block_start+d;if((0===b.strstart||b.strstart>=e)&&(b.lookahead=b.strstart-e,b.strstart=e,a(b,!1),0===b.strm.avail_out)||b.strstart-b.block_start>=b.w_size-262&&(a(b,!1),0===b.strm.avail_out))return 1}return b.insert=0,4===c?(a(b,!0),0===b.strm.avail_out?3:4):(b.strstart>b.block_start&&(a(b,!1),b.strm.avail_out),1)}),new t(4,4,8,4,q),new t(4,5,16,8,q),new t(4,6,32,
32,q),new t(4,4,16,16,r),new t(8,16,32,32,r),new t(8,16,128,128,r),new t(8,32,128,256,r),new t(32,128,258,1024,r),new t(32,258,258,4096,r)];h.deflateInit=function(a,b){return E(a,b,8,15,8,0)};h.deflateInit2=E;h.deflateReset=w;h.deflateResetKeep=v;h.deflateSetHeader=function(a,b){return a&&a.state?2!==a.state.wrap?-2:(a.state.gzhead=b,0):-2};h.deflate=function(h,k){var m,n;if(!h||!h.state||5<k||0>k)return h?e(h,-2):-2;if(n=h.state,!h.output||!h.input&&0!==h.avail_in||666===n.status&&4!==k)return e(h,
0===h.avail_out?-5:-2);if(n.strm=h,m=n.last_flush,n.last_flush=k,42===n.status)if(2===n.wrap)h.adler=0,c(n,31),c(n,139),c(n,8),n.gzhead?(c(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),c(n,255&n.gzhead.time),c(n,n.gzhead.time>>8&255),c(n,n.gzhead.time>>16&255),c(n,n.gzhead.time>>24&255),c(n,9===n.level?2:2<=n.strategy||2>n.level?4:0),c(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(c(n,255&n.gzhead.extra.length),c(n,n.gzhead.extra.length>>
8&255)),n.gzhead.hcrc&&(h.adler=B(h.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(c(n,0),c(n,0),c(n,0),c(n,0),c(n,0),c(n,9===n.level?2:2<=n.strategy||2>n.level?4:0),c(n,3),n.status=113);else{var p=8+(n.w_bits-8<<4)<<8;p|=(2<=n.strategy||2>n.level?0:6>n.level?1:6===n.level?2:3)<<6;0!==n.strstart&&(p|=32);n.status=113;g(n,p+(31-p%31));0!==n.strstart&&(g(n,h.adler>>>16),g(n,65535&h.adler));h.adler=1}if(69===n.status)if(n.gzhead.extra){for(p=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&
(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>p&&(h.adler=B(h.adler,n.pending_buf,n.pending-p,p)),b(h),p=n.pending,n.pending!==n.pending_buf_size));)c(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>p&&(h.adler=B(h.adler,n.pending_buf,n.pending-p,p));n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){p=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>p&&(h.adler=B(h.adler,n.pending_buf,
n.pending-p,p)),b(h),p=n.pending,n.pending===n.pending_buf_size)){var q=1;break}c(n,q=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0)}while(0!==q);n.gzhead.hcrc&&n.pending>p&&(h.adler=B(h.adler,n.pending_buf,n.pending-p,p));0===q&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){p=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>p&&(h.adler=B(h.adler,n.pending_buf,n.pending-p,p)),b(h),p=n.pending,n.pending===n.pending_buf_size)){q=
1;break}c(n,q=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0)}while(0!==q);n.gzhead.hcrc&&n.pending>p&&(h.adler=B(h.adler,n.pending_buf,n.pending-p,p));0===q&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&b(h),n.pending+2<=n.pending_buf_size&&(c(n,255&h.adler),c(n,h.adler>>8&255),h.adler=0,n.status=113)):n.status=113),0!==n.pending){if(b(h),0===h.avail_out)return n.last_flush=-1,0}else if(0===h.avail_in&&(k<<1)-
(4<k?9:0)<=(m<<1)-(4<m?9:0)&&4!==k)return e(h,-5);if(666===n.status&&0!==h.avail_in)return e(h,-5);if(0!==h.avail_in||0!==n.lookahead||0!==k&&666!==n.status){m=2===n.strategy?function(b,c){for(var d;;){if(0===b.lookahead&&(l(b),0===b.lookahead)){if(0===c)return 1;break}if(b.match_length=0,d=y._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++,d&&(a(b,!1),0===b.strm.avail_out))return 1}return b.insert=0,4===c?(a(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(a(b,!1),0===b.strm.avail_out)?
1:2}(n,k):3===n.strategy?function(b,c){for(var d,e,g,h,k=b.window;;){if(258>=b.lookahead){if(l(b),258>=b.lookahead&&0===c)return 1;if(0===b.lookahead)break}if(b.match_length=0,3<=b.lookahead&&0<b.strstart&&(e=k[g=b.strstart-1])===k[++g]&&e===k[++g]&&e===k[++g]){for(h=b.strstart+258;e===k[++g]&&e===k[++g]&&e===k[++g]&&e===k[++g]&&e===k[++g]&&e===k[++g]&&e===k[++g]&&e===k[++g]&&g<h;);b.match_length=258-(h-g);b.match_length>b.lookahead&&(b.match_length=b.lookahead)}if(3<=b.match_length?(d=y._tr_tally(b,
1,b.match_length-3),b.lookahead-=b.match_length,b.strstart+=b.match_length,b.match_length=0):(d=y._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++),d&&(a(b,!1),0===b.strm.avail_out))return 1}return b.insert=0,4===c?(a(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(a(b,!1),0===b.strm.avail_out)?1:2}(n,k):z[n.level].func(n,k);if(3!==m&&4!==m||(n.status=666),1===m||3===m)return 0===h.avail_out&&(n.last_flush=-1),0;if(2===m&&(1===k?y._tr_align(n):5!==k&&(y._tr_stored_block(n,0,0,!1),3===k&&
(d(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),b(h),0===h.avail_out))return n.last_flush=-1,0}return 4!==k?0:0>=n.wrap?1:(2===n.wrap?(c(n,255&h.adler),c(n,h.adler>>8&255),c(n,h.adler>>16&255),c(n,h.adler>>24&255),c(n,255&h.total_in),c(n,h.total_in>>8&255),c(n,h.total_in>>16&255),c(n,h.total_in>>24&255)):(g(n,h.adler>>>16),g(n,65535&h.adler)),b(h),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?0:1)};h.deflateEnd=function(a){var b;return a&&a.state?42!==(b=a.state.status)&&69!==b&&
73!==b&&91!==b&&103!==b&&113!==b&&666!==b?e(a,-2):(a.state=null,113===b?e(a,-3):0):-2};h.deflateSetDictionary=function(a,b){var c,e,g;var h=b.length;if(!a||!a.state||2===(e=(c=a.state).wrap)||1===e&&42!==c.status||c.lookahead)return-2;1===e&&(a.adler=u(a.adler,b,h,0));c.wrap=0;h>=c.w_size&&(0===e&&(d(c.head),c.strstart=0,c.block_start=0,c.insert=0),g=new x.Buf8(c.w_size),x.arraySet(g,b,h-c.w_size,c.w_size,0),b=g,h=c.w_size);g=a.avail_in;var k=a.next_in;var m=a.input;a.avail_in=h;a.next_in=0;a.input=
b;for(l(c);3<=c.lookahead;){b=c.strstart;for(h=c.lookahead-2;c.ins_h=(c.ins_h<<c.hash_shift^c.window[b+3-1])&c.hash_mask,c.prev[b&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=b,b++,--h;);c.strstart=b;c.lookahead=2;l(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=2,c.match_available=0,a.next_in=k,a.input=m,a.avail_in=g,c.wrap=e,0};h.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,
"./messages":13,"./trees":14}],9:[function(n,m,h){m.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],10:[function(n,m,h){m.exports=function(e,d){var b,a,c;var g=e.state;var h=e.next_in;var l=e.input;var m=h+(e.avail_in-5);var n=e.next_out;var t=e.output;d=n-(d-e.avail_out);var p=n+(e.avail_out-257);var v=g.dmax;var w=g.wsize;var E=g.whave;var x=g.wnext;var y=g.window;var u=g.hold;var B=g.bits;var C=
g.lencode;var z=g.distcode;var A=(1<<g.lenbits)-1;var D=(1<<g.distbits)-1;a:do{15>B&&(u+=l[h++]<<B,B+=8,u+=l[h++]<<B,B+=8);var I=C[u&A];b:for(;;){if(u>>>=b=I>>>24,B-=b,0===(b=I>>>16&255))t[n++]=65535&I;else{if(!(16&b)){if(0==(64&b)){I=C[(65535&I)+(u&(1<<b)-1)];continue b}if(32&b){g.mode=12;break a}e.msg="invalid literal/length code";g.mode=30;break a}var F=65535&I;(b&=15)&&(B<b&&(u+=l[h++]<<B,B+=8),F+=u&(1<<b)-1,u>>>=b,B-=b);15>B&&(u+=l[h++]<<B,B+=8,u+=l[h++]<<B,B+=8);I=z[u&D];c:for(;;){if(u>>>=b=
I>>>24,B-=b,!(16&(b=I>>>16&255))){if(0==(64&b)){I=z[(65535&I)+(u&(1<<b)-1)];continue c}e.msg="invalid distance code";g.mode=30;break a}if(a=65535&I,B<(b&=15)&&(u+=l[h++]<<B,(B+=8)<b&&(u+=l[h++]<<B,B+=8)),v<(a+=u&(1<<b)-1)){e.msg="invalid distance too far back";g.mode=30;break a}if(u>>>=b,B-=b,(b=n-d)<a){if(E<(b=a-b)&&g.sane){e.msg="invalid distance too far back";g.mode=30;break a}if(c=y,(I=0)===x){if(I+=w-b,b<F){for(F-=b;t[n++]=y[I++],--b;);I=n-a;c=t}}else if(x<b){if(I+=w+x-b,(b-=x)<F){for(F-=b;t[n++]=
y[I++],--b;);if(I=0,x<F){for(F-=b=x;t[n++]=y[I++],--b;);I=n-a;c=t}}}else if(I+=x-b,b<F){for(F-=b;t[n++]=y[I++],--b;);I=n-a;c=t}for(;2<F;)t[n++]=c[I++],t[n++]=c[I++],t[n++]=c[I++],F-=3;F&&(t[n++]=c[I++],1<F&&(t[n++]=c[I++]))}else{for(I=n-a;t[n++]=t[I++],t[n++]=t[I++],t[n++]=t[I++],2<(F-=3););F&&(t[n++]=t[I++],1<F&&(t[n++]=t[I++]))}break}}break}}while(h<m&&n<p);h-=F=B>>3;u&=(1<<(B-=F<<3))-1;e.next_in=h;e.next_out=n;e.avail_in=h<m?m-h+5:5-(h-m);e.avail_out=n<p?p-n+257:257-(n-p);g.hold=u;g.bits=B}},{}],
11:[function(n,m,h){function e(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function d(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new l.Buf16(320);this.work=new l.Buf16(288);
this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function b(a){var b;return a&&a.state?(b=a.state,a.total_in=a.total_out=b.total=0,a.msg="",b.wrap&&(a.adler=1&b.wrap),b.mode=1,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new l.Buf32(852),b.distcode=b.distdyn=new l.Buf32(592),b.sane=1,b.back=-1,0):-2}function a(a){var c;return a&&a.state?((c=a.state).wsize=0,c.whave=0,c.wnext=0,b(a)):-2}function c(b,c){var d,e;return b&&b.state?(e=b.state,0>c?(d=0,
c=-c):(d=1+(c>>4),48>c&&(c&=15)),c&&(8>c||15<c)?-2:(null!==e.window&&e.wbits!==c&&(e.window=null),e.wrap=d,e.wbits=c,a(b))):-2}function g(a,b){var e,g;return a?(g=new d,(a.state=g).window=null,0!==(e=c(a,b))&&(a.state=null),e):-2}function k(a,b,c,d){var e;a=a.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new l.Buf8(a.wsize)),d>=a.wsize?(l.arraySet(a.window,b,c-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(d<(e=a.wsize-a.wnext)&&(e=d),l.arraySet(a.window,b,c-d,e,a.wnext),
(d-=e)?(l.arraySet(a.window,b,c-d,d,0),a.wnext=d,a.whave=a.wsize):(a.wnext+=e,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=e))),0}var l=n("../utils/common"),q=n("./adler32"),r=n("./crc32"),t=n("./inffast"),p=n("./inftrees"),v,w,E=!0;h.inflateReset=a;h.inflateReset2=c;h.inflateResetKeep=b;h.inflateInit=function(a){return g(a,15)};h.inflateInit2=g;h.inflate=function(a,b){var c,d,g,h,m,n,x,y,G=0,J=new l.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||
!a.input&&0!==a.avail_in)return-2;12===(c=a.state).mode&&(c.mode=13);var K=a.next_out;var P=a.output;var L=a.avail_out;var M=a.next_in;var U=a.input;var R=a.avail_in;var O=c.hold;var H=c.bits;var S=R;var W=L;var T=0;a:for(;;)switch(c.mode){case 1:if(0===c.wrap){c.mode=13;break}for(;16>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(2&c.wrap&&35615===O){J[c.check=0]=255&O;J[1]=O>>>8&255;c.check=r(c.check,J,2,0);H=O=0;c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&O)<<8)+(O>>
8))%31){a.msg="incorrect header check";c.mode=30;break}if(8!=(15&O)){a.msg="unknown compression method";c.mode=30;break}if(H-=4,x=8+(15&(O>>>=4)),0===c.wbits)c.wbits=x;else if(x>c.wbits){a.msg="invalid window size";c.mode=30;break}c.dmax=1<<x;a.adler=c.check=1;c.mode=512&O?10:12;H=O=0;break;case 2:for(;16>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(c.flags=O,8!=(255&c.flags)){a.msg="unknown compression method";c.mode=30;break}if(57344&c.flags){a.msg="unknown header flags set";c.mode=30;break}c.head&&
(c.head.text=O>>8&1);512&c.flags&&(J[0]=255&O,J[1]=O>>>8&255,c.check=r(c.check,J,2,0));H=O=0;c.mode=3;case 3:for(;32>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}c.head&&(c.head.time=O);512&c.flags&&(J[0]=255&O,J[1]=O>>>8&255,J[2]=O>>>16&255,J[3]=O>>>24&255,c.check=r(c.check,J,4,0));H=O=0;c.mode=4;case 4:for(;16>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}c.head&&(c.head.xflags=255&O,c.head.os=O>>8);512&c.flags&&(J[0]=255&O,J[1]=O>>>8&255,c.check=r(c.check,J,2,0));H=O=0;c.mode=5;case 5:if(1024&c.flags){for(;16>
H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}c.length=O;c.head&&(c.head.extra_len=O);512&c.flags&&(J[0]=255&O,J[1]=O>>>8&255,c.check=r(c.check,J,2,0));H=O=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&(R<(d=c.length)&&(d=R),d&&(c.head&&(x=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),l.arraySet(c.head.extra,U,M,d,x)),512&c.flags&&(c.check=r(c.check,U,d,M)),R-=d,M+=d,c.length-=d),c.length))break a;c.length=0;c.mode=7;case 7:if(2048&c.flags){if(0===
R)break a;for(d=0;x=U[M+d++],c.head&&x&&65536>c.length&&(c.head.name+=String.fromCharCode(x)),x&&d<R;);if(512&c.flags&&(c.check=r(c.check,U,d,M)),R-=d,M+=d,x)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(4096&c.flags){if(0===R)break a;for(d=0;x=U[M+d++],c.head&&x&&65536>c.length&&(c.head.comment+=String.fromCharCode(x)),x&&d<R;);if(512&c.flags&&(c.check=r(c.check,U,d,M)),R-=d,M+=d,x)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;16>H;){if(0===
R)break a;R--;O+=U[M++]<<H;H+=8}if(O!==(65535&c.check)){a.msg="header crc mismatch";c.mode=30;break}H=O=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);a.adler=c.check=0;c.mode=12;break;case 10:for(;32>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}a.adler=c.check=e(O);H=O=0;c.mode=11;case 11:if(0===c.havedict)return a.next_out=K,a.avail_out=L,a.next_in=M,a.avail_in=R,c.hold=O,c.bits=H,2;a.adler=c.check=1;c.mode=12;case 12:if(5===b||6===b)break a;case 13:if(c.last){O>>>=7&H;H-=7&H;c.mode=27;break}for(;3>
H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}switch(c.last=1&O,--H,3&(O>>>=1)){case 0:c.mode=14;break;case 1:var Q=c;if(E){v=new l.Buf32(512);w=new l.Buf32(32);for(h=0;144>h;)Q.lens[h++]=8;for(;256>h;)Q.lens[h++]=9;for(;280>h;)Q.lens[h++]=7;for(;288>h;)Q.lens[h++]=8;p(1,Q.lens,0,288,v,0,Q.work,{bits:9});for(h=0;32>h;)Q.lens[h++]=5;p(2,Q.lens,0,32,w,0,Q.work,{bits:5});E=!1}Q.lencode=v;Q.lenbits=9;Q.distcode=w;Q.distbits=5;if(c.mode=20,6!==b)break;O>>>=2;H-=2;break a;case 2:c.mode=17;break;case 3:a.msg=
"invalid block type",c.mode=30}O>>>=2;H-=2;break;case 14:O>>>=7&H;for(H-=7&H;32>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if((65535&O)!=(O>>>16^65535)){a.msg="invalid stored block lengths";c.mode=30;break}if(c.length=65535&O,H=O=0,c.mode=15,6===b)break a;case 15:c.mode=16;case 16:if(d=c.length){if(R<d&&(d=R),L<d&&(d=L),0===d)break a;l.arraySet(P,U,M,d,K);R-=d;M+=d;L-=d;K+=d;c.length-=d;break}c.mode=12;break;case 17:for(;14>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(c.nlen=257+(31&O),O>>>=5,H-=
5,c.ndist=1+(31&O),O>>>=5,H-=5,c.ncode=4+(15&O),O>>>=4,H-=4,286<c.nlen||30<c.ndist){a.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=18;case 18:for(;c.have<c.ncode;){for(;3>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}c.lens[N[c.have++]]=7&O;O>>>=3;H-=3}for(;19>c.have;)c.lens[N[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,y={bits:c.lenbits},T=p(0,c.lens,0,19,c.lencode,0,c.work,y),c.lenbits=y.bits,T){a.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<
c.nlen+c.ndist;){for(;G=c.lencode[O&(1<<c.lenbits)-1],m=65535&G,!((h=G>>>24)<=H);){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(16>m)O>>>=h,H-=h,c.lens[c.have++]=m;else{if(16===m){for(Q=h+2;H<Q;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(O>>>=h,H-=h,0===c.have){a.msg="invalid bit length repeat";c.mode=30;break}x=c.lens[c.have-1];d=3+(3&O);O>>>=2;H-=2}else if(17===m){for(Q=h+3;H<Q;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}H-=h;x=0;d=3+(7&(O>>>=h));O>>>=3;H-=3}else{for(Q=h+7;H<Q;){if(0===R)break a;R--;
O+=U[M++]<<H;H+=8}H-=h;x=0;d=11+(127&(O>>>=h));O>>>=7;H-=7}if(c.have+d>c.nlen+c.ndist){a.msg="invalid bit length repeat";c.mode=30;break}for(;d--;)c.lens[c.have++]=x}}if(30===c.mode)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block";c.mode=30;break}if(c.lenbits=9,y={bits:c.lenbits},T=p(1,c.lens,0,c.nlen,c.lencode,0,c.work,y),c.lenbits=y.bits,T){a.msg="invalid literal/lengths set";c.mode=30;break}if(c.distbits=6,c.distcode=c.distdyn,y={bits:c.distbits},T=p(2,c.lens,c.nlen,c.ndist,
c.distcode,0,c.work,y),c.distbits=y.bits,T){a.msg="invalid distances set";c.mode=30;break}if(c.mode=20,6===b)break a;case 20:c.mode=21;case 21:if(6<=R&&258<=L){a.next_out=K;a.avail_out=L;a.next_in=M;a.avail_in=R;c.hold=O;c.bits=H;t(a,W);K=a.next_out;P=a.output;L=a.avail_out;M=a.next_in;U=a.input;R=a.avail_in;O=c.hold;H=c.bits;12===c.mode&&(c.back=-1);break}for(c.back=0;Q=(G=c.lencode[O&(1<<c.lenbits)-1])>>>16&255,m=65535&G,!((h=G>>>24)<=H);){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(Q&&0==(240&Q)){var Y=
h;var Z=Q;for(n=m;Q=(G=c.lencode[n+((O&(1<<Y+Z)-1)>>Y)])>>>16&255,m=65535&G,!(Y+(h=G>>>24)<=H);){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}O>>>=Y;H-=Y;c.back+=Y}if(O>>>=h,H-=h,c.back+=h,c.length=m,0===Q){c.mode=26;break}if(32&Q){c.back=-1;c.mode=12;break}if(64&Q){a.msg="invalid literal/length code";c.mode=30;break}c.extra=15&Q;c.mode=22;case 22:if(c.extra){for(Q=c.extra;H<Q;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}c.length+=O&(1<<c.extra)-1;O>>>=c.extra;H-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=
23;case 23:for(;Q=(G=c.distcode[O&(1<<c.distbits)-1])>>>16&255,m=65535&G,!((h=G>>>24)<=H);){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(0==(240&Q)){Y=h;Z=Q;for(n=m;Q=(G=c.distcode[n+((O&(1<<Y+Z)-1)>>Y)])>>>16&255,m=65535&G,!(Y+(h=G>>>24)<=H);){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}O>>>=Y;H-=Y;c.back+=Y}if(O>>>=h,H-=h,c.back+=h,64&Q){a.msg="invalid distance code";c.mode=30;break}c.offset=m;c.extra=15&Q;c.mode=24;case 24:if(c.extra){for(Q=c.extra;H<Q;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}c.offset+=
O&(1<<c.extra)-1;O>>>=c.extra;H-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===L)break a;if(d=W-L,c.offset>d){if((d=c.offset-d)>c.whave&&c.sane){a.msg="invalid distance too far back";c.mode=30;break}d>c.wnext?(d-=c.wnext,g=c.wsize-d):g=c.wnext-d;d>c.length&&(d=c.length);h=c.window}else h=P,g=K-c.offset,d=c.length;L<d&&(d=L);L-=d;for(c.length-=d;P[K++]=h[g++],--d;);0===c.length&&(c.mode=21);break;case 26:if(0===L)break a;
P[K++]=c.length;L--;c.mode=21;break;case 27:if(c.wrap){for(;32>H;){if(0===R)break a;R--;O|=U[M++]<<H;H+=8}if(W-=L,a.total_out+=W,c.total+=W,W&&(a.adler=c.check=c.flags?r(c.check,P,W,K-W):q(c.check,P,W,K-W)),W=L,(c.flags?O:e(O))!==c.check){a.msg="incorrect data check";c.mode=30;break}H=O=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;32>H;){if(0===R)break a;R--;O+=U[M++]<<H;H+=8}if(O!==(4294967295&c.total)){a.msg="incorrect length check";c.mode=30;break}H=O=0}c.mode=29;case 29:T=1;break a;case 30:T=
-3;break a;case 31:return-4;default:return-2}return a.next_out=K,a.avail_out=L,a.next_in=M,a.avail_in=R,c.hold=O,c.bits=H,(c.wsize||W!==a.avail_out&&30>c.mode&&(27>c.mode||4!==b))&&k(a,a.output,a.next_out,W-a.avail_out)?(c.mode=31,-4):(S-=a.avail_in,W-=a.avail_out,a.total_in+=S,a.total_out+=W,c.total+=W,c.wrap&&W&&(a.adler=c.check=c.flags?r(c.check,P,W,a.next_out-W):q(c.check,P,W,a.next_out-W)),a.data_type=c.bits+(c.last?64:0)+(12===c.mode?128:0)+(20===c.mode||15===c.mode?256:0),(0===S&&0===W||4===
b)&&0===T&&(T=-5),T)};h.inflateEnd=function(a){if(!a||!a.state)return-2;var b=a.state;return b.window&&(b.window=null),a.state=null,0};h.inflateGetHeader=function(a,b){var c;return a&&a.state?0==(2&(c=a.state).wrap)?-2:((c.head=b).done=!1,0):-2};h.inflateSetDictionary=function(a,b){var c,d=b.length;return a&&a.state?0!==(c=a.state).wrap&&11!==c.mode?-2:11===c.mode&&q(1,b,d,0)!==c.check?-3:k(a,b,d,d)?(c.mode=31,-4):(c.havedict=1,0):-2};h.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,
"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(n,m,h){var e=n("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,
28,29,29,64,64];m.exports=function(g,h,l,m,n,t,p,v){var k,q,r,y,u,B,C=v.bits,z,A,D,I,F,G=0,J,N=null,K=0,P=new e.Buf16(16);var L=new e.Buf16(16);var M=null,U=0;for(z=0;15>=z;z++)P[z]=0;for(A=0;A<m;A++)P[h[l+A]]++;var R=C;for(D=15;1<=D&&0===P[D];D--);if(D<R&&(R=D),0===D)return n[t++]=20971520,n[t++]=20971520,v.bits=1,0;for(C=1;C<D&&0===P[C];C++);R<C&&(R=C);for(z=k=1;15>=z;z++)if(k<<=1,0>(k-=P[z]))return-1;if(0<k&&(0===g||1!==D))return-1;L[1]=0;for(z=1;15>z;z++)L[z+1]=L[z]+P[z];for(A=0;A<m;A++)0!==h[l+
A]&&(p[L[h[l+A]]++]=A);if(0===g?(N=M=p,y=19):1===g?(N=d,K-=257,M=b,U-=257,y=256):(N=a,M=c,y=-1),z=C,L=t,F=A=J=0,r=-1,m=(G=1<<(I=R))-1,1===g&&852<G||2===g&&592<G)return 1;for(;;){var O=z-F;p[A]<y?(u=0,B=p[A]):p[A]>y?(u=M[U+p[A]],B=N[K+p[A]]):(u=96,B=0);k=1<<z-F;for(C=q=1<<I;n[L+(J>>F)+(q-=k)]=O<<24|u<<16|B|0,0!==q;);for(k=1<<z-1;J&k;)k>>=1;if(0!==k?(J&=k-1,J+=k):J=0,A++,0==--P[z]){if(z===D)break;z=h[l+p[A]]}if(R<z&&(J&m)!==r){0===F&&(F=R);L+=C;for(k=1<<(I=z-F);I+F<D&&!(0>=(k-=P[I+F]));)I++,k<<=1;if(G+=
1<<I,1===g&&852<G||2===g&&592<G)return 1;n[r=J&m]=R<<24|I<<16|L-t|0}}return 0!==J&&(n[L+J]=z-F<<24|4194304),v.bits=R,0}},{"../utils/common":3}],13:[function(n,m,h){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(n,m,h){function e(a){for(var b=a.length;0<=--b;)a[b]=0}function d(a,b,c,d,e){this.static_tree=a;this.extra_bits=b;this.extra_base=c;this.elems=
d;this.max_length=e;this.has_stree=a&&a.length}function b(a,b){this.dyn_tree=a;this.max_code=0;this.stat_desc=b}function a(a){return 256>a?G[a]:G[256+(a>>>7)]}function c(a,b){a.pending_buf[a.pending++]=255&b;a.pending_buf[a.pending++]=b>>>8&255}function g(a,b,d){a.bi_valid>16-d?(a.bi_buf|=b<<a.bi_valid&65535,c(a,a.bi_buf),a.bi_buf=b>>16-a.bi_valid,a.bi_valid+=d-16):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=d)}function k(a,b,c){g(a,c[2*b],c[2*b+1])}function l(a,b){for(var c=0;c|=1&a,a>>>=1,c<<=1,
0<--b;);return c>>>1}function q(a,b,c){var d,e=Array(16),g=0;for(d=1;15>=d;d++)e[d]=g=g+c[d-1]<<1;for(c=0;c<=b;c++)d=a[2*c+1],0!==d&&(a[2*c]=l(e[d]++,d))}function r(a){var b;for(b=0;286>b;b++)a.dyn_ltree[2*b]=0;for(b=0;30>b;b++)a.dyn_dtree[2*b]=0;for(b=0;19>b;b++)a.bl_tree[2*b]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function t(a){8<a.bi_valid?c(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf);a.bi_buf=0;a.bi_valid=0}function p(a,b,c,d){var e=2*b,g=2*c;
return a[e]<a[g]||a[e]===a[g]&&d[b]<=d[c]}function v(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len&&(e<a.heap_len&&p(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!p(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d}function w(b,c,d){var e,h,l,m,n=0;if(0!==b.last_lit)for(;e=b.pending_buf[b.d_buf+2*n]<<8|b.pending_buf[b.d_buf+2*n+1],h=b.pending_buf[b.l_buf+n],n++,0===e?k(b,h,c):(k(b,(l=J[h])+256+1,c),0!==(m=C[l])&&g(b,h-=N[l],m),k(b,l=a(--e),d),0!==(m=z[l])&&g(b,e-=M[l],m)),n<b.last_lit;);
k(b,256,c)}function E(a,b){var c,d,e,g=b.dyn_tree,h=b.stat_desc.static_tree,k=b.stat_desc.has_stree,l=b.stat_desc.elems,m=-1;a.heap_len=0;a.heap_max=573;for(c=0;c<l;c++)0!==g[2*c]?(a.heap[++a.heap_len]=m=c,a.depth[c]=0):g[2*c+1]=0;for(;2>a.heap_len;)g[2*(e=a.heap[++a.heap_len]=2>m?++m:0)]=1,a.depth[e]=0,a.opt_len--,k&&(a.static_len-=h[2*e+1]);b.max_code=m;for(c=a.heap_len>>1;1<=c;c--)v(a,g,c);for(e=l;c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],v(a,g,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=
d,g[2*e]=g[2*c]+g[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,g[2*c+1]=g[2*d+1]=e,a.heap[1]=e++,v(a,g,1),2<=a.heap_len;);a.heap[--a.heap_max]=a.heap[1];var n,p,r,t,u;c=b.dyn_tree;d=b.max_code;e=b.stat_desc.static_tree;h=b.stat_desc.has_stree;k=b.stat_desc.extra_bits;l=b.stat_desc.extra_base;var w=b.stat_desc.max_length,x=0;for(r=0;15>=r;r++)a.bl_count[r]=0;c[2*a.heap[a.heap_max]+1]=0;for(b=a.heap_max+1;573>b;b++)w<(r=c[2*c[2*(n=a.heap[b])+1]+1]+1)&&(r=w,x++),c[2*n+1]=r,d<n||(a.bl_count[r]++,
t=0,l<=n&&(t=k[n-l]),u=c[2*n],a.opt_len+=u*(r+t),h&&(a.static_len+=u*(e[2*n+1]+t)));if(0!==x){do{for(r=w-1;0===a.bl_count[r];)r--;a.bl_count[r]--;a.bl_count[r+1]+=2;a.bl_count[w]--;x-=2}while(0<x);for(r=w;0!==r;r--)for(n=a.bl_count[r];0!==n;)d<(p=a.heap[--b])||(c[2*p+1]!==r&&(a.opt_len+=(r-c[2*p+1])*c[2*p],c[2*p+1]=r),n--)}q(g,m,a.bl_count)}function x(a,b,c){var d,e=-1,g=b[1],h=0,k=7,l=4;0===g&&(k=138,l=3);b[2*(c+1)+1]=65535;for(d=0;d<=c;d++){var m=g;g=b[2*(d+1)+1];++h<k&&m===g||(h<l?a.bl_tree[2*
m]+=h:0!==m?(m!==e&&a.bl_tree[2*m]++,a.bl_tree[32]++):10>=h?a.bl_tree[34]++:a.bl_tree[36]++,e=m,(h=0)===g?(k=138,l=3):m===g?(k=6,l=3):(k=7,l=4))}}function y(a,b,c){var d,e,h=-1,l=b[1],m=0,n=7,p=4;0===l&&(n=138,p=3);for(d=0;d<=c;d++)if(e=l,l=b[2*(d+1)+1],!(++m<n&&e===l)){if(m<p)for(;k(a,e,a.bl_tree),0!=--m;);else 0!==e?(e!==h&&(k(a,e,a.bl_tree),m--),k(a,16,a.bl_tree),g(a,m-3,2)):10>=m?(k(a,17,a.bl_tree),g(a,m-3,3)):(k(a,18,a.bl_tree),g(a,m-11,7));h=e;(m=0)===l?(n=138,p=3):e===l?(n=6,p=3):(n=7,p=4)}}
function u(a,b,d,e){g(a,e?1:0,3);t(a);c(a,d);c(a,~d);B.arraySet(a.pending_buf,a.window,b,d,a.pending);a.pending+=d}var B=n("../utils/common"),C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=Array(576);e(I);var F=Array(60);e(F);var G=Array(512);e(G);var J=Array(256);e(J);var N=Array(29);e(N);var K,P,L,M=Array(30);e(M);var U=
!1;h._tr_init=function(a){if(!U){var c,e,g,h=Array(16);for(g=e=0;28>g;g++)for(N[g]=e,c=0;c<1<<C[g];c++)J[e++]=g;J[e-1]=g;for(g=e=0;16>g;g++)for(M[g]=e,c=0;c<1<<z[g];c++)G[e++]=g;for(e>>=7;30>g;g++)for(M[g]=e<<7,c=0;c<1<<z[g]-7;c++)G[256+e++]=g;for(c=0;15>=c;c++)h[c]=0;for(c=0;143>=c;)I[2*c+1]=8,c++,h[8]++;for(;255>=c;)I[2*c+1]=9,c++,h[9]++;for(;279>=c;)I[2*c+1]=7,c++,h[7]++;for(;287>=c;)I[2*c+1]=8,c++,h[8]++;q(I,287,h);for(c=0;30>c;c++)F[2*c+1]=5,F[2*c]=l(c,5);K=new d(I,C,257,286,15);P=new d(F,z,
0,30,15);L=new d([],A,0,19,7);U=!0}a.l_desc=new b(a.dyn_ltree,K);a.d_desc=new b(a.dyn_dtree,P);a.bl_desc=new b(a.bl_tree,L);a.bi_buf=0;a.bi_valid=0;r(a)};h._tr_stored_block=u;h._tr_flush_block=function(a,b,c,d){var e,h,k=0;0<a.level?(2===a.strm.data_type&&(a.strm.data_type=function(a){var b,c=4093624447;for(b=0;31>=b;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;for(b=32;256>b;b++)if(0!==a.dyn_ltree[2*b])return 1;return 0}(a)),
E(a,a.l_desc),E(a,a.d_desc),k=function(a){var b;x(a,a.dyn_ltree,a.l_desc.max_code);x(a,a.dyn_dtree,a.d_desc.max_code);E(a,a.bl_desc);for(b=18;3<=b&&0===a.bl_tree[2*D[b]+1];b--);return a.opt_len+=3*(b+1)+14,b}(a),e=a.opt_len+3+7>>>3,(h=a.static_len+3+7>>>3)<=e&&(e=h)):e=h=c+5;c+4<=e&&-1!==b?u(a,b,c,d):4===a.strategy||h===e?(g(a,2+(d?1:0),3),w(a,I,F)):(g(a,4+(d?1:0),3),function(a,b,c,d){var e;g(a,b-257,5);g(a,c-1,5);g(a,d-4,4);for(e=0;e<d;e++)g(a,a.bl_tree[2*D[e]+1],3);y(a,a.dyn_ltree,b-1);y(a,a.dyn_dtree,
c-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,k+1),w(a,a.dyn_ltree,a.dyn_dtree));r(a);d&&t(a)};h._tr_tally=function(b,c,d){return b.pending_buf[b.d_buf+2*b.last_lit]=c>>>8&255,b.pending_buf[b.d_buf+2*b.last_lit+1]=255&c,b.pending_buf[b.l_buf+b.last_lit]=255&d,b.last_lit++,0===c?b.dyn_ltree[2*d]++:(b.matches++,c--,b.dyn_ltree[2*(J[d]+256+1)]++,b.dyn_dtree[2*a(c)]++),b.last_lit===b.lit_bufsize-1};h._tr_align=function(a){g(a,2,3);k(a,256,I);16===a.bi_valid?(c(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):8<=
a.bi_valid&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)}},{"../utils/common":3}],15:[function(n,m,h){m.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],"/":[function(n,m,h){h={};(0,n("./lib/utils/common").assign)(h,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants"));m.exports=h},{"./lib/deflate":1,"./lib/inflate":2,
"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});!function(f){function n(h){if(m[h])return m[h].exports;var e=m[h]={exports:{},id:h,loaded:!1};return f[h].call(e.exports,e,e.exports,n),e.loaded=!0,e.exports}var m={};return n.m=f,n.c=m,n.p="https://midas.gtimg.cn/midas/minipay_v2/",n(0)}([function(f,n,m){!function(){function f(a,b,c){b=b||2;var d=[];return d[b]=a,d.join(c||"0").slice(-b)}function e(a){var b=Object.prototype.toString.call(a);if(null===a||a instanceof String||a instanceof Number||a instanceof Boolean||a instanceof Date||{"[object String]":1,
"[object Number]":1,"[object Boolean]":1,"[object Date]":1}[b])return a;if(void 0!==a){if(a===window)return"[object DOMWindow]";if(a===document)return"[object HTMLDocument]";if("function"!=typeof a.constructor)return a&&"string"==typeof a.tagName?(b=a.tagName,a="[object HTML"+(b+="",b.substr(0,1).toUpperCase()+b.substr(1).toLowerCase())+"Element]"):a=void 0,a;if(!{"[object Object]":1,"[object Array]":1}[b])return b;if(t[a.__CASHIER_JSON_HASH]!==a){for(b=l.getIntRandom();t[b];)b=l.getIntRandom();return t[a.__CASHIER_JSON_HASH=
b]=a,a}}}function d(a){return p.lastIndex=0,'"'+(p.test(a)?a.replace(p,function(a){var b=v[a];return"string"==typeof b?b:"\\u"+f(a.charCodeAt(0).toString(16),4)}):a)+'"'}function b(a){a=e(a);var c=Object.prototype.toString.call(a);if(void 0!==a){if(null===a||a instanceof Boolean||"[object Boolean]"===c)return String(a);if(a instanceof String||"[object String]"===c)return d(a);if(a instanceof Number||"[object Number]"===c)return isFinite(a)?String(a):"null";if(a instanceof Date||"[object Date]"===
c)return isFinite(a.valueOf())?d(a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"."+f(a.getUTCMilliseconds(),3)+"Z"):"null";if(a instanceof Array||"[object Array]"===c){c=[];var g=0;for(var h=a.length;g<h;g++)c[g]=b(a[g])||"null";return delete t[a.__CASHIER_JSON_HASH],delete a.__CASHIER_JSON_HASH,"["+c.join(",")+"]"}if(a){c=[];var k=Object.hasOwnProperty;for(h in a)"__CASHIER_JSON_HASH"!=h&&k.call(a,h)&&(g=
b(a[h]))&&c.push(d(h)+":"+g);return delete t[a.__CASHIER_JSON_HASH],delete a.__CASHIER_JSON_HASH,"{"+c.join(",")+"}"}return"null"}}function a(){console.warn("trigger unload event: _fireUnloadEvent !!!!!!!!!!!!!!")}function c(a,b){if("string"==typeof a&&0==a.indexOf(J)){a=a.substring(J.length);var c,d=n.parse(a);(c=G[d.port])&&c._handle(d,b,a)}}function g(a,b){(b=Z[b])&&M._handle(b._stream,a)&&b._handleRemote(a.key,a.args)}window.midas||(window.midas={});var k=window.midas.minipay={},l=k.LIB={},m=
k.VER={dialog:1,api:1};l.err=function(){window.debug&&(window.console&&console.error&&Function.prototype.apply.call(console.error,console,Array.prototype.slice.call(arguments,0)),"string"==typeof arguments[0]&&alert(arguments[0]))};l.warn=function(){window.debug&&window.console&&console.warn&&Function.prototype.apply.call(console.warn,console,Array.prototype.slice.call(arguments,0))};l.log=function(){window.debug&&window.console&&console.log&&Function.prototype.apply.call(console.log,console,Array.prototype.slice.call(arguments,
0))};l.getIntRandom=function(){return Math.round(Math.random()*(new Date).getTime())%9E9+1E9};l.emptyFn=function(){};l.serializeParam=function(a){if(!a)return"";var b=[],c;for(c in a)"undefined"==typeof a[c]&&null==a[c]||b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")};l.serializeCgiExtend=function(a){var b=[];return l.each(a,function(a,c){c="string"==typeof c?c:l.serializeParam(c);b.push(a+":"+c)}),encodeURIComponent(b.join(";"))};var n=k.JSON={},t={},p=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
v={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},w=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;n.stringify=function(a){return b(a)};n.parse=function(a){if(a=String(a),a&&(w.lastIndex=0,w.test(a)&&(a=a.replace(w,function(a){return"\\u"+f(a.charCodeAt(0).toString(16),4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))))try{return(new Function("return "+a))()}catch(da){return eval("("+a+")")}throw new SyntaxError("JSON.parse");};l.setTimeout=function(a,b,c,d){return setTimeout(function(){a.apply(c,d||[])},b)};l.ua=function(){var a,b={},c=navigator.userAgent;return window.ActiveXObject?(b.ie=6,(window.XMLHttpRequest||0<=c.indexOf("MSIE 7.0"))&&(b.ie=7),(window.XDomainRequest||0<=c.indexOf("Trident/4.0"))&&(b.ie=8),0<=c.indexOf("Trident/5.0")&&(b.ie=9),0<=c.indexOf("Trident/6.0")&&
(b.ie=10)):document.getBoxObjectFor||"undefined"!=typeof window.mozInnerScreenX?(a=/(?:Firefox|GranParadiso|Iceweasel|Minefield).(\d+\.\d+)/i.exec(c),b.firefox=a?parseFloat(a[1],10):3.3):navigator.taintEnabled?window.opera&&(b.opera=parseFloat(window.opera.version(),10)):(a=/AppleWebKit.(\d+\.\d+)/i.exec(c),b.webkit=a?parseFloat(a[1],10):document.evaluate?document.querySelector?525:420:419,(a=/Chrome.(\d+\.\d+)/i.exec(c))||window.chrome?b.chrome=a?parseFloat(a[1],10):2:((a=/Version.(\d+\.\d+)/i.exec(c))||
window.safariHandler)&&(b.safari=a?parseFloat(a[1],10):3.3)),a=/CPU.+?OS (\d+(?:_\d+)?).+?like Mac OS X/i.exec(c),0<=c.indexOf("iPod")?b.iPod=a?parseFloat(a[1].replace(/_/g,"."),10):1:0<=c.indexOf("iPhone")?b.iPhone=a?parseFloat(a[1].replace(/_/g,"."),10):1:0<=c.indexOf("iPad")?b.iPad=a?parseFloat(a[1].replace(/_/g,"."),10):1:0<=c.indexOf("Macintosh")||0<=c.indexOf("OS X")?(a=/(?:Mac )?OS X (\d+(?:_\d+)?)/i.exec(c),b.mac=a?parseFloat(a[1].replace(/_/g,"."),10):1):0<=c.indexOf("Window")?(a=/Windows NT (\d+(?:\.\d+)?)/i.exec(c),
b.windows=a?parseFloat(a[1],10):1):0<=c.indexOf("Android")?(a=/Android (\d+(?:\.\d+)?)/i.exec(c),b.android=a?parseFloat(a[1],10):1):0<=c.indexOf("Linux")&&(b.linux=1),b}();var E=l.Observer=function(a,b){this._sender=a;this._timeout=+b||0;this._subscriber=[];this._timer=0};E.prototype.subscribe=function(a,b,c){return"function"==typeof a&&(this._subscriber.push({fn:a,self:b,context:c}),!0)};E.prototype.unsubscribe=function(a){if("function"!=typeof a)return!1;for(var b,c=this._subscriber,d=!1,e=0;b=
c[e];e++)if(b.fn==a){d=!0;c=c.slice(0,e).concat(c.slice(e+1));break}return!!d&&(this._subscriber=c,!0)};E.prototype.notify=function(a){var b=function(){this._timer=0;for(var b,c=this._subscriber,d=0;b=c[d];d++)b.fn.call(b.self,a,this._sender,b.context)};this._timeout?(this._timer&&clearTimeout(this._timer),this._timer=l.setTimeout(b,this._timeout,this)):b.call(this)};var x=l.ReadyCall=function(){this.isReady=!1;this._onReady=new E(this);this._first=!0;this._onFirst=new E(this)};x.prototype.onReady=
function(a){this.isReady?a():this._onReady.subscribe(a);this._first&&(this._onFirst.notify(),this._first=!1)};x.prototype.ready=function(){this.isReady||(this.isReady=!0,this._onReady.notify())};x.prototype.onFirst=function(a){this._onFirst.subscribe(a)};var y=[];l.attachEvent=function(a,b,c,d){if(a&&b&&"function"==typeof c){d=d||{};d.win=d.win||window;var e=function(a){c.apply(d.self,[a||d.win.event].concat(d.args||[]))};y.push({el:a,type:b,cfn:e,fn:c});a.attachEvent?a.attachEvent("on"+b,e):a.addEventListener&&
a.addEventListener(b,e,!1)}};var u={};l.fireCrossEvent=function(a,b){var c;return!!u[b]&&((c=u[b]).fn.apply(c.opt.self,[a].concat(c.opt.args||[])),!0)};l.attachCrossEvent=function(a,b,c,d,e){if(a&&b&&"function"==typeof c&&d){if(d==window)return l.attachEvent(a,b,c,e);e=e||{};for(var f=l.getIntRandom();u[f];)f=l.getIntRandom();u[f]={fn:c,opt:e};d["_CASHIER_CROSS_EVENT_HANDLER_"+f]=window;d["_CASHIER_CROSS_EVENT_TARGET_"+f]=a;e=new d.Function("evt","var win=window._CASHIER_CROSS_EVENT_HANDLER_"+f+",ret=false,el=window._CASHIER_CROSS_EVENT_TARGET_"+
f+";if(win&&win.parent&&win.parent!=win&&win.cashier){try{ret=win.cashier.LIB.fireCrossEvent(evt||window.event,"+f+");}catch(_){}}if(!ret){el&&(el.removeEventListener?el.removeEventListener('"+b+"',arguments.callee,false):el.detachEvent&&el.detachEvent('on"+b+"',arguments.callee));try{delete window._CASHIER_CROSS_EVENT_HANDLER_"+f+";delete window._CASHIER_CROSS_EVENT_TARGET_"+f+";}catch(_){window._CASHIER_CROSS_EVENT_HANDLER_"+f+"=void 0;window._CASHIER_CROSS_EVENT_TARGET_"+f+"=void 0;}}");y.push({el:a,
type:b,cfn:e,fn:c,win:d,id:f});a.attachEvent?a.attachEvent("on"+b,e):a.addEventListener&&a.addEventListener(b,e,!1)}};l.detachEvent=function(a,b,c){for(var d,e=[],f=0;d=y[f];f++)if(a&&d.el!=a||b&&d.type!=b||"function"==typeof c&&d.fn!=c)e.push(d);else if(d.el.detachEvent?d.el.detachEvent("on"+d.type,d.cfn):d.el.removeEventListener&&d.el.removeEventListener(d.type,d.cfn,!1),d.win&&d.id)try{delete d.win["_CASHIER_CROSS_EVENT_HANDLER_"+d.id],delete d.win["_CASHIER_CROSS_EVENT_TARGET_"+d.id]}catch(ya){d.win["_CASHIER_CROSS_EVENT_HANDLER_"+
d.id]=void 0,d.win["_CASHIER_CROSS_EVENT_TARGET_"+d.id]=void 0}y=e};l.getEvent=function(){var a,b=window.event,c=0;if(!b)try{for(a=arguments.callee;a&&10>c&&!((b=a.arguments)&&(b=b[0])&&"object"==typeof b&&"type"in b&&"button"in b&&"ctrlKey"in b&&"altKey"in b&&"shiftKey"in b);)b=null,a=a.caller,c++}catch(va){return null}return b};l.unload=new E;l.unload.subscribe(function(){l.detachEvent()});var B=l.ua.chrome||l.ua.opera?"beforeunload":"unload";window.attachEvent?window.attachEvent("on"+B,a):window.addEventListener&&
window.addEventListener(B,a,!1);l.unload.subscribe(function(){k&&(k=window.midas.minipay=void 0);window.detachEvent?window.detachEvent("on"+B,a):window.removeEventListener&&window.removeEventListener(B,a,!1)});l.encodeURI=function(a){return a?(a+"").replace(/%/g,"%25").replace(/\+/g,"%2B").replace(/ /g,"%20").replace(/\?/g,"%3F").replace(/#/g,"%23").replace(/&/g,"%26").replace(/=/g,"%3D").replace(/"/g,"%22"):""};var C=0,z=l._psPool={};l.pingSender=function(a,b){if(a){var c="cashierPingSender_"+C++,
d=z[c]=new Image;d.id=c;d.onload=d.onerror=function(){this.onload=this.onerror=null;try{delete z[this.id]}catch(ra){}};b=b||500;0>b?d.src=a:l.setTimeout(function(){d.src=a},b)}};var A=function(a,b,c,d){this.key=a;this.query=b;this.merge=c;this.url=d;this.count=0;this.store={};this.timer=0;this._url=""};A.MAX_LEN=1E3;A.tmpl=function(a,b){return(a+"").replace(/\{(\w+)\}/g,function(a,c){return b[c]})};A.prototype.add=function(a){var b,c;if(this.key?(c=A.tmpl(this.key,a),(b=this.store[c])&&(b.rate++,
b=this.merge(b,a))):c=this.count,!b){this.count++;b=this.store[c]={};b.rate=1;for(var d in a)b[d]=a[d]}this.report()};A.prototype.report=function(a){var b=[],c=1;if("function"==typeof this.query)for(var d in this.store){var e=this.store[d];b.push(this.query(c++,e))}else{for(var f=0,g=this.query.length;f<g;f++)b.push([]);for(d in this.store){e=this.store[d];f=0;for(g=this.query.length;f<g;f++)b[f].push(this.query[f](c,e));c++}f=0;for(g=b.length;f<g;f++)b[f]=b[f].join("")}this._url=A.tmpl(this.url,
{random:l.getIntRandom(),count:this.count,query:b.join("")});this._url.length>=A.MAX_LEN||a?this._doReport():!this.timer&&(this.timer=l.setTimeout(this._doReport,3E5,this))};A.prototype.reportImmediate=function(){0<this.count&&(this.report(!0),setTimeout(l.emptyFn,1E3))};A.prototype._doReport=function(){clearTimeout(this.timer);this.timer=0;0!=this.count&&(this.count=0,this.store={},l.pingSender(this._url,-1))};l.timeStat=function(a,b,c,d){if((c=Math.max(+c,1)||1,!(1<c&&1<=Math.random()*c))&&"[object Array]"==
Object.prototype.toString.call(b))for(a=1,b=b.length;a<b;a++);};l.valueStat=function(a,b,c,d,e){e=Math.max(+e,1)||1;1<e&&1<=Math.random()*e};var D=0,I=new A("{statId},{type},{ret}",function(a,b){return["&",a,"_1=",b.id,"&",a,"_2=",b.type,"&",a,"_3=",b.code,"&",a,"_4=",+b.duration||1,"&",a,"_5=",b.rate].join("")},function(a,b){return a._total=a._total||a.duration*(a.rate-1)||0,a._total+=b.duration||0,a.duration=Math.max(Math.round(a._total/a.rate),1),a});l.unload.subscribe(I.reportImmediate,I);l.valueStat2=
function(a,b,c,d,e){if(!D){if(!(D=cashier.INFO?cashier.INFO.appid:cashier.appid))return void(l.valueStat2=l.emptyFn);I.url="https://cloudspeed.qq.com/speedcode.cgi?appid="+D+"&key=id,type,code,time,rate&fysn={random}{query}"}e=Math.max(+e,1)||1;1<e&&1<=Math.random()*e||I.add({id:a,type:b,code:c,duration:d,rate:e})};l.performanceTimeStat=function(a,b){l.setTimeout(function(){var c=window.performance||window.webkitPerformance||window.msPerformance;if(c){if(0==c.timing.loadEventEnd)return void l.setTimeout(arguments.callee,
5E3);l.timeStat(a,[c.timing.navigationStart,c.timing.unloadEventStart,c.timing.unloadEventEnd,c.timing.redirectStart,c.timing.redirectEnd,c.timing.fetchStart,c.timing.domainLookupStart,c.timing.domainLookupEnd,c.timing.connectStart,c.timing.connectEnd,c.timing.requestStart,c.timing.responseStart,c.timing.responseEnd,c.timing.domLoading,c.timing.domInteractive,c.timing.domContentLoadedEventStart,c.timing.domContentLoadedEventEnd,c.timing.domComplete,c.timing.loadEventStart,c.timing.loadEventEnd],b,
!0)}},5E3)};l.resourceTimeStat=function(a,b,c,d){l.setTimeout(function(){var e=window.performance||window.webkitPerformance||window.msPerformance;if(e&&(e.getEntriesByName||e.webkitGetEntriesByName)){if(0==e.timing.loadEventEnd)return void l.setTimeout(arguments.callee,5E3);try{var f=(e.getEntriesByName||e.webkitGetEntriesByName).call(e,b)[0]}catch(ya){return}if(!f)return void l.valueStat(d,1,11);if(0==f.responseEnd)return void l.setTimeout(arguments.callee,5E3);l.timeStat(a,[f.startTime,0,f.startTime+
f.startTime,f.redirectStart,f.redirectEnd,f.fetchStart,f.domainLookupStart,f.domainLookupEnd,f.connectStart,f.connectEnd,f.requestStart,f.responseStart,f.responseEnd,0,0,0,0,f.startTime+f.duration],c,!0);l.valueStat(d,1,12)}},5E3)};l.report=function(){return function(a,b,c,d){if(c||b){var e={},f=[],g=~~d.sandbox;d&&delete d.sandbox;l.extend(e,d||{},{3:a||"default",21:"client."+b+"."+c,24:d.appid||"",31:"minipayv2",22:navigator.userAgent,36:encodeURIComponent(location.href)});l.each(e,function(a,b){f.push(a+
"="+encodeURIComponent(b))});(new Image).src="https://"+(g?"sandbox.":"")+"api.unipay.qq.com/v1/900/15499/log_data?num=1&record0="+f.join("|")+"&rr="+Math.random()}}}();var F=function(){if(window.postMessage)try{if(0<=window.postMessage.toString().indexOf("[native code]"))return!0}catch(oa){return!0}return!1}(),G={},J="__CashXStream_";F&&l.attachEvent(window,"message",function(a){c(a.data,a.source)});var N=l.XStream=function(a,b,d){var e;return(e=G[b])?e:(G[b]=this,this.handler=a,this.targetPort=
b,this.target=d,this.closed=!1,this.onInit=new E(this),this._pool=[],void(!F&&!navigator[J+N.channel+N.localPort]&&(navigator[J+N.channel+N.localPort]=c)))};N.channel=0;N.localPort="";N.prototype._sendRaw=function(a){var b;try{F?this.target.postMessage(a,"*"):"function"==typeof(b=navigator[J+N.channel+this.targetPort])&&b(a,window)}catch(ua){}};N.prototype._handle=function(a,b,c){if(a.init)for(this.target=b,this.closed=!1,this.onInit.notify();this._pool.length;)this._sendRaw(this._pool.shift());else!this.closed&&
"function"==typeof this.handler&&this.handler.call(this,a.data,this.targetPort)};N.prototype.init=function(){if(this.target){var a=n.stringify({port:N.localPort,init:1});a=J+a;this._sendRaw(a);this.onInit.notify()}};N.prototype.send=function(a){!this.closed&&a&&(a=n.stringify({port:N.localPort,data:a}),a=J+a,this.target?this._sendRaw(a):this._pool.push(a))};N.prototype.close=function(){this.closed=!0;delete G[this.targetPort]};var K=l.OnceCall=function(a,b,c){this._timeout=a;this._timer=0;b=b||{};
this.onConsume=b.onConsume;this.onReject=b.onReject;this.onTimeout=b.onTimeout;this.hasCalled=!1;c&&this.start()};K.prototype._call=function(a){this.hasCalled||(this.hasCalled=!0,this._timer&&clearTimeout(this._timer),this._timer=0,"function"==typeof a&&a.call(this))};K.prototype.start=function(){0<=this._timeout&&(this._timer=l.setTimeout(this.timeout,this._timeout,this))};K.prototype.consume=function(){this._call(this.onConsume)};K.prototype.reject=function(){this._call(this.onReject)};K.prototype.timeout=
function(){this._timer=0;this._call(this.onTimeout)};l.getClientWidth=function(a){a=a||document;var b=a.documentElement,c=a.body;return"BackCompat"!=a.compatMode?b.clientWidth:l.ua.ie?Math.min(c.clientWidth,b.clientWidth)||c.clientWidth:c.clientWidth};l.getClientHeight=function(a){a=a||document;var b=a.documentElement,c=a.body;return"BackCompat"!=a.compatMode?b.clientHeight:l.ua.ie?Math.min(c.clientHeight,b.clientHeight)||c.clientHeight:c.clientHeight};l.isMinDevice=function(){return 768>=window.availHeight};
l.getScrollWidth=function(a){a=a||document;a=(l.ua.ie?a.body:a.documentElement).getBoundingClientRect();return"width"in a?a.width:a.right-a.left};l.getScrollHeight=function(a){a=a||document;a=(l.ua.ie?a.body:a.documentElement).getBoundingClientRect();return"height"in a?a.height:a.bottom-a.top};l.getScrollLeft=function(a){a=a||document;return-(l.ua.ie?a.body:a.documentElement).getBoundingClientRect().left};l.getScrollTop=function(a){a=a||document;return-(l.ua.ie?a.body:a.documentElement).getBoundingClientRect().top};
l.setScrollLeft=function(a,b){b=b||document;var c=b.documentElement,d=b.body;("CSS1Compat"!=b.compatMode||l.ua.webkit?d:c).scrollLeft=+a||0};l.setScrollTop=function(a,b){b=b||document;var c=b.documentElement,d=b.body;("CSS1Compat"!=b.compatMode||l.ua.webkit?d:c).scrollTop=+a||0};var P=l.getIntRandom(),L={};l.domReady=function(a,b){b=b||window;var c,d,e=b.document;if("complete"==e.readyState||"interactive"==e.readyState)return void(e.body?"function"==typeof a&&a():l.setTimeout(l.domReady,0,l,[a,b]));
!(c=e["_CASHIER_DOM_READY_CLIENT_"+P])&&(c=e["_CASHIER_DOM_READY_CLIENT_"+P]=l.getIntRandom());var f;if(!(d=L[c])){if(d=L[c]=new x,f=function(){("complete"==e.readyState||"interactive"==e.readyState)&&(e.body?d.ready():l.setTimeout(f,0))},e.attachEvent){e.attachEvent("onreadystatechange",f);b.attachEvent("onload",f);var g=function(){e.detachEvent("onreadystatechange",f);b.detachEvent("onload",f)};d.onReady(g);l.unload.subscribe(g);g=!1;try{g=null==b.frameElement}catch(ma){}e.documentElement.doScroll&&
g&&function(){if(!d.isReady){try{e.documentElement.doScroll("left")}catch(ma){return void l.setTimeout(arguments.callee,0)}f()}}()}else e.addEventListener&&(e.addEventListener("DOMContentLoaded",f,!1),b.addEventListener("load",f,!1),g=function(){e.removeEventListener("DOMContentLoaded",f,!1);b.removeEventListener("load",f,!1)},d.onReady(g),l.unload.subscribe(g));d.onReady(function(){delete L[c];try{delete e["_CASHIER_DOM_READY_CLIENT_"+P]}catch(ma){e["_CASHIER_DOM_READY_CLIENT_"+P]=void 0}})}d.onReady(a)};
l.xssFilter=function(a){for(;a!=unescape(a);)a=unescape(a);for(var b="< > ' \" %3c %3e %27 %22 %253c %253e %2527 %2522".split(" "),c="&#x3c; &#x3e; &#x27; &#x22; %26%23x3c%3B %26%23x3e%3B %26%23x27%3B %26%23x22%3B %2526%2523x3c%253B %2526%2523x3e%253B %2526%2523x27%253B %2526%2523x22%253B".split(" "),d=0;d<b.length;d++)a=a.replace(new RegExp(b[d],"gi"),c[d]);return a};l.fontFamily=l.ua.mac?'"Helvetica Neue",Helvetica,"Hiragino Sans GB",Arial,sans-serif':l.ua.windows&&6<=l.ua.windows?'"Microsoft Yahei",Tohama':
"Tahoma";l.cookie={get:function(a){return(a=document.cookie.match(new RegExp("(?:^|;\\s)"+a+"=(.*?)(?:;\\s|$)")))?unescape(a[1]):""},set:function(a,b,c){var d=new Date,e=c.domain||"pay.qq.com",f=c.path||"/";c=c.time||31536E7;d.setTime(d.getTime()+c);document.cookie=a+"="+escape(b)+"; path="+f+"; domain="+e+"; expires="+d.toUTCString()},del:function(a,b){b.time=-new Date;l.cookie.set(a,"",b)}};var M=l.DLG={},U={},R=1;M._handle=function(a,b){var c,d=b.idx;b.key;return!b.key&&(c=U[d])?(c.platform.consume(),
delete U[d],!1):(a.send({idx:d}),!0)};M._call=function(a,b,c){c=c||{};var d=c.timestamp=c.timestamp||(new Date).getTime(),e=R++;U[e]={timestamp:d,platform:new K(1E4,{onConsume:function(){l.valueStat(350303,1,20,(new Date).getTime()-d)},onTimeout:function(){!a.closed&&l.valueStat(350303,2,19,(new Date).getTime()-d)}},!0)};a.send({key:b,args:c,idx:e})};l.insertStyle=function(a,b){b=b||document;var c=b.createElement("style");c.type="text/css";b.getElementsByTagName("head")[0].appendChild(c);c.styleSheet?
c.styleSheet.cssText=a:c.appendChild(b.createTextNode(a))};var O={},H=l.ua.ie&&"BackCompat"==document.compatMode,S=["body{margin:0;_height:100%;}"];S.push(".midas_minipay_dialog_mask{position:fixed;_position:absolute;top:0;left:0;width:100%;height:100%;z-index:4000;background-color:#000;-moz-opacity:0.3;opacity:0.3;filter:alpha(opacity=30);}");S.push(".midas_minipay_dialog_wrap{position:absolute;-moz-border-radius:5px;border-radius:5px;font-size:12px;color:#313131;font-family:",l.fontFamily,";-o-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-ms-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-moz-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-webkit-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;}");
S.push(".midas_minipay_dialog_border{position:absolute;z-index:1;top:0;left:0;-moz-border-radius:5px;border-radius:5px;background:rgba(187,187,187,0.9);filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0 startColorstr=#5abbbbbb,endColorstr=#5abbbbbb);-o-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-ms-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-moz-transition:left .6s ease-out,top .6s ease-out,width .6s midas_minipay_dialog_backframeease-out;-webkit-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;}");
S.push(".midas_minipay_dialog_wrap_no_border .midas_minipay_dialog_border{display:none}");S.push(".midas_minipay_dialog_wrap_no_border_no_position .midas_minipay_dialog_border{display:none}");S.push(".midas_minipay_dialog_wrap_no_border_noani .midas_minipay_dialog_border{display:none}");S.push(".midas_minipay_dialog_wrap_no_border{position:absolute;color:#313131;background-color:#fff;font-size:12px;font-family:",l.fontFamily,";-o-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-ms-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-moz-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-webkit-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;}");
S.push(".midas_minipay_dialog_wrap_no_border_no_position{position:relative;color:#313131;background-color:#fff;font-size:12px;font-family:",l.fontFamily,";-o-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-ms-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-moz-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;-webkit-transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;transition:left .6s ease-out,top .6s ease-out,width .6s ease-out;}");
S.push(".midas_minipay_dialog_mask_noani{position:absolute;z-index:4000;-moz-opacity:1;opacity:1;filter:alpha(opacity=1);-o-transition:width .6s ease-out,height .6s ease-out;-ms-transition:width .6s ease-out,height .6s ease-out;-moz-transition:width .6s ease-out,height .6s ease-out;-webkit-transition:width .6s ease-out,height .6s ease-out;transition:width .6s ease-out,height .6s ease-out;}");S.push(".midas_minipay_dialog_wrap_noani{position:absolute;-moz-border-radius:5px;border-radius:5px;font-size:12px;color:#313131;font-family:",
l.fontFamily,";-o-transition:width .6s ease-out;-ms-transition:width .6s ease-out;-moz-transition:width .6s ease-out;-webkit-transition:width .6s ease-out;transition:width .6s ease-out;}");S.push(".midas_minipay_dialog_wrap_no_border_noani{position:absolute;color:#313131;background-color:#fff;font-size:12px;font-family:",l.fontFamily,";-o-transition:width .6s ease-out;-ms-transition:width .6s ease-out;-moz-transition:width .6s ease-out;-webkit-transition:width .6s ease-out;transition:width .6s ease-out;}");
var W=l.isMinDevice()?31:39;S.push(".midas_minipay_dialog_header{margin-left:10px;margin-right:10px;height:"+W+"px;position:relative;z-index:2;border-bottom:1px solid #d8d8d8;background:#fafafa;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#fafafa',endColorstr='#ededed',GradientType=0);background:-o-linear-gradient(top,#fafafa 0%,#ededed 100%);background:-moz-linear-gradient(top,#fafafa 0%,#ededed 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#fafafa),color-stop(100%,#ededed));background:-webkit-linear-gradient(top,#fafafa 0%,#ededed 100%);background:linear-gradient(top,#fafafa 0%,#ededed 100%);}");
S.push(".midas_minipay_dialog_header .cp-header-title{line-height:"+W+"px;font-size:16px;overflow:hidden; text-align:center; margin:0;padding-left:10px;font-weight:normal;}");S.push(".midas_minipay_dialog_header [class^='icon-']{display: inline-block;*display: inline;*zoom: 1;font-size: 0;background-repeat: no-repeat;}");S.push(".midas_minipay_dialog_header .checkbox-box{font-size: 12px;cursor: pointer;margin-right: 10px;}");S.push(".midas_minipay_dialog_header .checkbox-box input{display: none;}");
S.push(".midas_minipay_dialog_header .service a{color: #969696;text-decoration: underline;font-size: 12px;}");S.push(".midas_minipay_dialog_header .icon-checkbox{background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites.02b55a0447b7b1dad0c4877f628d09b2.png);background-position: 0px -45px;width: 12px;height: 12px;cursor: pointer;}");S.push("@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { .midas_minipay_dialog_header .icon-checkbox{background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites@2x.96d3e4193f4542347e1df88b5a79a952.png);background-size: 12px 57px;}}");
S.push(".midas_minipay_dialog_header .prop-custom-title span{margin: 0 5px;font-size: 16px;}");S.push(".midas_minipay_dialog_header .prop-custom-title .service{display: inline;} .midas_minipay_dialog_header .form-group label{width:auto;}");S.push(".midas_minipay_dialog_header .prop-custom-title img{width: 27px;height: 27px;margin-top: -3px;vertical-align: middle;display: inline;*display: inline;*zoom: 1}");S.push(".midas_minipay_dialog_header .checkbox-box .icon-checkbox{vertical-align: -2px;*position: relative; *left: -3px;top: -2px;}");
S.push(".midas_minipay_dialog_header .checkbox-box.checked .icon-checkbox{background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites.02b55a0447b7b1dad0c4877f628d09b2.png);background-position: 0px -29px;;width: 12px;height: 12px;}");S.push("@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { .midas_minipay_dialog_header .checkbox-box.checked .icon-checkbox{background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites@2x.96d3e4193f4542347e1df88b5a79a952.png);background-size: 12px 57px;}}");
S.push(".midas_minipay_dialog_header .checkbox-box input[type=checkbox]{display: none;outline: 0;}");S.push(".midas_minipay_dialog_header .header-icon-first, .midas_minipay_dialog_header .header-icon-last {  position: absolute;  width: 20px;  height: 20px;  top: 50%;  margin-top: -10px;  text-align: center;  line-height: 20px;  cursor: pointer;}");S.push(".midas_minipay_dialog_header .header-icon-first i,.midas_minipay_dialog_header .header-icon-last i {  *position: relative;  *top: 5px; }");S.push(".midas_minipay_dialog_header .header-icon-first {  left: 20px; } .midas_minipay_dialog_header .header-icon-last {  right: 11px;}");
S.push(".midas_minipay_dialog_icon{display: inline-block;*display: inline;*zoom: 1;font-size: 0;background-repeat: no-repeat;}");S.push(".midas_minipay_dialog_icon_i { _display: inline; _zoom: 1; _font-size: 0; _background-repeat: no-repeat; }");S.push(".midas_minipay_dialog_icon_back {  background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites.02b55a0447b7b1dad0c4877f628d09b2.png); background-position: 0px -14px; width: 7px; height: 11px;}");S.push("@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { .midas_minipay_dialog_icon_back {  background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites@2x.96d3e4193f4542347e1df88b5a79a952.png); background-size: 12px 57px;}}");
S.push(".midas_minipay_dialog_icon_clear {background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites.02b55a0447b7b1dad0c4877f628d09b2.png); background-position: 0px 1px; width: 10px; height: 10px; }");S.push("@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { .midas_minipay_dialog_icon_clear {background-image: url(https://midas.gtimg.cn/midas/minipay_v2/images/headerSprites@2x.96d3e4193f4542347e1df88b5a79a952.png); background-size: 12px 57px; }}");S.push(".midas_minipay_dialog_content{margin-bottom:10px;margin-left:10px;margin-right:10px;color:#5f5f5f;background-color:#fff;overflow:hidden;position:relative;z-index:2;}");
S.push(".midas_minipay_dialog_wrap_no_border .midas_minipay_dialog_content{margin:0;}");S.push(".midas_minipay_dialog_wrap_no_border_no_position .midas_minipay_dialog_content{margin:0;}");S.push(".midas_minipay_dialog_wrap_no_border .midas_minipay_dialog_header{margin:0;}");S.push(".midas_minipay_dialog_wrap_no_border_no_position .midas_minipay_dialog_header{margin:0;}");S.push(".midas_minipay_dialog_wrap_no_border_noani .midas_minipay_dialog_content{margin:0;}");S.push(".midas_minipay_dialog_wrap_no_border_noani .midas_minipay_dialog_header{margin:0;}");
S.push(".midas_minipay_dialog_content_mask{position:absolute;width:100%;height:100%;left:0;top:0;background:#fff;filter:alpha(opacity=0);opacity:0;}");S.push(".midas_minipay_dialog_content a:link,.midas_minipay_dialog_content a:visited{color:#5181b4;text-decoration:none;}");S.push(".midas_minipay_dialog_content a:hover{text-decoration:underline;}");S.push(".midas_minipay_dialog_footer{background-color:#f3f3f3;text-align:right;clear:both;padding:6px 6px 0 0;height:",H?35:29,"px;}");S.push(".midas_minipay_dialog_btn_n:link,.midas_minipay_dialog_btn_sb:link,.midas_minipay_dialog_btn_sb_disabled:link,.cash_dialog_button_disabled:link,.midas_minipay_dialog_btn_n:visited,.midas_minipay_dialog_btn_sb:visited,.midas_minipay_dialog_btn_sb_disabled:visited,.cash_dialog_button_disabled:visited,.midas_minipay_dialog_btn_n:hover,.midas_minipay_dialog_btn_sb:hover,.midas_minipay_dialog_btn_sb_disabled:hover,.cash_dialog_button_disabled:hover,.midas_minipay_dialog_btn_n:active,.midas_minipay_dialog_btn_sb:active,.midas_minipay_dialog_btn_sb_disabled:active,.cash_dialog_button_disabled:active{border-radius:3px;color:#333;line-height:22px;height:22px;display:inline-block;margin-left:4px;padding:0 10px;text-decoration:none;font-size:12px;}");
S.push(".midas_minipay_dialog_btn_n:link,.midas_minipay_dialog_btn_n:visited,.midas_minipay_dialog_btn_n:hover,.midas_minipay_dialog_btn_n:active{border:1px solid #b4b4b4;background:#f4f3f4;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f4f3f4',endColorstr='#dfdede',GradientType=0);background:-o-linear-gradient(top,#f4f3f4 0%,#dfdede 100%);background:-moz-linear-gradient(top,#f4f3f4 0%,#dfdede 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#f4f3f4),color-stop(100%,#dfdede));background:-webkit-linear-gradient(top,#f4f3f4 0%,#dfdede 100%);background:linear-gradient(top,#f4f3f4 0%,#dfdede 100%);}");
S.push(".midas_minipay_dialog_btn_n:hover,.midas_minipay_dialog_btn_n:active{background:#fafafa;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#fafafa',endColorstr='#dfdede',GradientType=0);background:-o-linear-gradient(top,#fafafa 0%,#dfdede 100%);background:-moz-linear-gradient(top,#fafafa 0%,#dfdede 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#fafafa),color-stop(100%,#dfdede));background:-webkit-linear-gradient(top,#fafafa 0%,#dfdede 100%);background:linear-gradient(top,#fafafa 0%,#dfdede 100%);}");
S.push(".midas_minipay_dialog_btn_sb:link,.midas_minipay_dialog_btn_sb:visited,.midas_minipay_dialog_btn_sb:hover,.midas_minipay_dialog_btn_sb:active{color:#fff;border:1px solid #4c92c8;background:#56bdf4;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#56bdf4',endColorstr='#46a3d7',GradientType=0);background:-o-linear-gradient(top,#56bdf4 0%,#46a3d7 100%);background:-moz-linear-gradient(top,#56bdf4 0%,#46a3d7 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#56bdf4),color-stop(100%,#46a3d7));background:-webkit-linear-gradient(top,#56bdf4 0%,#46a3d7 100%);background:linear-gradient(top,#56bdf4 0%,#46a3d7 100%);}");
S.push(".midas_minipay_dialog_btn_sb:hover,.midas_minipay_dialog_btn_sb:active{background:#56bdf4;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#56bdf4',endColorstr='#57addd',GradientType=0);background:-o-linear-gradient(top,#56bdf4 0%,#57addd 100%);background:-moz-linear-gradient(top,#56bdf4 0%,#57addd 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#56bdf4),color-stop(100%,#57addd));background:-webkit-linear-gradient(top,#56bdf4 0%,#57addd 100%);background:linear-gradient(top,#56bdf4 0%,#57addd 100%);}");
S.push(".cash_dialog_button_disabled:link,.cash_dialog_button_disabled:visited,.cash_dialog_button_disabled:hover,.cash_dialog_button_disabled:active{color:#bbb;background-color:#f9f9f9;border:1px solid #dcdcdc;cursor:no-drop;}");S.push(".midas_minipay_dialog_btn_sb_disabled:link,.midas_minipay_dialog_btn_sb_disabled:visited,.midas_minipay_dialog_btn_sb_disabled:hover,.midas_minipay_dialog_btn_sb_disabled:active{color:#fff;border:1px solid #60a7dd;background:#9cd7f7;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#9cd7f7',endColorstr='#83bede',GradientType=0);background:-o-linear-gradient(top,#9cd7f7 0%,#83bede 100%);background:-moz-linear-gradient(top,#9cd7f7 0%,#83bede 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#9cd7f7),color-stop(100%,#83bede));background:-webkit-linear-gradient(top,#9cd7f7 0%,#83bede 100%);background:linear-gradient(top,#9cd7f7 0%,#83bede 100%);cursor:no-drop;}");
S.push(".midas_minipay_dialog_c_c{margin:40px auto;position:relative;width:260px;}");S.push(".midas_minipay_dialog_c_c h3{padding-left:35px;font-size:14px;margin:0 0 10px 0;line-height:130%;font-weight:bold;}");S.push(".midas_minipay_dialog_c_c_p{padding-left:35px;margin-bottom:6px;line-height:130%;font-size:12px;}");S.push(".midas_minipay_dialog_confirm_icon{background-image:url('https://qzonestyle.gtimg.cn/open/fusion/img/sprite.png?max_age=31104000&v=3');background-repeat:no-repeat;width:25px;height:24px;font-size:0;line-height:100px;overflow:hidden;left:0;top:-2px;position:absolute;}");
S.push(".midas_minipay_dialog_icon_req{background-position:left -260px;}");S.push(".midas_minipay_dialog_icon_error{background-position:left -284px;}");S.push(".midas_minipay_dialog_icon_warn{background-position:left -308px;}");S.push(".midas_minipay_dialog_icon_ok{background-position:left -332px;}");S.push(".midas_minipay_dialog_icon_alt{width:18px;height:10px;font-size:0;line-height:0;position:relative;display:inline-block;*display:inline;*zoom:1;}");S.push(".midas_minipay_dialog_icon_alt i{background-image:url('https://qzonestyle.gtimg.cn/open/fusion/img/sprite.png?max_age=31104000&v=3');background-repeat:no-repeat;width:15px;height:15px;display:block;position:absolute;}");
S.push(".midas_minipay_dialog_icon_alt_error i{background-position:left -356px;}");S.push(".midas_minipay_dialog_icon_alt_warn i{background-position:left -371px;}");S.push(".midas_minipay_dialog_icon_alt_ok i{background-position:-15px -356px;}");S.push(".midas_minipay_dialog_icon_alt_none{display:none;}");O.DIALOG=S.join("");O.insertDialog=function(){l.insertStyle(O.DIALOG);O.insertDialog=l.emptyFn};var T=l.CAV={};T._dom=[];T._pos=[];T._hasTop=!1;T._onPropertyChanged=new E(T);var Q=!1;T._handle=function(a,
b,c){var d;0==b?l.domReady(function(){!c&&T._onPropertyChanged.notify()}):T._dom[b]&&(d=T._dom[b].win,l.domReady(function(){var a,e=d.document,f,g=0;try{(f=e.getElementById("QZ_Toolbar_Container"))?g+=f.offsetHeight:(f=e.getElementById("page3rdApp"))&&(g+=f.offsetTop),(f=d.QZFL.element.get(".fixed_topbar").elements[0])&&(g+=f.offsetHeight)}catch(wa){}f=g;e=T._pos[b]="hidden"==e.documentElement.style.overflow?{sl:0,st:0,sw:l.getClientWidth(e),sh:l.getClientHeight(e)-f,cw:l.getClientWidth(e),ch:l.getClientHeight(e)-
f}:{sl:l.getScrollLeft(e),st:l.getScrollTop(e),sw:l.getScrollWidth(e),sh:l.getScrollHeight(e)-f,cw:l.getClientWidth(e),ch:l.getClientHeight(e)-f};try{T._dom[b].frame&&(a=T._dom[b].frame.getBoundingClientRect(),e.l=a.left,e.t=a.top-f,e.r=a.right,e.b=a.bottom-f)}catch(wa){}!c&&T._onPropertyChanged.notify()},d))};T._init=function(a){if(!Q){Q=!0;var b,c,d=0;a=a||window;try{for(;a;){var e=!1;try{a.document&&a.document.domain==document.domain&&(e=!0)}catch(ta){}if(T._dom[d]=b={win:a},T._pos[d]=void 0,e&&
(l.attachCrossEvent(a,"scroll",T._handle,a,{args:[d]}),l.attachCrossEvent(a,"resize",T._handle,a,{args:[d]}),a==top&&(T._hasTop=!0),0<d&&(c=T._dom[d-1]))){try{var f=Array.prototype.slice.call(a.document.getElementsByTagName("iframe"),0).concat(Array.prototype.slice.call(a.document.getElementsByTagName("frame"),0))}catch(ta){f=[];var g=a.document.getElementsByTagName("iframe");for(var h,k=0;h=g[k];k++)f.push(h);g=a.document.getElementsByTagName("frame");for(k=0;h=g[k];k++)f.push(h)}var m=f.length;
for(k=0;k<m;k++)if(f[k].contentWindow==c.win){b.frame=f[k];break}T._handle(null,d,!0)}if(a==top)break;d++;a=a.parent}}catch(ta){}T._onPropertyChanged.notify()}};T._ready=new x;T._xReady=!1;T._onClientRectChanged=new E;var Y=null;T._getClientRect=function(){var a,b,c,d;return Y?Y:(a=l.getScrollLeft(),b=l.getScrollTop(),c=Math.max(l.getScrollWidth(),l.getClientWidth()),d=Math.max(l.getScrollHeight(),l.getClientHeight()),{left:a,top:b,right:c+a,bottom:d+b,clientLeft:0,clientTop:0,clientRight:c,clientBottom:d})};
l.domReady(function(){var a,b,c,d,e,f,g;Y||(a=window==top,b=l.getScrollLeft(),c=l.getScrollTop(),d=l.getClientWidth(),e=l.getClientHeight(),f=Math.min(d,a?1/0:screen.availWidth-30),g=Math.min(e,a?1/0:screen.availHeight-100),Y={left:b,top:c,right:f+b,bottom:g+c,clientLeft:0,clientTop:0,clientRight:f,clientBottom:g})});T._updatePos=function(a,b){b=a.pos;for(var c=1,d=b.length;c<d;c++)b[c]&&((T._pos[c]=b[c]).x=!0);T._hasTop=T._hasTop||a.hasTop;T._xReady=!0;T._onPropertyChanged.notify()};T._onPropertyChanged.subscribe(function(){T._xReady&&
l.domReady(function(){var a,b=l.getScrollLeft(),c=l.getScrollTop(),d=l.getClientWidth(),e=l.getClientHeight();var f=T._hasTop;var g=T._pos.length;f=T._pos[g-1]||{cw:Math.min(d,f?1/0:screen.availWidth-30),ch:Math.min(e,f?1/0:screen.availHeight-100)};if(a={left:0,top:0,right:f.cw,bottom:f.ch},0<g){f=a.left;var h=a.top;var k=a.right;var m=a.bottom;for(var n=g-1;0<n;n--)g=T._pos[n]||{},"l"in g||(g.l=0),"t"in g||(g.t=20),"r"in g||(g.r=k),"b"in g||(g.b=m-20),a.left-=g.l,a.top-=g.t,a.right-=g.l,a.bottom-=
g.t,f=Math.max(f,g.l)-g.l,h=Math.max(h,g.t)-g.t,k=Math.min(k,g.r)-g.l,m=Math.min(m,g.b)-g.t;a.left=Math.max(f,a.left);a.top=Math.max(h,a.top);a.right=Math.min(k,a.right,a.left+d);a.bottom=Math.min(m,a.bottom,a.top+e)}if(a.clientLeft=a.left,a.clientTop=a.top,a.clientRight=a.right,a.clientBottom=a.bottom,a.left+=b,a.top+=c,a.right+=b,a.bottom+=c,Y)for(var p in a){if(a[p]!=Y[p]){Y=a;T._onClientRectChanged.notify(a);break}}else Y=a,T._onClientRectChanged.notify(a);T._ready.ready()})});T._setScroll=function(a,
b){a&&T._ready.onReady(function(){var b=NaN,c=NaN;"left"in a&&(b=+a.left||0);"top"in a&&(c=+a.top||0);var d=T._pos.length;if(!isNaN(b)||!isNaN(c)){var e=l.getScrollWidth(),f=l.getScrollHeight(),g=l.getClientWidth(),h=l.getClientHeight();if(0==d)return!isNaN(b)&&l.setScrollLeft(Math.min(e-g,b)),void(!isNaN(c)&&l.setScrollTop(Math.min(f-h,c)));for(var k,m,n,p=0,q=0,r=l.getScrollLeft(),t=l.getScrollTop(),v=[],u=0;u<d;u++)if(n=0==u?{l:-r,t:-t,sl:r,st:t,sw:e,sh:f,cw:g,ch:h}:T._pos[u]){if(p-=n.l,0<(k=Math.min(n.sl,
p-b))||0>(k=Math.max(n.sl+n.cw-n.sw,p-b))){if(0!=u&&T._pos[u].x)v.push({i:u,l:k});else try{m=T._dom[u].win.document,l.setScrollLeft(l.getScrollLeft(m)-k,m)}catch(la){}p-=k}if(q-=n.t,0<(k=Math.min(n.st,q-c))||0>(k=Math.max(n.st+n.ch-n.sh,q-c))){if(0!=u&&T._pos[u].x)v.push({i:u,t:k});else try{m=T._dom[u].win.document,l.setScrollTop(l.getScrollTop(m)-k,m)}catch(la){}q-=k}}}})};T.refresh=function(){T._onPropertyChanged.notify()};var Z={},ba=5E3,V=[],X=l.Dialog=function(a){this._messageHandler={};this.opt=
a=a||{};var b=(this.timestamp=a.timestamp||(new Date).getTime(),this.id="dialog_"+ +new Date);Z[b]=this;V.unshift(this);var c=this.type=a.confirm?"confirm":a.src?"frame":"normal",d=this.size=a.size||{};d.w=d.w||("confirm"==this.type?300:400);d.h=d.h||("confirm"==this.type?140:300);var e=(this.sizeDialog=X.getDialogSizeByContentSize(d,a),this.pos=a.pos||{},this.quiet=!!a.quiet);this._loaded=this._submitted=!1;this._context=a.context;var f=this.targetNode=a.targetNode,h=this.dialogBody=document.createElement("div");
h.className=a.hideBorder?e?"midas_minipay_dialog_wrap_no_border_noani":f?"midas_minipay_dialog_wrap_no_border_no_position":"midas_minipay_dialog_wrap_no_border":e?"midas_minipay_dialog_wrap_noani":"midas_minipay_dialog_wrap";this.zIndex=a.zIndex||ba++;l.attachEvent(h,"mousedown",this.setForeground,{self:this});var k=this;if(this._messageHandler.getNickname=function(){k._send("getNickname",a.nickname)},!a.hideHeader){f=this.dialogHeader=document.createElement("div");f.className="midas_minipay_dialog_header";
a.preventDragging||(f.style.cursor="move",this._dragInfo=null,l.attachEvent(f,"mousedown",this._dragStart,{self:this}));a.targetNode&&(f.style.width=d.w+"px");var n=f;"BackCompat"==document.compatMode&&8>=l.ua.ie&&(n=document.createElement("div"),n.style.cssText="position:absolute;width:100%;height:100%;left:0;top:0;",f.appendChild(n));var p=this.backBtn=document.createElement("div");p.style.display="none";p.className="header-icon-first";p.innerHTML='<i class="midas_minipay_dialog_icon midas_minipay_dialog_icon_i midas_minipay_dialog_icon_back"></i>&nbsp;';
n.appendChild(p);var q=this.dialogTitle=document.createElement("div");(q.className="cp-header-title",q.innerHTML=a.title||"",n.appendChild(q),l.attachEvent(p,"mousedown",function(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=!0;this.goBack()},{self:this}),a.hideCloseButton)||(p=this.dialogCloseButton=document.createElement("div"),p.title="\u5173\u95ed",p.className="header-icon-last",p.innerHTML='<i class="midas_minipay_dialog_icon midas_minipay_dialog_icon_i midas_minipay_dialog_icon_clear"></i>&nbsp;',
n.appendChild(p),l.attachEvent(p,"click",function(){this._loaded?(this._messageHandler.confirmClose=function(a){a=a||{};delete this._messageHandler.confirmClose;!1!==a.canClose&&this.close()},this._send("confirmClose")):this.close()},{self:this}));h.appendChild(f)}f=this.dialogContent=document.createElement("div");if(f.className="midas_minipay_dialog_content",f.style.height=d.h+"px","confirm"==c)b=a.confirm,f.innerHTML=['<div class="midas_minipay_dialog_c_c"><i class="midas_minipay_dialog_confirm_icon ',
{1:"midas_minipay_dialog_icon_req",2:"midas_minipay_dialog_icon_error",3:"midas_minipay_dialog_icon_warn",4:"midas_minipay_dialog_icon_ok"}[b.icon]||"midas_minipay_dialog_icon_req",'"></i><h3>',b.content||"",'</h3><div class="midas_minipay_dialog_c_c_p">',b.desc||"",'</div><div class="midas_minipay_dialog_c_c_p"><i class="midas_minipay_dialog_icon_alt ',{1:"midas_minipay_dialog_icon_alt_error",2:"midas_minipay_dialog_icon_alt_warn",3:"midas_minipay_dialog_icon_alt_ok"}[b.iconAlt]||"midas_minipay_dialog_icon_alt_none",
'"><i></i></i>',b.contentAlt||"","</div></div>"].join("");else if("frame"==c){c=["v=",m.dialog,"&_fd_id=",b,"&_fd_c=",N.channel,"&_fd_size=",d.w,"|",d.h,"&_fd_w=",a.wrapper||""];if(e&&c.push("&quiet=1"),a.methods){var r;n=this.methods=a.methods;p=[];for(var t in n)t in this||(r=n[t],r&&"function"!=typeof r||(r=n[t]={method:r}),p.push(t),this[t]=function(a,b){return function(c){"function"==typeof b.method&&b.method.call(this,c);this._send(a,c);(c=b.ret)&&this._flag&&l.valueStat(this._flag,0<=c?1:2,
Math.abs(c),{rate:l.timeBasedRate(b.rate||0)})}}(t,r));c.push("&_fd_ms=",p.join("|"))}r=a.src;r=[r,0<=r.indexOf("?")?"&":"?","cash_param=",encodeURIComponent(c.join(""))].join("");t=this.dialogFrame=document.createElement("iframe");t.className="cash_dialog_frame";t.style.cssText=["width:",d.w,"px;height:",d.h,"px;background:transparent;overflow-x:hidden;"].join("");t.frameBorder="no";t.scrolling="auto";t.allowTransparency="true";t.src="about:blank";this._dialogSrc=r=r+"&t="+(new Date).getTime();f.appendChild(t);
this._stream=new N(g,b)}else f.innerHTML=a.content||"";h.appendChild(f);this.dialogBorder=document.createElement("div");this.dialogBorder.className="midas_minipay_dialog_border";h.appendChild(this.dialogBorder);h=this.dialogMask=document.createElement("div");h.className=e?"midas_minipay_dialog_mask_noani":"midas_minipay_dialog_mask";a.hideMask&&(h.style.display="none");h=this.dialogBackFrame=document.createElement("iframe");h.className=e?"midas_minipay_dialog_backframe_noani":"midas_minipay_dialog_backframe";
h.style.height=d.h+"px";h.frameBorder=0;h.scrolling="no";this.dialogWrapper=document.createElement("div");this._render()};X.construct=function(a,b){a=a||{};for(var c,d="timestamp pos size zIndex quiet context onLoad onFrameLoad onShown onSubmit onNotify onSuccess onError onCancel onClose".split(" "),e=0;c=d[e];e++)b[c]=a[c]||b[c];return new X(b)};X.ICON_TYPE={REQUEST:1,ERROR:2,WARN:3,OK:4};X.ICON_ALT_TYPE={ERROR:1,WARN:2,OK:3};X.getDialogSizeByContentSize=function(a,b){return a=a||{},b=b||{},{w:a.w+
(b.hideBorder?0:20),h:a.h+(b.hideBorder?0:20)+(b.hideHeader?0:40)}};X.fitPos=function(a,b,c){var d=T._getClientRect();!a.x&&(a.x=Math.round((d.right+d.left-b.w)/2));!a.y&&(a.y=Math.round((d.bottom+d.top-b.h)/2));c||(a.x=Math.min(d.right-b.w-5,Math.max(d.left-b.w+60,a.x))+4,a.y=Math.max(d.top+5,Math.min(d.bottom-30,a.y))-5)};X.prototype._render=function(){var a=this;T._ready.onReady(function(){O.insertDialog();var b=a.pos,c=a.sizeDialog,d=a.dialogBody,e=a.dialogBackFrame,f=a.dialogMask,g=a.dialogBorder,
h=a.targetNode;"undefined"==typeof b.x&&"undefined"==typeof b.y&&X.fitPos(b,c);a.quiet?(d.style.cssText=["visibility:hidden;left:-1000px;top:-1000px;width:",c.w,"px;z-index:",a.zIndex,";"].join(""),f.style.cssText=["visibility:hidden;left:-1000px;top:-1000px;width:",c.w,"px;height:",c.h,"px;"].join(""),g.style.cssText=["visibility:hidden;left:0px;top:0px;width:",c.w,"px;height:",c.h,"px;"].join("")):(d.style.cssText=h?"":["left:",b.x,"px;top:",b.y,"px;width:",c.w,"px;z-index:",a.zIndex,";"].join(""),
g.style.cssText=["left:0px;top:0px;width:",c.w,"px;height:",c.h,"px;"].join(""),e.style.cssText=["left:",b.x+"px;","top:",b.y+"px;","width:"+c.w+"px;","height:",c.h+"px;","position:absolute;border:none;z-index:4500;"].join(""));h?(h.insertBefore(d,h.firstChild),h.insertBefore(f,d),f.style.cssText=["visibility:hidden;left:-1000px;top:-1000px;width:",c.w,"px;height:",c.h,"px;"].join("")):(document.body.appendChild(a.dialogWrapper),a.dialogWrapper.appendChild(f),a.dialogWrapper.appendChild(e),a.dialogWrapper.appendChild(d));
a.dialogFrame.setAttribute("src",a._dialogSrc);try{"function"==typeof a.opt.onLoad&&a.opt.onLoad.call(a,{context:a.opt.context})}catch(wa){}})};X.prototype.showBackBtn=function(){"function"==typeof this.opt.onBackButton&&this.opt.onBackButton.call(this,{visible:!0});this.backBtn&&(this.backBtn.style.display="block")};X.prototype.hideBackBtn=function(){"function"==typeof this.opt.onBackButton&&this.opt.onBackButton.call(this,{visible:!1});this.backBtn&&(this.backBtn.style.display="none")};X.prototype.resetTitle=
function(){var a=this.opt;this.dialogTitle&&(this.dialogTitle.innerHTML=a.title||"")};X.prototype.messageCallback=function(a){a=a||{};var b=a.key;b&&"function"==typeof this._messageHandler[b]&&this._messageHandler[b].call(this,a)};X.prototype.goBack=function(){this._send("goback")};X.prototype.resize=function(a,b){if(a){a.w=+a.w;a.h=+a.h;a.x=+a.x;a.y=+a.y;var c=this.size,d=this.pos;d.x=a.x?a.x:a.w?d.x+Math.round((c.w-a.w)/2):d.x;d.y=a.y?a.y:a.h?d.y+Math.round((c.h-a.h)/2):d.y;c.w=a.w||c.w;c.h=a.h||
c.h;a=this.sizeDialog=X.getDialogSizeByContentSize(c,this.opt);X.fitPos(d,a,b);b=this.dialogBody;if((this.dialogMask,this.targetNode)||(b.style.width=a.w+"px"),this.dialogContent&&(this.dialogContent.style.height=c.h+"px"),this.dialogFrame&&(this.dialogFrame.style.cssText=["width:",c.w,"px;height:",c.h,"px;"].join(""),this.dialogBackFrame))b=l.isMinDevice()?31:39,this.dialogBackFrame.style.height=~~this.dialogContent.style.height.replace("px","")+b+"px";this.dialogBorder&&(this.dialogBorder.style.width=
a.w+"px",this.dialogBorder.style.height=a.h+"px");try{"function"==typeof this.opt.onResize&&this.opt.onResize.call(this,c)}catch(ra){}}};X.prototype.enableSubmit=function(){};X.prototype.disableSubmit=function(){};X.prototype.submit=function(){if(!this.quiet)if(this.disableSubmit(),"function"==typeof this.opt.onSubmit){try{var a=this.opt.onSubmit.call(this,{context:this.opt.context})}catch(da){}!1!==a&&("frame"==this.type?this._send("submit"):this.succeed())}else"frame"==this.type?this._send("submit"):
this.succeed()};X.prototype.succeed=function(a){a=a||{};var b=a.timestamp?(new Date).getTime()-a.timestamp:0;a.context=this.opt.context;this._submitted=!0;try{"function"==typeof this.opt.onSuccess&&this.opt.onSuccess.call(this,a)}catch(ua){}this.quiet?this.quit():"confirm"==this.type?this.close():this.enableSubmit();this._flag&&l.valueStat(this._flag,1,21,{rate:l.timeBasedRate(this._rates.succeed||0),duration:b})};X.prototype.show=function(a){a=a||{};a.timestamp?(new Date).getTime()-a.timestamp:0;
if(this.quiet){this.resize(a);var b=this.dialogBody,c=this.dialogMask,d=this.opt.hideBorder;b.style.visibility="visible";c.style.visibility="visible";l.setTimeout(function(){b.className=d?"midas_minipay_dialog_wrap_no_border":"midas_minipay_dialog_wrap";c.className="midas_minipay_dialog_mask"},0,this);this.quiet=!1;try{"function"==typeof this.opt.onShown&&this.opt.onShown.call(this,{context:this.opt.context})}catch(ra){}}};X.prototype.error=function(a){a=a||{};a.timestamp?(new Date).getTime()-a.timestamp:
0;if(a.context=this.opt.context,this.quiet){try{"function"==typeof this.opt.onError?this.opt.onError.call(this,a):a.msg&&aw.show(3,a.msg,3E3)}catch(da){}this.quit()}else{this.enableSubmit();try{"function"==typeof this.opt.onError&&this.opt.onError.call(this,a)}catch(da){}}};X.prototype.close=function(a){!a&&this._send("close");a=a||{};a.timestamp?(new Date).getTime()-a.timestamp:0;if(a.context=this.opt.context,!this.quiet){try{!this._submitted&&"function"==typeof this.opt.onCancel&&this.opt.onCancel.call(this,
a)}catch(da){}try{"function"==typeof this.opt.onClose&&this.opt.onClose.call(this,a)}catch(da){}}this.quit()};X.prototype.setForeground=function(){if(V[0]!=this&&Z[this.id]){for(var a,b=[this],c=0;a=V[c];c++)a!=this&&b.push(a);if(V=b,8E3<=ba)for(ba=5E3,c=V.length-1;0<=c;c--)V[c].zIndex=ba++,V[c].dialogBody.style.zIndex=V[c].zIndex;else this.zIndex=ba++,this.dialogBody.style.zIndex=this.zIndex}};X.prototype.quit=function(){l.detachEvent(this.dialogBody,"click");this.dialogHeader&&l.detachEvent(this.dialogHeader,
"mousedown");this.dialogCloseButton&&l.detachEvent(this.dialogCloseButton,"click");this.dialogFooter&&l.detachEvent(this.dialogFooter,"click");this.dialogBody.className=this.opt.hideBorder?"midas_minipay_dialog_wrap_no_border_noani":"midas_minipay_dialog_wrap_noani";this.dialogBody.style.visibility="hidden";this.dialogBody.style.left="-1000px";this.dialogBody.style.top="-1000px";try{this.dialogMask.parentNode.removeChild(this.dialogMask)}catch(va){}for(var a,b=[],c=0;a=V[c];c++)a!=this&&b.push(a);
V=b;0==b.length&&(ba=5E3);delete Z[this.id];this._stream&&this._stream.close();l.setTimeout(function(){try{this.dialogFrame.src="about:blank",this.dialogFrame.parentNode.removeChild(this.dialogFrame),this.dialogFrame=null,this.dialogContent.innerHTML="",this.dialogContent=null,this.dialogBody&&this.dialogBody.parentNode&&this.dialogBody.parentNode.removeChild(this.dialogBody),this.dialogWrapper.parentNode.removeChild(this.dialogWrapper)}catch(va){}},2E3,this);try{this.dialogBackFrame&&(this.dialogBackFrame.src=
"about:blank",this.dialogBackFrame.parentNode.removeChild(this.dialogBackFrame),this.dialogBackFrame=null)}catch(va){}};X.prototype._dragStart=function(a){if((a.target||a.srcElement)!=this.dialogCloseButton&&!this._dragInfo){this.dialogBody.className=this.opt.hideBorder?"midas_minipay_dialog_wrap_no_border_noani":"midas_minipay_dialog_wrap_noani";this.dialogMask.className="midas_minipay_dialog_mask_noani";var b=document.createElement("div");this.dialogContent&&this.dialogContent.appendChild(b);b.className=
"midas_minipay_dialog_content_mask";this._dragInfo={x:this.pos.x-a.clientX,y:this.pos.y-a.clientY,mask:b};this.dialogHeader&&this.dialogHeader.setCapture?this.dialogHeader.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);l.attachEvent(document.documentElement,"mousemove",this._drag,{self:this});l.attachEvent(document.documentElement,"mouseup",this._dragEnd,{self:this});a.preventDefault?a.preventDefault():a.returnValue=!1}};X.prototype._drag=function(a){if(this._dragInfo){var b=
T._getClientRect(),c=l.getScrollLeft(),d=l.getScrollTop();this.resize({x:this._dragInfo.x+Math.min(b.right-c,Math.max(b.left-c,a.clientX)),y:this._dragInfo.y+Math.min(b.bottom-d,Math.max(b.top-d,a.clientY))},!0);a.preventDefault?a.preventDefault():a.returnValue=!1}};X.prototype._dragEnd=function(a){this._dragInfo&&(l.detachEvent(document.documentElement,"mousemove",this._drag),l.detachEvent(document.documentElement,"mouseup",this._dragEnd),this.dialogHeader&&this.dialogHeader.releaseCapture?this.dialogHeader.releaseCapture():
window.releaseEvents&&window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP),this.dialogContent&&this.dialogContent.removeChild(this._dragInfo.mask),this._dragInfo=null,this.dialogBody.className=this.opt.hideBorder?"midas_minipay_dialog_wrap_no_border":"midas_minipay_dialog_wrap",this.dialogMask.className="midas_minipay_dialog_mask",a.preventDefault?a.preventDefault():a.returnValue=!1)};X.prototype._send=function(a,b){this._stream&&M._call(this._stream,a,b)};X.prototype.visible=function(a){this.dialogBody.style.visibility=
!0===a?"visible":"hidden"};X.prototype._handleRemote=function(a,b){var c,d=((new Date).getTime()-b.timestamp,this.opt);switch(a){case "load":b&&(this.quiet=b.quiet);try{"function"==typeof d.onFrameLoad&&d.onFrameLoad.call(this,{context:d.context})}catch(ra){}this._loaded=!0;break;case "newdialog":na(b,this);break;case "openwindow":try{"function"==typeof d.onOpenWindow&&d.onOpenWindow.call(this,b)}catch(ra){}break;case "notify":try{"function"==typeof d.onNotify&&d.onNotify.call(this,b)}catch(ra){}break;
case "succeed":case "error":case "show":case "close":case "resize":case "enableSubmit":case "disableSubmit":case "showBackBtn":case "hideBackBtn":case "resetTitle":case "messageCallback":case "setForeground":this[a].call(this,b);break;default:return void(d.methods&&(c=d.methods[a])&&"function"==typeof c.method&&c.method.call(this,b))}};l.attachEvent(window,"resize",function(){var a,b,c=Math.max(l.getClientWidth(),l.getScrollWidth()),d=Math.max(l.getClientHeight(),l.getScrollHeight()),e;for(e in Z){var f=
Z[e];f.quiet||(a={},b=!1,f.pos.x>=c-5&&(a.x=c-f.size.w-5,b=!0),f.pos.y>=d-5&&(a.y=d-f.size.h-5,b=!0),b&&f.resize(a))}});T._init();T._updatePos({hasTop:T._hasTop,pos:T._pos});N.channel=l.getIntRandom();N.localPort="lib";l.extend=function(a){for(var b=1;b<=arguments.length;b++)for(var c in arguments[b])a[c]=arguments[b][c];return a};l.each=function(a,b){if(a instanceof Array)for(var c=0,d=a.length;c<d;c++)b(c,a[c]);else if(a instanceof Object)for(c in a)b(c,a[c])};l.loadJs=function(a,b,c){try{a=a instanceof
Array?a:[a];var d=[],e=[];l.each(a,function(a,b){if("string"!=typeof b)throw"Input parameter src invalid!";b.match(/script/i)?e.push(b.match(/<script[^>]*>(.*)?<\/script>/i)[1]):d.push(b)});var f=function(a,b,d){var e=document.getElementsByTagName("head")[0],f=document.createElement("script");if(f.type="text/javascript",f.charset="UTF-8",a?f.src=a:0,b?f.text=b:0,d){var g=function(){"complete"!=f.readyState&&"loaded"!=f.readyState||(d(),f.onload=f.onreadystatechange=new Function,clearTimeout(h))},
h=setTimeout(function(){"complete"!=f.readyState&&c&&c()},5E3);f.onreadystatechange=g;f.onload=function(){f.readyState="complete";g()}}e.appendChild(f)},g=function(){--k;1>k&&(1>m?b?b():0:l.each(e,function(a,b){f(null,b,h)}))},h=function(){--m;1>m&&(b?b():0)},k=d.length,m=e.length;k?l.each(d,function(a,b){f(b,null,g)}):l.each(e,function(a,b){f(null,b,h)})}catch(ta){setTimeout(function(){throw ta;},1)}};H=function(){this.data=[]};H.prototype={push:function(a){a&&this.data.push(a)},lastest:function(){return this.data[this.data.length-
1]},pop:function(){return this.data.pop()},popAll:function(a){for(var b;0<this.data.length;)(b=this.pop())&&a(b)},remove:function(a){if(a)for(var b=this.data.length-1;-1<b;b--)this.data[b]==a&&this.data.slice(b,1)}};var ea=function(a){return"undefined"!=typeof a&&(!!(a.openid&&a.openkey&&a.session_id&&a.session_type)||(a.cookie_wx_id&&l.cookie.get(a.cookie_wx_id)&&a.cookie_wx_token&&l.cookie.get(a.cookie_wx_token)?(a.openid=l.cookie.get(a.cookie_wx_id),a.openkey=l.cookie.get(a.cookie_wx_token),a.session_id=
"hy_gameid",a.session_type="wc_actoken",delete a.cookie_wx_id,delete a.cookie_wx_token):(a.session_id="uin",a.session_type="skey"),!0))},fa=new H,ha=null,aa={subType:[]},na=function(a,b){b.visible(!1);var c=b.dialogHeader,d=null;a.buyType&&aa.subType.push(a.buyType);"qb"===a.buyType?(ha=k.recharge,d={title:"Q\u5e01\u5145\u503c",size:{w:b.opt.size.w,h:580},hideHeader:!c,onClose:function(){b.opt.onSubClose&&b.opt.onSubClose.call(this,{type:a.buyType});b.visible(!0);b._send("qbchargeclose")},methods:{onSuccess:function(){b._send("qbchargesuccess");
e.close()},onResize:function(a){b._send("qbchargeresize",a)}}}):"service"===a.buyType&&(ha=k.service,d={title:"\u5f00\u901a"+a.vipName,hideHeader:!c,size:{w:b.opt.size.w,h:580},onClose:function(){b.opt.onSubClose&&b.opt.onSubClose.call(this,{type:a.buyType});b.visible(!0);b._send("openServiceClose")},methods:{onSuccess:function(){b._send("openServiceSuccess");e.close()},onResize:function(a){b._send("openServiceResize",a)}}});d&&(d.forceHttps=b.opt.forceHttps);b.opt.onOpenWindow&&(d.onOpenWindow=b.opt.onOpenWindow);
b.opt.targetNode&&(d.targetNode=b.opt.relatedNode[a.buyType]);"function"==typeof b.opt.onSubResize&&(d.onResize=function(c){c.type=a.buyType;b.opt.onSubResize.call(this,c)});"function"==typeof b.opt.onSubResize&&(d.onResize=function(c){c.type=a.buyType;b.opt.onSubResize.call(this,c)});"function"==typeof b.opt.onSubBackButton&&(d.onBackButton=function(c){c.type=a.buyType;b.opt.onSubBackButton.call(this,c)});"function"==typeof b.opt.onSubHeaderDataReady&&(d.onHeaderDataReady=function(c){c.type=a.buyType;
b.opt.onSubHeaderDataReady.call(this,c)});try{"function"==typeof b.opt.onSubOpen&&b.opt.onSubOpen.call(this,{type:a.buyType})}catch(xa){}var e=ha(d,a)},ka=function(a){this.opener=a};ka.prototype={setTitle:function(a){this.opener.dialogHeader&&(this.opener.dialogTitle.innerHTML=a.title)}};var ia=function(a,b,c){if(!ea(c))return void(b.onError&&b.onError(-1E3,"\u8bf7\u5148\u767b\u5f55"));var d={game:{sandbox:"https://sandbox.pay.qq.com/midas/minipay_v2/views/cpay/game.shtml",production:"https://pay.qq.com/midas/minipay_v2/views/cpay/game.shtml"},
goods:{sandbox:"https://sandbox.pay.qq.com/midas/minipay_v2/views/cpay/goods.shtml",production:"https://pay.qq.com/midas/minipay_v2/views/cpay/goods.shtml"},qb:{sandbox:"https://sandbox.pay.qq.com/midas/minipay_v2/views/minipay/qb.shtml",production:"https://pay.qq.com/midas/minipay_v2/views/minipay/qb.shtml"},month:{sandbox:"https://sandbox.pay.qq.com/midas/minipay_v2/views/minipay/month.shtml",production:"https://pay.qq.com/midas/minipay_v2/views/minipay/month.shtml"}};a=a||"game";b=b||{};b.src=
~~c.sandbox?d[a].sandbox:d[a].production;b.forceHttps&&(b.src="https:"+b.src);d=[];var e=[];if("game"===a&&"duanyou"!=c.game_type&&(e=["buy_quantity"]),sa(c,e)){(b.methods.onOpenWindow||b.onOpenWindow)&&(c.inApp=1);for(var f in c)"undefined"!=typeof c[f]&&null!=c[f]&&d.push(f+"="+c[f]);d.push("supportCloseConfirm=1");b.nickname&&d.push("canGetNick=1");b.src+="?"+d.join("&");b.preventDragging="undefined"==typeof b.preventDragging||b.preventDragging;b.hideBorder=!0;l.extend(b,b.methods||{},b);var g=
b.onClose||b.methods.onClose;if(b.onClose=function(){fa.remove(this);delete aa[a];g.apply(this,Array.prototype.slice.call(arguments,0))},b.buyType=a,!b.enableMutiDialog){if(aa[a])try{aa[a].close(),delete aa[a]}catch(ma){}c=null;for(f=aa.subType.length-1;0<=f;f--)if(c=aa.subType[f],aa[c])try{aa.subType.splice(f,1),aa[c].close(),delete aa[c]}catch(ma){}}c=new X(b);return b.enableMutiDialog||(aa[a]=c),fa.push(c),c}};k.buyGoods=function(a,b){a=a||{};var c=l.extend({},a||{});c.size=c.size||{w:690,h:550};
c.methods=l.extend({},c.methods||{});b=b||{};a.hideHeader&&(b.show_header=1);b.methods=b.methods||{};b.goodstokenurl=encodeURIComponent(b.goodstokenurl||b.param);delete b.param;try{b.appid=decodeURIComponent(b.goodstokenurl||"").split("/")[3]}catch(ya){}for(var d=["onSuccess"],e=0,f=d.length;e<f;++e)b[d[e]]&&(c.methods[d[e]]=b[d[e]],delete b[d[e]]);if(delete b.methods,c.methods.onHeaderDataReady=function(b){if(b.title){this.dialogTitle&&(this.dialogTitle.innerHTML=b.title);try{"function"==typeof a.onHeaderDataReady&&
a.onHeaderDataReady.call(this,b)}catch(ma){}}},!ea(b))return void(c.onError&&c.onError(-1E3,"\u8bf7\u5148\u767b\u5f55"));c=ia("goods",c,b);return new ka(c),l.report(b.openid,"goods","pv",{sandbox:~~b.sandbox,appid:b.appid}),c};k.buyGame=function(a,b){var c={size:{w:690,h:"true"===b.showRecommend||!0===b.showRecommend?700:530},methods:{onHeaderDataReady:function(b){b.title&&this.dialogTitle&&(this.dialogTitle.innerHTML=b.title);try{"function"==typeof a.onHeaderDataReady&&a.onHeaderDataReady.call(this,
b)}catch(xa){}}},title:"\u5145\u503c\u6e38\u620f\u5e01"},d=c.methods;l.extend(c,a);c.methods=l.extend(d,a.methods);b=b||{};a.hideHeader&&(b.show_header=1);c.title=c.title.replace(/</g,"&lt;").replace(/>/g,"&gt;");c=ia("game",c,b);return l.report(b.openid,"game","pv",{sandbox:~~b.sandbox,appid:b.appid}),c};var sa=function(a,b){b=["appid","pf","session_id","session_type"].concat(b);return l.each(b,function(b,c){if(!a[c])throw Error(c+"\u53c2\u6570\u7f3a\u5931,\u8bf7\u53c2\u8003\u4f7f\u7528\u6587\u6863");
}),!0};k.recharge=function(a,b){var c,d,e={title:"\u5145\u503cQ\u5e01",size:{w:690,h:580},methods:{onHeaderDataReady:function(b){b.title?d.setTitle(b):d.update(b);try{"function"==typeof a.onHeaderDataReady&&a.onHeaderDataReady.call(this,b)}catch(ma){}}}},f=e.methods;return l.extend(e,a),e.methods=l.extend(f,a.methods),b=b||{},a.hideHeader&&(b.show_header=1),e.title=e.title.replace(/</g,"&lt;").replace(/>/g,"&gt;"),c=ia("qb",e,b),d=new qa(c,"qb"),l.report(b.openid,"qb","pv",{sandbox:~~b.sandbox,appid:b.appid}),
c};var qa=function(a,b){this.opener=a;this.agreeButton=this.ruleButton=null;this.opener=a;this.ruleUrl=null;this.checked=!0;this.type=b};qa.prototype=l.extend({},ka.prototype,{_genMonthHeaderHtml:function(a){return'<div class="prop-custom-title" style="user-select:none"><img src="'+a.logo+'"><span>'+l.xssFilter(a.name)+'</span><div id="month-agreewrap" class="form-group checkbox-box service checked"><label for="vip1"><input type="checkbox" name="vip"><i id="month-agree" class="icon-checkbox"></i> \u540c\u610f\u300a<a id="month-rule" href="javascript:void(0);">\u670d\u52a1\u6761\u6b3e</a>\u300b</label></div></div>'},
_genQbHeaderHtml:function(a){return'<div class="prop-custom-title" style="user-select:none"><img src="'+a.logo+'"><span>'+l.xssFilter(a.name)+'</span><div id="qb-agreewrap" class="form-group checkbox-box service checked"><label for="vip1"><input type="checkbox" name="vip"><i id="qb-agree" class="icon-checkbox"></i> \u540c\u610f\u300a<a id="qb-rule" href="javascript:void(0);">\u670d\u52a1\u6761\u6b3e</a>\u300b</label></div></div>'},update:function(a){if(this.opener.dialogHeader){if(this.ruleButton&&
l.detachEvent(this.ruleButton,"click"),this.agreeButton&&l.detachEvent(this.agreeButton,"click"),"service"===this.type)this.opener.dialogTitle.innerHTML=this._genMonthHeaderHtml(a),this.agreeButton=document.getElementById("month-agree"),this.ruleButton=document.getElementById("month-rule"),this.agreeWrapButton=document.getElementById("month-agreewrap");else{if("qb"!==this.type)return;this.opener.dialogTitle.innerHTML=this._genQbHeaderHtml(a);this.agreeButton=document.getElementById("qb-agree");this.ruleButton=
document.getElementById("qb-rule");this.agreeWrapButton=document.getElementById("qb-agreewrap")}this.ruleUrl=a.ruleUrl;l.attachEvent(this.agreeButton,"click",function(a){this.checked=!this.checked;this.agreeWrapButton.className=this.checked?"form-group checkbox-box service checked":"form-group checkbox-box service";this.opener._send("agree",{checked:this.checked,left:this.agreeButton.getBoundingClientRect().left-this.opener.dialogTitle.getBoundingClientRect().left})},{self:this});l.attachEvent(this.ruleButton,
"click",function(a){this.opener.opt.onOpenWindow?this.opener.opt.onOpenWindow(this.ruleUrl):this.opener._send("rule")},{self:this})}}});k.service=function(a,b){var c,d,e={title:"\u5f00\u901a\u5305\u6708",size:{w:690,h:580},methods:{onHeaderDataReady:function(b){b.title?d.setTitle(b):d.update(b);try{"function"==typeof a.onHeaderDataReady&&a.onHeaderDataReady.call(this,b)}catch(ma){}},onMonthChange:function(b){try{"function"==typeof a.onMonthChange&&a.onMonthChange.call(this,b)}catch(ma){}}}},f=e.methods;
return l.extend(e,a),e.methods=l.extend(f,a.methods),b=b||{},a.hideHeader&&(b.show_header=1),b.screen_type=l.isMinDevice()?"min":"normal",e.title=e.title.replace(/</g,"&lt;").replace(/>/g,"&gt;"),c=ia("month",e,b),d=new qa(c,"service"),l.report(b.openid,"month","pv",{sandbox:~~b.sandbox,appid:b.appid}),c};k.back=function(){fa.lastest().goBack()};k.close=function(){fa.popAll(function(a){a.close()})}}()}]);window.onSubProjectReady=function(f){function n(d){if(!m[d]){if(!f[d])return console.warn("Cannot find module:"+d),null;var b=m[d]={exports:{}};f[d].call(b.exports,function(a){return n(a)},b,b.exports)}return m[d].exports}for(var m={},h=Object.keys(f).length,e=0;e<h;e++)n(e);return n};
window._g_E=function(){var f=function(n,m){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,e){f.__proto__=e}||function(f,e){for(var d in e)e.hasOwnProperty(d)&&(f[d]=e[d])})(n,m)};return function(n,m){function h(){this.constructor=n}f(n,m);n.prototype=null===m?Object.create(m):(h.prototype=m.prototype,new h)}}();
window._g_D=function(f,n,m,h){var e,d=arguments.length,b=3>d?n:null===h?h=Object.getOwnPropertyDescriptor(n,m):h;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)b=Reflect.decorate(f,n,m,h);else for(var a=f.length-1;0<=a;a--)(e=f[a])&&(b=(3>d?e(b):3<d?e(n,m,b):e(n,m))||b);return 3<d&&b&&Object.defineProperty(n,m,b),b};
window._g_W=function(f,n,m,h){return new (m||(m=Promise))(function(e,d){function b(a){try{c(h.next(a))}catch(k){d(k)}}function a(a){try{c(h.throw(a))}catch(k){d(k)}}function c(c){c.done?e(c.value):(new m(function(a){a(c.value)})).then(b,a)}c((h=h.apply(f,n||[])).next())})};
window._g_G=function(f,n){function m(a){return function(b){return h([a,b])}}function h(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,d&&(b=2&a[0]?d.return:a[0]?d.throw||((b=d.return)&&b.call(d),0):d.next)&&!(b=b.call(d,a[1])).done)return b;switch(d=0,b&&(a=[2&a[0],b.value]),a[0]){case 0:case 1:b=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;d=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(b=0<(b=c.trys).length&&
b[b.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!b||a[1]>b[0]&&a[1]<b[3]))c.label=a[1];else if(6===a[0]&&c.label<b[1])c.label=b[1],b=a;else if(b&&c.label<b[2])c.label=b[2],c.ops.push(a);else{b[2]&&c.ops.pop();c.trys.pop();continue}}a=n.call(f,c)}catch(k){a=[6,k],d=0}finally{e=b=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var e,d,b,a,c={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
return a={next:m(0),throw:m(1),return:m(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};
window.boot=function(f){function n(){var a=document.getElementById("splash"),b=a.querySelector(".progress-bar span");cc.loader.onProgress=function(a,c,d){b&&(b.style.width=(100*a/c).toFixed(2)+"%")};a.style.display="block";b.style.width="0%";cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){setTimeout(function(){a.style.display="none"},500)})}var m=window._CCSettings;if(!m.debug){var h=m.uuids,e=m.rawAssets,d=m.assetTypes,b=m.rawAssets={},a;for(a in e){var c=e[a],g=b[a]={},k;for(k in c){var l=
c[k],q=l[1];"number"===typeof q&&(l[1]=d[q]);g[h[k]||k]=l}}e=m.scenes;for(d=0;d<e.length;++d)b=e[d],"number"===typeof b.uuid&&(b.uuid=h[b.uuid]);e=m.packedAssets;for(var r in e)for(d=e[r],b=0;b<d.length;++b)"number"===typeof d[b]&&(d[b]=h[d[b]]);r=m.subpackages;for(var t in r)if(e=r[t].uuids)for(d=0,b=e.length;d<b;d++)"number"===typeof e[d]&&(e[d]=h[e[d]])}h=m.debug?m.jsList:null;f="src/"+f;if(h){for(t=h.length-1;0<=t;t--)0<=h[t].indexOf("AppDefines")?h.splice(t,1):h[t]="src/"+h[t];h.push(f)}else h=
[f];f={id:"GameCanvas",scenes:m.scenes,debugMode:m.debug?cc.debug.DebugMode.INFO:cc.debug.DebugMode.ERROR,showFPS:m.debug,frameRate:60,jsList:h,groupList:m.groupList,collisionMatrix:m.collisionMatrix};window.addEventListener("error",function(a){a.error&&"This device does not support webgl"==a.error.message&&(alert("\u60a8\u7684\u8bbe\u5907\u4f3c\u4e4e\u4e0d\u592a\u517c\u5bb9\uff0c\u8bf7\u786e\u8ba4\u663e\u5361\u9a71\u52a8\u7a0b\u5e8f\u5df2\u7ecf\u6b63\u786e\u5b89\u88c5\uff01"),window.electron&&window.electron.require("app").quit())});
cc.AssetLibrary.init({libraryPath:"res/import",rawAssetsBase:"res/raw-",rawAssets:m.rawAssets,packedAssets:m.packedAssets,md5AssetsMap:m.md5AssetsMap,subpackages:m.subpackages});window.AppDefines||(window.AppDefines={});window.AppDefines.PublicPlatform=window.electron?window.qqgame?7:window.process&&"darwin"===window.process.platform?9:8:6;console.log=function(){};console.debug=function(){};console.warn=function(){};console.error=function(){};console.time=function(){};console.timeEnd=function(){};
0<window.navigator.maxTouchPoints&&(cc.sys.capabilities.touches=!0);cc.game.run(f,function(){cc.loader.downloader._subpackages=m.subpackages;cc.view.enableRetina(!0);cc.view.resizeWithBrowserSize(!0);cc.sys.isBrowser&&n();cc.sys.isMobile&&("landscape"===m.orientation?cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE):"portrait"===m.orientation&&cc.view.setOrientation(cc.macro.ORIENTATION_PORTRAIT),cc.view.enableAutoFullScreen(0>[cc.sys.BROWSER_TYPE_BAIDU,cc.sys.BROWSER_TYPE_WECHAT,cc.sys.BROWSER_TYPE_MOBILE_QQ,
cc.sys.BROWSER_TYPE_MIUI].indexOf(cc.sys.browserType)));cc.sys.isBrowser&&cc.sys.os===cc.sys.OS_ANDROID&&(cc.macro.DOWNLOAD_MAX_CONCURRENT=2);(function(a){cc.director.loadScene(a,null,function(){if(cc.sys.isBrowser){document.getElementById("GameCanvas").style.visibility="";var b=document.getElementById("GameDiv");b&&(b.style.backgroundImage="")}cc.loader.onProgress=null;console.log("Success to load scene: "+a)})})(m.launchScene)})};
